!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("leaflet")):"function"==typeof define&&define.amd?define(["leaflet"],e):e(t.L)}(this,function(B){"use strict";var e=(B=B&&B.hasOwnProperty("default")?B.default:B).Marker.prototype.onAdd,n=B.Marker.prototype.onRemove;B.Marker.mergeOptions({bounceOnAdd:!1,bounceOnAddOptions:{duration:1e3,height:-1},bounceOnAddCallback:function(){}}),B.Marker.include({_toPoint:function(t){return this._map.latLngToContainerPoint(t)},_toLatLng:function(t){return this._map.containerPointToLatLng(t)},_motionStep:function(t,e){var n=this,i=(new Date-e.start)/e.duration;1<i&&(i=1);var r=n._easeOutBounce(i);e.step(r),1!==i?B.Util.requestAnimFrame(function(t){n._motionStep(t,e)}):e.end()},_bounceMotion:function(e,n){var i=B.latLng(this._origLatlng),r=this._dropPoint.y,o=this._dropPoint.x,s=this._point.y-r,a=this;a._bLock||(a._bLock=!0,B.Util.requestAnimFrame(function(t){a._motionStep(t,{delay:10,duration:e||1e3,start:new Date,step:function(t){a._dropPoint.y=r+s*t-(a._map.project(a._map.getCenter()).y-a._origMapCenter.y),a._dropPoint.x=o-(a._map.project(a._map.getCenter()).x-a._origMapCenter.x),a.setLatLng(a._toLatLng(a._dropPoint))},end:function(){a._bLock=!1,a.setLatLng(i),"function"==typeof n&&n()}})}))},_easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounce:function(t,e){this._origLatlng=this.getLatLng(),this._bounce(t,e)},_bounce:function(t,e){"function"==typeof t&&(e=t,t=null),"number"==typeof(t=t||{duration:1e3,height:-1})&&(t.duration=arguments[0],t.height=arguments[1]),this._origMapCenter=this._map.project(this._map.getCenter()),this._dropPoint=this._getDropPoint(t.height),this._bounceMotion(t.duration,e)},_getDropPoint:function(t){this._point=this._toPoint(this._origLatlng);var e=void 0;return e=void 0===t||t<0?this._toPoint(this._map.getBounds()._northEast).y:this._point.y-t,new B.Point(this._point.x,e)},onAdd:function(t){this._map=t,this._origLatlng=this._latlng,!0===this.options.bounceOnAdd&&(void 0!==this.options.bounceOnAddDuration&&(this.options.bounceOnAddOptions.duration=this.options.bounceOnAddDuration),void 0!==this.options.bounceOnAddHeight&&(this.options.bounceOnAddOptions.height=this.options.bounceOnAddHeight),this._dropPoint=this._getDropPoint(this.options.bounceOnAddOptions.height),this.setLatLng(this._toLatLng(this._dropPoint))),e.call(this,t),!0===this.options.bounceOnAdd&&this._bounce(this.options.bounceOnAddOptions,this.options.bounceOnAddCallback)},onRemove:function(t){clearInterval(this._intervalId),n.call(this,t)}}),B.Map.mergeOptions({contextmenuItems:[]}),B.Map.ContextMenu=B.Handler.extend({_touchstart:B.Browser.msPointer?"MSPointerDown":B.Browser.pointer?"pointerdown":"touchstart",statics:{BASE_CLS:"leaflet-contextmenu"},initialize:function(t){B.Handler.prototype.initialize.call(this,t),this._items=[],this._visible=!1;var e=this._container=B.DomUtil.create("div",B.Map.ContextMenu.BASE_CLS,t._container);e.style.zIndex=1e4,e.style.position="absolute",t.options.contextmenuWidth&&(e.style.width=t.options.contextmenuWidth+"px"),this._createItems(),B.DomEvent.on(e,"click",B.DomEvent.stop).on(e,"mousedown",B.DomEvent.stop).on(e,"dblclick",B.DomEvent.stop).on(e,"contextmenu",B.DomEvent.stop)},addHooks:function(){var t=this._map.getContainer();B.DomEvent.on(t,"mouseleave",this._hide,this).on(document,"keydown",this._onKeyDown,this),B.Browser.touch&&B.DomEvent.on(document,this._touchstart,this._hide,this),this._map.on({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},removeHooks:function(){var t=this._map.getContainer();B.DomEvent.off(t,"mouseleave",this._hide,this).off(document,"keydown",this._onKeyDown,this),B.Browser.touch&&B.DomEvent.off(document,this._touchstart,this._hide,this),this._map.off({contextmenu:this._show,mousedown:this._hide,movestart:this._hide,zoomstart:this._hide},this)},showAt:function(t,e){t instanceof B.LatLng&&(t=this._map.latLngToContainerPoint(t)),this._showAtPoint(t,e)},hide:function(){this._hide()},addItem:function(t){return this.insertItem(t)},insertItem:function(t,e){e=void 0!==e?e:this._items.length;var n=this._createItem(this._container,t,e);return this._items.push(n),this._sizeChanged=!0,this._map.fire("contextmenu.additem",{contextmenu:this,el:n.el,index:e}),n.el},removeItem:function(t){var e=this._container;return isNaN(t)||(t=e.children[t]),t?(this._removeItem(B.Util.stamp(t)),this._sizeChanged=!0,this._map.fire("contextmenu.removeitem",{contextmenu:this,el:t}),t):null},removeAllItems:function(){for(var t=this._container.children,e=void 0;t.length;)e=t[0],this._removeItem(B.Util.stamp(e));return t},hideAllItems:function(){var t,e=void 0;for(e=0,t=this._items.length;e<t;e++)this._items[e].el.style.display="none"},showAllItems:function(){var t,e=void 0;for(e=0,t=this._items.length;e<t;e++)this._items[e].el.style.display=""},setDisabled:function(t,e){var n=this._container,i=B.Map.ContextMenu.BASE_CLS+"-item";isNaN(t)||(t=n.children[t]),t&&B.DomUtil.hasClass(t,i)&&(e?(B.DomUtil.addClass(t,i+"-disabled"),this._map.fire("contextmenu.disableitem",{contextmenu:this,el:t})):(B.DomUtil.removeClass(t,i+"-disabled"),this._map.fire("contextmenu.enableitem",{contextmenu:this,el:t})))},isVisible:function(){return this._visible},_createItems:function(){var t,e=this._map.options.contextmenuItems,n=void 0;for(n=0,t=e.length;n<t;n++)this._items.push(this._createItem(this._container,e[n]))},_createItem:function(t,e,n){if(e.separator||"-"===e)return this._createSeparator(t,n);var i=B.Map.ContextMenu.BASE_CLS+"-item",r=e.disabled?i+" "+i+"-disabled":i,o=this._insertElementAt("a",r,t,n),s=this._createEventHandler(o,e.callback,e.context,e.hideOnSelect),a=this._getIcon(e),u=this._getIconCls(e),l="";return a?l='<img class="'+B.Map.ContextMenu.BASE_CLS+'-icon" src="'+a+'"/>':u&&(l='<span class="'+B.Map.ContextMenu.BASE_CLS+"-icon "+u+'"></span>'),o.innerHTML=l+e.text,o.href="#",B.DomEvent.on(o,"mouseover",this._onItemMouseOver,this).on(o,"mouseout",this._onItemMouseOut,this).on(o,"mousedown",B.DomEvent.stopPropagation).on(o,"click",s),B.Browser.touch&&B.DomEvent.on(o,this._touchstart,B.DomEvent.stopPropagation),B.Browser.pointer||B.DomEvent.on(o,"click",this._onItemMouseOut,this),{id:B.Util.stamp(o),el:o,callback:s}},_removeItem:function(t){var e,n=void 0,i=void 0,r=void 0,o=void 0;for(r=0,e=this._items.length;r<e;r++)if((n=this._items[r]).id===t)return i=n.el,(o=n.callback)&&(B.DomEvent.off(i,"mouseover",this._onItemMouseOver,this).off(i,"mouseover",this._onItemMouseOut,this).off(i,"mousedown",B.DomEvent.stopPropagation).off(i,"click",o),B.Browser.touch&&B.DomEvent.off(i,this._touchstart,B.DomEvent.stopPropagation),B.Browser.pointer||B.DomEvent.on(i,"click",this._onItemMouseOut,this)),this._container.removeChild(i),this._items.splice(r,1),n;return null},_createSeparator:function(t,e){var n=this._insertElementAt("div",B.Map.ContextMenu.BASE_CLS+"-separator",t,e);return{id:B.Util.stamp(n),el:n}},_createEventHandler:function(e,n,i,r){var o=this,s=this._map,a=B.Map.ContextMenu.BASE_CLS+"-item-disabled";r=void 0===r||r;return function(t){B.DomUtil.hasClass(e,a)||(r&&o._hide(),n&&(console.log(o),n.call(i||s,o._showLocation)),o._map.fire("contextmenu.select",{contextmenu:o,el:e}))}},_insertElementAt:function(t,e,n,i){var r=void 0,o=document.createElement(t);return o.className=e,void 0!==i&&(r=n.children[i]),r?n.insertBefore(o,r):n.appendChild(o),o},_show:function(t){this._showAtPoint(t.containerPoint,t)},_showAtPoint:function(t,e){if(this._items.length){var n=this._map,i=n.containerPointToLayerPoint(t),r=n.layerPointToLatLng(i),o=B.extend(e||{},{contextmenu:this});this._showLocation={latlng:r,layerPoint:i,containerPoint:t},e&&e.relatedTarget&&(this._showLocation.relatedTarget=e.relatedTarget),this._setPosition(t),this._visible||(this._container.style.display="block",this._visible=!0),this._map.fire("contextmenu.show",o)}},_hide:function(){this._visible&&(this._visible=!1,this._container.style.display="none",this._map.fire("contextmenu.hide",{contextmenu:this}))},_getIcon:function(t){return B.Browser.retina&&t.retinaIcon||t.icon},_getIconCls:function(t){return B.Browser.retina&&t.retinaIconCls||t.iconCls},_setPosition:function(t){var e=this._map.getSize(),n=this._container,i=this._getElementSize(n),r=void 0;this._map.options.contextmenuAnchor&&(r=B.point(this._map.options.contextmenuAnchor),t=t.add(r)),(n._leaflet_pos=t).x+i.x>e.x?(n.style.left="auto",n.style.right=Math.min(Math.max(e.x-t.x,0),e.x-i.x-1)+"px"):(n.style.left=Math.max(t.x,0)+"px",n.style.right="auto"),t.y+i.y>e.y?(n.style.top="auto",n.style.bottom=Math.min(Math.max(e.y-t.y,0),e.y-i.y-1)+"px"):(n.style.top=Math.max(t.y,0)+"px",n.style.bottom="auto")},_getElementSize:function(t){var e=this._size,n=t.style.display;return e&&!this._sizeChanged||(e={},t.style.left="-999999px",t.style.right="auto",t.style.display="block",e.x=t.offsetWidth,e.y=t.offsetHeight,t.style.left="auto",t.style.display=n,this._sizeChanged=!1),e},_onKeyDown:function(t){27===t.keyCode&&this._hide()},_onItemMouseOver:function(t){B.DomUtil.addClass(t.target||t.srcElement,"over")},_onItemMouseOut:function(t){B.DomUtil.removeClass(t.target||t.srcElement,"over")}}),B.Map.addInitHook("addHandler","contextmenu",B.Map.ContextMenu),B.Map.mergeOptions({zoomControl:!1,attributionControl:!1}),B.Map.include({getPopup:function(){return this._popup},getScale:function(){var t=this.getBounds(),e=this.getSize(),n=111*((t.getNorthEast().lng-t.getSouthWest().lng)/e.x)*1e3*100*B.Util.getDPI()/2.54;return Math.round(n)}}),B.Icon.Default.mergeOptions({iconUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",iconRetinaUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAYAAAAWy4frAAAPiElEQVR42t1bCVCU5xkmbabtZJJOO+l0mhgT0yQe0WXZgz2570NB8I6J6UzaTBoORRFEruVGDhWUPRAQRFFREDnVxCtEBRb24DBNE3Waaatpkmluo4m+fd9v999olGVBDu3OPLj+//s+7/W93/f9//6/EwA4/T9g3AlFOUeeUGR2uMqzOyJk2R2x0qyOAmnmkS3SrCPrZJlHlsqzjypcs49OX1Jf//P7KhD885A0u10my2ovQscvybI6wEF8ivI7pFntAV6qkw9PWSBK1bEnZRltm2WZ7R8h4FbI0VG33GPgXXgCAra+A4EIn8KT4JH/FigoiJ/IIz6TZbVVKLLan5u0QESqlkckWW3p0sy2bxDAgZwO13TDytoB+NPe9+zild2DEFGuB7/NpzDodriF55o0o7XIRXXoNxMaiCSj9VU09C8EENxyj0C4thterh2EV+veuwOr6s7Dy3ssoO93k3llzxBE6PTgkXcMOF7EJ9KMtqjR9JFDQnNV9b+QqlqqEECQZ7TBgu1nYdXuIXgVneSwYtcgRFb1Q1iFGULLzRCsM90GOrZghxkiKvthec0grLpFlxCu6cKh1w6cHUSbctPhx8YlEElu4+NSVfNpBBACtpyGlbsGmBOElRhMBDofgk4GobOjQXC5CRZiUC/VDtn4qLrBJZ3A2cNg+nE4P31PgSDBbImq5UNJejMQFqi7cCicZ3iZBTAAQVoTBI4DKKCVGBDHH6nrBRlWxWr7sljVIhlTIDLVoRkS1eH/SNIPgzyzFRZV9NnG++LqQcyoGQLQgfFEIFYpcueAzc6SSiMOtTYgH9CXr+WpTbxRBeKlqn9UktZkRoACZ5PlO81YgfMM4RX9EKAxTSjCdvTjELPYW17dD8rsdiBfEBclSY2POxQIHnlIknroEAJk6U2wpMLISF/aNQShWAV/tWlSEIK2VqBNsr200gRyGmLokyS18cTdFtA7AnFNbcxAACGMrQtDLAjqBT+1cVJBNsk2+bBQ1wOcX5K0xs12A8GyzXRNafgeAYFb3mEkrBI4I/mWGUeNQI1lyp2PoO9j4aDKcH4Ebe0E8g3xgyylcc6wgbimNjSSoFtWK1sTqLRh2BM+SOgIfDGLJL8IG3ZZjUX/ViyvGYLFOwdZn/ljYI7yzsee4TjcsV/IR3FqQ+tdAxEnNSjFyQeBEK7pgRVodEnVIPhsNzqEYK0ZluFsRnq3YjH22KJyA6z4yTmSpZ5zlH8RTvWkt1CrB85PYUqjzx2BuG6sPyfeeAA8sjtwphhiCFSbwXub0S7ISPiOAZvO4h048xSfBM+cDpDieCZOggSz6JHdBv5FJ3CN6LPJR1QMgO9204h2aALgdDxzjlp4kw8YaHKyBSJJPigWb6wHQiRmbxkKL0QDXkhgD94YxGKsGskTQkvfxVnlIHBcBNfkegziwB3HAnHDuGynRXcp/utXZhrRHiWM5CPLjbdwHVDYAhFt3J8rTtoPbpktSDrE4INZ8iw12kUYEpPs4kozeOW0A3EQIovbYcfxITj798vwxbfX4Or1H8B46ROo7fwbvKY9bpNzy2hmiSOOyMrBEe2RT5x/7tjHxCFK2l/4YyBJ+95HQABmibKzEJvRs9RgF4FqE5MleGS3AumLN+6D4lYjfIeOD/e5eROg7sz7oEg7wHRk6Y3Yi/2MJwT7bCS75BvJBuGsSvqID1ggaHyeaAMeQERgyajBg3BG8SgxDAsvJFxUOcBkg7d0Ml3XjfuhCyvg6Ofix1+Al6qB6fpueotxsckFh5A92+QbydHw4vymGJxEG+rWiRL3goJWcSwvwbPECO5bDcMiRGNmchS4a1I9kP62DhOM9tPad4npEhaUdTPOsPJ+u7bJN85PpaqJ6YoT6xKcRIl1pQjwxIukxXhyIY57N1Swh7DyASbrm38MSHdRUStc+/4GjOUTV32acbhlNjNO6pWR7FPTk6xX3lGmK0ys0zrhn0Zhwh7wK3ibnVyg6we3LQa7WFQxyGSpiqRbe/o8jPXTe+EK4xDjECHOxdYRYc8++UhyfgXHma5w/Z5mJ+H63T3ChN3Y6O/guMcxj8NGicLDgYyQ3CKcnsUbMBuoa7j48ZgD+erqdczqbsYTpulj3LSu2POBfCQ58pn0EH1OwoTafwvX1+JV2VmIxEwHlJlBsdkwLHy2mZjcgjI9kJ4Ynbh6/Xu4l09YfhPjCsSJg7hpIbbng/92M5Mjn0kPcdlJGF/7JQJCSrsgAseeHzoqL+4bFnSe5EJKzgHpeaTsg3v9rCrtYFz+hScZdzAGYs8HX84H9Jn0KAYnQfyuIQT4Y5mo0akiMhQeDh44tEguXGcE0iP845MvxxzEjRs3QZ5Ux3hCtnUxbqq6PR/8cRdAcuSz1YfzGEhNm2BdDfjkvw0LcTYKokCK+oaFAolIjiDFBYl02/oujDmQC1c+ZxzC+BoIp2t35HXHPrDnA/lIcuQz6SKOOAnWVqsRbHscjidDNf0gRWF7CNX2M1l3VTOQbmpd55gDqT01xDhkmBTiJMhGsB+isdrPbGe6wrU15RjIzkQEyHB3GqYbYCAiSeHwCMBmI7mAYiwt6grX7QT9h5dHHcQ/P/sKlEm7GYd37lHGGaLut2tbirD5iT6TriCuKsVJsLrCwyWuih2Yj/unMC2VFlfsgr5hodxsZHIEZVoTkP787APw7TXHZy/ac/25rJ3pSpP24tRrZnyeW012bbtZbS9AefKZ+b6mMtjJS6V6GP/zOR3wK+pkQn7bzHbJCCRDsqFlBpz+djHCV7a2wMUr/x0xiM++ugprq45bnFhbhdNoF+MKLOt32C75SvqIb7xUO3/Fdr/8uMqDLmsqwU3VipH2QzA2k3hTr11ICnqZHMn7F+HCFIfZQQ5JfDVUvW1mzv708/V316FV/wF4Je9hsgSv3GOMYz71Jg6bkezS0CN5N1WLhSOussW2jResrnzNZXUFm5PnW0nl2CciVLQHebHBJh9U0g1S3GYQD4eQjH2QWH0C0utw15DXAEIybD0nxoUsYPMZmz4N59HYE+K0SzyC2Mo3bIHw4zTT+Kt33ESAX/FZCMWovUtMIMzvHRFKJA9G+VAGvJ7IPsKGC3HdDYI4qnwzhJQZmQ5l2AODcMSWb6mJ6fgWn+H4bsxbWzX9tmt2l9Xl7fzYcpwJGhl5MI5XESoL8kaGKB9XWww8xOoYIXBrD3hvOgnK9BbEYdypHsctSBcGYLbJ+FMvbupz2AanJ01uAPLVJab88B03H1xidKH8WB0TCCq1KNEM4YgRDm7FRlys+m8L6G6gJLmPkpuqxhJU0st8JF8FMeV+dwTipFL9zDlGewmB1wYdzJh/qRlccntHDcqevBCv6NBZ3xIz+CGP5xYTKIoMIMZzo+UTIAK3WRKgULUB+egcrTs/7A06XpQ20Tlai+O4mm0DKLuSAgPwkWgqIcOkkC+BOBRdVlcC+ciL0kUNG4jodd3vnKM13yHAK/8UBG6nTBrBOUc/pfDBRZJ88cg9DuQbL1rzxdw3yx61exPbOUazi4Rd8VqYMhBIwyunF5yz9VMCUV6vxQ+ECJcH8s05SlMy4t145xi1jAkjfIu7GIESxzYPSacC1Gfkg3fhGbD6ddMlVvuCQz/0oHAfKclSmiAAK0JN75zdC/Oy9JMKanKyTxBvOGAJJEbd4fAvVrxo9UukxMfZwbu4hwWiKDLCXCSfTNAUTba9Cs5x1SD4OBwIm4qjNQOkKE1uBH+aQkssVZmbqZ8UCLAvyS5BnLDf2hvaE6P+MZQfpYngsuBd2A1+W7EqBUZ4MUM/KXAvMjGbHvm23gCXaI1yTD9Po7KezWBJB8EXp0ACD0s+J6NnQkGzJGdPlFDHBdI+5t/Z+dGaQC4bHpvOgg+uznJcIGereiYUykIjs+WW22mrBi9WLbqnJx9wlugkIlHifvBGcgLNKLPQ4ESA+pCzI4jfwy2Ajff8CAduWzy4rLjnnWEGqFdmpfdMCKgaZEOZc5qrxg3nWM28cXmohhetPcqqsn4veG02MczDmWVmWs+4wjmr18YvWFfLBVI3bk8HubxZ5spVRZHTyQzJsSovoPHxhAKrQdyKrFNcED/wo8pnjuvzWrgHayJyIY5bz2ITw1ycJp9P7R4X8LDCHK/L2l0sEH60tmrcHzzjRet4tM9hVck+xQzKNxnGLRDqO+KUZZ7gqnHdZY1mxoQ8QUfjlYwI1taCBy5YBKrKcynd9wTqNwufEfhrqq17Ko16wh4FpPFK45ZtKDNOgnshZjDfAH9M7r4nyPONjEua/hZXjav8NzTTJvThTF6UppJtF+JqwA2NE15U6eFZdGgsmJvRyziUeBXIX7PT2huazRP+lKkgavszeM18jW0oVcfBrYCqYoRnN3aPGlw1iMM17ai1Gtqvnd/Q/H5SnvvF7f12ljkcz0psUmWBpSoz0LnRgKpBugq6L8CuxSkQde6kPcAsWqN7Ao1+yzaUacdAsckI0jwDPJPU5TBmbOxi/UW64pQOrjc+5/1V/dtJfRIbrw0KWFVWV+Hw6GNDZE6aHp7e0OUQ5qTrmY48rw/4sRWW3ojSpk36I+Wzo7Y/7hyl+ZJtXVI7WJ+45hrgacz29A32QTISrCDpiJLbuWp8Oiuh8jGYiof8eTHqDEtVKkCGmZVZqzI9scsuSIZkZXTfKnYHt8NNmLK3FaQxpb9GJz5jVcHMclWhrD+VeHfQsJLkWqohTGrlqnFZ9LrukSl97YIXpU5kVcHMSvDKTppnhNmY8WkJXXcFnSMZSY6e3cO1ruKxU/7+CGUSnbnCti4bWjHbOAvlGOApdPrJ9beDjtE5khFsaOaq8dHzMaW/vC/e6KGMWm4flYMku4cNnVmpPej8udtA1aBzrll47RGjs/aG+vX75tUkyihl1lKVZnDFrIuy+2AaOv9EvAX0nY7ROZeEJq4aF+g3zPvqHStejOYvlvGuA1FmNxtCM1P18AcMgjALv9MxYWaX9WcBktWuuu9eFqPM4mbvAzbEEg5h9tHpLIOtP+g7HeMnNHLVeG/JkvF7YWxc33jDqqy0ZhoEKovzM1P0DPSdjtFvG5ZVXLP0vn19z3KrVTvIHF3fYHHeCvruHN/AbdNN3PO69+17iLgzjrRux8El/SwIMg0M9P3HG9HqsPv+hUrrJXEvczj+AAbRx+AcX88F0v1AvBnKAnlTG8Rln5/6LuLHW5/zorT+D0wg1qq8y5xfu88CSyCnH5h3dW/ZGXve8uOMZRWP0no8cIFY7+YfswURrT36QL09ffsMppHYegW/P7CBWHvlMOGBe5/9jtdjY7R8wkTb+R9meZA6n2oJWAAAAABJRU5ErkJggg==",shadowUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAYAAACoYAD2AAAC5ElEQVRYw+2YW4/TMBCF45S0S1luXZCABy5CgLQgwf//S4BYBLTdJLax0fFqmB07nnQfEGqkIydpVH85M+NLjPe++dcPc4Q8Qh4hj5D/AaQJx6H/4TMwB0PeBNwU7EGQAmAtsNfAzoZkgIa0ZgLMa4Aj6CxIAsjhjOCoL5z7Glg1JAOkaicgvQBXuncwJAWjksLtBTWZe04CnYRktUGdilALppZBOgHGZcBzL6OClABvMSVIzyBjazOgrvACf1ydC5mguqAVg6RhdkSWQFj2uxfaq/BrIZOLEWgZdALIDvcMcZLD8ZbLC9de4yR1sYMi4G20S4Q/PWeJYxTOZn5zJXANZHIxAd4JWhPIloTJZhzMQduM89WQ3MUVAE/RnhAXpTycqys3NZALOBbB7kFrgLesQl2h45Fcj8L1tTSohUwuxhy8H/Qg6K7gIs+3kkaigQCOcyEXCHN07wyQazhrmIulvKMQAwMcmLNqyCVyMAI+BuxSMeTk3OPikLY2J1uE+VHQk6ANrhds+tNARqBeaGc72cK550FP4WhXmFmcMGhTwAR1ifOe3EvPqIegFmF+C8gVy0OfAaWQPMR7gF1OQKqGoBjq90HPMP01BUjPOqGFksC4emE48tWQAH0YmvOgF3DST6xieJgHAWxPAHMuNhrImIdvoNOKNWIOcE+UXE0pYAnkX6uhWsgVXDxHdTfCmrEEmMB2zMFimLVOtiiajxiGWrbU52EeCdyOwPEQD8LqyPH9Ti2kgYMf4OhSKB7qYILbBv3CuVTJ11Y80oaseiMWOONc/Y7kJYe0xL2f0BaiFTxknHO5HaMGMublKwxFGzYdWsBF174H/QDknhTHmHHN39iWFnkZx8lPyM8WHfYELmlLKtgWNmFNzQcC1b47gJ4hL19i7o65dhH0Negbca8vONZoP7doIeOC9zXm8RjuL0Gf4d4OYaU5ljo3GYiqzrWQHfJxA6ALhDpVKv9qYeZA8eM3EhfPSCmpuD0AAAAASUVORK5CYII="}),B.Icon.Default.include({_getIconUrl:function(t){return B.Icon.prototype._getIconUrl.call(this,t)}}),B.Control.Attribution.mergeOptions({prefix:"超擎地图"}),B.extend(B.Util,{clone:function(t){if(!t)return null;var e=JSON.stringify(t);return JSON.parse(e)},sortObject:function(t,r,o){t&&0!==t.length&&t.sort(function(t,e){var n=t[r],i=e[r];return o?n-i:i-n})},getAngle:function(t,e,n,i){var r=Math.abs(t-n),o=Math.abs(e-i),s=o/Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),a=Math.acos(s),u=Math.floor(180/(Math.PI/a));return t<n&&e<i&&(u=180-u),n===t&&e<i&&(u=180),t<n&&i===e&&(u=90),n<t&&e<i&&(u=180+u),n<t&&i===e&&(u=270),n<t&&i<e&&(u=360-u),u},getDPI:function(){var t=void 0;if(window&&void 0!==window.screen.deviceXDPI)t=window.screen.deviceXDPI;else{var e=document.createElement("DIV");e.style.cssText="width:1in;height:1in;position:absolute;left:0px;top:0px;z-index:99;visibility:hidden",document.body.appendChild(e),t=parseInt(e.offsetWidth),e.parentNode.removeChild(e)}return t}}),B.GridLayer.include({_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(this.options.noWrap&&(t.x<0||t.x>n.max.x))return!1;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return B.latLngBounds(this.options.bounds).overlaps(i)}}),B.Mixin.ContextMenu={bindContextMenu:function(t){return B.setOptions(this,t),this._initContextMenu(),this},unbindContextMenu:function(){return this.off("contextmenu",this._showContextMenu,this),this},addContextMenuItem:function(t){this.options.contextmenuItems.push(t)},removeContextMenuItemWithIndex:function(t){for(var e=[],n=0;n<this.options.contextmenuItems.length;n++)this.options.contextmenuItems[n].index==t&&e.push(n);for(var i=e.pop();void 0!==i;)this.options.contextmenuItems.splice(i,1),i=e.pop()},replaceContextMenuItem:function(t){this.removeContextMenuItemWithIndex(t.index),this.addContextMenuItem(t)},_initContextMenu:function(){this._items=[],this.on("contextmenu",this._showContextMenu,this)},_showContextMenu:function(t){var e=void 0,n=void 0,i=void 0,r=void 0,o=void 0;if(this._map.contextmenu){for(n=B.extend({relatedTarget:this},t),i=this._map.mouseEventToContainerPoint(t.originalEvent),this.options.contextmenuInheritItems||this._map.contextmenu.hideAllItems(),r=0,o=this.options.contextmenuItems.length;r<o;r++)e=this.options.contextmenuItems[r],this._items.push(this._map.contextmenu.insertItem(e,e.index));this._map.once("contextmenu.hide",this._hideContextMenu,this),this._map.contextmenu.showAt(i,n)}},_hideContextMenu:function(){var t,e=void 0;for(e=0,t=this._items.length;e<t;e++)this._map.contextmenu.removeItem(this._items[e]);this._items.length=0,this.options.contextmenuInheritItems||this._map.contextmenu.showAllItems()}};var t,i=[B.Marker,B.Path],r={contextmenu:!1,contextmenuItems:[],contextmenuInheritItems:!0},o=void 0,s=void 0;for(s=0,t=i.length;s<t;s++)(o=i[s]).prototype.options?o.mergeOptions(r):o.prototype.options=r,o.addInitHook(function(){this.options.contextmenu&&this._initContextMenu()}),o.include(B.Mixin.ContextMenu);var a=B.Marker.prototype._initIcon,u=B.Marker.prototype._setPos,l="msTransform"===B.DomUtil.TRANSFORM;B.Marker.addInitHook(function(){var t=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;t=t&&t[0]+"px "+t[1]+"px",this.options.rotationOrigin=this.options.rotationOrigin||t||"center bottom",this.options.rotationAngle=this.options.rotationAngle||0,this.on("drag",function(t){t.target._applyRotation()})}),B.Marker.include({_initIcon:function(){a.call(this)},_setPos:function(t){u.call(this,t),this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[B.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,l?this._icon.style[B.DomUtil.TRANSFORM]="rotate("+this.options.rotationAngle+"deg)":this._icon.style[B.DomUtil.TRANSFORM]+=" rotateZ("+this.options.rotationAngle+"deg)")},setRotationAngle:function(t){return this.options.rotationAngle=t,this.update(),this},setRotationOrigin:function(t){return this.options.rotationOrigin=t,this.update(),this}});function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=function(t,e,n){return e&&p(t.prototype,e),n&&p(t,n),t};function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:d(r,e,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0}function y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function _(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function w(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var m,v;function b(t){if(v[t])return v[t].exports;var e=v[t]={i:t,l:!1,exports:{}};return m[t].call(e.exports,e,e.exports,b),e.l=!0,e.exports}v={},b.m=m=[function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,r=(i=n(3))&&i.__esModule?i:{default:i},o=L.Class.extend({includes:[r.default],options:{snappable:!0,snapDistance:20,cursorMarker:!0,finishOnDoubleClick:!1,finishOn:null,allowSelfIntersection:!0,templineStyle:{},hintlineStyle:{dashArray:"5,5"},markerStyle:{draggable:!0}},initialize:function(t){var e=this;this._map=t,this.shapes=["Marker","Line","Poly","Rectangle","Circle","Cut"],this.shapes.forEach(function(t){e[t]=new L.PM.Draw[t](e._map)})},setPathOptions:function(t){this.options.pathOptions=t},getShapes:function(){return this.shapes},enable:function(t,e){if(!t)throw new Error("Error: Please pass a shape as a parameter. Possible shapes are: ".concat(this.getShapes().join(",")));this.disable(),this[t].enable(e)},disable:function(){var e=this;this.shapes.forEach(function(t){e[t].disable()})},addControls:function(){var e=this;this.shapes.forEach(function(t){e[t].addButton()})}});e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(n(3)),r=o(n(27));function o(t){return t&&t.__esModule?t:{default:t}}var s=L.Class.extend({includes:[r.default,i.default],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,draggable:!0},isPolygon:function(){return this._layer instanceof L.Polygon}});e.default=s},function(t,e,n){function i(t,e,n){if(!a(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!s(t))throw new Error("bbox must only contain numbers")})}(i),r&&function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(void 0===t?"undefined":g(t)))throw new Error("id must be a number or a string")}(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function r(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!s(t[0])||!s(t[1]))throw new Error("coordinates must contain numbers");return i({type:"Point",coordinates:t},e,n)}function o(t,e,n){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!s(t[0][1])||!s(t[0][1]))throw new Error("coordinates must contain numbers");return i({type:"LineString",coordinates:t},e,n)}function s(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function a(t){return!!t&&t.constructor===Object}n.d(e,"a",function(){return i}),n.d(e,"e",function(){return r}),n.d(e,"d",function(){return o}),n.d(e,"b",function(){return s}),n.d(e,"c",function(){return a})},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={_initSnappableMarkers:function(){this.options.snapDistance=this.options.snapDistance||30,this.isPolygon()?this._markers.map(this._assignEvents,this):this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_assignEvents:function(t){var e=this;t.forEach(function(t){t.off("drag",e._handleSnapping,e),t.on("drag",e._handleSnapping,e),t.off("dragend",e._cleanupSnapping,e),t.on("dragend",e._cleanupSnapping,e)})},_unsnap:function(){delete this._snapLatLng},_cleanupSnapping:function(){delete this._snapList,this._map.off("pm:remove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(function(t){t.remove()})},_handleSnapLayerRemoval:function(t){var e=t.layer,n=this._snapList.findIndex(function(t){return t._leaflet_id===e._leaflet_id});this._snapList.splice(n,1)},_handleSnapping:function(t){if(t.originalEvent.altKey)return!1;if(void 0===this._snapList&&this._createSnapList(t),this._snapList.length<=0)return!1;var e,n=t.target,i=this._calcClosestLayer(n.getLatLng(),this._snapList);e=i.layer instanceof L.Marker||i.layer instanceof L.CircleMarker?i.latlng:this._checkPrioritiySnapping(i);var r=this.options.snapDistance,o={marker:n,snapLatLng:e,segment:i.segment,layer:this._layer,layerInteractedWith:i.layer};if(i.distance<r){n.setLatLng(e),n._snapped=!0;var s=this._snapLatLng||{},a=e||{};s.lat===a.lat&&s.lng===a.lng||(this._snapLatLng=e,n.fire("pm:snap",o),this._layer.fire("pm:snap",o))}else this._snapLatLng&&(this._unsnap(o),n._snapped=!1,o.marker.fire("pm:unsnap",o),this._layer.fire("pm:unsnap",o));return!0},_checkPrioritiySnapping:function(t){var e,n=this._map,i=t.segment[0],r=t.segment[1],o=t.latlng,s=this._getDistance(n,i,o),a=this._getDistance(n,r,o),u=s<a?i:r;return e=(s<a?s:a)<this.options.snapDistance?u:o,Object.assign({},e)},_createSnapList:function(){var n=this,i=[],r=[],o=this._map;o.eachLayer(function(t){if(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.CircleMarker){i.push(t),o.off("pm:remove",n._handleSnapLayerRemoval,n),o.on("pm:remove",n._handleSnapLayerRemoval,n);var e=L.polyline([],{color:"red",pmIgnore:!0});r.push(e)}}),i=(i=(i=i.filter(function(t){return n._layer!==t})).filter(function(t){return t._latlng||t._latlngs&&0<t._latlngs.length})).filter(function(t){return!t._pmTempLayer}),this._otherSnapLayers?this._snapList=i.concat(this._otherSnapLayers):this._snapList=i,this.debugIndicatorLines=r},_calcClosestLayer:function(i,t){var r=this,o={};return t.forEach(function(t,e){var n=r._calcLayerDistances(i,t);r.debugIndicatorLines[e].setLatLngs([i,n.latlng]),(void 0===o.distance||n.distance<o.distance)&&((o=n).layer=t)}),o},_calcLayerDistances:function(t,e){var s,a,u,l=this,h=this._map,c=e instanceof L.Polygon,n=!(e instanceof L.Polygon)&&e instanceof L.Polyline,i=e instanceof L.Marker||e instanceof L.CircleMarker,p=t;if(c)s=e.getLatLngs()[0];else if(n)s=e.getLatLngs();else if(i)return s=e.getLatLng(),{latlng:Object.assign({},s),distance:this._getDistance(h,s,p)};s.forEach(function(t,e){var n,i=t;n=c?e+1===s.length?0:e+1:e+1===s.length?void 0:e+1;var r=s[n];if(r){var o=l._getDistanceToSegment(h,p,i,r);(void 0===u||o<u)&&(u=o,a=[i,r])}return!0});var r=this._getClosestPointOnSegment(h,t,a[0],a[1]);return{latlng:Object.assign({},r),segment:a,distance:u}},_getClosestPointOnSegment:function(t,e,n,i){var r=t.getMaxZoom();r===1/0&&(r=t.getZoom());var o=t.project(e,r),s=t.project(n,r),a=t.project(i,r),u=L.LineUtil.closestPointOnSegment(o,s,a);return t.unproject(u,r)},_getDistanceToSegment:function(t,e,n,i){var r=t.latLngToLayerPoint(e),o=t.latLngToLayerPoint(n),s=t.latLngToLayerPoint(i);return L.LineUtil.pointToSegmentDistance(r,o,s)},_getDistance:function(t,e,n){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(n))}};e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var v=n(2);e.default=function(t){var e,n,m={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach(function(_){e.forEach(function(t){for(var e=0;e<_.length-1;e++)for(var n=e;n<t.length-1;n++){if(_===t){if(1===Math.abs(e-n))continue;if(0===e&&n===_.length-2&&_[e][0]===_[_.length-1][0]&&_[e][1]===_[_.length-1][1])continue}var i=(r=_[e][0],o=_[e][1],s=_[e+1][0],a=_[e+1][1],u=t[n][0],l=t[n][1],h=t[n+1][0],y=g=d=f=void 0,y={x:null,y:null,onLine1:!1,onLine2:!1},0==(p=((c=t[n+1][1])-l)*(s-r)-(h-u)*(a-o))?null!==y.x&&null!==y.y&&y:(g=(s-r)*(f=o-l)-(a-o)*(d=r-u),f=((h-u)*f-(c-l)*d)/p,d=g/p,y.x=r+f*(s-r),y.y=o+f*(a-o),0<=f&&f<=1&&(y.onLine1=!0),0<=d&&d<=1&&(y.onLine2=!0),!(!y.onLine1||!y.onLine2)&&[y.x,y.y]));i&&m.features.push(Object(v.e)([i[0],i[1]]))}var r,o,s,a,u,l,h,c,p,f,d,g,y})}),m}},function(t,o,e){function a(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return 0!==n.id&&!n.id||(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function i(t,e,n){return void 0===n&&(n={}),a({type:"Point",coordinates:t},e,n)}function r(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return a({type:"Polygon",coordinates:t},e,n)}function s(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return a({type:"LineString",coordinates:t},e,n)}function u(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function l(t,e,n){return void 0===n&&(n={}),a({type:"MultiLineString",coordinates:t},e,n)}function h(t,e,n){return void 0===n&&(n={}),a({type:"MultiPoint",coordinates:t},e,n)}function c(t,e,n){return void 0===n&&(n={}),a({type:"MultiPolygon",coordinates:t},e,n)}function p(t,e){void 0===e&&(e="kilometers");var n=o.factors[e];if(!n)throw new Error(e+" units is invalid");return t*n}function f(t,e){void 0===e&&(e="kilometers");var n=o.factors[e];if(!n)throw new Error(e+" units is invalid");return t/n}function n(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(o,"__esModule",{value:!0}),o.earthRadius=6371008.8,o.factors={centimeters:100*o.earthRadius,centimetres:100*o.earthRadius,degrees:o.earthRadius/111325,feet:3.28084*o.earthRadius,inches:39.37*o.earthRadius,kilometers:o.earthRadius/1e3,kilometres:o.earthRadius/1e3,meters:o.earthRadius,metres:o.earthRadius,miles:o.earthRadius/1609.344,millimeters:1e3*o.earthRadius,millimetres:1e3*o.earthRadius,nauticalmiles:o.earthRadius/1852,radians:1,yards:o.earthRadius/1.0936},o.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/o.earthRadius,yards:1/1.0936},o.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},o.feature=a,o.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return s(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return h(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error(t+" is invalid")}},o.point=i,o.points=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return i(t,e)}),n)},o.polygon=r,o.polygons=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return r(t,e)}),n)},o.lineString=s,o.lineStrings=function(t,e,n){return void 0===n&&(n={}),u(t.map(function(t){return s(t,e)}),n)},o.featureCollection=u,o.multiLineString=l,o.multiPoint=h,o.multiPolygon=c,o.geometryCollection=function(t,e,n){return void 0===n&&(n={}),a({type:"GeometryCollection",geometries:t},e,n)},o.round=function(t,e){if(void 0===e&&(e=0),e&&!(0<=e))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},o.radiansToLength=p,o.lengthToRadians=f,o.lengthToDegrees=function(t,e){return n(f(t,e))},o.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},o.radiansToDegrees=n,o.degreesToRadians=function(t){return t%360*Math.PI/180},o.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(0<=t))throw new Error("length must be a positive number");return p(f(t,e),n)},o.convertArea=function(t,e,n){if(void 0===e&&(e="meters"),void 0===n&&(n="kilometers"),!(0<=t))throw new Error("area must be a positive number");var i=o.areaFactors[e];if(!i)throw new Error("invalid original units");var r=o.areaFactors[n];if(!r)throw new Error("invalid final units");return t/i*r},o.isNumber=d,o.isObject=function(t){return!!t&&t.constructor===Object},o.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})},o.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(void 0===t?"undefined":g(t)))throw new Error("id must be a number or a string")},o.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},o.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},o.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},o.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},o.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},o.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},o.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,n){n.d(e,"b",function(){return r}),n.d(e,"a",function(){return o});var h=n(2);function i(t,e){var n,i,r,o,s,a,u,l,h,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,l=f?t.features[n].properties:d?t.properties:{},h=f?t.features[n].bbox:d?t.bbox:void 0,c=f?t.features[n].id:d?t.id:void 0,s=(u=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=u?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,p,l,h,c))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],p,l,h,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,l,h,c))return!1;p++}}function r(t,o,s){var a=s;return i(t,function(t,e,n,i,r){a=0===e&&void 0===s?t:o(a,t,e,n,i,r)}),a}function o(t,l){i(t,function(t,e,n,i,r){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==l(Object(h.a)(t,n,{bbox:i,id:r}),e,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var a=0;a<t.coordinates.length;a++){var u={type:o,coordinates:t.coordinates[a]};if(!1===l(Object(h.a)(u,n),e,a))return!1}})}},function(t,e,n){t.exports=n(8)},function(t,e,n){n(9);var i=n(10),r=u(n(11)),o=u(n(12)),s=u(n(0));n(14),n(15),n(16),n(17),n(18),n(19);var a=u(n(1));function u(t){return t&&t.__esModule?t:{default:t}}n(28),n(29),n(30),n(31),n(32),n(33),n(34),n(35),L.PM=L.PM||{Map:r.default,Toolbar:o.default,Draw:s.default,Edit:a.default,version:i.version,initialize:function(){this.addInitHooks()},addInitHooks:function(){L.Map.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Map(this))}),L.LayerGroup.addInitHook(function(){this.pm=new L.PM.Edit.LayerGroup(this)}),L.Marker.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Marker(this))}),L.Polyline.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}),L.Polygon.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Poly(this))}),L.Rectangle.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}),L.Circle.addInitHook(function(){this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))})}},L.PM.initialize()},function(t,e,n){Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,i=arguments[1],r=0;r<n;r++)if(t.call(i,e[r],r,e))return r;return-1},Array.prototype.find=Array.prototype.find||function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),n=e.length>>>0,i=arguments[1],r=0;r<n;r++){var o=e[r];if(t.call(i,o,r,e))return o}},"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var n=arguments[e];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})},function(t,e){t.exports={name:"leaflet.pm",version:"0.24.0",description:"A Leaflet Plugin For Editing Geometry Layers in Leaflet 1.0",keywords:["leaflet","polygon management","geometry editing","map data","map overlay","polygon","geojson","leaflet-draw","data-field-geojson","ui-leaflet-draw"],files:["dist"],main:"dist/leaflet.pm.min.js",dependencies:{"@turf/difference":"^5.1.5","@turf/intersect":"^6.1.2","@turf/kinks":"^5.1.5"},devDependencies:{"@babel/core":"^7.0.0-beta.40","@babel/preset-env":"^7.0.0-beta.40","babel-loader":"^8.0.0-beta.0","css-loader":"^0.28.0",eslint:"^4.18.2","eslint-config-airbnb-base":"^12.1.0","eslint-plugin-import":"^2.9.0","extract-text-webpack-plugin":"^3.0.2","file-loader":"^0.11.1",leaflet:"^1.3.1","style-loader":"^0.19.0",tape:"^4.9.0","tape-run":"^3.0.4","uglifyjs-webpack-plugin":"^1.1.0","url-loader":"^0.6.2",webpack:"^3.11.0"},peerDependencies:{leaflet:"^1.2.0"},scripts:{start:"npm run dev",dev:"./node_modules/.bin/webpack --config=webpack.dev.js",test:"browserify ./spec/test.spec.js | tape-run",build:"./node_modules/.bin/webpack --config=webpack.build.js",prepare:"npm run build"},repository:{type:"git",url:"git+https://github.com/codeofsumit/leaflet.pm.git"},author:{name:"Sumit Kumar",email:"sk@outlook.com",url:"http://twitter.com/TweetsOfSumit"},license:"MIT",bugs:{url:"https://github.com/codeofsumit/leaflet.pm/issues"},homepage:"https://leafletpm.now.sh"}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=L.Class.extend({initialize:function(t){var e=this;this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this.map.on("layerremove",function(t){t.layer.pm&&!t.layer._pmTempLayer&&e.map.fire("pm:remove",t)}),this._globalRemovalMode=!1},addControls:function(t){this.Toolbar.addControls(t)},removeControls:function(){this.Toolbar.removeControls()},toggleControls:function(){this.Toolbar.toggleControls()},controlsVisible:function(){return this.Toolbar.isVisible},enableDraw:function(t,e){var n=0<arguments.length&&void 0!==t?t:"Poly",i=1<arguments.length?e:void 0;this.Draw.enable(n,i)},disableDraw:function(t){var e=0<arguments.length&&void 0!==t?t:"Poly";this.Draw.disable(e)},setPathOptions:function(t){this.Draw.setPathOptions(t)},removeLayer:function(t){var e=t.target;e._layers||e.pm&&e.pm.dragging()||t.target.remove()},toggleGlobalRemovalMode:function(){var e=this;this.globalRemovalEnabled()?(this._globalRemovalMode=!1,this.map.eachLayer(function(t){t.off("click",e.removeLayer)})):(this._globalRemovalMode=!0,this.map.eachLayer(function(t){t.pm&&t.on("click",e.removeLayer)})),this.Toolbar.toggleButton("deleteLayer",this._globalRemovalMode)},globalRemovalEnabled:function(){return this._globalRemovalMode},globalEditEnabled:function(){return this._globalEditMode},enableGlobalEditMode:function(e){var n=[];this.map.eachLayer(function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle)&&n.push(t)}),n=(n=n.filter(function(t){return!!t.pm})).filter(function(t){return!t._pmTempLayer}),this._globalEditMode=!0,n.forEach(function(t){t.pm.enable(e)}),this.Toolbar.toggleButton("editPolygon",this._globalEditMode),this._fireEditModeEvent(!0)},disableGlobalEditMode:function(){var e=[];this.map.eachLayer(function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle)&&e.push(t)}),e=(e=e.filter(function(t){return!!t.pm})).filter(function(t){return!t._pmTempLayer}),this._globalEditMode=!1,e.forEach(function(t){t.pm.disable()}),this.Toolbar.toggleButton("editPolygon",this._globalEditMode),this._fireEditModeEvent(!1)},_fireEditModeEvent:function(t){this.map.fire("pm:globaleditmodetoggled",{enabled:t,map:this.map})},toggleGlobalEditMode:function(t){this.globalEditEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)}});e.default=i},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,r=(i=n(13))&&i.__esModule?i:{default:i};L.Control.PMButton=r.default;var o=L.Class.extend({options:{drawMarker:!0,drawPolygon:!0,drawPolyline:!0,drawCircle:!0,drawRectangle:!0,editMode:!0,cutPolygon:!0,dragPolygon:!1,removalMode:!0,position:"topleft"},initialize:function(t){this.map=t,this.buttons={},this.isVisible=!1,this.container=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-bar leaflet-control"),this._defineButtons()},getButtons:function(){return this.buttons},addControls:function(t){var e=0<arguments.length&&void 0!==t?t:this.options;void 0!==e.editPolygon&&(e.editMode=e.editPolygon),void 0!==e.deleteLayer&&(e.removalMode=e.deleteLayer),L.Util.setOptions(this,e),this._showHideButtons(),this.isVisible=!0},removeControls:function(){var t=this.getButtons();for(var e in t)t[e].remove();this.isVisible=!1},toggleControls:function(t){var e=0<arguments.length&&void 0!==t?t:this.options;this.isVisible?this.removeControls():this.addControls(e)},_addButton:function(t,e){return this.buttons[t]=e,this.options[t]=this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons:function(t){for(var e in this.buttons)this.buttons[e]!==t&&this.buttons[e].toggled()&&this.buttons[e]._triggerClick()},toggleButton:function(t,e){return"editPolygon"===t&&(t="editMode"),"deleteLayer"===t&&(t="removalMode"),this.triggerClickOnToggledButtons(this.buttons[t]),this.buttons[t].toggle(e)},_defineButtons:function(){var t=this,e={className:" leaflet-pm-icon-delete",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},n={className:"leaflet-pm-icon-polygon",onClick:function(){},afterClick:function(){t.map.pm.Draw.Poly.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},i={className:"leaflet-pm-icon-cut",onClick:function(){},afterClick:function(){t.map.pm.Draw.Cut.toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},r={className:"leaflet-pm-icon-marker",onClick:function(){},afterClick:function(){t.map.pm.Draw.Marker.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},o={className:"leaflet-pm-icon-polyline",onClick:function(){},afterClick:function(){t.map.pm.Draw.Line.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},s={className:"leaflet-pm-icon-circle",onClick:function(){},afterClick:function(){t.map.pm.Draw.Circle.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},a={className:"leaflet-pm-icon-rectangle",onClick:function(){},afterClick:function(){t.map.pm.Draw.Rectangle.toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},u={className:"leaflet-pm-icon-edit",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position},l={className:"leaflet-pm-icon-drag",onClick:function(){},afterClick:function(){},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position};this._addButton("drawMarker",new L.Control.PMButton(r)),this._addButton("drawPolyline",new L.Control.PMButton(o)),this._addButton("drawRectangle",new L.Control.PMButton(a)),this._addButton("drawPolygon",new L.Control.PMButton(n)),this._addButton("drawCircle",new L.Control.PMButton(s)),this._addButton("cutPolygon",new L.Control.PMButton(i)),this._addButton("editMode",new L.Control.PMButton(u)),this._addButton("dragPolygon",new L.Control.PMButton(l)),this._addButton("removalMode",new L.Control.PMButton(e))},_showHideButtons:function(){this.removeControls();var t=this.getButtons();for(var e in t)this.options[e]&&(t[e].setPosition(this.options.position),t[e].addTo(this.map))}});e.default=o},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=L.Control.extend({options:{position:"topleft"},initialize:function(t){this._button=L.Util.setOptions(this,t)},onAdd:function(t){return this._map=t,this._container=this._map.pm.Toolbar.container,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove:function(){return this.buttonsDomNode.remove(),this._container},getText:function(){return this._button.text},getIconUrl:function(){return this._button.iconUrl},destroy:function(){this._button={},this._update()},toggle:function(t){return this._button.toggleStatus="boolean"==typeof t?t:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled:function(){return this._button.toggleStatus},onCreate:function(){this.toggle(!1)},_triggerClick:function(t){this._button.onClick(t),this._clicked(t),this._button.afterClick(t)},_makeButton:function(t){var e=this,n=L.DomUtil.create("a","leaflet-buttons-control-button",this._container);t.toggleStatus&&L.DomUtil.addClass(n,"active");var i=L.DomUtil.create("div","control-icon",n);return t.iconUrl&&i.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(i,t.className),L.DomEvent.addListener(n,"click",function(){e._button.disableOtherButtons&&e._map.pm.Toolbar.triggerClickOnToggledButtons(e)}),L.DomEvent.addListener(n,"click",this._triggerClick,this),L.DomEvent.disableClickPropagation(n),n},_applyStyleClasses:function(){this._container&&(this._button.toggleStatus?L.DomUtil.addClass(this.buttonsDomNode,"active"):L.DomUtil.removeClass(this.buttonsDomNode,"active"))},_clicked:function(){this._button.doToggle&&this.toggle()}});e.default=i},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Marker=r.default.extend({initialize:function(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable:function(t){L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker([0,0],this.options.markerStyle),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.eachLayer(function(t){t instanceof L.Marker&&t.pm&&t.pm.enable()})},disable:function(){this._enabled&&(this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(function(t){t instanceof L.Marker&&t.pm&&!t._pmTempLayer&&t.pm.disable()}),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this._enabled=!1)},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_createMarker:function(t){if(t.latlng){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),n=new L.Marker(e,this.options.markerStyle);n.addTo(this._map),n.pm.enable(),this.disable(),this._map.fire("pm:create",{shape:this._shape,marker:n,layer:n}),this._cleanupSnapping()}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}}})},function(t,e,n){var i=o(n(4)),r=o(n(0));function o(t){return t&&t.__esModule?t:{default:t}}r.default.Line=r.default.extend({initialize:function(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable:function(t){L.Util.setOptions(this,t),this.options.finishOnDoubleClick&&!this.options.finishOn&&(this.options.finishOn="dblclick"),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._map._container.style.cursor="crosshair",this._map.on("click",this._createVertex,this),this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="default",this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},hasSelfIntersection:function(){return 0<(0,i.default)(this._layer.toGeoJSON()).features.length},_syncHintLine:function(){var t=this._layer.getLatLngs();if(0<t.length){var e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this.options.allowSelfIntersection||this._handleSelfIntersection()},_handleSelfIntersection:function(){var t=L.polyline(this._layer.getLatLngs());t.addLatLng(this._hintMarker.getLatLng());var e=(0,i.default)(t.toGeoJSON());this._doesSelfIntersect=0<e.features.length,this._doesSelfIntersect?this._hintline.setStyle({color:"red"}):this._hintline.setStyle(this.options.hintlineStyle)},_createVertex:function(t){if(this.options.allowSelfIntersection||!this._doesSelfIntersect){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();if(e.equals(this._layer.getLatLngs()[0]))this._finishShape(t);else{var n=0===this._layer.getLatLngs().length;this._layer.addLatLng(e);var i=this._createMarker(e,n);this._hintline.setLatLngs([e,e]),this._layer.fire("pm:vertexadded",{shape:this._shape,workingLayer:this._layer,marker:i,latlng:e})}}},_finishShape:function(){if(this.options.allowSelfIntersection||!this._doesSelfIntersect){var t=this._layer.getLatLngs(),e=L.polyline(t,this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:e}),this.options.snappable&&this._cleanupSnapping()}},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,this._layerGroup.addLayer(e),e.on("click",this._finishShape,this),e}})},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Poly=r.default.Line.extend({initialize:function(t){this._map=t,this._shape="Poly",this.toolbarButtonName="drawPolygon"},_finishShape:function(t){if(this.options.allowSelfIntersection||!this._doesSelfIntersect){var e=this._layer.getLatLngs();t&&"dblclick"===t.type&&e.splice(e.length-1,1);var n=L.polygon(e,this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:n}),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex}},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return n._pmTempLayer=!0,this._layerGroup.addLayer(n),e&&(n.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(n)-1,this.options.snappable&&this._cleanupSnapping()),n}})},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Rectangle=r.default.extend({initialize:function(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable:function(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._layer._pmTempLayer=!0,this._startMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!0,zIndexOffset:100,opacity:this.options.cursorMarker?1:0}),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker){L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._styleMarkers=[];for(var e=0;e<2;e+=1){var n=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!0,zIndexOffset:100});n._pmTempLayer=!0,this._layerGroup.addLayer(n),this._styleMarkers.push(n)}}this._map._container.style.cursor="crosshair",this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="default",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(function(t){L.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._setRectangleOrigin()},_setRectangleOrigin:function(){var t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_syncRectangleSize:function(){var n=this,t=this._startMarker.getLatLng(),e=this._hintMarker.getLatLng();if(this._layer.setBounds([t,e]),this.options.cursorMarker&&this._styleMarkers){var i=[];this._findCorners().forEach(function(t){t.equals(n._startMarker.getLatLng())||t.equals(n._hintMarker.getLatLng())||i.push(t)}),i.forEach(function(t,e){n._styleMarkers[e].setLatLng(t)})}},_finishShape:function(){var t=this._startMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=L.rectangle([t,e],this.options.pathOptions).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:n})},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}})},function(t,e,n){var i,r=(i=n(0))&&i.__esModule?i:{default:i};r.default.Circle=r.default.extend({initialize:function(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle"},enable:function(t){L.Util.setOptions(this,t),this.options.radius=0,this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circle([0,0],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._centerMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._centerMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._centerMarker),this._hintMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._hintline=L.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map._container.style.cursor="crosshair",this._map.on("click",this._placeCenterMarker,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.fire("pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[]},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="default",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.fire("pm:drawend",{shape:this._shape}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._centerMarker.getLatLng();this._hintline.setLatLngs([t,this._hintMarker.getLatLng()])},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=t.distanceTo(e);this._layer.setRadius(n)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_placeCenterMarker:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._layer.fire("pm:centerplaced",{shape:this._shape,workingLayer:this._layer,latlng:t}))},_finishShape:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),n=t.distanceTo(e),i=L.circle(t,{radius:n}).addTo(this._map);this.disable(),this._map.fire("pm:create",{shape:this._shape,layer:i})},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,this._layerGroup.addLayer(e),e}})},function(t,e,n){var s=r(n(20)),a=r(n(23)),i=r(n(0));function r(t){return t&&t.__esModule?t:{default:t}}i.default.Cut=i.default.Poly.extend({initialize:function(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_cut:function(i){var r=this,e=this._map._layers,o=[];Object.keys(e).map(function(t){return e[t]}).filter(function(t){return t.pm}).filter(function(t){return t instanceof L.Polygon}).filter(function(t){return t!==i}).filter(function(t){try{return!!(0,s.default)(i.toGeoJSON(),t.toGeoJSON())}catch(t){return console.error("You cant cut polygons with self-intersections"),!1}}).forEach(function(n){var t=(0,a.default)(n.toGeoJSON(),i.toGeoJSON());if("MultiPolygon"===t.geometry.type)t.geometry.coordinates.reduce(function(t,e){return t.push({type:"Polygon",coordinates:e}),t},[]).forEach(function(t){var e=L.geoJSON(t,n.options);o.push(e),e.addTo(r._map),e.pm.enable(r.options),e.pm.disable()});else{var e=L.geoJSON(t,n.options).addTo(r._map);o.push(e),e.addTo(r._map),e.pm.enable(r.options),e.pm.disable()}n.fire("pm:cut",{shape:r._shape,layer:n,resultingLayers:o}),r._map.fire("pm:cut",{shape:r._shape,cuttedLayer:n,resultingLayers:o}),n._pmTempLayer=!0,i._pmTempLayer=!0,n.remove(),i.remove()})},_finishShape:function(){var t=this._layer.getLatLngs(),e=L.polygon(t,this.options.pathOptions);this._cut(e),this.disable(),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex}})},function(t,e,n){var i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var g=n(5),y=n(21),_=i(n(22));e.default=function t(e,n,i){void 0===i&&(i={});var r=y.getGeom(e),o=y.getGeom(n);if("Polygon"===r.type&&"Polygon"===o.type){var s=_.intersection(r.coordinates,o.coordinates);if(null===s||0===s.length)return null;if(1!==s.length)return g.multiPolygon(s,i.properties);var a=s[0][0][0],u=s[0][0][s[0][0].length-1];return a[0]===u[0]&&a[1]===u[1]?g.polygon(s[0],i.properties):null}if("MultiPolygon"===r.type){for(var l=[],h=0,c=r.coordinates;h<c.length;h++){var p=c[h],f=t(y.getGeom(g.polygon(p)),o);if(f){var d=y.getGeom(f);if("Polygon"===d.type)l.push(d.coordinates);else{if("MultiPolygon"!==d.type)throw new Error("intersection is invalid");l=l.concat(d.coordinates)}}}return 0===l.length?null:1===l.length?g.polygon(l[0],i.properties):g.multiPolygon(l,i.properties)}if("MultiPolygon"===o.type)return t(o,r);throw new Error("poly1 and poly2 must be either polygons or multiPolygons")}},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.getCoord=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&2<=t.length&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(1<e.length&&Object(i.isNumber)(e[0])&&Object(i.isNumber)(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}},e.getGeom=function(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")},e.getGeomType=function(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")},e.getType=function(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")};var i=n(5);n.n(i)},function(t,e,n){var i;i=function(){return function r(o,s,a){function u(e,t){if(!s[e]){if(!o[e]){if(0,l)return l(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[e]={exports:{}};o[e][0].call(i.exports,function(t){return u(o[e][1][t]||t)},i,i.exports,r,o,s,a)}return s[e].exports}for(var l=!1,t=0;t<a.length;t++)u(a[t]);return u}({1:[function(t,e,n){var i=t("./src/index"),r={union:i.union,diff:i.diff,xor:i.xor,intersection:i.intersection};r.default=r,e.exports=r},{"./src/index":12}],2:[function(t,e,n){var i;i=function(){function r(t){return t?1+Math.max(r(t.left),r(t.right)):0}function n(t,e){return e<t?1:t<e?-1:0}function h(t){var e=t.right;return t.right=e.left,e.left&&(e.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),((t.parent=e).left=t).balanceFactor+=1,e.balanceFactor<0&&(t.balanceFactor-=e.balanceFactor),e.balanceFactor+=1,0<t.balanceFactor&&(e.balanceFactor+=t.balanceFactor),e}function c(t){var e=t.left;return t.left=e.right,t.left&&(t.left.parent=t),e.parent=t.parent,e.parent&&(e.parent.left===t?e.parent.left=e:e.parent.right=e),--((t.parent=e).right=t).balanceFactor,0<e.balanceFactor&&(t.balanceFactor-=e.balanceFactor),--e.balanceFactor,t.balanceFactor<0&&(e.balanceFactor+=t.balanceFactor),e}function t(t,e){void 0===e&&(e=!1),this._comparator=t||n,this._root=null,this._size=0,this._noDuplicates=!!e}var e={size:{}};return t.prototype.destroy=function(){return this._root=null,this},e.size.get=function(){return this._size},t.prototype.contains=function(t){if(this._root)for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},t.prototype.next=function(t){var e=t;if(e)if(e.right)for(e=e.right;e&&e.left;)e=e.left;else for(e=t.parent;e&&e.right===t;)e=(t=e).parent;return e},t.prototype.prev=function(t){var e=t;if(e)if(e.left)for(e=e.left;e&&e.right;)e=e.right;else for(e=t.parent;e&&e.left===t;)e=(t=e).parent;return e},t.prototype.forEach=function(t){for(var e=this._root,n=[],i=!1,r=0;!i;)e?(n.push(e),e=e.left):0<n.length?(t(e=n.pop(),r++),e=e.right):i=!0;return this},t.prototype.keys=function(){for(var t=this._root,e=[],n=[],i=!1;!i;)t?(e.push(t),t=t.left):0<e.length?(t=e.pop(),n.push(t.key),t=t.right):i=!0;return n},t.prototype.values=function(){for(var t=this._root,e=[],n=[],i=!1;!i;)t?(e.push(t),t=t.left):0<e.length?(t=e.pop(),n.push(t.data),t=t.right):i=!0;return n},t.prototype.at=function(t){for(var e=this._root,n=[],i=!1,r=0;!i;)if(e)n.push(e),e=e.left;else if(0<n.length){if(e=n.pop(),r===t)return e;r++,e=e.right}else i=!0;return null},t.prototype.minNode=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t},t.prototype.min=function(){var t=this._root;if(!t)return null;for(;t.left;)t=t.left;return t.key},t.prototype.max=function(){var t=this._root;if(!t)return null;for(;t.right;)t=t.right;return t.key},t.prototype.isEmpty=function(){return!this._root},t.prototype.pop=function(){var t=this._root,e=null;if(t){for(;t.left;)t=t.left;e={key:t.key,data:t.data},this.remove(t.key)}return e},t.prototype.find=function(t){for(var e,n=this._root,i=this._comparator;n;){if(0===(e=i(t,n.key)))return n;n=e<0?n.left:n.right}return null},t.prototype.insert=function(t,e){if(!this._root)return this._root={parent:null,left:null,right:null,balanceFactor:0,key:t,data:e},this._size++,this._root;var n=this._comparator,i=this._root,r=null,o=0;if(this._noDuplicates)for(;i;){if(0===(o=n(t,(r=i).key)))return null;i=o<0?i.left:i.right}else for(;i;)i=(o=n(t,(r=i).key))<=0?i.left:i.right;var s,a={left:null,right:null,balanceFactor:0,parent:r,key:t,data:e};for(o<=0?r.left=a:r.right=a;r&&((o=n(r.key,t))<0?--r.balanceFactor:r.balanceFactor+=1,0!==r.balanceFactor);){if(r.balanceFactor<-1){1===r.right.balanceFactor&&c(r.right),s=h(r),r===this._root&&(this._root=s);break}if(1<r.balanceFactor){-1===r.left.balanceFactor&&h(r.left),s=c(r),r===this._root&&(this._root=s);break}r=r.parent}return this._size++,a},t.prototype.remove=function(t){if(!this._root)return null;for(var e=this._root,n=this._comparator,i=0;e&&0!==(i=n(t,e.key));)e=i<0?e.left:e.right;if(!e)return null;var r,o,s=e.key;if(e.left){for(r=e.left;r.left||r.right;){for(;r.right;)r=r.right;e.key=r.key,e.data=r.data,r.left&&(r=(e=r).left)}e.key=r.key,e.data=r.data,e=r}if(e.right){for(o=e.right;o.left||o.right;){for(;o.left;)o=o.left;e.key=o.key,e.data=o.data,o.right&&(o=(e=o).right)}e.key=o.key,e.data=o.data,e=o}for(var a,u=e.parent,l=e;u&&(u.left===l?--u.balanceFactor:u.balanceFactor+=1,u.balanceFactor<-1?(1===u.right.balanceFactor&&c(u.right),a=h(u),u===this._root&&(this._root=a),u=a):1<u.balanceFactor&&(-1===u.left.balanceFactor&&h(u.left),a=c(u),u===this._root&&(this._root=a),u=a),-1!==u.balanceFactor&&1!==u.balanceFactor);)u=(l=u).parent;return e.parent&&(e.parent.left===e?e.parent.left=null:e.parent.right=null),e===this._root&&(this._root=null),this._size--,s},t.prototype.load=function(t,e){if(void 0===t&&(t=[]),void 0===e&&(e=[]),Array.isArray(t))for(var n=0,i=t.length;n<i;n++)this.insert(t[n],e[n]);return this},t.prototype.isBalanced=function(){return function t(e){if(null===e)return!0;var n=r(e.left),i=r(e.right);return!!(Math.abs(n-i)<=1&&t(e.left)&&t(e.right))}(this._root)},t.prototype.toString=function(t){return function(t,e){void 0===e&&(e=function(t){return t.key});var n=[];return function t(e,n,i,r,o){if(e){r(n+(i?"└── ":"├── ")+o(e)+"\n");var s=n+(i?"    ":"│   ");e.left&&t(e.left,s,!1,r,o),e.right&&t(e.right,s,!0,r,o)}}(t,"",!0,function(t){return n.push(t)},e),n.join("")}(this._root,t)},Object.defineProperties(t.prototype,e),t},"object"==(void 0===n?"undefined":g(n))&&void 0!==e?e.exports=i():this.avl=i()},{}],3:[function(t,e,n){function i(t,e){if(!(this instanceof i))return new i(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||r,0<this.length)for(var n=(this.length>>1)-1;0<=n;n--)this._down(n)}function r(t,e){return t<e?-1:e<t?1:0}e.exports=i,(e.exports.default=i).prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];0<t;){var r=t-1>>1,o=e[r];if(0<=n(i,o))break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&n(e[s],a)<0&&(a=e[o=s]),0<=n(a,r))break;e[t]=a,t=o}e[t]=r}}},{}],4:[function(t,e,n){var a=t("./signed_area");e.exports=function(t,e){var n,i,r,o=t.point,s=e.point;return o[0]>s[0]?1:o[0]<s[0]?-1:o[1]!==s[1]?o[1]>s[1]?1:-1:(i=e,r=o,(n=t).left!==i.left?n.left?1:-1:0!==a(r,n.otherEvent.point,i.otherEvent.point)?n.isBelow(i.otherEvent.point)?-1:1:!n.isSubject&&i.isSubject?1:-1)}},{"./signed_area":16}],5:[function(t,e,n){var r=t("./signed_area"),o=t("./compare_events"),s=t("./equals");e.exports=function(t,e){if(t===e)return 0;if(0!==r(t.point,t.otherEvent.point,e.point)||0!==r(t.point,t.otherEvent.point,e.otherEvent.point))return s(t.point,e.point)?t.isBelow(e.otherEvent.point)?-1:1:t.point[0]===e.point[0]?t.point[1]<e.point[1]?-1:1:1===o(t,e)?e.isAbove(t.point)?-1:1:t.isBelow(e.point)?-1:1;if(t.isSubject!==e.isSubject)return t.isSubject?-1:1;var n=t.point,i=e.point;return n[0]===i[0]&&n[1]===i[1]?(n=t.otherEvent.point,i=e.otherEvent.point,n[0]===i[0]&&n[1]===i[1]?0:t.contourId>e.contourId?1:-1):1===o(t,e)?1:-1}},{"./compare_events":4,"./equals":10,"./signed_area":16}],6:[function(t,e,n){var i=t("./edge_type"),r=t("./operation"),o=r.INTERSECTION,s=r.UNION,a=r.DIFFERENCE,u=r.XOR;function l(t,e){switch(t.type){case i.NORMAL:switch(e){case o:return!t.otherInOut;case s:return t.otherInOut;case a:return t.isSubject&&t.otherInOut||!t.isSubject&&!t.otherInOut;case u:return!0}break;case i.SAME_TRANSITION:return e===o||e===s;case i.DIFFERENT_TRANSITION:return e===a;case i.NON_CONTRIBUTING:return!1}return!1}e.exports=function(t,e,n){null===e?(t.inOut=!1,t.otherInOut=!0):(t.isSubject===e.isSubject?(t.inOut=!e.inOut,t.otherInOut=e.otherInOut):(t.inOut=!e.otherInOut,t.otherInOut=e.isVertical()?!e.inOut:e.inOut),e&&(t.prevInResult=!l(e,n)||e.isVertical()?e.prevInResult:e)),t.inResult=l(t,n)}},{"./edge_type":9,"./operation":13}],7:[function(t,e,n){var p=t("./compare_events"),f=t("./operation");function d(t,e,n,i){var r=t+1,o=e.length;if(o-1<r)return t-1;for(var s=e[t].point,a=e[r].point;r<o&&a[0]===s[0]&&a[1]===s[1];){if(!n[r])return r;a=e[++r].point}for(r=t-1;n[r]&&i<=r;)r--;return r}e.exports=function(t,e){var n,i,r,o=function(t){var e,n,i,r,o=[];for(n=0,i=t.length;n<i;n++)((e=t[n]).left&&e.inResult||!e.left&&e.otherEvent.inResult)&&o.push(e);for(var s=!1;!s;)for(s=!0,n=0,i=o.length;n<i;n++)n+1<i&&1===p(o[n],o[n+1])&&(r=o[n],o[n]=o[n+1],o[n+1]=r,s=!1);for(n=0,i=o.length;n<i;n++)(e=o[n]).pos=n,e.left||(r=e.pos,e.pos=e.otherEvent.pos,e.otherEvent.pos=r);return o}(t),s={},a=[];for(n=0,i=o.length;n<i;n++)if(!s[n]){var u=[[]];o[n].isExteriorRing?e===f.DIFFERENCE&&!o[n].isSubject&&1<a.length?a[a.length-1].push(u[0]):a.push(u):e!==f.DIFFERENCE||o[n].isSubject||0!==a.length?0===a.length?a.push([[u]]):a[a.length-1].push(u[0]):a.push(u);var l=a.length-1,h=n,c=o[n].point;for(u[0].push(c);n<=h;)r=o[h],s[h]=!0,r.left?(r.resultInOut=!1,r.contourId=l):(r.otherEvent.resultInOut=!0,r.otherEvent.contourId=l),s[h=r.pos]=!0,u[0].push(o[h].point),h=d(h,o,s,n);r=o[h=-1===h?n:h],s[h]=s[r.pos]=!0,r.otherEvent.resultInOut=!0,r.otherEvent.contourId=l}return a}},{"./compare_events":4,"./operation":13}],8:[function(t,e,n){var o=t("./sweep_event"),s=t("./equals"),a=t("./compare_events");e.exports=function(t,e,n){var i=new o(e,!1,t,t.isSubject),r=new o(e,!0,t.otherEvent,t.isSubject);return s(t.point,t.otherEvent.point)&&console.warn("what is that, a collapsed segment?",t),i.contourId=r.contourId=t.contourId,0<a(r,t.otherEvent)&&(t.otherEvent.left=!0,r.left=!1),t.otherEvent.otherEvent=r,t.otherEvent=i,n.push(r),n.push(i),n}},{"./compare_events":4,"./equals":10,"./sweep_event":18}],9:[function(t,e,n){e.exports={NORMAL:0,NON_CONTRIBUTING:1,SAME_TRANSITION:2,DIFFERENT_TRANSITION:3}},{}],10:[function(t,e,n){e.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]}},{}],11:[function(t,e,n){var p=t("tinyqueue"),d=t("./sweep_event"),g=t("./compare_events"),f=t("./operation"),y=Math.max,_=Math.min,m=0;function v(t,e,n,i,r,o){var s,a,u,l,h,c;for(s=0,a=t.length-1;s<a;s++)if(u=t[s],l=t[s+1],h=new d(u,!1,void 0,e),c=new d(l,!1,h,e),h.otherEvent=c,u[0]!==l[0]||u[1]!==l[1]){h.contourId=c.contourId=n,o||(h.isExteriorRing=!1,c.isExteriorRing=!1),0<g(h,c)?c.left=!0:h.left=!0;var p=u[0],f=u[1];r[0]=_(r[0],p),r[1]=_(r[1],f),r[2]=y(r[2],p),r[3]=y(r[3],f),i.push(h),i.push(c)}}e.exports=function(t,e,n,i,r){var o,s,a,u,l,h,c=new p(null,g);for(a=0,u=t.length;a<u;a++)for(l=0,h=(o=t[a]).length;l<h;l++)(s=0===l)&&m++,v(o[l],!0,m,c,n,s);for(a=0,u=e.length;a<u;a++)for(l=0,h=(o=e[a]).length;l<h;l++)s=0===l,r===f.DIFFERENCE&&(s=!1),s&&m++,v(o[l],!1,m,c,i,s);return c}},{"./compare_events":4,"./operation":13,"./sweep_event":18,tinyqueue:3}],12:[function(t,e,n){var c=t("./subdivide_segments"),p=t("./connect_edges"),f=t("./fill_queue"),d=t("./operation"),g=[];function i(t,e,n){"number"==typeof t[0][0][0]&&(t=[t]),"number"==typeof e[0][0][0]&&(e=[e]);var i,r=(i=null,t.length*e.length==0&&(n===d.INTERSECTION?i=g:n===d.DIFFERENCE?i=t:n!==d.UNION&&n!==d.XOR||(i=0===t.length?e:t)),i);if(r)return r===g?null:r;var o,s,a=[1/0,1/0,-1/0,-1/0],u=[1/0,1/0,-1/0,-1/0],l=f(t,e,a,u,n);if(o=e,s=null,(u[2]<a[0]||a[2]<u[0]||u[3]<a[1]||a[3]<u[1])&&(n===d.INTERSECTION?s=g:n===d.DIFFERENCE?s=t:n!==d.UNION&&n!==d.XOR||(s=t.concat(o))),r=s)return r===g?null:r;var h=c(l,t,e,a,u,n);return p(h,n)}i.union=function(t,e){return i(t,e,d.UNION)},i.diff=function(t,e){return i(t,e,d.DIFFERENCE)},i.xor=function(t,e){return i(t,e,d.XOR)},i.intersection=function(t,e){return i(t,e,d.INTERSECTION)},i.operations=d,e.exports=i,e.exports.default=i},{"./connect_edges":7,"./fill_queue":11,"./operation":13,"./subdivide_segments":17}],13:[function(t,e,n){e.exports={INTERSECTION:0,UNION:1,DIFFERENCE:2,XOR:3}},{}],14:[function(t,e,n){var u=t("./divide_segment"),l=t("./segment_intersection"),h=t("./equals"),c=t("./compare_events"),p=t("./edge_type");e.exports=function(t,e,n){var i=l(t.point,t.otherEvent.point,e.point,e.otherEvent.point),r=i?i.length:0;if(0===r)return 0;if(1===r&&(h(t.point,e.point)||h(t.otherEvent.point,e.otherEvent.point)))return 0;if(2===r&&t.isSubject===e.isSubject)return 0;if(1===r)return h(t.point,i[0])||h(t.otherEvent.point,i[0])||u(t,i[0],n),h(e.point,i[0])||h(e.otherEvent.point,i[0])||u(e,i[0],n),1;var o=[],s=!1,a=!1;return h(t.point,e.point)?s=!0:1===c(t,e)?o.push(e,t):o.push(t,e),h(t.otherEvent.point,e.otherEvent.point)?a=!0:1===c(t.otherEvent,e.otherEvent)?o.push(e.otherEvent,t.otherEvent):o.push(t.otherEvent,e.otherEvent),s&&a||s?(e.type=p.NON_CONTRIBUTING,t.type=e.inOut===t.inOut?p.SAME_TRANSITION:p.DIFFERENT_TRANSITION,s&&!a&&u(o[1].otherEvent,o[0].point,n),2):(a?u(o[0],o[1].point,n):o[0]!==o[3].otherEvent?(u(o[0],o[1].point,n),u(o[1],o[2].point,n)):(u(o[0],o[1].point,n),u(o[3].otherEvent,o[2].point,n)),3)}},{"./compare_events":4,"./divide_segment":8,"./edge_type":9,"./equals":10,"./segment_intersection":15}],15:[function(t,e,n){function v(t,e){return t[0]*e[1]-t[1]*e[0]}function b(t,e){return t[0]*e[0]+t[1]*e[1]}e.exports=function(t,e,n,i,r){var o=[e[0]-t[0],e[1]-t[1]],s=[i[0]-n[0],i[1]-n[1]];function a(t,e,n){return[t[0]+e*n[0],t[1]+e*n[1]]}var u=[n[0]-t[0],n[1]-t[1]],l=v(o,s),h=l*l,c=b(o,o);if(h>1e-9*c*b(s,s)){var p=v(u,s)/l;if(p<0||1<p)return null;var f=v(u,o)/l;return f<0||1<f?null:r?null:[a(t,p,o)]}var d=b(u,u);if((h=(l=v(u,o))*l)>1e-9*c*d)return null;var g=b(o,u)/c,y=g+b(o,s)/c,_=Math.min(g,y),m=Math.max(g,y);return _<=1&&0<=m?1===_?r?null:[a(t,0<_?_:0,o)]:0===m?r?null:[a(t,m<1?m:1,o)]:r&&0===_&&1===m?null:[a(t,0<_?_:0,o),a(t,m<1?m:1,o)]:null}},{}],16:[function(t,e,n){e.exports=function(t,e,n){return(t[0]-n[0])*(e[1]-n[1])-(e[0]-n[0])*(t[1]-n[1])}},{}],17:[function(t,e,n){var m=t("avl"),v=t("./compute_fields"),b=t("./possible_intersection"),x=t("./compare_segments"),E=t("./operation");e.exports=function(t,e,n,i,r,o){for(var s,a,u,l=new m(x),h=[],c=Math.min(i[2],r[2]),p=E.INTERSECTION,f=E.DIFFERENCE;t.length;){var d=t.pop();if(h.push(d),o===p&&d.point[0]>c||o===f&&d.point[0]>i[2])break;if(d.left){a=s=l.insert(d),s=s!==(u=l.minNode())?l.prev(s):null,a=l.next(a);var g,y=s?s.key:null;if(v(d,y,o),a&&2===b(d,a.key,t)&&(v(d,y,o),v(d,a.key,o)),s&&2===b(s.key,d,t)){var _=s;g=(_=_!==u?l.prev(_):null)?_.key:null,v(y,g,o),v(d,y,o)}}else d=d.otherEvent,a=s=l.find(d),s&&a&&(s=s!==u?l.prev(s):null,a=l.next(a),l.remove(d),a&&s&&b(s.key,a.key,t))}return h}},{"./compare_segments":5,"./compute_fields":6,"./operation":13,"./possible_intersection":14,avl:2}],18:[function(t,e,n){var o=t("./edge_type");function i(t,e,n,i,r){this.left=e,this.point=t,this.otherEvent=n,this.isSubject=i,this.type=r||o.NORMAL,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.inResult=!1,this.resultInOut=!1,this.isExteriorRing=!0}i.prototype={isBelow:function(t){var e=this.point,n=this.otherEvent.point;return this.left?0<(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1]):0<(n[0]-t[0])*(e[1]-t[1])-(e[0]-t[0])*(n[1]-t[1])},isAbove:function(t){return!this.isBelow(t)},isVertical:function(){return this.point[0]===this.otherEvent.point[0]},clone:function(){var t=new i(this.point,this.left,this.otherEvent,this.isSubject,this.type);return t.inResult=this.inResult,t.prevInResult=this.prevInResult,t.isExteriorRing=this.isExteriorRing,t.inOut=this.inOut,t.otherInOut=this.otherInOut,t}},e.exports=i},{"./edge_type":9}]},{},[1])(1)},t.exports=i()},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var h=n(24),i=(n.n(h),n(25)),c=n(2),p=n(26),r=n(6);function f(t){switch(t.type){case"Polygon":return 1<Object(i.a)(t)?t:null;case"MultiPolygon":var e=[];if(Object(r.a)(t,function(t){1<Object(i.a)(t)&&e.push(t.geometry.coordinates)}),e.length)return{type:"MultiPolygon",coordinates:e}}}e.default=function(t,e){var n=Object(p.a)(t),i=Object(p.a)(e),r=t.properties||{};if(n=f(n),i=f(i),!n)return null;if(!i)return Object(c.a)(n,r);var o=new h.GeoJSONReader,s=o.read(n),a=o.read(i),u=h.OverlayOp.difference(s,a);if(u.isEmpty())return null;var l=(new h.GeoJSONWriter).write(u);return Object(c.a)(l,r)}},function(t,e,n){!function(t){function e(){}function n(t){this.message=t||""}function i(t){this.message=t||""}function r(t){this.message=t||""}function o(){}function s(t){return null===t?te:t.color}function a(t){return null===t?null:t.parent}function u(t,e){null!==t&&(t.color=e)}function l(t){return null===t?null:t.left}function h(t){return null===t?null:t.right}function c(){this.root_=null,this.size_=0}function p(){}function f(){this.array_=[],arguments[0]instanceof Nt&&this.addAll(arguments[0])}function d(){}function g(t){this.message=t||""}function y(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t,e,n){if(null==this)throw new TypeError(this+" is not an object");var i=Object(this),r=Math.max(Math.min(i.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(e),10)||0;o=o<0?Math.max(r+o,0):Math.min(o,r);var s=2 in arguments&&void 0!==n?parseInt(Number(n),10)||0:r;for(s=s<0?Math.max(r+n,0):Math.min(s,r);o<s;)i[o]=t,++o;return i},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};function _(){}_.prototype.interfaces_=function(){return[]},_.prototype.getClass=function(){return _},_.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};function m(){}var v,b=((v=Error)&&(E.__proto__=v),(E.prototype=Object.create(v&&v.prototype)).constructor=E),x={MAX_VALUE:{configurable:!0}};function E(t){v.call(this,t),this.name="IllegalArgumentException",this.message=t,this.stack=(new v).stack}m.isNaN=function(t){return Number.isNaN(t)},m.doubleToLongBits=function(t){return t},m.longBitsToDouble=function(t){return t},m.isInfinite=function(t){return!Number.isFinite(t)},x.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(m,x);function I(){}function L(){}function w(){}function S(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=S.NULL_ORDINATE;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=S.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])}var M={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};S.prototype.setOrdinate=function(t,e){switch(t){case S.X:this.x=e;break;case S.Y:this.y=e;break;case S.Z:this.z=e;break;default:throw new b("Invalid ordinate index: "+t)}},S.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!_.equalsWithTolerance(this.x,e.x,n)&&!!_.equalsWithTolerance(this.y,e.y,n)}},S.prototype.getOrdinate=function(t){switch(t){case S.X:return this.x;case S.Y:return this.y;case S.Z:return this.z}throw new b("Invalid ordinate index: "+t)},S.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||m.isNaN(this.z))&&m.isNaN(t.z)},S.prototype.equals=function(t){return t instanceof S&&this.equals2D(t)},S.prototype.equalInZ=function(t,e){return _.equalsWithTolerance(this.z,t.z,e)},S.prototype.compareTo=function(t){return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0},S.prototype.clone=function(){},S.prototype.copy=function(){return new S(this)},S.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},S.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},S.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},S.prototype.hashCode=function(){var t=17;return 37*(t=37*t+S.hashCode(this.x))+S.hashCode(this.y)},S.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},S.prototype.interfaces_=function(){return[I,L,e]},S.prototype.getClass=function(){return S},S.hashCode=function(){if(1===arguments.length){var t=m.doubleToLongBits(arguments[0]);return Math.trunc((t^t)>>>32)}},M.DimensionalComparator.get=function(){return C},M.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},M.NULL_ORDINATE.get=function(){return m.NaN},M.X.get=function(){return 0},M.Y.get=function(){return 1},M.Z.get=function(){return 2},Object.defineProperties(S,M);var C=function(t){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var e=t;if(2!==e&&3!==e)throw new b("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};C.prototype.compare=function(t,e){var n=t,i=e,r=C.compare(n.x,i.x);if(0!==r)return r;var o=C.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:C.compare(n.z,i.z)},C.prototype.interfaces_=function(){return[w]},C.prototype.getClass=function(){return C},C.compare=function(t,e){return t<e?-1:e<t?1:m.isNaN(t)?m.isNaN(e)?0:-1:m.isNaN(e)?1:0};function P(){}P.prototype.create=function(){},P.prototype.interfaces_=function(){return[]},P.prototype.getClass=function(){return P};function N(){}var O={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};N.prototype.interfaces_=function(){return[]},N.prototype.getClass=function(){return N},N.toLocationSymbol=function(t){switch(t){case N.EXTERIOR:return"e";case N.BOUNDARY:return"b";case N.INTERIOR:return"i";case N.NONE:return"-"}throw new b("Unknown location value: "+t)},O.INTERIOR.get=function(){return 0},O.BOUNDARY.get=function(){return 1},O.EXTERIOR.get=function(){return 2},O.NONE.get=function(){return-1},Object.defineProperties(N,O);function T(t,e){return t.interfaces_&&-1<t.interfaces_().indexOf(e)}function k(){}var R={LOG_10:{configurable:!0}};k.prototype.interfaces_=function(){return[]},k.prototype.getClass=function(){return k},k.log10=function(t){var e=Math.log(t);return m.isInfinite(e)?e:m.isNaN(e)?e:e/k.LOG_10},k.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},k.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:n<t?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:o<i?o:i}},k.wrap=function(t,e){return t<0?e- -t%e:t%e},k.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return n<t&&(n=t),n<e&&(n=e),n}if(4===arguments.length){var i=arguments[1],r=arguments[2],o=arguments[3],s=arguments[0];return s<i&&(s=i),s<r&&(s=r),s<o&&(s=o),s}},k.average=function(t,e){return(t+e)/2},R.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(k,R);function D(t){this.str=t}D.prototype.append=function(t){this.str+=t},D.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},D.prototype.toString=function(t){return this.str};function A(t){this.value=t}A.prototype.intValue=function(){return this.value},A.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},A.isNaN=function(t){return Number.isNaN(t)};function F(){}F.isWhitespace=function(t){return t<=32&&0<=t||127===t},F.toUpperCase=function(t){return t.toUpperCase()};function B(){if(this._hi=0,(this._lo=0)===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof B){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){B.call(this,B.parse(arguments[0]))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n,i)}}var G={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};B.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},B.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=B.magnitude(n._hi),r=B.TEN.pow(i);(n=n.divide(r)).gt(B.TEN)?(n=n.divide(B.TEN),i+=1):n.lt(B.ONE)&&(n=n.multiply(B.TEN),--i);for(var o=i+1,s=new D,a=B.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===o&&s.append(".");var l=Math.trunc(n._hi);if(l<0)break;var h=!1,c=0;c=9<l?(h=!0,"9"):"0"+l,s.append(c),n=n.subtract(B.valueOf(l)).multiply(B.TEN),h&&n.selfAdd(B.TEN);var p=!0,f=B.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-u&&(p=!1),!p)break}return e[0]=i,s.toString()},B.prototype.sqr=function(){return this.multiply(this)},B.prototype.doubleValue=function(){return this._hi+this._lo},B.prototype.subtract=function(){if(arguments[0]instanceof B){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},B.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},B.prototype.isZero=function(){return 0===this._hi&&0===this._lo},B.prototype.selfSubtract=function(){if(arguments[0]instanceof B){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},B.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},B.prototype.min=function(t){return this.le(t)?this:t},B.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof B){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n,i,r,o,s=arguments[0],a=arguments[1],u=null,l=null,h=null,c=null;return r=this._hi/s,c=(u=(h=B.SPLIT*r)-(h-r))*(l=(c=B.SPLIT*s)-(c-s))-(o=r*s)+u*(i=s-l)+(n=r-u)*l+n*i,c=r+(h=(this._hi-o-c+this._lo-r*a)/s),this._hi=c,this._lo=r-c+h,this}},B.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},B.prototype.divide=function(){if(arguments[0]instanceof B){var t,e,n,i,r=arguments[0],o=null,s=null,a=null,u=null;return t=(n=this._hi/r._hi)-(o=(a=B.SPLIT*n)-(a-n)),u=o*(s=(u=B.SPLIT*r._hi)-(u-r._hi))-(i=n*r._hi)+o*(e=r._hi-s)+t*s+t*e,a=(this._hi-i-u+this._lo-n*r._lo)/r._hi,new B(u=n+a,n-u+a)}if("number"==typeof arguments[0]){var l=arguments[0];return m.isNaN(l)?B.createNaN():B.copy(this).selfDivide(l,0)}},B.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},B.prototype.pow=function(t){if(0===t)return B.valueOf(1);var e=new B(this),n=B.valueOf(1),i=Math.abs(t);if(1<i)for(;0<i;)i%2==1&&n.selfMultiply(e),0<(i/=2)&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},B.prototype.ceil=function(){if(this.isNaN())return B.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new B(t,e)},B.prototype.compareTo=function(t){return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0},B.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},B.prototype.setValue=function(){if(arguments[0]instanceof B){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},B.prototype.max=function(t){return this.ge(t)?this:t},B.prototype.sqrt=function(){if(this.isZero())return B.valueOf(0);if(this.isNegative())return B.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=B.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},B.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof B){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e,n,i,r,o,s=arguments[0],a=null;return a=(i=this._hi+s)-(r=i-this._hi),n=(o=(a=s-r+(this._hi-a))+this._lo)+(i-(e=i+o)),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){var u,l,h,c,p=arguments[0],f=arguments[1],d=null,g=null,y=null;h=this._hi+p,l=this._lo+f,g=h-(y=h-this._hi),d=l-(c=l-this._lo);var _=(u=h+(y=(g=p-y+(this._hi-g))+l))+(y=(d=f-c+(this._lo-d))+(y+(h-u))),m=y+(u-_);return this._hi=_,this._lo=m,this}},B.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof B){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n,i,r=arguments[0],o=arguments[1],s=null,a=null,u=null,l=null;s=(u=B.SPLIT*this._hi)-this._hi,l=B.SPLIT*r,s=u-s,n=this._hi-s,a=l-r;var h=(u=this._hi*r)+(l=s*(a=l-a)-u+s*(i=r-a)+n*a+n*i+(this._hi*o+this._lo*r)),c=l+(s=u-h);return this._hi=h,this._lo=c,this}},B.prototype.selfSqr=function(){return this.selfMultiply(this)},B.prototype.floor=function(){if(this.isNaN())return B.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new B(t,e)},B.prototype.negate=function(){return this.isNaN()?this:new B(-this._hi,-this._lo)},B.prototype.clone=function(){},B.prototype.multiply=function(){if(arguments[0]instanceof B){var t=arguments[0];return t.isNaN()?B.createNaN():B.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return m.isNaN(e)?B.createNaN():B.copy(this).selfMultiply(e,0)}},B.prototype.isNaN=function(){return m.isNaN(this._hi)},B.prototype.intValue=function(){return Math.trunc(this._hi)},B.prototype.toString=function(){var t=B.magnitude(this._hi);return-3<=t&&t<=20?this.toStandardNotation():this.toSciNotation()},B.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+B.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+B.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},B.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=B.SPLIT*n)-(s-n)),o=(a=B.SPLIT*this._hi)-this._hi;var u=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new B(u,n-u+s)},B.prototype.toSciNotation=function(){if(this.isZero())return B.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=B.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";1<n.length&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},B.prototype.abs=function(){return this.isNaN()?B.NaN:this.isNegative()?this.negate():new B(this)},B.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo},B.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},B.prototype.add=function(){if(arguments[0]instanceof B){var t=arguments[0];return B.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return B.copy(this).selfAdd(e)}},B.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof B){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},B.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},B.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},B.prototype.trunc=function(){return this.isNaN()?B.NaN:this.isPositive()?this.floor():this.ceil()},B.prototype.signum=function(){return 0<this._hi?1:this._hi<0?-1:0<this._lo?1:this._lo<0?-1:0},B.prototype.interfaces_=function(){return[e,I,L]},B.prototype.getClass=function(){return B},B.sqr=function(t){return B.valueOf(t).selfMultiply(t)},B.valueOf=function(){return"string"==typeof arguments[0]?B.parse(arguments[0]):"number"==typeof arguments[0]?new B(arguments[0]):void 0},B.sqrt=function(t){return B.valueOf(t).sqrt()},B.parse=function(t){for(var e=0,n=t.length;F.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new B,s=0,a=0,u=0;!(n<=e);){var l=t.charAt(e);if(e++,F.isDigit(l)){var h=l-"0";o.selfMultiply(B.TEN),o.selfAdd(h),s++}else{if("."!==l){if("e"!==l&&"E"!==l)throw new Error("Unexpected character '"+l+"' at position "+e+" in string "+t);var c=t.substring(e);try{u=A.parseInt(c)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+c+" in string "+t):e}break}a=s}}var p=o,f=s-a-u;if(0==f)p=o;else if(0<f){var d=B.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=B.TEN.pow(-f);p=o.multiply(g)}return i?p.negate():p},B.createNaN=function(){return new B(m.NaN,m.NaN)},B.copy=function(t){return new B(t)},B.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},B.stringOfChar=function(t,e){for(var n=new D,i=0;i<e;i++)n.append(t);return n.toString()},G.PI.get=function(){return new B(3.141592653589793,12246467991473532e-32)},G.TWO_PI.get=function(){return new B(6.283185307179586,24492935982947064e-32)},G.PI_2.get=function(){return new B(1.5707963267948966,6123233995736766e-32)},G.E.get=function(){return new B(2.718281828459045,14456468917292502e-32)},G.NaN.get=function(){return new B(m.NaN,m.NaN)},G.EPS.get=function(){return 123259516440783e-46},G.SPLIT.get=function(){return 134217729},G.MAX_PRINT_DIGITS.get=function(){return 32},G.TEN.get=function(){return B.valueOf(10)},G.ONE.get=function(){return B.valueOf(1)},G.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},G.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(B,G);function U(){}var j={DP_SAFE_EPSILON:{configurable:!0}};U.prototype.interfaces_=function(){return[]},U.prototype.getClass=function(){return U},U.orientationIndex=function(t,e,n){var i=U.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=B.valueOf(e.x).selfAdd(-t.x),o=B.valueOf(e.y).selfAdd(-t.y),s=B.valueOf(n.x).selfAdd(-e.x),a=B.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},U.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},U.intersection=function(t,e,n,i){var r=B.valueOf(i.y).selfSubtract(n.y).selfMultiply(B.valueOf(e.x).selfSubtract(t.x)),o=B.valueOf(i.x).selfSubtract(n.x).selfMultiply(B.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=B.valueOf(i.x).selfSubtract(n.x).selfMultiply(B.valueOf(t.y).selfSubtract(n.y)),u=B.valueOf(i.y).selfSubtract(n.y).selfMultiply(B.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u).selfDivide(s).doubleValue(),h=B.valueOf(t.x).selfAdd(B.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),c=B.valueOf(e.x).selfSubtract(t.x).selfMultiply(B.valueOf(t.y).selfSubtract(n.y)),p=B.valueOf(e.y).selfSubtract(t.y).selfMultiply(B.valueOf(t.x).selfSubtract(n.x)),f=c.subtract(p).selfDivide(s).doubleValue(),d=B.valueOf(n.y).selfAdd(B.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new S(h,d)},U.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(0<r){if(o<=0)return U.signum(s);i=r+o}else{if(!(r<0))return U.signum(s);if(0<=o)return U.signum(s);i=-r-o}var a=U.DP_SAFE_EPSILON*i;return a<=s||a<=-s?U.signum(s):2},U.signum=function(t){return 0<t?1:t<0?-1:0},j.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(U,j);function q(){}var z={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};z.X.get=function(){return 0},z.Y.get=function(){return 1},z.Z.get=function(){return 2},z.M.get=function(){return 3},q.prototype.setOrdinate=function(t,e,n){},q.prototype.size=function(){},q.prototype.getOrdinate=function(t,e){},q.prototype.getCoordinate=function(){},q.prototype.getCoordinateCopy=function(t){},q.prototype.getDimension=function(){},q.prototype.getX=function(t){},q.prototype.clone=function(){},q.prototype.expandEnvelope=function(t){},q.prototype.copy=function(){},q.prototype.getY=function(t){},q.prototype.toCoordinateArray=function(){},q.prototype.interfaces_=function(){return[L]},q.prototype.getClass=function(){return q},Object.defineProperties(q,z);function V(){}function Y(){}var H,X=((H=V)&&(J.__proto__=H),((J.prototype=Object.create(H&&H.prototype)).constructor=J).prototype.interfaces_=function(){return[]},J.prototype.getClass=function(){return J},J);function J(){H.call(this,"Projective point not representable on the Cartesian plane.")}Y.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},Y.getProperty=function(t){return{"line.separator":"\n"}[t]};function W(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof W&&arguments[1]instanceof W){var i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof S&&arguments[1]instanceof S){var o=arguments[0],s=arguments[1];this.x=o.y-s.y,this.y=s.x-o.x,this.w=o.x*s.y-s.x*o.y}}else if(3===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2];this.x=a,this.y=u,this.w=l}else if(4===arguments.length){var h=arguments[0],c=arguments[1],p=arguments[2],f=arguments[3],d=h.y-c.y,g=c.x-h.x,y=h.x*c.y-c.x*h.y,_=p.y-f.y,m=f.x-p.x,v=p.x*f.y-f.x*p.y;this.x=g*v-m*y,this.y=_*y-d*v,this.w=d*m-_*g}}W.prototype.getY=function(){var t=this.y/this.w;if(m.isNaN(t)||m.isInfinite(t))throw new X;return t},W.prototype.getX=function(){var t=this.x/this.w;if(m.isNaN(t)||m.isInfinite(t))throw new X;return t},W.prototype.getCoordinate=function(){var t=new S;return t.x=this.getX(),t.y=this.getY(),t},W.prototype.interfaces_=function(){return[]},W.prototype.getClass=function(){return W},W.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,h=r*u-a*o,c=(o*l-u*s)/h,p=(a*s-r*l)/h;if(m.isNaN(c)||m.isInfinite(c)||m.isNaN(p)||m.isInfinite(p))throw new X;return new S(c,p)};function K(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof K){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.init(r,o,s,a)}}var Z={serialVersionUID:{configurable:!0}};K.prototype.getArea=function(){return this.getWidth()*this.getHeight()},K.prototype.equals=function(t){if(!(t instanceof K))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},K.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new K;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new K(e,i,n,r)},K.prototype.isNull=function(){return this._maxx<this._minx},K.prototype.getMaxX=function(){return this._maxx},K.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof K){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},K.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof K){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof S){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},K.prototype.getMinY=function(){return this._miny},K.prototype.getMinX=function(){return this._minx},K.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof K){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},K.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},K.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},K.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},K.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},K.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},K.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},K.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},K.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return e<t?t:e},K.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},K.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof K){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof S){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},K.prototype.centre=function(){return this.isNull()?null:new S((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},K.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof K){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},K.prototype.getMaxY=function(){return this._maxy},K.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},K.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+S.hashCode(this._minx))+S.hashCode(this._maxx))+S.hashCode(this._miny))+S.hashCode(this._maxy)},K.prototype.interfaces_=function(){return[I,e]},K.prototype.getClass=function(){return K},K.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),u=Math.max(o.x,s.x),l=Math.min(i.x,r.x),h=Math.max(i.x,r.x);return!(u<l||h<a||(a=Math.min(o.y,s.y),u=Math.max(o.y,s.y),l=Math.min(i.y,r.y),h=Math.max(i.y,r.y),u<l||h<a))}},Z.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(K,Z);function Q(t){this.geometryFactory=t||new je}var $={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};Q.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=$.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=$.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],nt[n]&&(e=nt[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Q.prototype.write=function(t){return this.extractGeometry(t)},Q.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!et[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+et[e].apply(this,[t])+")"};function tt(t){this.parser=new Q(t)}var et={coordinate:function(t){return t.x+" "+t.y},point:function(t){return et.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+et.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(et.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(et.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+et.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+et.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+et.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+et.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},nt={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split($.spaces);return this.geometryFactory.createPoint(new S(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace($.trimParens,"$1"),i.push(nt.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split($.spaces),i.push(new S(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split($.spaces),i.push(new S(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split($.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace($.trimParens,"$1"),i.push(nt.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split($.parenComma),s=[],a=0,u=o.length;a<u;++a)e=o[a].replace($.trimParens,"$1"),n=nt.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split($.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace($.trimParens,"$1"),i.push(nt.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}};tt.prototype.write=function(t){return this.parser.write(t)},tt.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};function it(){}var rt,ot,st=((ot=Error)&&(lt.__proto__=ot),(lt.prototype=Object.create(ot&&ot.prototype)).constructor=lt),at=((rt=st)&&(ut.__proto__=rt),((ut.prototype=Object.create(rt&&rt.prototype)).constructor=ut).prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut},ut);function ut(){if(rt.call(this),0===arguments.length)rt.call(this);else if(1===arguments.length){var t=arguments[0];rt.call(this,t)}}function lt(t){ot.call(this,t),this.name="RuntimeException",this.message=t,this.stack=(new ot).stack}it.prototype.interfaces_=function(){return[]},it.prototype.getClass=function(){return it},it.shouldNeverReachHere=function(){if(0===arguments.length)it.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new at("Should never reach here"+(null!==t?": "+t:""))}},it.isTrue=function(){var t;if(1===arguments.length)it.isTrue(arguments[0],null);else if(2===arguments.length&&(t=arguments[1],!arguments[0]))throw null===t?new at:new at(t)},it.equals=function(){var t,e,n;if(2===arguments.length)it.equals(t=arguments[0],e=arguments[1],null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new at("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};function ht(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new S,this._intPt[1]=new S,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}var ct={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};ht.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},ht.prototype.getTopologySummary=function(){var t=new D;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},ht.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},ht.prototype.getIntersectionNum=function(){return this._result},ht.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},ht.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},ht.prototype.setPrecisionModel=function(t){this._precisionModel=t},ht.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},ht.prototype.getIntersection=function(t){return this._intPt[t]},ht.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},ht.prototype.hasIntersection=function(){return this._result!==ht.NO_INTERSECTION},ht.prototype.getEdgeDistance=function(t,e){return ht.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},ht.prototype.isCollinear=function(){return this._result===ht.COLLINEAR_INTERSECTION},ht.prototype.toString=function(){return tt.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+tt.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},ht.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},ht.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},ht.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},ht.prototype.interfaces_=function(){return[]},ht.prototype.getClass=function(){return ht},ht.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r<i?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=r<i?s:a)||t.equals(e)||(o=Math.max(s,a))}return it.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},ht.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return it.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},ct.DONT_INTERSECT.get=function(){return 0},ct.DO_INTERSECT.get=function(){return 1},ct.COLLINEAR.get=function(){return 2},ct.NO_INTERSECTION.get=function(){return 0},ct.POINT_INTERSECTION.get=function(){return 1},ct.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(ht,ct);function pt(){}var ft,dt=((ft=ht)&&(gt.__proto__=ft),((gt.prototype=Object.create(ft&&ft.prototype)).constructor=gt).prototype.isInSegmentEnvelopes=function(t){var e=new K(this._inputLines[0][0],this._inputLines[0][1]),n=new K(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},gt.prototype.computeIntersection=function(){if(3!==arguments.length)return ft.prototype.computeIntersection.apply(this,arguments);var t=arguments[0],e=arguments[1],n=arguments[2];if(this._isProper=!1,K.intersects(e,n,t)&&0===_t.orientationIndex(e,n,t)&&0===_t.orientationIndex(n,e,t))return this._isProper=!0,(t.equals(e)||t.equals(n))&&(this._isProper=!1),this._result=ft.POINT_INTERSECTION,null;this._result=ft.NO_INTERSECTION},gt.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},gt.prototype.safeHCoordinateIntersection=function(e,n,i,r){var o=null;try{o=W.intersection(e,n,i,r)}catch(t){if(!(t instanceof X))throw t;o=gt.nearestEndpoint(e,n,i,r)}return o},gt.prototype.intersection=function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new S(gt.nearestEndpoint(t,e,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r},gt.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},gt.prototype.checkDD=function(t,e,n,i,r){var o=U.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);Y.out.println("DD in env = "+s+"  --------------------- "+o),1e-4<r.distance(o)&&Y.out.println("Distance = "+r.distance(o))},gt.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new S(t),o=new S(e),s=new S(n),a=new S(i),u=new S;this.normalizeToEnvCentre(r,o,s,a,u);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=u.x,l.y+=u.y,l},gt.prototype.computeCollinearIntersection=function(t,e,n,i){var r=K.intersects(t,e,n),o=K.intersects(t,e,i),s=K.intersects(n,i,t),a=K.intersects(n,i,e);return r&&o?(this._intPt[0]=n,this._intPt[1]=i,ft.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,ft.COLLINEAR_INTERSECTION):r&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||o||a?ft.COLLINEAR_INTERSECTION:ft.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||s?ft.COLLINEAR_INTERSECTION:ft.POINT_INTERSECTION):o&&s?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?ft.COLLINEAR_INTERSECTION:ft.POINT_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||s?ft.COLLINEAR_INTERSECTION:ft.POINT_INTERSECTION):ft.NO_INTERSECTION},gt.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,p=n.y>i.y?n.y:i.y,f=((l<o?o:l)+(a<c?a:c))/2,d=((h<s?s:h)+(u<p?u:p))/2;r.x=f,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},gt.prototype.computeIntersect=function(t,e,n,i){if(this._isProper=!1,!K.intersects(t,e,n,i))return ft.NO_INTERSECTION;var r=_t.orientationIndex(t,e,n),o=_t.orientationIndex(t,e,i);if(0<r&&0<o||r<0&&o<0)return ft.NO_INTERSECTION;var s=_t.orientationIndex(n,i,t),a=_t.orientationIndex(n,i,e);return 0<s&&0<a||s<0&&a<0?ft.NO_INTERSECTION:0===r&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new S(n):0===o?this._intPt[0]=new S(i):0===s?this._intPt[0]=new S(t):0===a&&(this._intPt[0]=new S(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),ft.POINT_INTERSECTION)},gt.prototype.interfaces_=function(){return[]},gt.prototype.getClass=function(){return gt},gt.nearestEndpoint=function(t,e,n,i){var r=t,o=_t.distancePointLine(t,n,i),s=_t.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=_t.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=_t.distancePointLine(i,t,e))<o&&(o=s,r=i),r},gt);function gt(){ft.apply(this,arguments)}pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt},pt.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return pt.signOfDet2x2(i,r,o,s)},pt.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:0<e?0<n?-r:r:0<n?r:-r;if(0===e||0===n)return 0<i?0<t?r:-r:0<t?-r:r;if(0<e?0<i?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):i=e<=-i?(r=-r,n=-n,-i):(o=t,t=-n,n=o,o=e,e=-i,o):0<i?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):i=i<=e?(t=-t,e=-e,n=-n,-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,o),0<t){if(!(0<n))return r;if(!(t<=n))return r}else{if(0<n)return-r;if(!(n<=t))return-r;r=-r,t=-t,n=-n}for(;;){if(n-=(s=Math.floor(n/t))*t,(i-=s*e)<0)return-r;if(e<i)return r;if(n+n<t){if(e<i+i)return r}else{if(i+i<e)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if(t-=(s=Math.floor(t/n))*n,(e-=s*i)<0)return r;if(i<e)return-r;if(t+t<n){if(i<e+e)return-r}else{if(e+e<i)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};function yt(t){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=t;this._p=e}yt.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return i<n&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,u=pt.signOfDet2x2(r,o,s,a);if(0===u)return this._isPointOnSegment=!0,null;a<o&&(u=-u),0<u&&this._crossingCount++}},yt.prototype.isPointInPolygon=function(){return this.getLocation()!==N.EXTERIOR},yt.prototype.getLocation=function(){return this._isPointOnSegment?N.BOUNDARY:this._crossingCount%2==1?N.INTERIOR:N.EXTERIOR},yt.prototype.isOnSegment=function(){return this._isPointOnSegment},yt.prototype.interfaces_=function(){return[]},yt.prototype.getClass=function(){return yt},yt.locatePointInRing=function(){if(arguments[0]instanceof S&&T(arguments[1],q)){for(var t=arguments[1],e=new yt(arguments[0]),n=new S,i=new S,r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,i),e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof S&&arguments[1]instanceof Array){for(var o=arguments[1],s=new yt(arguments[0]),a=1;a<o.length;a++){var u=o[a],l=o[a-1];if(s.countSegment(u,l),s.isOnSegment())return s.getLocation()}return s.getLocation()}};var _t=function(){},mt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};_t.prototype.interfaces_=function(){return[]},_t.prototype.getClass=function(){return _t},_t.orientationIndex=function(t,e,n){return U.orientationIndex(t,e,n)},_t.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(T(arguments[0],q)){var s=arguments[0],a=s.size();if(a<3)return 0;var u=new S,l=new S,h=new S;s.getCoordinate(0,l),s.getCoordinate(1,h);var c=l.x;h.x-=c;for(var p=0,f=1;f<a-1;f++)u.y=l.y,l.x=h.x,l.y=h.y,s.getCoordinate(f+1,h),h.x-=c,p+=l.x*(u.y-h.y);return p/2}},_t.distanceLineLine=function(t,e,n,i){if(t.equals(e))return _t.distancePointLine(t,n,i);if(n.equals(i))return _t.distancePointLine(i,t,e);var r=!1;if(K.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0==o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=s/o;(u<0||1<u||a<0||1<a)&&(r=!0)}}else r=!0;return r?k.min(_t.distancePointLine(t,n,i),_t.distancePointLine(e,n,i),_t.distancePointLine(n,t,e),_t.distancePointLine(i,t,e)):0},_t.isPointInRing=function(t,e){return _t.locatePointInRing(t,e)!==N.EXTERIOR},_t.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new S;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,u=i.y,l=a-r,h=u-o;n+=Math.sqrt(l*l+h*h),r=a,o=u}return n},_t.isCCW=function(t){var e=t.length-1;if(e<3)throw new b("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}for(var s=i;--s<0&&(s=e),t[s].equals2D(n)&&s!==i;);for(var a=i;t[a=(a+1)%e].equals2D(n)&&a!==i;);var u=t[s],l=t[a];if(u.equals2D(n)||l.equals2D(n)||u.equals2D(l))return!1;var h=_t.computeOrientation(u,n,l);return 0===h?u.x>l.x:0<h},_t.locatePointInRing=function(t,e){return yt.locatePointInRing(t,e)},_t.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},_t.computeOrientation=function(t,e,n){return _t.orientationIndex(t,e,n)},_t.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new b("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=_t.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var u=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),l=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/u;if(l<=0)return o.distance(s);if(1<=l)return o.distance(a);var h=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/u;return Math.abs(h)*Math.sqrt(u)}},_t.isOnLine=function(t,e){for(var n=new dt,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},mt.CLOCKWISE.get=function(){return-1},mt.RIGHT.get=function(){return _t.CLOCKWISE},mt.COUNTERCLOCKWISE.get=function(){return 1},mt.LEFT.get=function(){return _t.COUNTERCLOCKWISE},mt.COLLINEAR.get=function(){return 0},mt.STRAIGHT.get=function(){return _t.COLLINEAR},Object.defineProperties(_t,mt);function vt(){}vt.prototype.filter=function(t){},vt.prototype.interfaces_=function(){return[]},vt.prototype.getClass=function(){return vt};function bt(t){var e=t;this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()}var xt={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};bt.prototype.isGeometryCollection=function(){return this.getSortIndex()===bt.SORTINDEX_GEOMETRYCOLLECTION},bt.prototype.getFactory=function(){return this._factory},bt.prototype.getGeometryN=function(t){return this},bt.prototype.getArea=function(){return 0},bt.prototype.isRectangle=function(){return!1},bt.prototype.equals=function(){if(arguments[0]instanceof bt){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof bt))return!1;var n=e;return this.equalsExact(n)}},bt.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},bt.prototype.geometryChanged=function(){this.apply(bt.geometryChangedFilter)},bt.prototype.geometryChangedAction=function(){this._envelope=null},bt.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},bt.prototype.getLength=function(){return 0},bt.prototype.getNumGeometries=function(){return 1},bt.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},bt.prototype.getUserData=function(){return this._userData},bt.prototype.getSRID=function(){return this._SRID},bt.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},bt.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===bt.SORTINDEX_GEOMETRYCOLLECTION)throw new b("This method does not support GeometryCollection arguments")},bt.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},bt.prototype.norm=function(){var t=this.copy();return t.normalize(),t},bt.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},bt.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new K(this._envelope)},bt.prototype.setSRID=function(t){this._SRID=t},bt.prototype.setUserData=function(t){this._userData=t},bt.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},bt.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},bt.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===bt.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===bt.SORTINDEX_MULTIPOINT||this.getSortIndex()===bt.SORTINDEX_MULTILINESTRING||this.getSortIndex()===bt.SORTINDEX_MULTIPOLYGON},bt.prototype.interfaces_=function(){return[L,I,e]},bt.prototype.getClass=function(){return bt},bt.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},bt.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},xt.serialVersionUID.get=function(){return 0x799ea46522854c00},xt.SORTINDEX_POINT.get=function(){return 0},xt.SORTINDEX_MULTIPOINT.get=function(){return 1},xt.SORTINDEX_LINESTRING.get=function(){return 2},xt.SORTINDEX_LINEARRING.get=function(){return 3},xt.SORTINDEX_MULTILINESTRING.get=function(){return 4},xt.SORTINDEX_POLYGON.get=function(){return 5},xt.SORTINDEX_MULTIPOLYGON.get=function(){return 6},xt.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},xt.geometryChangedFilter.get=function(){return Et},Object.defineProperties(bt,xt);var Et=function(){};Et.interfaces_=function(){return[vt]},Et.filter=function(t){t.geometryChangedAction()};function It(){}It.prototype.filter=function(t){},It.prototype.interfaces_=function(){return[]},It.prototype.getClass=function(){return It};function Lt(){}var wt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Lt.prototype.isInBoundary=function(t){},Lt.prototype.interfaces_=function(){return[]},Lt.prototype.getClass=function(){return Lt},wt.Mod2BoundaryNodeRule.get=function(){return St},wt.EndPointBoundaryNodeRule.get=function(){return Mt},wt.MultiValentEndPointBoundaryNodeRule.get=function(){return Ct},wt.MonoValentEndPointBoundaryNodeRule.get=function(){return Pt},wt.MOD2_BOUNDARY_RULE.get=function(){return new St},wt.ENDPOINT_BOUNDARY_RULE.get=function(){return new Mt},wt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Ct},wt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Pt},wt.OGC_SFS_BOUNDARY_RULE.get=function(){return Lt.MOD2_BOUNDARY_RULE},Object.defineProperties(Lt,wt);var St=function(){};St.prototype.isInBoundary=function(t){return t%2==1},St.prototype.interfaces_=function(){return[Lt]},St.prototype.getClass=function(){return St};var Mt=function(){};Mt.prototype.isInBoundary=function(t){return 0<t},Mt.prototype.interfaces_=function(){return[Lt]},Mt.prototype.getClass=function(){return Mt};var Ct=function(){};Ct.prototype.isInBoundary=function(t){return 1<t},Ct.prototype.interfaces_=function(){return[Lt]},Ct.prototype.getClass=function(){return Ct};var Pt=function(){};Pt.prototype.isInBoundary=function(t){return 1===t},Pt.prototype.interfaces_=function(){return[Lt]},Pt.prototype.getClass=function(){return Pt};function Nt(){}Nt.prototype.add=function(){},Nt.prototype.addAll=function(){},Nt.prototype.isEmpty=function(){},Nt.prototype.iterator=function(){},Nt.prototype.size=function(){},Nt.prototype.toArray=function(){},Nt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";function Ot(){}Ot.prototype.hasNext=function(){},Ot.prototype.next=function(){},Ot.prototype.remove=function(){};var Tt,kt=((Tt=Nt)&&(Rt.__proto__=Tt),((Rt.prototype=Object.create(Tt&&Tt.prototype)).constructor=Rt).prototype.get=function(){},Rt.prototype.set=function(){},Rt.prototype.isEmpty=function(){},Rt);function Rt(){Tt.apply(this,arguments)}(i.prototype=new Error).name="NoSuchElementException";function Dt(){}var At,Ft,Bt=((Ft=kt)&&(zt.__proto__=Ft),((zt.prototype=Object.create(Ft&&Ft.prototype)).constructor=zt).prototype.ensureCapacity=function(){},zt.prototype.interfaces_=function(){return[Ft,Nt]},zt.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(t,arguments[1]),!0},zt.prototype.clear=function(){this.array_=[]},zt.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},zt.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},zt.prototype.iterator=function(){return new Gt(this)},zt.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},zt.prototype.isEmpty=function(){return 0===this.array_.length},zt.prototype.size=function(){return this.array_.length},zt.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},zt.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},zt),Gt=((At=Ot)&&(qt.__proto__=At),((qt.prototype=Object.create(At&&At.prototype)).constructor=qt).prototype.next=function(){if(this.position_===this.arrayList_.size())throw new i;return this.arrayList_.get(this.position_++)},qt.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},qt.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},qt.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},qt),Ut=function(v){function t(){if(v.call(this),0!==arguments.length)if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}v&&(t.__proto__=v),(t.prototype=Object.create(v&&v.prototype)).constructor=t;var e={coordArrayType:{configurable:!0}};return e.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(t){return this.get(t)},t.prototype.addAll=function(){if(2!==arguments.length)return v.prototype.addAll.apply(this,arguments);for(var t=arguments[1],e=!1,n=arguments[0].iterator();n.hasNext();)this.add(n.next(),t),e=!0;return e},t.prototype.clone=function(){for(var t=v.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(){if(1===arguments.length){var t=arguments[0];v.prototype.add.call(this,t)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var e=arguments[0],n=arguments[1];return this.add(e,n,!0),!0}if(arguments[0]instanceof S&&"boolean"==typeof arguments[1]){var i=arguments[0];if(!arguments[1]&&1<=this.size()&&this.get(this.size()-1).equals2D(i))return null;v.prototype.add.call(this,i)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1];return this.add(r,o),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var s=arguments[0],a=arguments[1];if(arguments[2])for(var u=0;u<s.length;u++)this.add(s[u],a);else for(var l=s.length-1;0<=l;l--)this.add(s[l],a);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof S){var h=arguments[0],c=arguments[1];if(!arguments[2]){var p=this.size();if(0<p){if(0<h&&this.get(h-1).equals2D(c))return null;if(h<p&&this.get(h).equals2D(c))return null}}v.prototype.add.call(this,h,c)}}else if(4===arguments.length){var f=arguments[0],d=arguments[1],g=arguments[2],y=arguments[3],_=1;y<g&&(_=-1);for(var m=g;m!==y;m+=_)this.add(f[m],d);return!0}},t.prototype.closeRing=function(){0<this.size()&&this.add(new S(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,e),t}(Bt),jt={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};function qt(t){At.call(this),this.arrayList_=t,this.position_=0}function zt(){Ft.call(this),this.array_=[],arguments[0]instanceof Nt&&this.addAll(arguments[0])}jt.ForwardComparator.get=function(){return Vt},jt.BidirectionalComparator.get=function(){return Yt},jt.coordArrayType.get=function(){return new Array(0).fill(null)},Dt.prototype.interfaces_=function(){return[]},Dt.prototype.getClass=function(){return Dt},Dt.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Dt.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Dt.indexOf(i,e)<0)return i}return null},Dt.scroll=function(t,e){var n=Dt.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);Y.arraycopy(t,n,i,0,t.length-n),Y.arraycopy(t,0,i,t.length-n,n),Y.arraycopy(i,0,t,0,t.length)},Dt.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},Dt.intersection=function(t,e){for(var n=new Ut,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Dt.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Dt.removeRepeatedPoints=function(t){return Dt.hasRepeatedPoints(t)?new Ut(t,!1).toCoordinateArray():t},Dt.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Dt.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Dt.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new S(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],u=0;u<a;u++)o[s+u]=new S(i[r+u])},Dt.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Dt.envelope=function(t){for(var e=new K,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Dt.toCoordinateArray=function(t){return t.toArray(Dt.coordArrayType)},Dt.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Dt.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Dt.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Dt.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Dt.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||0<e.compareTo(t[n]))&&(e=t[n]);return e},Dt.extract=function(t,e,n){e=k.clamp(e,0,t.length);var i=(n=k.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(Dt,jt);var Vt=function(){};Vt.prototype.compare=function(t,e){return Dt.compare(t,e)},Vt.prototype.interfaces_=function(){return[w]},Vt.prototype.getClass=function(){return Vt};var Yt=function(){};Yt.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Dt.compare(n,i);return Dt.isEqualReversed(n,i)?0:r},Yt.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Dt.increasingDirection(n),o=Dt.increasingDirection(i),s=0<r?0:n.length-1,a=0<o?0:n.length-1,u=0;u<n.length;u++){var l=n[s].compareTo(i[a]);if(0!==l)return l;s+=r,a+=o}return 0},Yt.prototype.interfaces_=function(){return[w]},Yt.prototype.getClass=function(){return Yt};function Ht(){}Ht.prototype.get=function(){},Ht.prototype.put=function(){},Ht.prototype.size=function(){},Ht.prototype.values=function(){},Ht.prototype.entrySet=function(){};var Xt,Jt=((Xt=Ht)&&(Wt.__proto__=Xt),(Wt.prototype=Object.create(Xt&&Xt.prototype)).constructor=Wt);function Wt(){Xt.apply(this,arguments)}(r.prototype=new Error).name="OperationNotSupported",(o.prototype=new Nt).contains=function(){};var Kt,Zt,Qt=((Zt=o)&&(ne.__proto__=Zt),((ne.prototype=Object.create(Zt&&Zt.prototype)).constructor=ne).prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},ne.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},ne.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},ne.prototype.remove=function(t){throw new Error},ne.prototype.size=function(){return this.array_.length},ne.prototype.isEmpty=function(){return 0===this.array_.length},ne.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},ne.prototype.iterator=function(){return new $t(this)},ne),$t=((Kt=Ot)&&(ee.__proto__=Kt),((ee.prototype=Object.create(Kt&&Kt.prototype)).constructor=ee).prototype.next=function(){if(this.position_===this.hashSet_.size())throw new i;return this.hashSet_.array_[this.position_++]},ee.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},ee.prototype.remove=function(){throw new r},ee),te=0;function ee(t){Kt.call(this),this.hashSet_=t,this.position_=0}function ne(){Zt.call(this),this.array_=[],arguments[0]instanceof Nt&&this.addAll(arguments[0])}(c.prototype=new Jt).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(0<n))return e.value;e=e.right}}return null},c.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:te,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(0<i)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:te,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},c.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===l(a(a(t)))){var e=h(a(a(t)));1===s(e)?(u(a(t),te),u(e,te),u(a(a(t)),1),t=a(a(t))):(t===h(a(t))&&(t=a(t),this.rotateLeft(t)),u(a(t),te),u(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=l(a(a(t)));1===s(n)?(u(a(t),te),u(n,te),u(a(a(t)),1),t=a(a(t))):(t===l(a(t))&&(t=a(t),this.rotateRight(t)),u(a(t),te),u(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=te},c.prototype.values=function(){var t=new Bt,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=c.successor(e));)t.add(e.value);return t},c.prototype.entrySet=function(){var t=new Qt,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=c.successor(e));)t.add(e);return t},c.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,(e.left=t).parent=e}},c.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,(e.right=t).parent=e}},c.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},c.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)n=(i=n).parent;return n},c.prototype.size=function(){return this.size_};function ie(){}ie.prototype.interfaces_=function(){return[]},ie.prototype.getClass=function(){return ie},p.prototype=new o,(f.prototype=new p).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},f.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},f.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},f.prototype.remove=function(t){throw new r},f.prototype.size=function(){return this.array_.length},f.prototype.isEmpty=function(){return 0===this.array_.length},f.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},f.prototype.iterator=function(){return new re(this)};var re=function(t){this.treeSet_=t,this.position_=0};re.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new i;return this.treeSet_.array_[this.position_++]},re.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},re.prototype.remove=function(){throw new r};function oe(){}oe.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},oe.asList=function(t){for(var e=new Bt,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};function se(){}var ae={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};ae.P.get=function(){return 0},ae.L.get=function(){return 1},ae.A.get=function(){return 2},ae.FALSE.get=function(){return-1},ae.TRUE.get=function(){return-2},ae.DONTCARE.get=function(){return-3},ae.SYM_FALSE.get=function(){return"F"},ae.SYM_TRUE.get=function(){return"T"},ae.SYM_DONTCARE.get=function(){return"*"},ae.SYM_P.get=function(){return"0"},ae.SYM_L.get=function(){return"1"},ae.SYM_A.get=function(){return"2"},se.prototype.interfaces_=function(){return[]},se.prototype.getClass=function(){return se},se.toDimensionSymbol=function(t){switch(t){case se.FALSE:return se.SYM_FALSE;case se.TRUE:return se.SYM_TRUE;case se.DONTCARE:return se.SYM_DONTCARE;case se.P:return se.SYM_P;case se.L:return se.SYM_L;case se.A:return se.SYM_A}throw new b("Unknown dimension value: "+t)},se.toDimensionValue=function(t){switch(F.toUpperCase(t)){case se.SYM_FALSE:return se.FALSE;case se.SYM_TRUE:return se.TRUE;case se.SYM_DONTCARE:return se.DONTCARE;case se.SYM_P:return se.P;case se.SYM_L:return se.L;case se.SYM_A:return se.A}throw new b("Unknown dimension symbol: "+t)},Object.defineProperties(se,ae);function ue(){}ue.prototype.filter=function(t){},ue.prototype.interfaces_=function(){return[]},ue.prototype.getClass=function(){return ue};function le(){}le.prototype.filter=function(t,e){},le.prototype.isDone=function(){},le.prototype.isGeometryChanged=function(){},le.prototype.interfaces_=function(){return[]},le.prototype.getClass=function(){return le};var he=function(r){function n(t,e){if(r.call(this,e),this._geometries=t||[],r.hasNullElements(this._geometries))throw new b("geometries must not contain null elements")}r&&(n.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((n.prototype=Object.create(r&&r.prototype)).constructor=n).prototype.computeEnvelopeInternal=function(){for(var t=new K,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},n.prototype.getGeometryN=function(t){return this._geometries[t]},n.prototype.getSortIndex=function(){return r.SORTINDEX_GEOMETRYCOLLECTION},n.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},n.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},n.prototype.equalsExact=function(){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._geometries.length!==n._geometries.length)return!1;for(var i=0;i<this._geometries.length;i++)if(!this._geometries[i].equalsExact(n._geometries[i],e))return!1;return!0},n.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();oe.sort(this._geometries)},n.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},n.prototype.getBoundaryDimension=function(){for(var t=se.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},n.prototype.getDimension=function(){for(var t=se.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},n.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},n.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},n.prototype.getNumGeometries=function(){return this._geometries.length},n.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},n.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new f(oe.asList(this._geometries)),n=new f(oe.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[1],r=arguments[0],o=this.getNumGeometries(),s=r.getNumGeometries(),a=0;a<o&&a<s;){var u=this.getGeometryN(a),l=r.getGeometryN(a),h=u.compareToSameClass(l,i);if(0!==h)return h;a++}return a<o?1:a<s?-1:0}},n.prototype.apply=function(){if(T(arguments[0],It))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(T(arguments[0],le)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(T(arguments[0],ue)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(T(arguments[0],vt)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},n.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),it.shouldNeverReachHere(),null},n.prototype.clone=function(){var t=r.prototype.clone.call(this);t._geometries=new Array(this._geometries.length).fill(null);for(var e=0;e<this._geometries.length;e++)t._geometries[e]=this._geometries[e].clone();return t},n.prototype.getGeometryType=function(){return"GeometryCollection"},n.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)},n.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},t.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(n,t),n}(bt),ce=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return bt.SORTINDEX_MULTILINESTRING},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getBoundaryDimension=function(){return this.isClosed()?se.FALSE:0},i.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},i.prototype.getDimension=function(){return 1},i.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},i.prototype.getBoundary=function(){return new pe(this).getBoundary()},i.prototype.getGeometryType=function(){return"MultiLineString"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[ie]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(i,t),i}(he),pe=function(t,e){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var n=t,i=Lt.MOD2_BOUNDARY_RULE;this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}else if(2===arguments.length){var r=t,o=e;this._geom=r,this._geomFact=r.getFactory(),this._bnRule=o}};pe.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},pe.prototype.getBoundary=function(){return this._geom instanceof me?this.boundaryLineString(this._geom):this._geom instanceof ce?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},pe.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},pe.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},pe.prototype.computeBoundaryCoordinates=function(t){var e=new Bt;this._endpointMap=new c;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Dt.toCoordinateArray(e)},pe.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new fe,this._endpointMap.put(t,e)),e.count++},pe.prototype.interfaces_=function(){return[]},pe.prototype.getClass=function(){return pe},pe.getBoundary=function(){return 1===arguments.length?new pe(arguments[0]).getBoundary():2===arguments.length?new pe(arguments[0],arguments[1]).getBoundary():void 0};var fe=function(){this.count=null};fe.prototype.interfaces_=function(){return[]},fe.prototype.getClass=function(){return fe};function de(){}var ge={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};de.prototype.interfaces_=function(){return[]},de.prototype.getClass=function(){return de},de.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},de.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[1],r="",o=new function(){}(new function(){}(de.getStackTrace(arguments[0]))),s=0;s<i;s++)try{r+=o.readLine()+de.NEWLINE}catch(t){if(!(t instanceof d))throw t;it.shouldNeverReachHere()}return r}},de.split=function(t,e){for(var n=e.length,i=new Bt,r=""+t,o=r.indexOf(e);0<=o;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}0<r.length&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a},de.toString=function(){if(1===arguments.length){var t=arguments[0];return de.SIMPLE_ORDINATE_FORMAT.format(t)}},de.spaces=function(t){return de.chars(" ",t)},ge.NEWLINE.get=function(){return Y.getProperty("line.separator")},ge.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(de,ge);function ye(){}ye.prototype.interfaces_=function(){return[]},ye.prototype.getClass=function(){return ye},ye.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},ye.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,q.X)===t.getOrdinate(e-1,q.X)&&t.getOrdinate(0,q.Y)===t.getOrdinate(e-1,q.Y)},ye.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||m.isNaN(s)&&m.isNaN(a)))return!1}return!0},ye.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(ye.copy(e,0,i,0,r),0<r)for(var o=r;o<n;o++)ye.copy(e,r-1,i,o,1);return i},ye.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)ye.swap(t,i,e-i)},ye.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},ye.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)ye.copyCoord(t,e+o,n,i+o)},ye.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new D;i.append("(");for(var r=0;r<e;r++){0<r&&i.append(" ");for(var o=0;o<n;o++)0<o&&i.append(","),i.append(de.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},ye.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?ye.createClosedRing(t,e,4):e.getOrdinate(0,q.X)===e.getOrdinate(n-1,q.X)&&e.getOrdinate(0,q.Y)===e.getOrdinate(n-1,q.Y)?e:ye.createClosedRing(t,e,n+1)},ye.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();ye.copy(e,0,i,0,r);for(var o=r;o<n;o++)ye.copy(e,0,i,o,1);return i};function _e(){}var me=function(r){function e(t,e){r.call(this,e),this._points=null,this.init(t)}r&&(e.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((e.prototype=Object.create(r&&r.prototype)).constructor=e).prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new K:this._points.expandEnvelope(new K)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return r.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t;if(this._points.size()!==n._points.size())return!1;for(var i=0;i<this._points.size();i++)if(!this.equal(this._points.getCoordinate(i),n._points.getCoordinate(i),e))return!1;return!0},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return 0<this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))&&ye.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?se.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return _t.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return ye.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(T(arguments[0],It))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(T(arguments[0],le)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else T(arguments[0],ue)?arguments[0].filter(this):T(arguments[0],vt)&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new pe(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var t=r.prototype.clone.call(this);return t._points=this._points.clone(),t},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new b("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[ie]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,t),e}(bt);_e.prototype.interfaces_=function(){return[]},_e.prototype.getClass=function(){return _e};function ve(){}var be=function(n){function t(t,e){n.call(this,e),this._coordinates=t||null,this.init(this._coordinates)}n&&(t.__proto__=n);var e={serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new K;var t=new K;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},t.prototype.getSortIndex=function(){return n.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&(!(!this.isEmpty()||!t.isEmpty())||this.isEmpty()===t.isEmpty()&&this.equal(t.getCoordinate(),this.getCoordinate(),e))},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return se.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},t.prototype.apply=function(){if(T(arguments[0],It)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(T(arguments[0],le)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else T(arguments[0],ue)?arguments[0].filter(this):T(arguments[0],vt)&&arguments[0].filter(this)},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var t=n.prototype.clone.call(this);return t._coordinates=this._coordinates.clone(),t},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return 0===this._coordinates.size()},t.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),it.isTrue(t.size()<=1),this._coordinates=t},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[_e]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(t,e),t}(bt);ve.prototype.interfaces_=function(){return[]},ve.prototype.getClass=function(){return ve};function xe(t){this._factory=t||null,this._isUserDataCopied=!1}var Ee=function(s){function i(t,e,n){if(s.call(this,n),this._shell=null,(this._holes=null)===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),s.hasNullElements(e))throw new b("holes must not contain null elements");if(t.isEmpty()&&s.hasNonEmptyElements(e))throw new b("shell is empty but holes are not");this._shell=t,this._holes=e}s&&(i.__proto__=s);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(s&&s.prototype)).constructor=i).prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},i.prototype.getSortIndex=function(){return s.SORTINDEX_POLYGON},i.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},i.prototype.getArea=function(){var t=0;t+=Math.abs(_t.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(_t.signedArea(this._holes[e].getCoordinateSequence()));return t},i.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var u=t.getX(a),l=t.getY(a);if(u!==o==(l!==s))return!1;o=u,s=l}return!0},i.prototype.equalsExact=function(){if(2!==arguments.length)return s.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;var n=t,i=this._shell,r=n._shell;if(!i.equalsExact(r,e))return!1;if(this._holes.length!==n._holes.length)return!1;for(var o=0;o<this._holes.length;o++)if(!this._holes[o].equalsExact(n._holes[o],e))return!1;return!0},i.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);oe.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);Y.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Dt.minCoordinate(e.getCoordinates());Dt.scroll(i,r),Y.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],_t.isCCW(e.getCoordinates())===n&&Dt.reverse(e.getCoordinates())}},i.prototype.getCoordinate=function(){return this._shell.getCoordinate()},i.prototype.getNumInteriorRing=function(){return this._holes.length},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},i.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},i.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},i.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},i.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[1],r=arguments[0],o=this._shell,s=r._shell,a=o.compareToSameClass(s,i);if(0!==a)return a;for(var u=this.getNumInteriorRing(),l=r.getNumInteriorRing(),h=0;h<u&&h<l;){var c=this.getInteriorRingN(h),p=r.getInteriorRingN(h),f=c.compareToSameClass(p,i);if(0!==f)return f;h++}return h<u?1:h<l?-1:0}},i.prototype.apply=function(t){if(T(t,It)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(T(t,le)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(T(t,ue))t.filter(this);else if(T(t,vt)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},i.prototype.clone=function(){var t=s.prototype.clone.call(this);t._shell=this._shell.clone(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].clone();return t},i.prototype.getGeometryType=function(){return"Polygon"},i.prototype.copy=function(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),n=0;n<e.length;n++)e[n]=this._holes[n].copy();return new i(t,e,this._factory)},i.prototype.getExteriorRing=function(){return this._shell},i.prototype.isEmpty=function(){return this._shell.isEmpty()},i.prototype.getInteriorRingN=function(t){return this._holes[t]},i.prototype.interfaces_=function(){return[ve]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(i,t),i}(bt),Ie=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return bt.SORTINDEX_MULTIPOINT},i.prototype.isValid=function(){return!0},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getCoordinate=function(){if(1!==arguments.length)return n.prototype.getCoordinate.apply(this,arguments);var t=arguments[0];return this._geometries[t].getCoordinate()},i.prototype.getBoundaryDimension=function(){return se.FALSE},i.prototype.getDimension=function(){return 0},i.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},i.prototype.getGeometryType=function(){return"MultiPoint"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[_e]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(i,t),i}(he),Le=function(n){function t(t,e){t instanceof S&&e instanceof je&&(t=e.getCoordinateSequenceFactory().create(t)),n.call(this,t,e),this.validateConstruction()}n&&(t.__proto__=n);var e={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.getSortIndex=function(){return bt.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return se.FALSE},t.prototype.isClosed=function(){return!!this.isEmpty()||n.prototype.isClosed.call(this)},t.prototype.reverse=function(){var t=this._points.copy();return ye.reverse(t),this.getFactory().createLinearRing(t)},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new b("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new b("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.MINIMUM_VALID_SIZE.get=function(){return 4},e.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,e),t}(me),we=function(n){function i(){n.apply(this,arguments)}n&&(i.__proto__=n);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(n&&n.prototype)).constructor=i).prototype.getSortIndex=function(){return bt.SORTINDEX_MULTIPOLYGON},i.prototype.equalsExact=function(){if(2!==arguments.length)return n.prototype.equalsExact.apply(this,arguments);var t=arguments[0],e=arguments[1];return!!this.isEquivalentClass(t)&&n.prototype.equalsExact.call(this,t,e)},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Bt,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},i.prototype.getGeometryType=function(){return"MultiPolygon"},i.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new i(t,this._factory)},i.prototype.interfaces_=function(){return[ve]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(i,t),i}(he),Se={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};xe.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},xe.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},xe.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof he?this.editGeometryCollection(t,e):t instanceof Ee?this.editPolygon(t,e):t instanceof be?e.edit(t,this._factory):t instanceof me?e.edit(t,this._factory):(it.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},xe.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new Bt,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===Ie?this._factory.createMultiPoint(i.toArray([])):n.getClass()===ce?this._factory.createMultiLineString(i.toArray([])):n.getClass()===we?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},xe.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new Bt,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},xe.prototype.interfaces_=function(){return[]},xe.prototype.getClass=function(){return xe},xe.GeometryEditorOperation=function(){},Se.NoOpGeometryOperation.get=function(){return Me},Se.CoordinateOperation.get=function(){return Ce},Se.CoordinateSequenceOperation.get=function(){return Pe},Object.defineProperties(xe,Se);var Me=function(){};Me.prototype.edit=function(t,e){return t},Me.prototype.interfaces_=function(){return[xe.GeometryEditorOperation]},Me.prototype.getClass=function(){return Me};var Ce=function(){};Ce.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof Le?e.createLinearRing(n):t instanceof me?e.createLineString(n):t instanceof be?0<n.length?e.createPoint(n[0]):e.createPoint():t},Ce.prototype.interfaces_=function(){return[xe.GeometryEditorOperation]},Ce.prototype.getClass=function(){return Ce};var Pe=function(){};Pe.prototype.edit=function(t,e){return t instanceof Le?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof me?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof be?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},Pe.prototype.interfaces_=function(){return[xe.GeometryEditorOperation]},Pe.prototype.getClass=function(){return Pe};function Ne(t,e){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(t instanceof Array)this._coordinates=t,this._dimension=3;else if(Number.isInteger(t)){var n=t;this._coordinates=new Array(n).fill(null);for(var i=0;i<n;i++)this._coordinates[i]=new S}else if(T(t,q)){var r=t;if(null===r)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._coordinates=new Array(r.size()).fill(null);for(var o=0;o<this._coordinates.length;o++)this._coordinates[o]=r.getCoordinateCopy(o)}}else if(2===arguments.length)if(t instanceof Array&&Number.isInteger(e)){var s=t,a=e;this._coordinates=s,this._dimension=a,null===s&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(t)&&Number.isInteger(e)){var u=t,l=e;this._coordinates=new Array(u).fill(null),this._dimension=l;for(var h=0;h<u;h++)this._coordinates[h]=new S}}var Oe={serialVersionUID:{configurable:!0}};Ne.prototype.setOrdinate=function(t,e,n){switch(e){case q.X:this._coordinates[t].x=n;break;case q.Y:this._coordinates[t].y=n;break;case q.Z:this._coordinates[t].z=n;break;default:throw new b("invalid ordinateIndex")}},Ne.prototype.size=function(){return this._coordinates.length},Ne.prototype.getOrdinate=function(t,e){switch(e){case q.X:return this._coordinates[t].x;case q.Y:return this._coordinates[t].y;case q.Z:return this._coordinates[t].z}return m.NaN},Ne.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},Ne.prototype.getCoordinateCopy=function(t){return new S(this._coordinates[t])},Ne.prototype.getDimension=function(){return this._dimension},Ne.prototype.getX=function(t){return this._coordinates[t].x},Ne.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Ne(t,this._dimension)},Ne.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Ne.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Ne(t,this._dimension)},Ne.prototype.toString=function(){if(0<this._coordinates.length){var t=new D(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Ne.prototype.getY=function(t){return this._coordinates[t].y},Ne.prototype.toCoordinateArray=function(){return this._coordinates},Ne.prototype.interfaces_=function(){return[q,e]},Ne.prototype.getClass=function(){return Ne},Oe.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Ne,Oe);function Te(){}var ke={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Te.prototype.readResolve=function(){return Te.instance()},Te.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new Ne(arguments[0]);if(T(arguments[0],q))return new Ne(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return 3<e&&(e=3),e<2?new Ne(t):new Ne(t,e)}},Te.prototype.interfaces_=function(){return[P,e]},Te.prototype.getClass=function(){return Te},Te.instance=function(){return Te.instanceObject},ke.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},ke.instanceObject.get=function(){return new Te},Object.defineProperties(Te,ke);function Re(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=Re.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Ge){var t=arguments[0];(this._modelType=t)===Re.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this._modelType=Re.FIXED,this.setScale(e)}else if(arguments[0]instanceof Re){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}}var De,Ae=((De=Ht)&&(Be.__proto__=De),((Be.prototype=Object.create(De&&De.prototype)).constructor=Be).prototype.get=function(t){return this.map_.get(t)||null},Be.prototype.put=function(t,e){return this.map_.set(t,e),e},Be.prototype.values=function(){for(var t=new Bt,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},Be.prototype.entrySet=function(){var e=new Qt;return this.map_.entries().forEach(function(t){return e.add(t)}),e},Be.prototype.size=function(){return this.map_.size()},Be),Fe={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};function Be(){De.call(this),this.map_=new Map}Re.prototype.equals=function(t){if(!(t instanceof Re))return!1;return this._modelType===t._modelType&&this._scale===t._scale},Re.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new A(n).compareTo(new A(i))},Re.prototype.getScale=function(){return this._scale},Re.prototype.isFloating=function(){return this._modelType===Re.FLOATING||this._modelType===Re.FLOATING_SINGLE},Re.prototype.getType=function(){return this._modelType},Re.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Re.FLOATING?t="Floating":this._modelType===Re.FLOATING_SINGLE?t="Floating-Single":this._modelType===Re.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},Re.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return m.isNaN(t)?t:this._modelType===Re.FLOATING_SINGLE?t:this._modelType===Re.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof S){var e=arguments[0];if(this._modelType===Re.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},Re.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Re.FLOATING?t=16:this._modelType===Re.FLOATING_SINGLE?t=6:this._modelType===Re.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},Re.prototype.setScale=function(t){this._scale=Math.abs(t)},Re.prototype.interfaces_=function(){return[e,I]},Re.prototype.getClass=function(){return Re},Re.mostPrecise=function(t,e){return 0<=t.compareTo(e)?t:e},Fe.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Fe.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Re,Fe);var Ge=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},Ue={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Ge.prototype.readResolve=function(){return Ge.nameToTypeMap.get(this._name)},Ge.prototype.toString=function(){return this._name},Ge.prototype.interfaces_=function(){return[e]},Ge.prototype.getClass=function(){return Ge},Ue.serialVersionUID.get=function(){return-552860263173159e4},Ue.nameToTypeMap.get=function(){return new Ae},Object.defineProperties(Ge,Ue),Re.Type=Ge,Re.FIXED=new Ge("FIXED"),Re.FLOATING=new Ge("FLOATING"),Re.FLOATING_SINGLE=new Ge("FLOATING SINGLE");var je=function t(){this._precisionModel=new Re,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?T(arguments[0],P)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Re&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},qe={serialVersionUID:{configurable:!0}};je.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new S(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new S(t.getMinX(),t.getMinY()),new S(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new S(t.getMinX(),t.getMinY()),new S(t.getMinX(),t.getMaxY()),new S(t.getMaxX(),t.getMaxY()),new S(t.getMaxX(),t.getMinY()),new S(t.getMinX(),t.getMinY())]),null)},je.prototype.createLineString=function(t){return t?t instanceof Array?new me(this.getCoordinateSequenceFactory().create(t),this):T(t,q)?new me(t,this):void 0:new me(this.getCoordinateSequenceFactory().create([]),this)},je.prototype.createMultiLineString=function(){return 0===arguments.length?new ce(null,this):1===arguments.length?new ce(arguments[0],this):void 0},je.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(je.toGeometryArray(t));var a=t.iterator().next();if(1<t.size()){if(a instanceof Ee)return this.createMultiPolygon(je.toPolygonArray(t));if(a instanceof me)return this.createMultiLineString(je.toLineStringArray(t));if(a instanceof be)return this.createMultiPoint(je.toPointArray(t));it.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},je.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},je.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(T(arguments[0],q))return new be(arguments[0],this)}},je.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},je.prototype.createPolygon=function(){if(0===arguments.length)return new Ee(null,null,this);if(1===arguments.length){if(T(arguments[0],q)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Le){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length){return new Ee(arguments[0],arguments[1],this)}},je.prototype.getSRID=function(){return this._SRID},je.prototype.createGeometryCollection=function(){return 0===arguments.length?new he(null,this):1===arguments.length?new he(arguments[0],this):void 0},je.prototype.createGeometry=function(t){return new xe(this).edit(t,{edit:function(t){if(2===arguments.length){var e=t;return this._coordinateSequenceFactory.create(e)}}})},je.prototype.getPrecisionModel=function(){return this._precisionModel},je.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(T(arguments[0],q))return new Le(arguments[0],this)}},je.prototype.createMultiPolygon=function(){return 0===arguments.length?new we(null,this):1===arguments.length?new we(arguments[0],this):void 0},je.prototype.createMultiPoint=function(){if(0===arguments.length)return new Ie(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new Ie(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(T(arguments[0],q)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());ye.copy(e,i,r,0,1),n[i]=this.createPoint(r)}return this.createMultiPoint(n)}}},je.prototype.interfaces_=function(){return[e]},je.prototype.getClass=function(){return je},je.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},je.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},je.getDefaultCoordinateSequenceFactory=function(){return Te.instance()},je.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},je.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},je.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},je.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},je.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},je.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},je.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},qe.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(je,qe);function ze(t){this.geometryFactory=t||new je}var Ve=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];ze.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!He[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==Ve.indexOf(n)?He[n].apply(this,[e.coordinates]):"GeometryCollection"===n?He[n].apply(this,[e.geometries]):He[n].apply(this,[e])},ze.prototype.write=function(t){var e=t.getGeometryType();if(!Xe[e])throw new Error("Geometry is not supported");return Xe[e].apply(this,[t])};function Ye(t){this.geometryFactory=t||new je,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new ze(this.geometryFactory)}var He={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!He[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=He.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new S(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new S(t[0],t[1]),new S(t[2],t[1]),new S(t[2],t[3]),new S(t[0],t[3]),new S(t[0],t[1])])},Point:function(t){var e=new S(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(He.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=He.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(He.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=He.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=He.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(He.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},Xe={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:Xe.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Xe.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(Xe.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Xe.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=Xe.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=Xe.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=Xe.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(Xe[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}};Ye.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Re.FIXED&&this.reducePrecision(e),e},Ye.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};function Je(){this.parser=new ze(this.geometryFactory)}Je.prototype.write=function(t){return this.parser.write(t)};function We(){}var Ke={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We},We.opposite=function(t){return t===We.LEFT?We.RIGHT:t===We.RIGHT?We.LEFT:t},Ke.ON.get=function(){return 0},Ke.LEFT.get=function(){return 1},Ke.RIGHT.get=function(){return 2},Object.defineProperties(We,Ke),(g.prototype=new Error).name="EmptyStackException",(y.prototype=new kt).add=function(t){return this.array_.push(t),!0},y.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},y.prototype.push=function(t){return this.array_.push(t),t},y.prototype.pop=function(t){if(0===this.array_.length)throw new g;return this.array_.pop()},y.prototype.peek=function(){if(0===this.array_.length)throw new g;return this.array_[this.array_.length-1]},y.prototype.empty=function(){return 0===this.array_.length},y.prototype.isEmpty=function(){return this.empty()},y.prototype.search=function(t){return this.array_.indexOf(t)},y.prototype.size=function(){return this.array_.length},y.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};function Ze(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}Ze.prototype.getCoordinate=function(){return this._minCoord},Ze.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Ze.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();it.isTrue(0<this._minIndex&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=_t.computeOrientation(this._minCoord,n,e),r=!1;e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===_t.COUNTERCLOCKWISE?r=!0:e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===_t.CLOCKWISE&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Ze.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=We.LEFT;return n[e].y<n[e+1].y&&(i=We.RIGHT),i},Ze.prototype.getEdge=function(){return this._orientedDe},Ze.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Ze.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ze.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}it.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===We.LEFT&&(this._orientedDe=this._minDe.getSym())},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze};function Qe(){this.array_=[]}var $e,tn=(($e=st)&&(en.__proto__=$e),((en.prototype=Object.create($e&&$e.prototype)).constructor=en).prototype.getCoordinate=function(){return this.pt},en.prototype.interfaces_=function(){return[]},en.prototype.getClass=function(){return en},en.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},en);function en(t,e){$e.call(this,en.msgWithCoord(t,e)),this.pt=e?new S(e):null,this.name="TopologyException"}Qe.prototype.addLast=function(t){this.array_.push(t)},Qe.prototype.removeFirst=function(){return this.array_.shift()},Qe.prototype.isEmpty=function(){return 0===this.array_.length};function nn(){this._finder=null,this._dirEdgeList=new Bt,this._nodes=new Bt,this._rightMostCoord=null,this._env=null,this._finder=new Ze}nn.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},nn.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},nn.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new tn("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},nn.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(We.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},nn.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},nn.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();1<=e.getDepth(We.RIGHT)&&e.getDepth(We.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},nn.prototype.computeDepths=function(t){var e=new Qt,n=new Qe,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},nn.prototype.compareTo=function(t){return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0},nn.prototype.getEnvelope=function(){if(null===this._env){for(var t=new K,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},nn.prototype.addReachable=function(t){var e=new y;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},nn.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(We.LEFT,t.getDepth(We.RIGHT)),e.setDepth(We.RIGHT,t.getDepth(We.LEFT))},nn.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},nn.prototype.getNodes=function(){return this._nodes},nn.prototype.getDirectedEdges=function(){return this._dirEdgeList},nn.prototype.interfaces_=function(){return[I]},nn.prototype.getClass=function(){return nn};function rn(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[We.ON]=e}else if(arguments[0]instanceof rn){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.init(3),this.location[We.ON]=r,this.location[We.LEFT]=o,this.location[We.RIGHT]=s}}rn.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},rn.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==N.NONE)return!1;return!0},rn.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===N.NONE&&(this.location[e]=t)},rn.prototype.isLine=function(){return 1===this.location.length},rn.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[We.ON]=this.location[We.ON],e[We.LEFT]=N.NONE,e[We.RIGHT]=N.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===N.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},rn.prototype.getLocations=function(){return this.location},rn.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[We.LEFT];this.location[We.LEFT]=this.location[We.RIGHT],this.location[We.RIGHT]=t},rn.prototype.toString=function(){var t=new D;return 1<this.location.length&&t.append(N.toLocationSymbol(this.location[We.LEFT])),t.append(N.toLocationSymbol(this.location[We.ON])),1<this.location.length&&t.append(N.toLocationSymbol(this.location[We.RIGHT])),t.toString()},rn.prototype.setLocations=function(t,e,n){this.location[We.ON]=t,this.location[We.LEFT]=e,this.location[We.RIGHT]=n},rn.prototype.get=function(t){return t<this.location.length?this.location[t]:N.NONE},rn.prototype.isArea=function(){return 1<this.location.length},rn.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===N.NONE)return!0;return!1},rn.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(We.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},rn.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(N.NONE)},rn.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},rn.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},rn.prototype.interfaces_=function(){return[]},rn.prototype.getClass=function(){return rn};function on(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new rn(t),this.elt[1]=new rn(t)}else if(arguments[0]instanceof on){var e=arguments[0];this.elt[0]=new rn(e.elt[0]),this.elt[1]=new rn(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new rn(N.NONE),this.elt[1]=new rn(N.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.elt[0]=new rn(r,o,s),this.elt[1]=new rn(r,o,s)}else if(4===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2],h=arguments[3];this.elt[0]=new rn(N.NONE,N.NONE,N.NONE),this.elt[1]=new rn(N.NONE,N.NONE,N.NONE),this.elt[a].setLocations(u,l,h)}}on.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},on.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},on.prototype.isNull=function(t){return this.elt[t].isNull()},on.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},on.prototype.isLine=function(t){return this.elt[t].isLine()},on.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new rn(t.elt[e]):this.elt[e].merge(t.elt[e])},on.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},on.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(We.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},on.prototype.toString=function(){var t=new D;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},on.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},on.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},on.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(We.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},on.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},on.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},on.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new rn(this.elt[t].location[0]))},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on},on.toLineLabel=function(t){for(var e=new on(N.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};function sn(t,e){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Bt,this._pts=new Bt,this._label=new on(N.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Bt,this._geometryFactory=null;var n=t,i=e;this._geometryFactory=i,this.computePoints(n),this.computeRing()}sn.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=_t.isCCW(this._ring.getCoordinates())},sn.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},sn.prototype.computePoints=function(t){var e=this._startDe=t,n=!0;do{if(null===e)throw new tn("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new tn("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();it.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},sn.prototype.getLinearRing=function(){return this._ring},sn.prototype.getCoordinate=function(t){return this._pts.get(t)},sn.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},sn.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;0<=a;a--)this._pts.add(i[a])}},sn.prototype.isHole=function(){return this._isHole},sn.prototype.setInResult=function(){for(var t=this._startDe;t.getEdge().setInResult(!0),(t=t.getNext())!==this._startDe;);},sn.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!_t.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},sn.prototype.addHole=function(t){this._holes.add(t)},sn.prototype.isShell=function(){return null===this._shell},sn.prototype.getLabel=function(){return this._label},sn.prototype.getEdges=function(){return this._edges},sn.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},sn.prototype.getShell=function(){return this._shell},sn.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,We.RIGHT);if(n===N.NONE)return null;if(this._label.getLocation(e)===N.NONE)return this._label.setLocation(e,n),null}},sn.prototype.setShell=function(t){null!==(this._shell=t)&&t.addHole(this)},sn.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},sn.prototype.interfaces_=function(){return[]},sn.prototype.getClass=function(){return sn};function an(t){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length){var e=t;this._label=e}}var un,ln,hn=((ln=sn)&&(fn.__proto__=ln),((fn.prototype=Object.create(ln&&ln.prototype)).constructor=fn).prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},fn.prototype.getNext=function(t){return t.getNextMin()},fn.prototype.interfaces_=function(){return[]},fn.prototype.getClass=function(){return fn},fn),cn=((un=sn)&&(pn.__proto__=un),((pn.prototype=Object.create(un&&un.prototype)).constructor=pn).prototype.buildMinimalRings=function(){var t=new Bt,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new hn(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},pn.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},pn.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){for(var t=this._startDe;t.getNode().getEdges().linkMinimalDirectedEdges(this),(t=t.getNext())!==this._startDe;);},pn.prototype.getNext=function(t){return t.getNext()},pn.prototype.interfaces_=function(){return[]},pn.prototype.getClass=function(){return pn},pn);function pn(){var t=arguments[0],e=arguments[1];un.call(this,t,e)}function fn(){var t=arguments[0],e=arguments[1];ln.call(this,t,e)}an.prototype.setVisited=function(t){this._isVisited=t},an.prototype.setInResult=function(t){this._isInResult=t},an.prototype.isCovered=function(){return this._isCovered},an.prototype.isCoveredSet=function(){return this._isCoveredSet},an.prototype.setLabel=function(t){this._label=t},an.prototype.getLabel=function(){return this._label},an.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},an.prototype.updateIM=function(t){it.isTrue(2<=this._label.getGeometryCount(),"found partial label"),this.computeIM(t)},an.prototype.isInResult=function(){return this._isInResult},an.prototype.isVisited=function(){return this._isVisited},an.prototype.interfaces_=function(){return[]},an.prototype.getClass=function(){return an};function dn(t){this.nodeMap=new c,this.nodeFact=null;var e=t;this.nodeFact=e}var gn,yn=((gn=an)&&(_n.__proto__=gn),((_n.prototype=Object.create(gn&&gn.prototype)).constructor=_n).prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},_n.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},_n.prototype.getCoordinate=function(){return this._coord},_n.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},_n.prototype.computeIM=function(t){},_n.prototype.computeMergedLocation=function(t,e){var n=N.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==N.BOUNDARY&&(n=i)}return n},_n.prototype.setLabel=function(){if(2!==arguments.length)return gn.prototype.setLabel.apply(this,arguments);var t=arguments[0],e=arguments[1];null===this._label?this._label=new on(t,e):this._label.setLocation(t,e)},_n.prototype.getEdges=function(){return this._edges},_n.prototype.mergeLabel=function(){if(arguments[0]instanceof _n){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof on)for(var e=arguments[0],n=0;n<2;n++){var i=this.computeMergedLocation(e,n);this._label.getLocation(n)===N.NONE&&this._label.setLocation(n,i)}},_n.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},_n.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=N.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case N.BOUNDARY:n=N.INTERIOR;break;case N.INTERIOR:default:n=N.BOUNDARY}this._label.setLocation(t,n)},_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n);function _n(){gn.call(this),this._coord=null,this._edges=null;var t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new on(0,N.NONE)}dn.prototype.find=function(t){return this.nodeMap.get(t)},dn.prototype.addNode=function(){if(arguments[0]instanceof S){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof yn){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},dn.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},dn.prototype.iterator=function(){return this.nodeMap.values().iterator()},dn.prototype.values=function(){return this.nodeMap.values()},dn.prototype.getBoundaryNodes=function(t){for(var e=new Bt,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===N.BOUNDARY&&e.add(i)}return e},dn.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},dn.prototype.interfaces_=function(){return[]},dn.prototype.getClass=function(){return dn};function mn(){}var vn={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};mn.prototype.interfaces_=function(){return[]},mn.prototype.getClass=function(){return mn},mn.isNorthern=function(t){return t===mn.NE||t===mn.NW},mn.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},mn.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(e<t?t:e)?3:n},mn.isInHalfPlane=function(t,e){return e===mn.SE?t===mn.SE||t===mn.SW:t===e||t===e+1},mn.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new b("Cannot compute the quadrant for point ( "+t+", "+e+" )");return 0<=t?0<=e?mn.NE:mn.SE:0<=e?mn.NW:mn.SW}if(arguments[0]instanceof S&&arguments[1]instanceof S){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new b("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?mn.NE:mn.SE:i.y>=n.y?mn.NW:mn.SW}},vn.NE.get=function(){return 0},vn.NW.get=function(){return 1},vn.SW.get=function(){return 2},vn.SE.get=function(){return 3},Object.defineProperties(mn,vn);function bn(t,e,n,i){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var r=t;this._edge=r}else if(3===arguments.length){var o=t,s=e,a=n;this._edge=o,this.init(s,a),this._label=null}else if(4===arguments.length){var u=t,l=e,h=n,c=i;this._edge=u,this.init(l,h),this._label=c}}bn.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:_t.computeOrientation(t._p0,t._p1,this._p1)},bn.prototype.getDy=function(){return this._dy},bn.prototype.getCoordinate=function(){return this._p0},bn.prototype.setNode=function(t){this._node=t},bn.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},bn.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},bn.prototype.getDirectedCoordinate=function(){return this._p1},bn.prototype.getDx=function(){return this._dx},bn.prototype.getLabel=function(){return this._label},bn.prototype.getEdge=function(){return this._edge},bn.prototype.getQuadrant=function(){return this._quadrant},bn.prototype.getNode=function(){return this._node},bn.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},bn.prototype.computeLabel=function(t){},bn.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=mn.quadrant(this._dx,this._dy),it.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},bn.prototype.interfaces_=function(){return[I]},bn.prototype.getClass=function(){return bn};function xn(){}var En,In=((En=bn)&&(Ln.__proto__=En),((Ln.prototype=Object.create(En&&En.prototype)).constructor=Ln).prototype.getNextMin=function(){return this._nextMin},Ln.prototype.getDepth=function(t){return this._depth[t]},Ln.prototype.setVisited=function(t){this._isVisited=t},Ln.prototype.computeDirectedLabel=function(){this._label=new on(this._edge.getLabel()),this._isForward||this._label.flip()},Ln.prototype.getNext=function(){return this._next},Ln.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new tn("assigned depths do not match",this.getCoordinate());this._depth[t]=e},Ln.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,We.LEFT)===N.INTERIOR&&this._label.getLocation(e,We.RIGHT)===N.INTERIOR||(t=!1);return t},Ln.prototype.setNextMin=function(t){this._nextMin=t},Ln.prototype.print=function(t){En.prototype.print.call(this,t),t.print(" "+this._depth[We.LEFT]+"/"+this._depth[We.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},Ln.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},Ln.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,N.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,N.EXTERIOR);return t&&e&&n},Ln.prototype.setEdgeRing=function(t){this._edgeRing=t},Ln.prototype.getMinEdgeRing=function(){return this._minEdgeRing},Ln.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},Ln.prototype.setInResult=function(t){this._isInResult=t},Ln.prototype.getSym=function(){return this._sym},Ln.prototype.isForward=function(){return this._isForward},Ln.prototype.getEdge=function(){return this._edge},Ln.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},Ln.prototype.setSym=function(t){this._sym=t},Ln.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},Ln.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===We.LEFT&&(i=-1);var r=We.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},Ln.prototype.getEdgeRing=function(){return this._edgeRing},Ln.prototype.isInResult=function(){return this._isInResult},Ln.prototype.setNext=function(t){this._next=t},Ln.prototype.isVisited=function(){return this._isVisited},Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.depthFactor=function(t,e){return t===N.EXTERIOR&&e===N.INTERIOR?1:t===N.INTERIOR&&e===N.EXTERIOR?-1:0},Ln);function Ln(){var t=arguments[0],e=arguments[1];if(En.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}xn.prototype.createNode=function(t){return new yn(t,null)},xn.prototype.interfaces_=function(){return[]},xn.prototype.getClass=function(){return xn};function wn(t){if(this._edges=new Bt,this._nodes=null,this._edgeEndList=new Bt,0===arguments.length)this._nodes=new dn(new xn);else if(1===arguments.length){var e=t;this._nodes=new dn(e)}}wn.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},wn.prototype.find=function(t){return this._nodes.find(t)},wn.prototype.addNode=function(){if(arguments[0]instanceof yn){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof S){var e=arguments[0];return this._nodes.addNode(e)}},wn.prototype.getNodeIterator=function(){return this._nodes.iterator()},wn.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},wn.prototype.debugPrintln=function(t){Y.out.println(t)},wn.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===N.BOUNDARY},wn.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},wn.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&_t.computeOrientation(t,e,i)===_t.COLLINEAR&&mn.quadrant(t,e)===mn.quadrant(n,i)},wn.prototype.getEdgeEnds=function(){return this._edgeEndList},wn.prototype.debugPrint=function(t){Y.out.print(t)},wn.prototype.getEdgeIterator=function(){return this._edges.iterator()},wn.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},wn.prototype.insertEdge=function(t){this._edges.add(t)},wn.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},wn.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new In(n,!0),r=new In(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},wn.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},wn.prototype.getNodes=function(){return this._nodes.values()},wn.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},wn.prototype.interfaces_=function(){return[]},wn.prototype.getClass=function(){return wn},wn.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};function Sn(t){this._geometryFactory=null,this._shellList=new Bt;var e=t;this._geometryFactory=e}Sn.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},Sn.prototype.computePolygons=function(t){for(var e=new Bt,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},Sn.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new tn("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},Sn.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new Bt,r=t.iterator();r.hasNext();){var o=r.next();if(2<o.getMaxNodeDegree()){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},Sn.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},Sn.prototype.buildMaximalEdgeRings=function(t){for(var e=new Bt,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new cn(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},Sn.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},Sn.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Sn.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),h=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var c=!1;h.contains(i)&&_t.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null===o||s.contains(h))&&(o=u)}return o},Sn.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return it.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Sn.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0];wn.linkResultDirectedEdges(arguments[1]);var n=this.buildMaximalEdgeRings(e),i=new Bt,r=this.buildMinimalEdgeRings(n,this._shellList,i);this.sortShellsAndHoles(r,this._shellList,i),this.placeFreeHoles(this._shellList,i)}},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn};function Mn(){}Mn.prototype.getBounds=function(){},Mn.prototype.interfaces_=function(){return[]},Mn.prototype.getClass=function(){return Mn};function Cn(t,e){this._bounds=null,this._item=null;var n=t,i=e;this._bounds=n,this._item=i}Cn.prototype.getItem=function(){return this._item},Cn.prototype.getBounds=function(){return this._bounds},Cn.prototype.interfaces_=function(){return[Mn,e]},Cn.prototype.getClass=function(){return Cn};function Pn(){this._size=null,this._items=null,this._size=0,this._items=new Bt,this._items.add(null)}Pn.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),--this._size,this.reorder(1),t},Pn.prototype.size=function(){return this._size},Pn.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Pn.prototype.clear=function(){this._size=0,this._items.clear()},Pn.prototype.isEmpty=function(){return 0===this._size},Pn.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Pn.prototype.interfaces_=function(){return[]},Pn.prototype.getClass=function(){return Pn};function Nn(){}Nn.prototype.visitItem=function(t){},Nn.prototype.interfaces_=function(){return[]},Nn.prototype.getClass=function(){return Nn};function On(){}On.prototype.insert=function(t,e){},On.prototype.remove=function(t,e){},On.prototype.query=function(){},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On};function Tn(t){if(this._childBoundables=new Bt,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length){var e=t;this._level=e}}var kn={serialVersionUID:{configurable:!0}};Tn.prototype.getLevel=function(){return this._level},Tn.prototype.size=function(){return this._childBoundables.size()},Tn.prototype.getChildBoundables=function(){return this._childBoundables},Tn.prototype.addChildBoundable=function(t){it.isTrue(null===this._bounds),this._childBoundables.add(t)},Tn.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Tn.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Tn.prototype.interfaces_=function(){return[Mn,e]},Tn.prototype.getClass=function(){return Tn},kn.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Tn,kn);function Rn(){}Rn.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Rn.min=function(t){return Rn.sort(t),t.get(0)},Rn.sort=function(t,e){var n=t.toArray();e?oe.sort(n,e):oe.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},Rn.singletonList=function(t){var e=new Bt;return e.add(t),e};function Dn(t,e,n){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var i=t,r=e,o=n;this._boundable1=i,this._boundable2=r,this._itemDistance=o,this._distance=this.distance()}Dn.prototype.expandToQueue=function(t,e){var n=Dn.isComposite(this._boundable1),i=Dn.isComposite(this._boundable2);if(n&&i)return Dn.area(this._boundable1)>Dn.area(this._boundable2)?this.expand(this._boundable1,this._boundable2,t,e):this.expand(this._boundable2,this._boundable1,t,e),null;if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new b("neither boundable is composite")},Dn.prototype.isLeaves=function(){return!(Dn.isComposite(this._boundable1)||Dn.isComposite(this._boundable2))},Dn.prototype.compareTo=function(t){return this._distance<t._distance?-1:this._distance>t._distance?1:0},Dn.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new Dn(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},Dn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},Dn.prototype.getDistance=function(){return this._distance},Dn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},Dn.prototype.interfaces_=function(){return[I]},Dn.prototype.getClass=function(){return Dn},Dn.area=function(t){return t.getBounds().getArea()},Dn.isComposite=function(t){return t instanceof Tn};function An(){if(this._root=null,this._built=!1,this._itemBoundables=new Bt,this._nodeCapacity=null,0===arguments.length){var t=An.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(1===arguments.length){var e=arguments[0];it.isTrue(1<e,"Node capacity must be greater than 1"),this._nodeCapacity=e}}var Fn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};An.prototype.getNodeCapacity=function(){return this._nodeCapacity},An.prototype.lastNode=function(t){return t.get(t.size()-1)},An.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Tn?t+=this.size(n):n instanceof Cn&&(t+=1)}return t}},An.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Cn&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},An.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new Bt:t}if(1===arguments.length){for(var e=arguments[0],n=new Bt,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof Tn){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Cn?n.add(r.getItem()):it.shouldNeverReachHere()}return n.size()<=0?null:n}},An.prototype.insert=function(t,e){it.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Cn(t,e))},An.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new Bt;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(it.isTrue(-2<n),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof Tn?this.boundablesAtLevel(n,s,r):(it.isTrue(s instanceof Cn),-1===n&&r.add(s))}return null}},An.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new Bt;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(T(arguments[2],Nn)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn)for(var r=arguments[0],o=arguments[2],s=arguments[1].getChildBoundables(),a=0;a<s.size();a++){var u=s.get(a);this.getIntersectsOp().intersects(u.getBounds(),r)&&(u instanceof Tn?this.query(r,u,o):u instanceof Cn?o.visitItem(u.getItem()):it.shouldNeverReachHere())}else if(T(arguments[2],kt)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn)for(var l=arguments[0],h=arguments[2],c=arguments[1].getChildBoundables(),p=0;p<c.size();p++){var f=c.get(p);this.getIntersectsOp().intersects(f.getBounds(),l)&&(f instanceof Tn?this.query(l,f,h):f instanceof Cn?h.add(f.getItem()):it.shouldNeverReachHere())}},An.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},An.prototype.getRoot=function(){return this.build(),this._root},An.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();if(this.getIntersectsOp().intersects(u.getBounds(),n)&&u instanceof Tn&&(o=this.remove(n,u,r))){s=u;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},An.prototype.createHigherLevels=function(t,e){it.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},An.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof Tn){var i=this.depth(n);t<i&&(t=i)}}return t+1}},An.prototype.createParentBoundables=function(t,e){it.isTrue(!t.isEmpty());var n=new Bt;n.add(this.createNode(e));var i=new Bt(t);Rn.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},An.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},An.prototype.interfaces_=function(){return[e]},An.prototype.getClass=function(){return An},An.compareDoubles=function(t,e){return e<t?1:t<e?-1:0},Fn.IntersectsOp.get=function(){return Gn},Fn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Fn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(An,Fn);function Bn(){}var Gn=function(){};Bn.prototype.distance=function(t,e){},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn};function Un(){}var jn,qn=function(l){function g(t){t=t||g.DEFAULT_NODE_CAPACITY,l.call(this,t)}l&&(g.__proto__=l);var t={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return((g.prototype=Object.create(l&&l.prototype)).constructor=g).prototype.createParentBoundablesFromVerticalSlices=function(t,e){it.isTrue(0<t.length);for(var n=new Bt,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},g.prototype.createNode=function(t){return new zn(t)},g.prototype.size=function(){return 0===arguments.length?l.prototype.size.call(this):l.prototype.size.apply(this,arguments)},g.prototype.insert=function(){if(2!==arguments.length)return l.prototype.insert.apply(this,arguments);var t=arguments[0],e=arguments[1];if(t.isNull())return null;l.prototype.insert.call(this,t,e)},g.prototype.getIntersectsOp=function(){return g.intersectsOp},g.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new Bt;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},g.prototype.query=function(){if(1===arguments.length){var t=arguments[0];return l.prototype.query.call(this,t)}if(2===arguments.length){var e=arguments[0],n=arguments[1];l.prototype.query.call(this,e,n)}else if(3===arguments.length)if(T(arguments[2],Nn)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn){var i=arguments[0],r=arguments[1],o=arguments[2];l.prototype.query.call(this,i,r,o)}else if(T(arguments[2],kt)&&arguments[0]instanceof Object&&arguments[1]instanceof Tn){var s=arguments[0],a=arguments[1],u=arguments[2];l.prototype.query.call(this,s,a,u)}},g.prototype.getComparator=function(){return g.yComparator},g.prototype.createParentBoundablesFromVerticalSlice=function(t,e){return l.prototype.createParentBoundables.call(this,t,e)},g.prototype.remove=function(){if(2!==arguments.length)return l.prototype.remove.apply(this,arguments);var t=arguments[0],e=arguments[1];return l.prototype.remove.call(this,t,e)},g.prototype.depth=function(){return 0===arguments.length?l.prototype.depth.call(this):l.prototype.depth.apply(this,arguments)},g.prototype.createParentBoundables=function(t,e){it.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new Bt(t);Rn.sort(i,g.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},g.prototype.nearestNeighbour=function(){if(1===arguments.length){if(T(arguments[0],Bn)){var t=arguments[0],e=new Dn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof Dn){var n=arguments[0];return this.nearestNeighbour(n,m.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof g&&T(arguments[1],Bn)){var i=arguments[0],r=arguments[1],o=new Dn(this.getRoot(),i.getRoot(),r);return this.nearestNeighbour(o)}if(arguments[0]instanceof Dn&&"number"==typeof arguments[1]){var s=arguments[0],a=arguments[1],u=null,l=new Pn;for(l.add(s);!l.isEmpty()&&0<a;){var h=l.poll(),c=h.getDistance();if(a<=c)break;h.isLeaves()?(a=c,u=h):h.expandToQueue(l,a)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var p=arguments[2],f=new Cn(arguments[0],arguments[1]),d=new Dn(this.getRoot(),f,p);return this.nearestNeighbour(d)[0]}},g.prototype.interfaces_=function(){return[On,e]},g.prototype.getClass=function(){return g},g.centreX=function(t){return g.avg(t.getMinX(),t.getMaxX())},g.avg=function(t,e){return(t+e)/2},g.centreY=function(t){return g.avg(t.getMinY(),t.getMaxY())},t.STRtreeNode.get=function(){return zn},t.serialVersionUID.get=function(){return 0x39920f7d5f261e0},t.xComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(t,e){return l.compareDoubles(g.centreX(t.getBounds()),g.centreX(e.getBounds()))}}},t.yComparator.get=function(){return{interfaces_:function(){return[w]},compare:function(t,e){return l.compareDoubles(g.centreY(t.getBounds()),g.centreY(e.getBounds()))}}},t.intersectsOp.get=function(){return{interfaces_:function(){return[l.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(g,t),g}(An),zn=((jn=Tn)&&(Vn.__proto__=jn),((Vn.prototype=Object.create(jn&&jn.prototype)).constructor=Vn).prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new K(n.getBounds()):t.expandToInclude(n.getBounds())}return t},Vn.prototype.interfaces_=function(){return[]},Vn.prototype.getClass=function(){return Vn},Vn);function Vn(){var t=arguments[0];jn.call(this,t)}Un.prototype.interfaces_=function(){return[]},Un.prototype.getClass=function(){return Un},Un.relativeSign=function(t,e){return t<e?-1:e<t?1:0},Un.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=Un.relativeSign(e.x,n.x),r=Un.relativeSign(e.y,n.y);switch(t){case 0:return Un.compareValue(i,r);case 1:return Un.compareValue(r,i);case 2:return Un.compareValue(r,-i);case 3:return Un.compareValue(-i,r);case 4:return Un.compareValue(-i,-r);case 5:return Un.compareValue(-r,-i);case 6:return Un.compareValue(-r,i);case 7:return Un.compareValue(i,-r)}return it.shouldNeverReachHere("invalid octant value"),0},Un.compareValue=function(t,e){return t<0?-1:0<t?1:e<0?-1:0<e?1:0};function Yn(t,e,n,i){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var r=t,o=e,s=n,a=i;this._segString=r,this.coord=new S(o),this.segmentIndex=s,this._segmentOctant=a,this._isInterior=!o.equals2D(r.getCoordinate(s))}Yn.prototype.getCoordinate=function(){return this.coord},Yn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},Yn.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:Un.compare(this._segmentOctant,this.coord,e.coord)},Yn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},Yn.prototype.isInterior=function(){return this._isInterior},Yn.prototype.interfaces_=function(){return[I]},Yn.prototype.getClass=function(){return Yn};function Hn(t){this._nodeMap=new c,this._edge=null;var e=t;this._edge=e}Hn.prototype.getSplitCoordinates=function(){var t=new Ut;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},Hn.prototype.addCollapsedNodes=function(){var t=new Bt;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},Hn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Hn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new A(e+1))}},Hn.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new S(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new S(e.coord))},Hn.prototype.iterator=function(){return this._nodeMap.values().iterator()},Hn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Hn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},Hn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new A(e[0])),i=r}},Hn.prototype.getEdge=function(){return this._edge},Hn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Hn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new S(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new S(e.coord)),new Kn(o,this._edge.getData())},Hn.prototype.add=function(t,e){var n=new Yn(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(it.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},Hn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new st("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new st("bad split edge end point at "+r)},Hn.prototype.interfaces_=function(){return[]},Hn.prototype.getClass=function(){return Hn};function Xn(){}Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn},Xn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new b("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return 0<=t?0<=e?i<=n?0:1:i<=n?7:6:0<=e?i<=n?3:2:i<=n?4:5}if(arguments[0]instanceof S&&arguments[1]instanceof S){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0==s&&0==a)throw new b("Cannot compute the octant for two identical points "+r);return Xn.octant(s,a)}};function Jn(){}Jn.prototype.getCoordinates=function(){},Jn.prototype.size=function(){},Jn.prototype.getCoordinate=function(t){},Jn.prototype.isClosed=function(){},Jn.prototype.setData=function(t){},Jn.prototype.getData=function(){},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};function Wn(){}Wn.prototype.addIntersection=function(t,e){},Wn.prototype.interfaces_=function(){return[Jn]},Wn.prototype.getClass=function(){return Wn};var Kn=function(t,e){this._nodeList=new Hn(this),this._pts=null,this._data=null;var n=t,i=e;this._pts=n,this._data=i};Kn.prototype.getCoordinates=function(){return this._pts},Kn.prototype.size=function(){return this._pts.length},Kn.prototype.getCoordinate=function(t){return this._pts[t]},Kn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Kn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},Kn.prototype.setData=function(t){this._data=t},Kn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:Xn.octant(t,e)},Kn.prototype.getData=function(){return this._data},Kn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],i=arguments[3],r=new S(arguments[0].getIntersection(i));this.addIntersection(r,n)}},Kn.prototype.toString=function(){return tt.toLineString(new Ne(this._pts))},Kn.prototype.getNodeList=function(){return this._nodeList},Kn.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},Kn.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},Kn.prototype.interfaces_=function(){return[Wn]},Kn.prototype.getClass=function(){return Kn},Kn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Bt;return Kn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();)i.next().getNodeList().addSplitEdges(n)};function Zn(t,e,n,i){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new S,this.p1=new S;else if(1===arguments.length){var r=t;this.p0=new S(r.p0),this.p1=new S(r.p1)}else if(2===arguments.length)this.p0=t,this.p1=e;else if(4===arguments.length){var o=t,s=e,a=n,u=i;this.p0=new S(o,s),this.p1=new S(a,u)}}var Qn={serialVersionUID:{configurable:!0}};Zn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Zn.prototype.orientationIndex=function(){if(arguments[0]instanceof Zn){var t=arguments[0],e=_t.orientationIndex(this.p0,this.p1,t.p0),n=_t.orientationIndex(this.p0,this.p1,t.p1);return 0<=e&&0<=n?Math.max(e,n):e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof S){var i=arguments[0];return _t.orientationIndex(this.p0,this.p1,i)}},Zn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},Zn.prototype.isVertical=function(){return this.p0.x===this.p1.x},Zn.prototype.equals=function(t){if(!(t instanceof Zn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},Zn.prototype.intersection=function(t){var e=new dt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},Zn.prototype.project=function(){if(arguments[0]instanceof S){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new S(t);var e=this.projectionFactor(t),n=new S;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof Zn){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(1<=r&&1<=o)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),1<r&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),1<o&&(a=this.p1),new Zn(s,a)}},Zn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Zn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Zn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},Zn.prototype.distancePerpendicular=function(t){return _t.distancePointLinePerpendicular(t,this.p0,this.p1)},Zn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Zn.prototype.midPoint=function(){return Zn.midPoint(this.p0,this.p1)},Zn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?m.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},Zn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=m.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var u=t.closestPoint(this.p1);return(r=u.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=u),n},Zn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return 0<e&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},Zn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Zn.prototype.getLength=function(){return this.p0.distance(this.p1)},Zn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},Zn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},Zn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},Zn.prototype.lineIntersection=function(t){try{return W.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof X))throw t}return null},Zn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Zn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,u=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,u=e*o/s}return new S(n-u,i+a)},Zn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},Zn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(1<e||m.isNaN(e))&&(e=1),e},Zn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Zn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Zn.prototype.distance=function(){if(arguments[0]instanceof Zn){var t=arguments[0];return _t.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof S){var e=arguments[0];return _t.distancePointLine(e,this.p0,this.p1)}},Zn.prototype.pointAlong=function(t){var e=new S;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},Zn.prototype.hashCode=function(){var t=m.doubleToLongBits(this.p0.x);t^=31*m.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=m.doubleToLongBits(this.p1.x);return n^=31*m.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},Zn.prototype.interfaces_=function(){return[I,e]},Zn.prototype.getClass=function(){return Zn},Zn.midPoint=function(t,e){return new S((t.x+e.x)/2,(t.y+e.y)/2)},Qn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Zn,Qn);function $n(){this.tempEnv1=new K,this.tempEnv2=new K,this._overlapSeg1=new Zn,this._overlapSeg2=new Zn}$n.prototype.overlap=function(){if(2!==arguments.length&&4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n};function ti(t,e,n,i){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var r=t,o=e,s=n,a=i;this._pts=r,this._start=o,this._end=s,this._context=a}ti.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},ti.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},ti.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},ti.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},ti.prototype.setId=function(t){this._id=t},ti.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},ti.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new K(t,e)}return this._env},ti.prototype.getEndIndex=function(){return this._end},ti.prototype.getStartIndex=function(){return this._start},ti.prototype.getContext=function(){return this._context},ti.prototype.getId=function(){return this._id},ti.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],u=n._pts[i],l=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(u,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var h=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);t<h&&(i<c&&this.computeOverlapsInternal(t,h,n,i,c,o),c<r&&this.computeOverlapsInternal(t,h,n,c,r,o)),h<e&&(i<c&&this.computeOverlapsInternal(h,e,n,i,c,o),c<r&&this.computeOverlapsInternal(h,e,n,c,r,o))},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti};function ei(){}ei.prototype.interfaces_=function(){return[]},ei.prototype.getClass=function(){return ei},ei.getChainStartIndices=function(t){var e=0,n=new Bt;n.add(new A(e));do{var i=ei.findChainEnd(t,e);n.add(new A(i)),e=i}while(e<t.length-1);return ei.toIntArray(n)},ei.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=mn.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||mn.quadrant(t[r-1],t[r])===i);)r++;return r-1},ei.getChains=function(){if(1===arguments.length)return ei.getChains(arguments[0],null);if(2===arguments.length){for(var t=arguments[0],e=arguments[1],n=new Bt,i=ei.getChainStartIndices(t),r=0;r<i.length-1;r++){var o=new ti(t,i[r],i[r+1],e);n.add(o)}return n}},ei.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};function ni(){}ni.prototype.computeNodes=function(t){},ni.prototype.getNodedSubstrings=function(){},ni.prototype.interfaces_=function(){return[]},ni.prototype.getClass=function(){return ni};function ii(t){if(this._segInt=null,0!==arguments.length&&1===arguments.length){var e=t;this.setSegmentIntersector(e)}}ii.prototype.setSegmentIntersector=function(t){this._segInt=t},ii.prototype.interfaces_=function(){return[ni]},ii.prototype.getClass=function(){return ii};function ri(){if(this._quadrantSegments=ri.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=ri.CAP_ROUND,this._joinStyle=ri.JOIN_ROUND,this._mitreLimit=ri.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=ri.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(o),this.setMitreLimit(s)}}var oi,si=function(e){function t(t){t?e.call(this,t):e.call(this),this._monoChains=new Bt,this._index=new qn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e);var n={SegmentOverlapAction:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return Kn.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(t){for(var e=ei.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},t.prototype.computeNodes=function(t){for(var e=(this._nodedSegStrings=t).iterator();e.hasNext();)this.add(e.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var t=new ai(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return ai},Object.defineProperties(t,n),t}(ii),ai=((oi=$n)&&(li.__proto__=oi),((li.prototype=Object.create(oi&&oi.prototype)).constructor=li).prototype.overlap=function(){if(4!==arguments.length)return oi.prototype.overlap.apply(this,arguments);var t=arguments[1],e=arguments[2],n=arguments[3],i=arguments[0].getContext(),r=e.getContext();this._si.processIntersections(i,t,r,n)},li.prototype.interfaces_=function(){return[]},li.prototype.getClass=function(){return li},li),ui={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};function li(){oi.call(this),this._si=null;var t=arguments[0];this._si=t}ri.prototype.getEndCapStyle=function(){return this._endCapStyle},ri.prototype.isSingleSided=function(){return this._isSingleSided},ri.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=ri.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=ri.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==ri.JOIN_ROUND&&(this._quadrantSegments=ri.DEFAULT_QUADRANT_SEGMENTS)},ri.prototype.getJoinStyle=function(){return this._joinStyle},ri.prototype.setJoinStyle=function(t){this._joinStyle=t},ri.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},ri.prototype.getSimplifyFactor=function(){return this._simplifyFactor},ri.prototype.getQuadrantSegments=function(){return this._quadrantSegments},ri.prototype.setEndCapStyle=function(t){this._endCapStyle=t},ri.prototype.getMitreLimit=function(){return this._mitreLimit},ri.prototype.setMitreLimit=function(t){this._mitreLimit=t},ri.prototype.setSingleSided=function(t){this._isSingleSided=t},ri.prototype.interfaces_=function(){return[]},ri.prototype.getClass=function(){return ri},ri.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},ui.CAP_ROUND.get=function(){return 1},ui.CAP_FLAT.get=function(){return 2},ui.CAP_SQUARE.get=function(){return 3},ui.JOIN_ROUND.get=function(){return 1},ui.JOIN_MITRE.get=function(){return 2},ui.JOIN_BEVEL.get=function(){return 3},ui.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},ui.DEFAULT_MITRE_LIMIT.get=function(){return 5},ui.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(ri,ui);function hi(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=_t.COUNTERCLOCKWISE,this._inputLine=t||null}var ci={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};hi.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)},hi.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=hi.DELETE,i=r=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},hi.prototype.isShallowConcavity=function(t,e,n,i){return _t.computeOrientation(t,e,n)===this._angleOrientation&&_t.distancePointLine(e,t,n)<i},hi.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/hi.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},hi.prototype.isConcave=function(t,e,n){return _t.computeOrientation(t,e,n)===this._angleOrientation},hi.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=_t.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);for(;this.deleteShallowConcavities(););return this.collapseLine()},hi.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===hi.DELETE;)e++;return e},hi.prototype.isShallow=function(t,e,n,i){return _t.distancePointLine(e,t,n)<i},hi.prototype.collapseLine=function(){for(var t=new Ut,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==hi.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},hi.prototype.interfaces_=function(){return[]},hi.prototype.getClass=function(){return hi},hi.simplify=function(t,e){return new hi(t).simplify(e)},ci.INIT.get=function(){return 0},ci.DELETE.get=function(){return 1},ci.KEEP.get=function(){return 1},ci.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(hi,ci);function pi(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Bt}var fi={COORDINATE_ARRAY_TYPE:{configurable:!0}};pi.prototype.getCoordinates=function(){return this._ptList.toArray(pi.COORDINATE_ARRAY_TYPE)},pi.prototype.setPrecisionModel=function(t){this._precisionModel=t},pi.prototype.addPt=function(t){var e=new S(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},pi.prototype.revere=function(){},pi.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;0<=i;i--)this.addPt(t[i])},pi.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},pi.prototype.toString=function(){return(new je).createLineString(this.getCoordinates()).toString()},pi.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new S(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},pi.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},pi.prototype.interfaces_=function(){return[]},pi.prototype.getClass=function(){return pi},fi.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(pi,fi);function di(){}var gi={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};di.prototype.interfaces_=function(){return[]},di.prototype.getClass=function(){return di},di.toDegrees=function(t){return 180*t/Math.PI},di.normalize=function(t){for(;t>Math.PI;)t-=di.PI_TIMES_2;for(;t<=-Math.PI;)t+=di.PI_TIMES_2;return t},di.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},di.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return 0<i*(n.x-e.x)+r*(n.y-e.y)},di.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},di.interiorAngle=function(t,e,n){var i=di.angle(e,t),r=di.angle(e,n);return Math.abs(r-i)},di.normalizePositive=function(t){if(t<0){for(;t<0;)t+=di.PI_TIMES_2;di.PI_TIMES_2<=t&&(t=0)}else{for(;di.PI_TIMES_2<=t;)t-=di.PI_TIMES_2;t<0&&(t=0)}return t},di.angleBetween=function(t,e,n){var i=di.angle(e,t),r=di.angle(e,n);return di.diff(i,r)},di.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},di.toRadians=function(t){return t*Math.PI/180},di.getTurn=function(t,e){var n=Math.sin(e-t);return 0<n?di.COUNTERCLOCKWISE:n<0?di.CLOCKWISE:di.NONE},di.angleBetweenOriented=function(t,e,n){var i=di.angle(e,t),r=di.angle(e,n)-i;return r<=-Math.PI?r+di.PI_TIMES_2:r>Math.PI?r-di.PI_TIMES_2:r},gi.PI_TIMES_2.get=function(){return 2*Math.PI},gi.PI_OVER_2.get=function(){return Math.PI/2},gi.PI_OVER_4.get=function(){return Math.PI/4},gi.COUNTERCLOCKWISE.get=function(){return _t.COUNTERCLOCKWISE},gi.CLOCKWISE.get=function(){return _t.CLOCKWISE},gi.NONE.get=function(){return _t.COLLINEAR},Object.defineProperties(di,gi);function yi(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Zn,this._seg1=new Zn,this._offset0=new Zn,this._offset1=new Zn,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new dt,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),8<=e.getQuadrantSegments()&&e.getJoinStyle()===ri.JOIN_ROUND&&(this._closingSegLengthFactor=yi.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}var _i={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};yi.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=_t.computeOrientation(this._s0,this._s1,this._s2),i=n===_t.CLOCKWISE&&this._side===We.LEFT||n===_t.COUNTERCLOCKWISE&&this._side===We.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},yi.prototype.addLineEndCap=function(t,e){var n=new Zn(t,e),i=new Zn;this.computeOffsetSegment(n,We.LEFT,this._distance,i);var r=new Zn;this.computeOffsetSegment(n,We.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case ri.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,_t.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case ri.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case ri.CAP_SQUARE:var u=new S;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var l=new S(i.p1.x+u.x,i.p1.y+u.y),h=new S(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(h)}},yi.prototype.getCoordinates=function(){return this._segList.getCoordinates()},yi.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=W.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof X))throw t;o=new S(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},yi.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),u=n.x-t.x,l=n.y-t.y,h=Math.atan2(l,u);i===_t.CLOCKWISE?a<=h&&(a+=2*Math.PI):h<=a&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,h,i,r),this._segList.addPt(n)},yi.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*yi.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===ri.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===ri.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},yi.prototype.createSquare=function(t){this._segList.addPt(new S(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new S(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new S(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new S(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},yi.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},yi.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},yi.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},yi.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},yi.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=di.angle(r,this._seg0.p0),s=di.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=di.normalize(o+s),u=di.normalize(a+Math.PI),l=i*n,h=n-l*Math.abs(Math.sin(s)),c=r.x+l*Math.cos(u),p=r.y+l*Math.sin(u),f=new S(c,p),d=new Zn(r,f),g=d.pointAlongOffset(1,h),y=d.pointAlongOffset(1,-h);this._side===We.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},yi.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===We.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),u=r*n*o/a,l=r*n*s/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},yi.prototype.addFilletArc=function(t,e,n,i,r){var o=i===_t.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var u=s/a,l=0,h=new S;l<s;){var c=e+o*l;h.x=t.x+r*Math.cos(c),h.y=t.y+r*Math.sin(c),this._segList.addPt(h),l+=u}},yi.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*yi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor){var n=new S((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new S((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},yi.prototype.createCircle=function(t){var e=new S(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},yi.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},yi.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new pi,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*yi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},yi.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===ri.JOIN_BEVEL||this._bufParams.getJoinStyle()===ri.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,_t.CLOCKWISE,this._distance))},yi.prototype.closeRing=function(){this._segList.closeRing()},yi.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi},_i.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},_i.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},_i.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},_i.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(yi,_i);function mi(t,e){this._distance=0,this._precisionModel=null,this._bufParams=null;var n=t,i=e;this._precisionModel=n,this._bufParams=i}mi.prototype.getOffsetCurve=function(t,e){if(0===(this._distance=e))return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Dt.reverse(o),o},mi.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=hi.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],We.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=hi.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],We.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment(),n.closeRing()},mi.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===We.RIGHT&&(i=-i);var r=hi.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},mi.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=hi.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],We.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=hi.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],We.LEFT);for(var u=a-2;0<=u;u--)e.addNextSegment(s[u],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},mi.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case ri.CAP_ROUND:e.createCircle(t);break;case ri.CAP_SQUARE:e.createSquare(t)}},mi.prototype.getLineCurve=function(t,e){if((this._distance=e)<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},mi.prototype.getBufferParameters=function(){return this._bufParams},mi.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},mi.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return mi.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},mi.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=hi.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],We.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{var a=hi.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],We.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment()},mi.prototype.getSegGen=function(t){return new yi(this._precisionModel,this._bufParams,t)},mi.prototype.interfaces_=function(){return[]},mi.prototype.getClass=function(){return mi},mi.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new S(t[n]);return e};function vi(t){this._subgraphs=null,this._seg=new Zn,this._cga=new _t;var e=t;this._subgraphs=e}var bi={DepthSegment:{configurable:!0}};vi.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new Bt,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(T(arguments[2],kt)&&arguments[0]instanceof S&&arguments[1]instanceof In){for(var o=arguments[0],s=arguments[1],a=arguments[2],u=s.getEdge().getCoordinates(),l=0;l<u.length-1;l++)if(this._seg.p0=u[l],this._seg.p1=u[l+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||_t.computeOrientation(this._seg.p0,this._seg.p1,o)===_t.RIGHT)){var h=s.getDepth(We.LEFT);this._seg.p0.equals(u[l])||(h=s.getDepth(We.RIGHT));var c=new xi(this._seg,h);a.add(c)}}else if(T(arguments[2],kt)&&arguments[0]instanceof S&&T(arguments[1],kt))for(var p=arguments[0],f=arguments[2],d=arguments[1].iterator();d.hasNext();){var g=d.next();g.isForward()&&this.findStabbedSegments(p,g,f)}},vi.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Rn.min(e)._leftDepth},vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi},bi.DepthSegment.get=function(){return xi},Object.defineProperties(vi,bi);var xi=function(t,e){this._upwardSeg=null,this._leftDepth=null;var n=t,i=e;this._upwardSeg=new Zn(n),this._leftDepth=i};xi.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},xi.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},xi.prototype.toString=function(){return this._upwardSeg.toString()},xi.prototype.interfaces_=function(){return[I]},xi.prototype.getClass=function(){return xi};function Ei(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null}Ei.prototype.area=function(){return Ei.area(this.p0,this.p1,this.p2)},Ei.prototype.signedArea=function(){return Ei.signedArea(this.p0,this.p1,this.p2)},Ei.prototype.interpolateZ=function(t){if(null===t)throw new b("Supplied point is null.");return Ei.interpolateZ(t,this.p0,this.p1,this.p2)},Ei.prototype.longestSideLength=function(){return Ei.longestSideLength(this.p0,this.p1,this.p2)},Ei.prototype.isAcute=function(){return Ei.isAcute(this.p0,this.p1,this.p2)},Ei.prototype.circumcentre=function(){return Ei.circumcentre(this.p0,this.p1,this.p2)},Ei.prototype.area3D=function(){return Ei.area3D(this.p0,this.p1,this.p2)},Ei.prototype.centroid=function(){return Ei.centroid(this.p0,this.p1,this.p2)},Ei.prototype.inCentre=function(){return Ei.inCentre(this.p0,this.p1,this.p2)},Ei.prototype.interfaces_=function(){return[]},Ei.prototype.getClass=function(){return Ei},Ei.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},Ei.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},Ei.det=function(t,e,n,i){return t*i-e*n},Ei.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,u=n.y-o,l=i.y-o,h=s*l-a*u,c=t.x-r,p=t.y-o,f=(l*c-a*p)/h,d=(-u*c+s*p)/h;return e.z+f*(n.z-e.z)+d*(i.z-e.z)},Ei.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return s<r&&(s=r),s<o&&(s=o),s},Ei.isAcute=function(t,e,n){return!!di.isAcute(t,e,n)&&!!di.isAcute(e,n,t)&&!!di.isAcute(n,t,e)},Ei.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,u=e.y-r,l=2*Ei.det(o,s,a,u),h=Ei.det(s,o*o+s*s,u,a*a+u*u),c=Ei.det(o,o*o+s*s,a,a*a+u*u);return new S(i-h/l,r+c/l)},Ei.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new W(t.x+n/2,t.y+i/2,1),o=new W(t.x-i+n/2,t.y+n+i/2,1);return new W(r,o)},Ei.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new S(t.x+r*o,t.y+r*s)},Ei.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-o*a,h=o*s-i*u,c=i*a-r*s,p=l*l+h*h+c*c;return Math.sqrt(p)/2},Ei.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new S(i,r)},Ei.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,u=(i*t.y+r*e.y+o*n.y)/s;return new S(a,u)};function Ii(t,e,n){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Bt;var i=t,r=e,o=n;this._inputGeom=i,this._distance=r,this._curveBuilder=o}Ii.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,N.EXTERIOR,N.INTERIOR)},Ii.prototype.addPolygon=function(t){var e=this._distance,n=We.LEFT;this._distance<0&&(e=-this._distance,n=We.RIGHT);var i=t.getExteriorRing(),r=Dt.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,N.EXTERIOR,N.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Dt.removeRepeatedPoints(s.getCoordinates());0<this._distance&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,We.opposite(n),N.INTERIOR,N.EXTERIOR)}},Ii.prototype.isTriangleErodedCompletely=function(t,e){var n=new Ei(t[0],t[1],t[2]),i=n.inCentre();return _t.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},Ii.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Dt.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,N.EXTERIOR,N.INTERIOR)},Ii.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new Kn(t,new on(0,N.BOUNDARY,e,n));this._curveList.add(i)},Ii.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Ii.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<Le.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=Le.MINIMUM_VALID_SIZE&&_t.isCCW(t)&&(o=r,s=i,n=We.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},Ii.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Ee?this.addPolygon(t):t instanceof me?this.addLineString(t):t instanceof be?this.addPoint(t):t instanceof Ie?this.addCollection(t):t instanceof ce?this.addCollection(t):t instanceof we?this.addCollection(t):t instanceof he&&this.addCollection(t)},Ii.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},Ii.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Ii.prototype.interfaces_=function(){return[]},Ii.prototype.getClass=function(){return Ii};function Li(){}Li.prototype.locate=function(t){},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li};function wi(t){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=t;this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()}wi.prototype.next=function(){if(this._atStart)return this._atStart=!1,wi.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new i;var t=this._parent.getGeometryN(this._index++);return t instanceof he?(this._subcollectionIterator=new wi(t),this._subcollectionIterator.next()):t},wi.prototype.remove=function(){throw new Error(this.getClass().getName())},wi.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},wi.prototype.interfaces_=function(){return[Ot]},wi.prototype.getClass=function(){return wi},wi.isAtomic=function(t){return!(t instanceof he)};function Si(t){this._geom=null;var e=t;this._geom=e}Si.prototype.locate=function(t){return Si.locate(t,this._geom)},Si.prototype.interfaces_=function(){return[Li]},Si.prototype.getClass=function(){return Si},Si.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&_t.isPointInRing(t,e.getCoordinates())},Si.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Si.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(Si.isPointInRing(t,r))return!1}return!0},Si.containsPoint=function(t,e){if(e instanceof Ee)return Si.containsPointInPolygon(t,e);if(e instanceof he)for(var n=new wi(e);n.hasNext();){var i=n.next();if(i!==e&&Si.containsPoint(t,i))return!0}return!1},Si.locate=function(t,e){return e.isEmpty()?N.EXTERIOR:Si.containsPoint(t,e)?N.INTERIOR:N.EXTERIOR};function Mi(){this._edgeMap=new c,this._edgeList=null,this._ptInAreaLocation=[N.NONE,N.NONE]}Mi.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Mi.prototype.propagateSideLabels=function(t){for(var e=N.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,We.LEFT)!==N.NONE&&(e=i.getLocation(t,We.LEFT))}if(e===N.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,We.ON)===N.NONE&&a.setLocation(t,We.ON,r),a.isArea(t)){var u=a.getLocation(t,We.LEFT),l=a.getLocation(t,We.RIGHT);if(l!==N.NONE){if(l!==r)throw new tn("side location conflict",s.getCoordinate());u===N.NONE&&it.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=u}else it.isTrue(a.getLocation(t,We.LEFT)===N.NONE,"found single null side"),a.setLocation(t,We.RIGHT,r),a.setLocation(t,We.LEFT,r)}}},Mi.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Mi.prototype.print=function(t){Y.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Mi.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Mi.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,We.LEFT);it.isTrue(i!==N.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();it.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,We.LEFT),u=s.getLocation(t,We.RIGHT);if(a===u)return!1;if(u!==r)return!1;r=a}return!0},Mi.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Mi.prototype.iterator=function(){return this.getEdges().iterator()},Mi.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Bt(this._edgeMap.values())),this._edgeList},Mi.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===N.NONE&&(this._ptInAreaLocation[t]=Si.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Mi.prototype.toString=function(){var t=new D;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Mi.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Mi.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===N.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var l=N.NONE;if(e[u])l=N.EXTERIOR;else{var h=s.getCoordinate();l=this.getLocation(u,h,t)}a.setAllLocationsIfNull(u,l)}},Mi.prototype.getDegree=function(){return this._edgeMap.size()},Mi.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Mi.prototype.interfaces_=function(){return[]},Mi.prototype.getClass=function(){return Mi};function Ci(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=Ci.orientation(t)}var Pi,Ni,Oi=((Ni=Mi)&&(Ri.__proto__=Ni),((Ri.prototype=Object.create(Ni&&Ni.prototype)).constructor=Ri).prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new tn("no outgoing dirEdge found",this.getCoordinate());it.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},Ri.prototype.insert=function(t){this.insertEdgeEnd(t,t)},Ri.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return mn.isNorthern(r)&&mn.isNorthern(o)?n:mn.isNorthern(r)||mn.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(it.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},Ri.prototype.print=function(t){Y.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},Ri.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Bt;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},Ri.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},Ri.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;0<=n;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},Ri.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(We.LEFT),i=t.getDepth(We.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new tn("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[1],s=arguments[2],a=arguments[0];a<o;a++){var u=this._edgeList.get(a);u.setEdgeDepths(We.RIGHT,s),s=u.getDepth(We.LEFT)}return s}},Ri.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},Ri.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;0<=r;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(it.isTrue(null!==e,"found null for first outgoing dirEdge"),it.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},Ri.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},Ri.prototype.getLabel=function(){return this._label},Ri.prototype.findCoveredLineEdges=function(){for(var t=N.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=N.INTERIOR;break}if(i.isInResult()){t=N.EXTERIOR;break}}}if(t===N.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===N.INTERIOR):(s.isInResult()&&(r=N.EXTERIOR),a.isInResult()&&(r=N.INTERIOR))}},Ri.prototype.computeLabelling=function(t){Ni.prototype.computeLabelling.call(this,t),this._label=new on(N.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),i=0;i<2;i++){var r=n.getLocation(i);r!==N.INTERIOR&&r!==N.BOUNDARY||this._label.setLocation(i,N.INTERIOR)}},Ri.prototype.interfaces_=function(){return[]},Ri.prototype.getClass=function(){return Ri},Ri),Ti=((Pi=xn)&&(ki.__proto__=Pi),((ki.prototype=Object.create(Pi&&Pi.prototype)).constructor=ki).prototype.createNode=function(t){return new yn(t,new Oi)},ki.prototype.interfaces_=function(){return[]},ki.prototype.getClass=function(){return ki},ki);function ki(){Pi.apply(this,arguments)}function Ri(){Ni.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}Ci.prototype.compareTo=function(t){return Ci.compareOriented(this._pts,this._orientation,t._pts,t._orientation)},Ci.prototype.interfaces_=function(){return[I]},Ci.prototype.getClass=function(){return Ci},Ci.orientation=function(t){return 1===Dt.increasingDirection(t)},Ci.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var h=t[u].compareTo(n[l]);if(0!==h)return h;var c=(u+=r)===s,p=(l+=o)===a;if(c&&!p)return-1;if(!c&&p)return 1;if(c&&p)return 0}};function Di(){this._edges=new Bt,this._ocaMap=new c}Di.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);0<e&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)0<r&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Di.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Di.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Di.prototype.iterator=function(){return this._edges.iterator()},Di.prototype.getEdges=function(){return this._edges},Di.prototype.get=function(t){return this._edges.get(t)},Di.prototype.findEqualEdge=function(t){var e=new Ci(t.getCoordinates());return this._ocaMap.get(e)},Di.prototype.add=function(t){this._edges.add(t);var e=new Ci(t.getCoordinates());this._ocaMap.put(e,t)},Di.prototype.interfaces_=function(){return[]},Di.prototype.getClass=function(){return Di};function Ai(){}Ai.prototype.processIntersections=function(t,e,n,i){},Ai.prototype.isDone=function(){},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai};function Fi(t){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=t;this._li=e}Fi.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Fi.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Fi.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Fi.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Fi.prototype.getLineIntersector=function(){return this._li},Fi.prototype.hasProperIntersection=function(){return this._hasProper},Fi.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Fi.prototype.hasIntersection=function(){return this._hasIntersection},Fi.prototype.isDone=function(){return!1},Fi.prototype.hasInteriorIntersection=function(){return this._hasInterior},Fi.prototype.interfaces_=function(){return[Ai]},Fi.prototype.getClass=function(){return Fi},Fi.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};function Bi(t,e,n){this.coord=null,this.segmentIndex=null,this.dist=null;var i=t,r=e,o=n;this.coord=new S(i),this.segmentIndex=r,this.dist=o}Bi.prototype.getSegmentIndex=function(){return this.segmentIndex},Bi.prototype.getCoordinate=function(){return this.coord},Bi.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Bi.prototype.compareTo=function(t){return this.compare(t.segmentIndex,t.dist)},Bi.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Bi.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Bi.prototype.getDistance=function(){return this.dist},Bi.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Bi.prototype.interfaces_=function(){return[I]},Bi.prototype.getClass=function(){return Bi};function Gi(t){this._nodeMap=new c,this.edge=null;var e=t;this.edge=e}Gi.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},Gi.prototype.iterator=function(){return this._nodeMap.values().iterator()},Gi.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Gi.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Gi.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=0<e.dist||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new S(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new Hi(o,new on(this.edge._label))},Gi.prototype.add=function(t,e,n){var i=new Bi(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Gi.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi};function Ui(){}Ui.prototype.getChainStartIndices=function(t){var e=0,n=new Bt;n.add(new A(e));do{var i=this.findChainEnd(t,e);n.add(new A(i)),e=i}while(e<t.length-1);return Ui.toIntArray(n)},Ui.prototype.findChainEnd=function(t,e){for(var n=mn.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&mn.quadrant(t[i-1],t[i])===n;)i++;return i-1},Ui.prototype.interfaces_=function(){return[]},Ui.prototype.getClass=function(){return Ui},Ui.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};function ji(t){this.e=null,this.pts=null,this.startIndex=null,this.env1=new K,this.env2=new K;var e=t;this.e=e,this.pts=e.getCoordinates();var n=new Ui;this.startIndex=n.getChainStartIndices(this.pts)}ji.prototype.getCoordinates=function(){return this.pts},ji.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return n<e?e:n},ji.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},ji.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4],l=arguments[5],h=this.pts[r],c=this.pts[o],p=s.pts[a],f=s.pts[u];if(o-r==1&&u-a==1)return l.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(h,c),this.env2.init(p,f),!this.env1.intersects(this.env2))return null;var d=Math.trunc((r+o)/2),g=Math.trunc((a+u)/2);r<d&&(a<g&&this.computeIntersectsForChain(r,d,s,a,g,l),g<u&&this.computeIntersectsForChain(r,d,s,g,u,l)),d<o&&(a<g&&this.computeIntersectsForChain(d,o,s,a,g,l),g<u&&this.computeIntersectsForChain(d,o,s,g,u,l))}},ji.prototype.getStartIndexes=function(){return this.startIndex},ji.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},ji.prototype.interfaces_=function(){return[]},ji.prototype.getClass=function(){return ji};function qi(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=qi.NULL_VALUE}var zi={NULL_VALUE:{configurable:!0}};qi.prototype.getDepth=function(t,e){return this._depth[t][e]},qi.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},qi.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==qi.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===qi.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===qi.NULL_VALUE}},qi.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},qi.prototype.getDelta=function(t){return this._depth[t][We.RIGHT]-this._depth[t][We.LEFT]},qi.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?N.EXTERIOR:N.INTERIOR},qi.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},qi.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==N.EXTERIOR&&i!==N.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=qi.depthAtLocation(i):this._depth[e][n]+=qi.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===N.INTERIOR&&this._depth[r][o]++}},qi.prototype.interfaces_=function(){return[]},qi.prototype.getClass=function(){return qi},qi.depthAtLocation=function(t){return t===N.EXTERIOR?0:t===N.INTERIOR?1:qi.NULL_VALUE},zi.NULL_VALUE.get=function(){return-1},Object.defineProperties(qi,zi);function Vi(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Di,this._bufParams=t||null}var Yi,Hi=((Yi=an)&&(Xi.__proto__=Yi),((Xi.prototype=Object.create(Yi&&Yi.prototype)).constructor=Xi).prototype.getDepth=function(){return this._depth},Xi.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new Xi(t,on.toLineLabel(this._label))},Xi.prototype.isIsolated=function(){return this._isIsolated},Xi.prototype.getCoordinates=function(){return this.pts},Xi.prototype.setIsolated=function(t){this._isIsolated=t},Xi.prototype.setName=function(t){this._name=t},Xi.prototype.equals=function(t){if(!(t instanceof Xi))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},Xi.prototype.getCoordinate=function(){if(0===arguments.length)return 0<this.pts.length?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},Xi.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},Xi.prototype.computeIM=function(t){Xi.updateIM(this._label,t)},Xi.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},Xi.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},Xi.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},Xi.prototype.getDepthDelta=function(){return this._depthDelta},Xi.prototype.getNumPoints=function(){return this.pts.length},Xi.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;0<=e;e--)t.print(this.pts[e]+" ");t.println("")},Xi.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new ji(this)),this._mce},Xi.prototype.getEnvelope=function(){if(null===this._env){this._env=new K;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},Xi.prototype.addIntersection=function(t,e,n,i){var r=new S(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(o=a,s=0)}this.eiList.add(r,o,s)},Xi.prototype.toString=function(){var t=new D;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},Xi.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},Xi.prototype.setDepthDelta=function(t){this._depthDelta=t},Xi.prototype.getEdgeIntersectionList=function(){return this.eiList},Xi.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi},Xi.updateIM=function(){if(2!==arguments.length)return Yi.prototype.updateIM.apply(this,arguments);var t=arguments[0],e=arguments[1];e.setAtLeastIfValid(t.getLocation(0,We.ON),t.getLocation(1,We.ON),1),t.isArea()&&(e.setAtLeastIfValid(t.getLocation(0,We.LEFT),t.getLocation(1,We.LEFT),2),e.setAtLeastIfValid(t.getLocation(0,We.RIGHT),t.getLocation(1,We.RIGHT),2))},Xi);function Xi(){if(Yi.call(this),this.pts=null,this._env=null,this.eiList=new Gi(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new qi,this._depthDelta=0,1===arguments.length)Xi.call(this,arguments[0],null);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.pts=t,this._label=e}}Vi.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},Vi.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new on(t.getLabel())).flip(),n.merge(i);var r=Vi.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(Vi.depthDelta(t.getLabel()))},Vi.prototype.buildSubgraphs=function(t,e){for(var n=new Bt,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new vi(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},Vi.prototype.createSubgraphs=function(t){for(var e=new Bt,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new nn;r.create(i),e.add(r)}}return Rn.sort(e,Rn.reverseOrder()),e},Vi.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Vi.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new si,n=new dt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Fi(n)),e},Vi.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new mi(n,this._bufParams),r=new Ii(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new wn(new Ti),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Sn(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},Vi.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new Hi(r.getCoordinates(),new on(s));this.insertUniqueEdge(a)}}},Vi.prototype.setNoder=function(t){this._workingNoder=t},Vi.prototype.interfaces_=function(){return[]},Vi.prototype.getClass=function(){return Vi},Vi.depthDelta=function(t){var e=t.getLocation(0,We.LEFT),n=t.getLocation(0,We.RIGHT);return e===N.INTERIOR&&n===N.EXTERIOR?1:e===N.EXTERIOR&&n===N.INTERIOR?-1:0},Vi.convertSegStrings=function(t){for(var e=new je,n=new Bt;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};function Ji(t,e,n,i){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var r=t,o=e;this._noder=r,this._scaleFactor=o,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var s=t,a=e,u=n,l=i;this._noder=s,this._scaleFactor=a,this._offsetX=u,this._offsetY=l,this._isScaled=!this.isIntegerPrecision()}}Ji.prototype.rescale=function(){if(T(arguments[0],Nt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&Y.out.println(n)}},Ji.prototype.scale=function(){if(T(arguments[0],Nt)){for(var t=arguments[0],e=new Bt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Kn(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new S(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return Dt.removeRepeatedPoints(o)}},Ji.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Ji.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Ji.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Ji.prototype.interfaces_=function(){return[ni]},Ji.prototype.getClass=function(){return Ji};function Wi(t){this._li=new dt,this._segStrings=null;var e=t;this._segStrings=e}var Ki={fact:{configurable:!0}};Wi.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new st("found endpt/interior pt intersection at index "+o+" :pt "+n)},Wi.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),u=0;u<s.length-1;u++)for(var l=0;l<a.length-1;l++)this.checkInteriorIntersections(r,u,o,l);else if(4===arguments.length){var h=arguments[0],c=arguments[1],p=arguments[2],f=arguments[3];if(h===p&&c===f)return null;var d=h.getCoordinates()[c],g=h.getCoordinates()[c+1],y=p.getCoordinates()[f],_=p.getCoordinates()[f+1];if(this._li.computeIntersection(d,g,y,_),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,d,g)||this.hasInteriorIntersection(this._li,y,_)))throw new st("found non-noded intersection at "+d+"-"+g+" and "+y+"-"+_)}},Wi.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Wi.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},Wi.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},Wi.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new st("found non-noded collapse at "+Wi.fact.createLineString([t,e,n]))},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi},Ki.fact.get=function(){return new je},Object.defineProperties(Wi,Ki);function Zi(t,e,n){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var i=t,r=e,o=n;if(this._originalPt=i,this._pt=i,this._scaleFactor=r,this._li=o,r<=0)throw new b("Scale factor must be non-zero");1!==r&&(this._pt=new S(this.scale(i.x),this.scale(i.y)),this._p0Scaled=new S,this._p1Scaled=new S),this.initCorners(this._pt)}var Qi={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Zi.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return it.isTrue(!(s&&a),"Found bad envelope test"),a},Zi.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new S(this._maxx,this._maxy),this._corner[1]=new S(this._minx,this._maxy),this._corner[2]=new S(this._minx,this._miny),this._corner[3]=new S(this._maxx,this._miny)},Zi.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Zi.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},Zi.prototype.getCoordinate=function(){return this._originalPt},Zi.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},Zi.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=Zi.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new K(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},Zi.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},Zi.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},Zi.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},Qi.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Zi,Qi);function $i(){this.tempEnv1=new K,this.selectedSegment=new Zn}$i.prototype.select=function(){if(1!==arguments.length&&2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},$i.prototype.interfaces_=function(){return[]},$i.prototype.getClass=function(){return $i};function tr(t){this._index=null;var e=t;this._index=e}var er={HotPixelSnapAction:{configurable:!0}};tr.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new rr(e,n,i);return this._index.query(r,{interfaces_:function(){return[Nn]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.HotPixelSnapAction.get=function(){return rr},Object.defineProperties(tr,er);function nr(t){this._li=null,this._interiorIntersections=null;var e=t;this._li=e,this._interiorIntersections=new Bt}var ir,rr=((ir=$i)&&(or.__proto__=ir),((or.prototype=Object.create(ir&&ir.prototype)).constructor=or).prototype.isNodeAdded=function(){return this._isNodeAdded},or.prototype.select=function(){if(2!==arguments.length)return ir.prototype.select.apply(this,arguments);var t=arguments[1],e=arguments[0].getContext();if(null!==this._parentEdge&&e===this._parentEdge&&t===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(e,t)},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},or);function or(){ir.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}nr.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},nr.prototype.isDone=function(){return!1},nr.prototype.getInteriorIntersections=function(){return this._interiorIntersections},nr.prototype.interfaces_=function(){return[Ai]},nr.prototype.getClass=function(){return nr};function sr(t){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=t;this._pm=e,this._li=new dt,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()}sr.prototype.checkCorrectness=function(t){var e=Kn.getNodedSubstrings(t),n=new Wi(e);try{n.checkValid()}catch(t){if(!(t instanceof V))throw t;t.printStackTrace()}},sr.prototype.getNodedSubstrings=function(){return Kn.getNodedSubstrings(this._nodedSegStrings)},sr.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},sr.prototype.findInteriorIntersections=function(t,e){var n=new nr(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},sr.prototype.computeVertexSnaps=function(){if(T(arguments[0],Nt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof Kn)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new Zi(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},sr.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new si,this._pointSnapper=new tr(this._noder.getIndex()),this.snapRound(t,this._li)},sr.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new Zi(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},sr.prototype.interfaces_=function(){return[ni]},sr.prototype.getClass=function(){return sr};function ar(t,e){if(this._argGeom=null,this._distance=null,this._bufParams=new ri,this._resultGeometry=null,this._saveException=null,1===arguments.length){var n=t;this._argGeom=n}else if(2===arguments.length){var i=t,r=e;this._argGeom=i,this._bufParams=r}}var ur={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};ar.prototype.bufferFixedPrecision=function(t){var e=new Ji(new sr(new Re(1)),t.getScale()),n=new Vi(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},ar.prototype.bufferReducedPrecision=function(){if(0===arguments.length){for(var t=ar.MAX_PRECISION_DIGITS;0<=t;t--){try{this.bufferReducedPrecision(t)}catch(t){if(!(t instanceof tn))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var e=arguments[0],n=ar.precisionScaleFactor(this._argGeom,this._distance,e),i=new Re(n);this.bufferFixedPrecision(i)}},ar.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Re.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},ar.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},ar.prototype.bufferOriginalPrecision=function(){try{var t=new Vi(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof st))throw t;this._saveException=t}},ar.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},ar.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},ar.prototype.interfaces_=function(){return[]},ar.prototype.getClass=function(){return ar},ar.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new ar(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof bt&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2],i=new ar(arguments[0]);return i.setQuadrantSegments(n),i.getResultGeometry(e)}if(arguments[2]instanceof ri&&arguments[0]instanceof bt&&"number"==typeof arguments[1]){var r=arguments[1];return new ar(arguments[0],arguments[2]).getResultGeometry(r)}}else if(4===arguments.length){var o=arguments[1],s=arguments[2],a=arguments[3],u=new ar(arguments[0]);return u.setQuadrantSegments(s),u.setEndCapStyle(a),u.getResultGeometry(o)}},ar.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=k.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(0<e?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},ur.CAP_ROUND.get=function(){return ri.CAP_ROUND},ur.CAP_BUTT.get=function(){return ri.CAP_FLAT},ur.CAP_FLAT.get=function(){return ri.CAP_FLAT},ur.CAP_SQUARE.get=function(){return ri.CAP_SQUARE},ur.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(ar,ur);function lr(){this._pt=[new S,new S],this._distance=m.NaN,this._isNull=!0}lr.prototype.getCoordinates=function(){return this._pt},lr.prototype.getCoordinate=function(t){return this._pt[t]},lr.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},lr.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},lr.prototype.getDistance=function(){return this._distance},lr.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},lr.prototype.interfaces_=function(){return[]},lr.prototype.getClass=function(){return lr};function hr(){}hr.prototype.interfaces_=function(){return[]},hr.prototype.getClass=function(){return hr},hr.computeDistance=function(){if(arguments[2]instanceof lr&&arguments[0]instanceof me&&arguments[1]instanceof S)for(var t=arguments[1],e=arguments[2],n=arguments[0].getCoordinates(),i=new Zn,r=0;r<n.length-1;r++){i.setCoordinates(n[r],n[r+1]);var o=i.closestPoint(t);e.setMinimum(o,t)}else if(arguments[2]instanceof lr&&arguments[0]instanceof Ee&&arguments[1]instanceof S){var s=arguments[0],a=arguments[1],u=arguments[2];hr.computeDistance(s.getExteriorRing(),a,u);for(var l=0;l<s.getNumInteriorRing();l++)hr.computeDistance(s.getInteriorRingN(l),a,u)}else if(arguments[2]instanceof lr&&arguments[0]instanceof bt&&arguments[1]instanceof S){var h=arguments[0],c=arguments[1],p=arguments[2];if(h instanceof me)hr.computeDistance(h,c,p);else if(h instanceof Ee)hr.computeDistance(h,c,p);else if(h instanceof he)for(var f=h,d=0;d<f.getNumGeometries();d++){var g=f.getGeometryN(d);hr.computeDistance(g,c,p)}else p.setMinimum(h.getCoordinate(),c)}else if(arguments[2]instanceof lr&&arguments[0]instanceof Zn&&arguments[1]instanceof S){var y=arguments[1],_=arguments[2],m=arguments[0].closestPoint(y);_.setMinimum(m,y)}};function cr(t){this._maxPtDist=new lr,this._inputGeom=t||null}var pr={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};cr.prototype.computeMaxMidpointDistance=function(t){var e=new dr(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},cr.prototype.computeMaxVertexDistance=function(t){var e=new fr(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},cr.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},cr.prototype.getDistancePoints=function(){return this._maxPtDist},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},pr.MaxPointDistanceFilter.get=function(){return fr},pr.MaxMidpointDistanceFilter.get=function(){return dr},Object.defineProperties(cr,pr);var fr=function(t){this._maxPtDist=new lr,this._minPtDist=new lr,this._geom=t||null};fr.prototype.filter=function(t){this._minPtDist.initialize(),hr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},fr.prototype.getMaxPointDistance=function(){return this._maxPtDist},fr.prototype.interfaces_=function(){return[It]},fr.prototype.getClass=function(){return fr};var dr=function(t){this._maxPtDist=new lr,this._minPtDist=new lr,this._geom=t||null};dr.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new S((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),hr.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},dr.prototype.isDone=function(){return!1},dr.prototype.isGeometryChanged=function(){return!1},dr.prototype.getMaxPointDistance=function(){return this._maxPtDist},dr.prototype.interfaces_=function(){return[le]},dr.prototype.getClass=function(){return dr};function gr(t){this._comps=t||null}gr.prototype.filter=function(t){t instanceof Ee&&this._comps.add(t)},gr.prototype.interfaces_=function(){return[ue]},gr.prototype.getClass=function(){return gr},gr.getPolygons=function(){if(1===arguments.length)return gr.getPolygons(arguments[0],new Bt);if(2===arguments.length){var t=arguments[0],e=arguments[1];return t instanceof Ee?e.add(t):t instanceof he&&t.apply(new gr(e)),e}};function yr(t,e){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var n=t;this._lines=n}else if(2===arguments.length){var i=t,r=e;this._lines=i,this._isForcedToLineString=r}}yr.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof Le){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof me&&this._lines.add(t)},yr.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},yr.prototype.interfaces_=function(){return[vt]},yr.prototype.getClass=function(){return yr},yr.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(yr.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(yr.getLines(e,n))}},yr.getLines=function(){if(1===arguments.length)return yr.getLines(arguments[0],!1);if(2===arguments.length){if(T(arguments[0],Nt)&&T(arguments[1],Nt)){for(var t=arguments[1],e=arguments[0].iterator();e.hasNext();){var n=e.next();yr.getLines(n,t)}return t}if(arguments[0]instanceof bt&&"boolean"==typeof arguments[1]){var i=arguments[0],r=arguments[1],o=new Bt;return i.apply(new yr(o,r)),o}if(arguments[0]instanceof bt&&T(arguments[1],Nt)){var s=arguments[0],a=arguments[1];return s instanceof me?a.add(s):s.apply(new yr(a)),a}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&T(arguments[0],Nt)&&T(arguments[1],Nt)){for(var u=arguments[1],l=arguments[2],h=arguments[0].iterator();h.hasNext();){var c=h.next();yr.getLines(c,u,l)}return u}if("boolean"==typeof arguments[2]&&arguments[0]instanceof bt&&T(arguments[1],Nt)){var p=arguments[1],f=arguments[2];return arguments[0].apply(new yr(p,f)),p}}};function _r(t){if(this._boundaryRule=Lt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var e=t;if(null===e)throw new b("Rule must be non-null");this._boundaryRule=e}}_r.prototype.locateInternal=function(){if(arguments[0]instanceof S&&arguments[1]instanceof Ee){var t=arguments[0],e=arguments[1];if(e.isEmpty())return N.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===N.EXTERIOR)return N.EXTERIOR;if(i===N.BOUNDARY)return N.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===N.INTERIOR)return N.EXTERIOR;if(s===N.BOUNDARY)return N.BOUNDARY}return N.INTERIOR}if(arguments[0]instanceof S&&arguments[1]instanceof me){var a=arguments[0],u=arguments[1];if(!u.getEnvelopeInternal().intersects(a))return N.EXTERIOR;var l=u.getCoordinates();return u.isClosed()||!a.equals(l[0])&&!a.equals(l[l.length-1])?_t.isOnLine(a,l)?N.INTERIOR:N.EXTERIOR:N.BOUNDARY}if(arguments[0]instanceof S&&arguments[1]instanceof be){var h=arguments[0];return arguments[1].getCoordinate().equals2D(h)?N.INTERIOR:N.EXTERIOR}},_r.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?_t.locatePointInRing(t,e.getCoordinates()):N.EXTERIOR},_r.prototype.intersects=function(t,e){return this.locate(t,e)!==N.EXTERIOR},_r.prototype.updateLocationInfo=function(t){t===N.INTERIOR&&(this._isIn=!0),t===N.BOUNDARY&&this._numBoundaries++},_r.prototype.computeLocation=function(t,e){if(e instanceof be&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof me)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Ee)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof ce)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof we)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof he)for(var u=new wi(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}},_r.prototype.locate=function(t,e){return e.isEmpty()?N.EXTERIOR:e instanceof me?this.locateInternal(t,e):e instanceof Ee?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?N.BOUNDARY:0<this._numBoundaries||this._isIn?N.INTERIOR:N.EXTERIOR)},_r.prototype.interfaces_=function(){return[]},_r.prototype.getClass=function(){return _r};function mr(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)mr.call(this,arguments[0],mr.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];this._component=t,this._segIndex=e,this._pt=n}}var vr={INSIDE_AREA:{configurable:!0}};mr.prototype.isInsideArea=function(){return this._segIndex===mr.INSIDE_AREA},mr.prototype.getCoordinate=function(){return this._pt},mr.prototype.getGeometryComponent=function(){return this._component},mr.prototype.getSegmentIndex=function(){return this._segIndex},mr.prototype.interfaces_=function(){return[]},mr.prototype.getClass=function(){return mr},vr.INSIDE_AREA.get=function(){return-1},Object.defineProperties(mr,vr);function br(t){this._pts=t||null}br.prototype.filter=function(t){t instanceof be&&this._pts.add(t)},br.prototype.interfaces_=function(){return[ue]},br.prototype.getClass=function(){return br},br.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof be?Rn.singletonList(t):br.getPoints(t,new Bt)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof be?n.add(e):e instanceof he&&e.apply(new br(n)),n}};function xr(t){this._locations=null;var e=t;this._locations=e}xr.prototype.filter=function(t){(t instanceof be||t instanceof me||t instanceof Ee)&&this._locations.add(new mr(t,0,t.getCoordinate()))},xr.prototype.interfaces_=function(){return[ue]},xr.prototype.getClass=function(){return xr},xr.getLocations=function(t){var e=new Bt;return t.apply(new xr(e)),e};function Er(t,e,n){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new _r,this._minDistanceLocation=null,this._minDistance=m.MAX_VALUE,2===arguments.length){var i=t,r=e;this._geom=[i,r],this._terminateDistance=0}else if(3===arguments.length){var o=t,s=e,a=n;this._geom=new Array(2).fill(null),this._geom[0]=o,this._geom[1]=s,this._terminateDistance=a}}Er.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=gr.getPolygons(this._geom[e]);if(0<r.size()){var o=xr.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&T(arguments[0],kt)&&T(arguments[1],kt)){for(var s=arguments[0],a=arguments[1],u=arguments[2],l=0;l<s.size();l++)for(var h=s.get(l),c=0;c<a.size();c++)if(this.computeContainmentDistance(h,a.get(c),u),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof mr&&arguments[1]instanceof Ee){var p=arguments[0],f=arguments[1],d=arguments[2],g=p.getCoordinate();if(N.EXTERIOR!==this._ptLocator.locate(g,f))return d[this._minDistance=0]=p,d[1]=new mr(f,g),null}},Er.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Er.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=yr.getLines(this._geom[0]),n=yr.getLines(this._geom[1]),i=br.getPoints(this._geom[0]),r=br.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Er.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Er.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Er.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Er.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof me&&arguments[1]instanceof be){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=_t.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new Zn(i[o],i[o+1]).closestPoint(r);n[0]=new mr(t,o,a),n[1]=new mr(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof me&&arguments[1]instanceof me){var u=arguments[0],l=arguments[1],h=arguments[2];if(u.getEnvelopeInternal().distance(l.getEnvelopeInternal())>this._minDistance)return null;for(var c=u.getCoordinates(),p=l.getCoordinates(),f=0;f<c.length-1;f++)for(var d=0;d<p.length-1;d++){var g=_t.distanceLineLine(c[f],c[f+1],p[d],p[d+1]);if(g<this._minDistance){this._minDistance=g;var y=new Zn(c[f],c[f+1]),_=new Zn(p[d],p[d+1]),m=y.closestPoints(_);h[0]=new mr(u,f,m[0]),h[1]=new mr(l,d,m[1])}if(this._minDistance<=this._terminateDistance)return null}}},Er.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new mr(r,0,r.getCoordinate()),n[1]=new mr(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Er.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new b("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Er.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Er.prototype.interfaces_=function(){return[]},Er.prototype.getClass=function(){return Er},Er.distance=function(t,e){return new Er(t,e).distance()},Er.isWithinDistance=function(t,e,n){return new Er(t,e,n).distance()<=n},Er.nearestPoints=function(t,e){return new Er(t,e).nearestPoints()};function Ir(){this._pt=[new S,new S],this._distance=m.NaN,this._isNull=!0}Ir.prototype.getCoordinates=function(){return this._pt},Ir.prototype.getCoordinate=function(t){return this._pt[t]},Ir.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Ir.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Ir.prototype.toString=function(){return tt.toLineString(this._pt[0],this._pt[1])},Ir.prototype.getDistance=function(){return this._distance},Ir.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir};function Lr(){}Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.computeDistance=function(){if(arguments[2]instanceof Ir&&arguments[0]instanceof me&&arguments[1]instanceof S)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new Zn,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Ir&&arguments[0]instanceof Ee&&arguments[1]instanceof S){var a=arguments[0],u=arguments[1],l=arguments[2];Lr.computeDistance(a.getExteriorRing(),u,l);for(var h=0;h<a.getNumInteriorRing();h++)Lr.computeDistance(a.getInteriorRingN(h),u,l)}else if(arguments[2]instanceof Ir&&arguments[0]instanceof bt&&arguments[1]instanceof S){var c=arguments[0],p=arguments[1],f=arguments[2];if(c instanceof me)Lr.computeDistance(c,p,f);else if(c instanceof Ee)Lr.computeDistance(c,p,f);else if(c instanceof he)for(var d=c,g=0;g<d.getNumGeometries();g++){var y=d.getGeometryN(g);Lr.computeDistance(y,p,f)}else f.setMinimum(c.getCoordinate(),p)}else if(arguments[2]instanceof Ir&&arguments[0]instanceof Zn&&arguments[1]instanceof S){var _=arguments[1],m=arguments[2],v=arguments[0].closestPoint(_);m.setMinimum(v,_)}};function wr(t,e){this._g0=null,this._g1=null,this._ptDist=new Ir,this._densifyFrac=0;var n=t,i=e;this._g0=n,this._g1=i}var Sr={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};wr.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},wr.prototype.setDensifyFraction=function(t){if(1<t||t<=0)throw new b("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},wr.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},wr.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},wr.prototype.computeOrientedDistance=function(t,e,n){var i=new Mr(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),0<this._densifyFrac){var r=new Cr(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},wr.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},wr.prototype.interfaces_=function(){return[]},wr.prototype.getClass=function(){return wr},wr.distance=function(){if(2===arguments.length)return new wr(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new wr(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},Sr.MaxPointDistanceFilter.get=function(){return Mr},Sr.MaxDensifiedByFractionDistanceFilter.get=function(){return Cr},Object.defineProperties(wr,Sr);var Mr=function(t){this._maxPtDist=new Ir,this._minPtDist=new Ir,this._euclideanDist=new Lr,this._geom=null;var e=t;this._geom=e};Mr.prototype.filter=function(t){this._minPtDist.initialize(),Lr.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Mr.prototype.getMaxPointDistance=function(){return this._maxPtDist},Mr.prototype.interfaces_=function(){return[It]},Mr.prototype.getClass=function(){return Mr};var Cr=function(t,e){this._maxPtDist=new Ir,this._minPtDist=new Ir,this._geom=null,this._numSubSegs=0;var n=t,i=e;this._geom=n,this._numSubSegs=Math.trunc(Math.round(1/i))};Cr.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,u=n.y+s*o,l=new S(a,u);this._minPtDist.initialize(),Lr.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Cr.prototype.isDone=function(){return!1},Cr.prototype.isGeometryChanged=function(){return!1},Cr.prototype.getMaxPointDistance=function(){return this._maxPtDist},Cr.prototype.interfaces_=function(){return[le]},Cr.prototype.getClass=function(){return Cr};function Pr(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null}var Nr={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Pr.prototype.checkMaximumDistance=function(t,e,n){var i=new wr(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+tt.toLineString(r[0],r[1])+")"}},Pr.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Pr.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(0<this._bufDistance?this.checkPositiveValid():this.checkNegativeValid(),Pr.VERBOSE&&Y.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Pr.prototype.checkNegativeValid=function(){if(!(this._input instanceof Ee||this._input instanceof we||this._input instanceof he))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Pr.prototype.getErrorIndicator=function(){return this._errorIndicator},Pr.prototype.checkMinimumDistance=function(t,e,n){var i=new Er(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+tt.toLineString(r[0],r[1])+" )"}},Pr.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Pr.prototype.getErrorLocation=function(){return this._errorLocation},Pr.prototype.getPolygonLines=function(t){for(var e=new Bt,n=new yr(e),i=gr.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},Pr.prototype.getErrorMessage=function(){return this._errMsg},Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr},Nr.VERBOSE.get=function(){return!1},Nr.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Pr,Nr);function Or(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null}var Tr={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Or.prototype.isValid=function(){return this.checkPolygonal(),this._isValid&&(this.checkExpectedEmpty(),this._isValid&&(this.checkEnvelope(),this._isValid&&(this.checkArea(),this._isValid&&this.checkDistance()))),this._isValid},Or.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Or.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new K(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new K(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Or.prototype.checkDistance=function(){var t=new Pr(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Or.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();0<this._distance&&e<t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Or.prototype.checkPolygonal=function(){this._result instanceof Ee||this._result instanceof we||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Or.prototype.getErrorIndicator=function(){return this._errorIndicator},Or.prototype.getErrorLocation=function(){return this._errorLocation},Or.prototype.checkExpectedEmpty=function(){return 2<=this._input.getDimension()?null:0<this._distance?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Or.prototype.report=function(t){if(!Or.VERBOSE)return null;Y.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Or.prototype.getErrorMessage=function(){return this._errorMsg},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or},Or.isValidMsg=function(t,e,n){var i=new Or(t,e,n);return i.isValid()?null:i.getErrorMessage()},Or.isValid=function(t,e,n){return!!new Or(t,e,n).isValid()},Tr.VERBOSE.get=function(){return!1},Tr.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Or,Tr);function kr(t,e){this._pts=null,this._data=null;var n=t,i=e;this._pts=n,this._data=i}kr.prototype.getCoordinates=function(){return this._pts},kr.prototype.size=function(){return this._pts.length},kr.prototype.getCoordinate=function(t){return this._pts[t]},kr.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},kr.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:Xn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},kr.prototype.setData=function(t){this._data=t},kr.prototype.getData=function(){return this._data},kr.prototype.toString=function(){return tt.toLineString(new Ne(this._pts))},kr.prototype.interfaces_=function(){return[Jn]},kr.prototype.getClass=function(){return kr};function Rr(t){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Bt,this._intersectionCount=0,this._keepIntersections=!0;var e=t;this._li=e,this._interiorIntersection=null}Rr.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Rr.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Rr.prototype.getIntersectionSegments=function(){return this._intSegments},Rr.prototype.count=function(){return this._intersectionCount},Rr.prototype.getIntersections=function(){return this._intersections},Rr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Rr.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Rr.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Rr.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Rr.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Rr.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Rr.prototype.interfaces_=function(){return[Ai]},Rr.prototype.getClass=function(){return Rr},Rr.createAllIntersectionsFinder=function(t){var e=new Rr(t);return e.setFindAllIntersections(!0),e},Rr.createAnyIntersectionFinder=function(t){return new Rr(t)},Rr.createIntersectionCounter=function(t){var e=new Rr(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};function Dr(t){this._li=new dt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var e=t;this._segStrings=e}Dr.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Dr.prototype.getIntersections=function(){return this._segInt.getIntersections()},Dr.prototype.isValid=function(){return this.execute(),this._isValid},Dr.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Dr.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Rr(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new si;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Dr.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new tn(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Dr.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+tt.toLineString(t[0],t[1])+" and "+tt.toLineString(t[2],t[3])},Dr.prototype.interfaces_=function(){return[]},Dr.prototype.getClass=function(){return Dr},Dr.computeIntersections=function(t){var e=new Dr(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};function Ar(){this._nv=null;var t=arguments[0];this._nv=new Dr(Ar.toSegmentStrings(t))}Ar.prototype.checkValid=function(){this._nv.checkValid()},Ar.prototype.interfaces_=function(){return[]},Ar.prototype.getClass=function(){return Ar},Ar.toSegmentStrings=function(t){for(var e=new Bt,n=t.iterator();n.hasNext();){var i=n.next();e.add(new kr(i.getCoordinates(),i))}return e},Ar.checkValid=function(t){new Ar(t).checkValid()};function Fr(t){this._mapOp=t}Fr.prototype.map=function(t){for(var e=new Bt,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(je.toGeometryArray(e))},Fr.prototype.interfaces_=function(){return[]},Fr.prototype.getClass=function(){return Fr},Fr.map=function(t,e){return new Fr(e).map(t)};function Br(t,e,n){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Bt,this._resultLineList=new Bt;var i=t,r=e,o=n;this._op=i,this._geometryFactory=r,this._ptLocator=o}Br.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Br.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Br.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Br.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!No.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Br.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Br.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Br.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},Br.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(it.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(No.isResultOfOp(i,e)&&e===No.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Br.prototype.interfaces_=function(){return[]},Br.prototype.getClass=function(){return Br};function Gr(t,e){this._op=null,this._geometryFactory=null,this._resultPointList=new Bt;var n=t,i=e;this._op=n,this._geometryFactory=i}Gr.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Gr.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==No.INTERSECTION)){var i=n.getLabel();No.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Gr.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Gr.prototype.interfaces_=function(){return[]},Gr.prototype.getClass=function(){return Gr};function Ur(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}Ur.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Ur.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof Le&&!i.isEmpty()||(n=!1);for(var r=new Bt,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof Le||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new Bt;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},Ur.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Ur.prototype.getInputGeometry=function(){return this._inputGeom},Ur.prototype.transformMultiLineString=function(t,e){for(var n=new Bt,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Ur.prototype.transformCoordinates=function(t,e){return this.copy(t)},Ur.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Ur.prototype.transformMultiPoint=function(t,e){for(var n=new Bt,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Ur.prototype.transformMultiPolygon=function(t,e){for(var n=new Bt,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Ur.prototype.copy=function(t){return t.copy()},Ur.prototype.transformGeometryCollection=function(t,e){for(var n=new Bt,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(je.toGeometryArray(n)):this._factory.buildGeometry(n)},Ur.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof be)return this.transformPoint(t,null);if(t instanceof Ie)return this.transformMultiPoint(t,null);if(t instanceof Le)return this.transformLinearRing(t,null);if(t instanceof me)return this.transformLineString(t,null);if(t instanceof ce)return this.transformMultiLineString(t,null);if(t instanceof Ee)return this.transformPolygon(t,null);if(t instanceof we)return this.transformMultiPolygon(t,null);if(t instanceof he)return this.transformGeometryCollection(t,null);throw new b("Unknown Geometry subtype: "+t.getClass().getName())},Ur.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return 0<i&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Ur.prototype.interfaces_=function(){return[]},Ur.prototype.getClass=function(){return Ur};function jr(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Zn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof me&&"number"==typeof arguments[1]){var t=arguments[1];jr.call(this,arguments[0].getCoordinates(),t)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this._srcPts=e,this._isClosed=jr.isClosed(e),this._snapTolerance=n}}jr.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new S(o)),0===i&&this._isClosed&&t.set(t.size()-1,new S(o)))}},jr.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},jr.prototype.snapTo=function(t){var e=new Ut(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},jr.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);0<=o&&t.add(o+1,new S(r),!1)}},jr.prototype.findSegmentIndexToSnap=function(t,e){for(var n=m.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},jr.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},jr.prototype.interfaces_=function(){return[]},jr.prototype.getClass=function(){return jr},jr.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};function qr(t){this._srcGeom=t||null}var zr={SNAP_PRECISION_FACTOR:{configurable:!0}};qr.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Hr(e,n).transform(this._srcGeom)},qr.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new Hr(t,n,!0).transform(this._srcGeom),r=i;return e&&T(r,ve)&&(r=i.buffer(0)),r},qr.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},qr.prototype.extractTargetCoordinates=function(t){for(var e=new f,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},qr.prototype.computeMinimumSegmentLength=function(t){for(var e=m.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},qr.prototype.interfaces_=function(){return[]},qr.prototype.getClass=function(){return qr},qr.snap=function(t,e,n){var i=new Array(2).fill(null),r=new qr(t);i[0]=r.snapTo(e,n);var o=new qr(e);return i[1]=o.snapTo(i[0],n),i},qr.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=qr.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===Re.FIXED){var i=1/n.getScale()*2/1.415;e<i&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(qr.computeOverlaySnapTolerance(r),qr.computeOverlaySnapTolerance(o))}},qr.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*qr.SNAP_PRECISION_FACTOR},qr.snapToSelf=function(t,e,n){return new qr(t).snapToSelf(e,n)},zr.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(qr,zr);function Vr(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null}var Yr,Hr=((Yr=Ur)&&(Xr.__proto__=Yr),((Xr.prototype=Object.create(Yr&&Yr.prototype)).constructor=Xr).prototype.snapLine=function(t,e){var n=new jr(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},Xr.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},Xr.prototype.interfaces_=function(){return[]},Xr.prototype.getClass=function(){return Xr},Xr);function Xr(t,e,n){Yr.call(this),this._snapTolerance=t||null,this._snapPts=e||null,this._isSelfSnap=void 0!==n&&n}Vr.prototype.getCommon=function(){return m.longBitsToDouble(this._commonBits)},Vr.prototype.add=function(t){var e=m.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Vr.signExpBits(this._commonBits),this._isFirst=!1,null):Vr.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Vr.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Vr.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Vr.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=m.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+m.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},Vr.prototype.interfaces_=function(){return[]},Vr.prototype.getClass=function(){return Vr},Vr.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Vr.signExpBits=function(t){return t>>52},Vr.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Vr.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;0<=i;i--){if(Vr.getBit(t,i)!==Vr.getBit(e,i))return n;n++}return 52};function Jr(){this._commonCoord=null,this._ccFilter=new Kr}var Wr={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Jr.prototype.addCommonBits=function(t){var e=new Zr(this._commonCoord);t.apply(e),t.geometryChanged()},Jr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new S(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new Zr(e);return t.apply(n),t.geometryChanged(),t},Jr.prototype.getCommonCoordinate=function(){return this._commonCoord},Jr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Jr.prototype.interfaces_=function(){return[]},Jr.prototype.getClass=function(){return Jr},Wr.CommonCoordinateFilter.get=function(){return Kr},Wr.Translater.get=function(){return Zr},Object.defineProperties(Jr,Wr);var Kr=function(){this._commonBitsX=new Vr,this._commonBitsY=new Vr};Kr.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},Kr.prototype.getCommonCoordinate=function(){return new S(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Kr.prototype.interfaces_=function(){return[It]},Kr.prototype.getClass=function(){return Kr};var Zr=function(t){this.trans=null;var e=t;this.trans=e};Zr.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},Zr.prototype.isDone=function(){return!1},Zr.prototype.isGeometryChanged=function(){return!0},Zr.prototype.interfaces_=function(){return[le]},Zr.prototype.getClass=function(){return Zr};function Qr(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()}Qr.prototype.selfSnap=function(t){return new qr(t).snapTo(t,this._snapTolerance)},Qr.prototype.removeCommonBits=function(t){this._cbr=new Jr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},Qr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},Qr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=No.overlayOp(e[0],e[1],t);return this.prepareResult(n)},Qr.prototype.checkValid=function(t){t.isValid()||Y.out.println("Snapped geometry is invalid")},Qr.prototype.computeSnapTolerance=function(){this._snapTolerance=qr.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Qr.prototype.snap=function(t){var e=this.removeCommonBits(t);return qr.snap(e[0],e[1],this._snapTolerance)},Qr.prototype.interfaces_=function(){return[]},Qr.prototype.getClass=function(){return Qr},Qr.overlayOp=function(t,e,n){return new Qr(t,e).getResultGeometry(n)},Qr.union=function(t,e){return Qr.overlayOp(t,e,No.UNION)},Qr.intersection=function(t,e){return Qr.overlayOp(t,e,No.INTERSECTION)},Qr.symDifference=function(t,e){return Qr.overlayOp(t,e,No.SYMDIFFERENCE)},Qr.difference=function(t,e){return Qr.overlayOp(t,e,No.DIFFERENCE)};function $r(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e}$r.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=No.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof st))throw t;i=t}if(!n)try{e=Qr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof st?i:t}return e},$r.prototype.interfaces_=function(){return[]},$r.prototype.getClass=function(){return $r},$r.overlayOp=function(t,e,n){return new $r(t,e).getResultGeometry(n)},$r.union=function(t,e){return $r.overlayOp(t,e,No.UNION)},$r.intersection=function(t,e){return $r.overlayOp(t,e,No.INTERSECTION)},$r.symDifference=function(t,e){return $r.overlayOp(t,e,No.SYMDIFFERENCE)},$r.difference=function(t,e){return $r.overlayOp(t,e,No.DIFFERENCE)};function to(t,e){this.mce=null,this.chainIndex=null;var n=t,i=e;this.mce=n,this.chainIndex=i}to.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},to.prototype.interfaces_=function(){return[]},to.prototype.getClass=function(){return to};function eo(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this._eventType=eo.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._eventType=eo.INSERT,this._label=n,this._xValue=i,this._obj=r}}var no={INSERT:{configurable:!0},DELETE:{configurable:!0}};eo.prototype.isDelete=function(){return this._eventType===eo.DELETE},eo.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},eo.prototype.getObject=function(){return this._obj},eo.prototype.compareTo=function(t){return this._xValue<t._xValue?-1:this._xValue>t._xValue?1:this._eventType<t._eventType?-1:this._eventType>t._eventType?1:0},eo.prototype.getInsertEvent=function(){return this._insertEvent},eo.prototype.isInsert=function(){return this._eventType===eo.INSERT},eo.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},eo.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},eo.prototype.interfaces_=function(){return[I]},eo.prototype.getClass=function(){return eo},no.INSERT.get=function(){return 1},no.DELETE.get=function(){return 2},Object.defineProperties(eo,no);function io(){}io.prototype.interfaces_=function(){return[]},io.prototype.getClass=function(){return io};function ro(t,e,n){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var i=t,r=e,o=n;this._li=i,this._includeProper=r,this._recordIsolated=o}ro.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(ro.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},ro.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ro.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},ro.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ro.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},ro.prototype.hasProperIntersection=function(){return this._hasProper},ro.prototype.hasIntersection=function(){return this._hasIntersection},ro.prototype.isDone=function(){return this._isDone},ro.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},ro.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},ro.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ro.prototype.interfaces_=function(){return[]},ro.prototype.getClass=function(){return ro},ro.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};function oo(){this._min=m.POSITIVE_INFINITY,this._max=m.NEGATIVE_INFINITY}var so,ao=((so=io)&&(lo.__proto__=so),((lo.prototype=Object.create(so&&so.prototype)).constructor=lo).prototype.prepareEvents=function(){Rn.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},lo.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof ro&&T(arguments[0],kt)&&T(arguments[1],kt)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&T(arguments[0],kt)&&arguments[1]instanceof ro){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},lo.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new to(n,r),s=new eo(e,n.getMinX(r),o);this.events.add(s),this.events.add(new eo(n.getMaxX(r),s))}},lo.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},lo.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();){var r=i.next();this.addEdge(r,n)}},lo.prototype.interfaces_=function(){return[]},lo.prototype.getClass=function(){return lo},lo),uo={NodeComparator:{configurable:!0}};function lo(){so.call(this),this.events=new Bt,this.nOverlaps=null}oo.prototype.getMin=function(){return this._min},oo.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},oo.prototype.getMax=function(){return this._max},oo.prototype.toString=function(){return tt.toLineString(new S(this._min,0),new S(this._max,0))},oo.prototype.interfaces_=function(){return[]},oo.prototype.getClass=function(){return oo},uo.NodeComparator.get=function(){return ho},Object.defineProperties(oo,uo);var ho=function(){};ho.prototype.compare=function(t,e){var n=(t._min+t._max)/2,i=(e._min+e._max)/2;return n<i?-1:i<n?1:0},ho.prototype.interfaces_=function(){return[w]},ho.prototype.getClass=function(){return ho};function co(){this._leaves=new Bt,this._root=null,this._level=0}var po,fo,go=((fo=oo)&&(mo.__proto__=fo),((mo.prototype=Object.create(fo&&fo.prototype)).constructor=mo).prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},mo.prototype.interfaces_=function(){return[]},mo.prototype.getClass=function(){return mo},mo),yo=((po=oo)&&(_o.__proto__=po),((_o.prototype=Object.create(po&&po.prototype)).constructor=_o).prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},_o.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},_o.prototype.interfaces_=function(){return[]},_o.prototype.getClass=function(){return _o},_o);function _o(){po.call(this),this._node1=null,this._node2=null;var t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}function mo(){fo.call(this),this._item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}co.prototype.buildTree=function(){Rn.sort(this._leaves,new oo.NodeComparator);for(var t=this._leaves,e=null,n=new Bt;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},co.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new go(t,e,n))},co.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},co.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},co.prototype.printNode=function(t){Y.out.println(tt.toLineString(new S(t._min,this._level),new S(t._max,this._level)))},co.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},co.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new yo(t.get(n),t.get(n+1));e.add(r)}}},co.prototype.interfaces_=function(){return[]},co.prototype.getClass=function(){return co};function vo(){this._items=new Bt}vo.prototype.visitItem=function(t){this._items.add(t)},vo.prototype.getItems=function(){return this._items},vo.prototype.interfaces_=function(){return[Nn]},vo.prototype.getClass=function(){return vo};function bo(t){this._index=null;var e=t;if(!T(e,ve))throw new b("Argument must be Polygonal");this._index=new Io(e)}var xo={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};bo.prototype.locate=function(t){var e=new yt(t),n=new Eo(e);return this._index.query(t.y,t.y,n),e.getLocation()},bo.prototype.interfaces_=function(){return[Li]},bo.prototype.getClass=function(){return bo},xo.SegmentVisitor.get=function(){return Eo},xo.IntervalIndexedGeometry.get=function(){return Io},Object.defineProperties(bo,xo);var Eo=function(t){this._counter=null;var e=t;this._counter=e};Eo.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},Eo.prototype.interfaces_=function(){return[Nn]},Eo.prototype.getClass=function(){return Eo};var Io=function(t){this._index=new co;var e=t;this.init(e)};Io.prototype.init=function(t){for(var e=yr.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},Io.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new Zn(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},Io.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new vo;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},Io.prototype.interfaces_=function(){return[]},Io.prototype.getClass=function(){return Io};function Lo(t,e,n){if(this._li=new dt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var i=t;this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new So(0,i)}else if(2===arguments.length){var r=t,o=e,s=Lt.OGC_SFS_BOUNDARY_RULE;0<=r.getPrecisionModel().compareTo(o.getPrecisionModel())?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new So(0,r,s),this._arg[1]=new So(1,o,s)}else if(3===arguments.length){var a=t,u=e,l=n;0<=a.getPrecisionModel().compareTo(u.getPrecisionModel())?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(u.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new So(0,a,l),this._arg[1]=new So(1,u,l)}}var wo,So=((wo=wn)&&(Mo.__proto__=wo),((Mo.prototype=Object.create(wo&&wo.prototype)).constructor=Mo).prototype.insertBoundaryPoint=function(t,e){var n=this._nodes.addNode(e).getLabel(),i=1;n.getLocation(t,We.ON)===N.BOUNDARY&&i++;var r=Mo.determineBoundary(this._boundaryNodeRule,i);n.setLocation(t,r)},Mo.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],i=arguments[2],r=new ro(arguments[0],!0,!1);r.setIsDoneIfProperInt(i);var o=this.createEdgeSetIntersector(),s=this._parentGeom instanceof Le||this._parentGeom instanceof Ee||this._parentGeom instanceof we,a=n||!s;return o.computeIntersections(this._edges,r,a),this.addSelfIntersectionNodes(this._argIndex),r}},Mo.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},Mo.prototype.computeEdgeIntersections=function(t,e,n){var i=new ro(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},Mo.prototype.getGeometry=function(){return this._parentGeom},Mo.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},Mo.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},Mo.prototype.addPoint=function(){if(arguments[0]instanceof be){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,N.INTERIOR)}else if(arguments[0]instanceof S){var e=arguments[0];this.insertPoint(this._argIndex,e,N.INTERIOR)}},Mo.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),N.EXTERIOR,N.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,N.INTERIOR,N.EXTERIOR)}},Mo.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],N.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],N.BOUNDARY)},Mo.prototype.addLineString=function(t){var e=Dt.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new Hi(e,new on(this._argIndex,N.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),it.isTrue(2<=e.length,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},Mo.prototype.getInvalidPoint=function(){return this._invalidPoint},Mo.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},Mo.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},Mo.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===N.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},Mo.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Dt.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;_t.isCCW(i)&&(r=n,o=e);var s=new Hi(i,new on(this._argIndex,N.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],N.BOUNDARY)},Mo.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new on(t,n):r.setLocation(t,n)},Mo.prototype.createEdgeSetIntersector=function(){return new ao},Mo.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},Mo.prototype.add=function(){if(1!==arguments.length)return wo.prototype.add.apply(this,arguments);var t=arguments[0];if(t.isEmpty())return null;if(t instanceof we&&(this._useBoundaryDeterminationRule=!1),t instanceof Ee)this.addPolygon(t);else if(t instanceof me)this.addLineString(t);else if(t instanceof be)this.addPoint(t);else if(t instanceof Ie)this.addCollection(t);else if(t instanceof ce)this.addCollection(t);else if(t instanceof we)this.addCollection(t);else{if(!(t instanceof he))throw new Error(t.getClass().getName());this.addCollection(t)}},Mo.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Mo.prototype.locate=function(t){return T(this._parentGeom,ve)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new bo(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},Mo.prototype.findEdge=function(){if(1!==arguments.length)return wo.prototype.findEdge.apply(this,arguments);var t=arguments[0];return this._lineEdgeMap.get(t)},Mo.prototype.interfaces_=function(){return[]},Mo.prototype.getClass=function(){return Mo},Mo.determineBoundary=function(t,e){return t.isInBoundary(e)?N.BOUNDARY:N.INTERIOR},Mo);function Mo(){if(wo.call(this),this._parentGeom=null,this._lineEdgeMap=new Ae,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new _r,2===arguments.length){var t=arguments[0],e=arguments[1],n=Lt.OGC_SFS_BOUNDARY_RULE;this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e&&this.add(e)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._argIndex=i,this._parentGeom=r,this._boundaryNodeRule=o,null!==r&&this.add(r)}}Lo.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Lo.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Lo.prototype.interfaces_=function(){return[]},Lo.prototype.getClass=function(){return Lo};function Co(){}Co.prototype.interfaces_=function(){return[]},Co.prototype.getClass=function(){return Co},Co.map=function(){if(arguments[0]instanceof bt&&T(arguments[1],Co.MapOp)){for(var t=arguments[0],e=arguments[1],n=new Bt,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(T(arguments[0],Nt)&&T(arguments[1],Co.MapOp)){for(var o=arguments[0],s=arguments[1],a=new Bt,u=o.iterator();u.hasNext();){var l=u.next(),h=s.map(l);null!==h&&a.add(h)}return a}},Co.MapOp=function(){};var Po,No=((Po=Lo)&&(Oo.__proto__=Po),((Oo.prototype=Object.create(Po&&Po.prototype)).constructor=Oo).prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new on(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},Oo.prototype.getGraph=function(){return this._graph},Oo.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},Oo.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},Oo.prototype.computeGeometry=function(t,e,n,i){var r=new Bt;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?Oo.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(r)},Oo.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},Oo.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==N.EXTERIOR)return!0}return!1},Oo.prototype.replaceCollapsedEdges=function(){for(var t=new Bt,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},Oo.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},Oo.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},Oo.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},Oo.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Bt;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Ar.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new Sn(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Br(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Gr(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},Oo.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},Oo.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},Oo.prototype.findResultAreaEdges=function(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&Oo.isResultOfOp(i.getLocation(0,We.RIGHT),i.getLocation(1,We.RIGHT),t)&&n.setInResult(!0)}},Oo.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(it.isTrue(!i.isNull(r,We.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,We.LEFT,i.getLocation(r,We.LEFT)),it.isTrue(!i.isNull(r,We.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,We.RIGHT,i.getLocation(r,We.RIGHT))))}}},Oo.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},Oo.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},Oo.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},Oo.prototype.interfaces_=function(){return[]},Oo.prototype.getClass=function(){return Oo},Oo);function Oo(){var t=arguments[0],e=arguments[1];Po.call(this,t,e),this._ptLocator=new _r,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Di,this._resultPolyList=new Bt,this._resultLineList=new Bt,this._resultPointList=new Bt,this._graph=new wn(new Ti),this._geomFact=t.getFactory()}No.overlayOp=function(t,e,n){return new No(t,e).getResultGeometry(n)},No.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return No.createEmptyResult(No.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Fr.map(t,{interfaces_:function(){return[Co.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),$r.overlayOp(t,e,No.INTERSECTION)},No.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return No.createEmptyResult(No.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),$r.overlayOp(t,e,No.SYMDIFFERENCE)},No.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case No.INTERSECTION:o=Math.min(i,r);break;case No.UNION:o=Math.max(i,r);break;case No.DIFFERENCE:o=i;break;case No.SYMDIFFERENCE:o=Math.max(i,r)}return o},No.createEmptyResult=function(t,e,n,i){var r=null;switch(No.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},No.difference=function(t,e){return t.isEmpty()?No.createEmptyResult(No.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),$r.overlayOp(t,e,No.DIFFERENCE))},No.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return No.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1];switch(r===N.BOUNDARY&&(r=N.INTERIOR),o===N.BOUNDARY&&(o=N.INTERIOR),arguments[2]){case No.INTERSECTION:return r===N.INTERIOR&&o===N.INTERIOR;case No.UNION:return r===N.INTERIOR||o===N.INTERIOR;case No.DIFFERENCE:return r===N.INTERIOR&&o!==N.INTERIOR;case No.SYMDIFFERENCE:return r===N.INTERIOR&&o!==N.INTERIOR||r!==N.INTERIOR&&o===N.INTERIOR}return!1}},No.INTERSECTION=1,No.UNION=2,No.DIFFERENCE=3,No.SYMDIFFERENCE=4;function To(t,e){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new _r,this._seg=new Zn;var n=t,i=e;this._g=n,this._boundaryDistanceTolerance=i,this._linework=this.extractLinework(n)}To.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},To.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?N.BOUNDARY:this._ptLocator.locate(t,this._g)},To.prototype.extractLinework=function(t){var e=new ko;t.apply(e);var n=e.getLinework(),i=je.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},To.prototype.interfaces_=function(){return[]},To.prototype.getClass=function(){return To};var ko=function(){this._linework=null,this._linework=new Bt};ko.prototype.getLinework=function(){return this._linework},ko.prototype.filter=function(t){if(t instanceof Ee){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},ko.prototype.interfaces_=function(){return[ue]},ko.prototype.getClass=function(){return ko};function Ro(t){this._g=null,this._doLeft=!0,this._doRight=!0;var e=t;this._g=e}Ro.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Ro.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Ro.prototype.getPoints=function(t){for(var e=new Bt,n=yr.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Ro.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,u=n*o/s,l=(e.x+t.x)/2,h=(e.y+t.y)/2;if(this._doLeft){var c=new S(l-u,h+a);i.add(c)}if(this._doRight){var p=new S(l+u,h-a);i.add(p)}},Ro.prototype.interfaces_=function(){return[]},Ro.prototype.getClass=function(){return Ro};function Do(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=Do.TOLERANCE,this._testCoords=new Bt;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=Do.computeBoundaryDistanceTolerance(t,e),this._geom=[t,e,n],this._locFinder=[new To(this._geom[0],this._boundaryDistanceTolerance),new To(this._geom[1],this._boundaryDistanceTolerance),new To(this._geom[2],this._boundaryDistanceTolerance)]}var Ao={TOLERANCE:{configurable:!0}};Do.prototype.reportResult=function(t,e,n){Y.out.println("Overlay result invalid - A:"+N.toLocationSymbol(e[0])+" B:"+N.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+N.toLocationSymbol(e[2]))},Do.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Do.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Do.hasLocation(this._location,N.BOUNDARY)||this.isValidResult(i,this._location)}},Do.prototype.addTestPts=function(t){var e=new Ro(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Do.prototype.isValidResult=function(t,e){var n=No.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===N.INTERIOR);return i||this.reportResult(t,e,n),i},Do.prototype.getInvalidLocation=function(){return this._invalidLocation},Do.prototype.interfaces_=function(){return[]},Do.prototype.getClass=function(){return Do},Do.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Do.computeBoundaryDistanceTolerance=function(t,e){return Math.min(qr.computeSizeBasedSnapTolerance(t),qr.computeSizeBasedSnapTolerance(e))},Do.isValid=function(t,e,n,i){return new Do(t,e,i).isValid(n)},Ao.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Do,Ao);function Fo(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=Fo.extractFactory(t),this._inputGeoms=t}Fo.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},Fo.prototype.combine=function(){for(var t=new Bt,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Fo.prototype.interfaces_=function(){return[]},Fo.prototype.getClass=function(){return Fo},Fo.combine=function(){return 1===arguments.length?new Fo(arguments[0]).combine():2===arguments.length?new Fo(Fo.createList(arguments[0],arguments[1])).combine():3===arguments.length?new Fo(Fo.createList(arguments[0],arguments[1],arguments[2])).combine():void 0},Fo.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Fo.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Bt;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new Bt;return s.add(i),s.add(r),s.add(o),s}};function Bo(t){this._inputPolys=null,this._geomFactory=null;var e=t;this._inputPolys=e,null===this._inputPolys&&(this._inputPolys=new Bt)}var Go={STRTREE_NODE_CAPACITY:{configurable:!0}};Bo.prototype.reduceToGeometries=function(t){for(var e=new Bt,n=t.iterator();n.hasNext();){var i=n.next(),r=null;T(i,kt)?r=this.unionTree(i):i instanceof bt&&(r=i),e.add(r)}return e},Bo.prototype.extractByEnvelope=function(t,e,n){for(var i=new Bt,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Bo.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Fo.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Bo.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new qn(Bo.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Bo.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Bo.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Bo.getGeometry(e,n),Bo.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},Bo.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Bo.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Bo.prototype.unionActual=function(t,e){return Bo.restrictToPolygons(t.union(e))},Bo.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Bo.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new Bt,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Fo.combine(i)},Bo.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Bo.prototype.interfaces_=function(){return[]},Bo.prototype.getClass=function(){return Bo},Bo.restrictToPolygons=function(t){if(T(t,ve))return t;var e=gr.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(je.toPolygonArray(e))},Bo.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Bo.union=function(t){return new Bo(t).union()},Go.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Bo,Go);function Uo(){}Uo.prototype.interfaces_=function(){return[]},Uo.prototype.getClass=function(){return Uo},Uo.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return No.createEmptyResult(No.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),$r.overlayOp(t,e,No.UNION)},t.GeoJSONReader=Ye,t.GeoJSONWriter=Je,t.OverlayOp=No,t.UnionOp=Uo,t.BufferOp=ar,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){var i=n(6),l=6378137;function r(t){var e=0;if(t&&0<t.length){e+=Math.abs(o(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(o(t[n]))}return e}function o(t){var e,n,i,r,o,s,a=0,u=t.length;if(2<u){for(s=0;s<u;s++)o=s===u-2?(i=u-2,r=u-1,0):s===u-1?(i=u-1,r=0,1):(r=(i=s)+1,s+2),e=t[i],n=t[r],a+=(h(t[o][0])-h(e[0]))*Math.sin(h(n[1]));a=a*l*l/2}return a}function h(t){return t*Math.PI/180}e.a=function(t){return Object(i.b)(t,function(t,e){return t+function t(e){var n,i=0;switch(e.type){case"Polygon":return r(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=r(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}}(e)},0)}},function(t,e,n){function i(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}n.d(e,"a",function(){return i}),n(2)},function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={_initDraggableLayer:function(){this._tempDragCoord=null;var t=this._layer._path?this._layer._path:this._layer._renderer._container;L.DomUtil.addClass(t,"leaflet-pm-draggable"),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0,this._layer.on("mousedown",this._dragMixinOnMouseDown,this)},_dragMixinOnMouseUp:function(){var t=this,e=this._layer._path?this._layer._path:this._layer._renderer._container;return this._originalMapDragState&&this._layer._map.dragging.enable(),this._safeToCacheDragState=!0,this._layer._map.off("mousemove",this._dragMixinOnMouseMove,this),this._layer.off("mouseup",this._dragMixinOnMouseUp,this),!!this._dragging&&(this._initMarkers(),window.setTimeout(function(){t._dragging=!1,L.DomUtil.removeClass(e,"leaflet-pm-dragging"),t._layer.fire("pm:dragend"),t._fireEdit()},10),!0)},_dragMixinOnMouseMove:function(t){var e=this._layer._path?this._layer._path:this._layer._renderer._container;this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer.bringToFront(),this._originalMapDragState&&this._layer._map.dragging.disable(),this._markerGroup.clearLayers(),this._layer.fire("pm:dragstart")),this._onLayerDrag(t)},_dragMixinOnMouseDown:function(t){0<t.originalEvent.button||(this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,this._layer.on("mouseup",this._dragMixinOnMouseUp,this),this._layer._map.on("mousemove",this._dragMixinOnMouseMove,this))},dragging:function(){return this._dragging},_onLayerDrag:function(t){function e(t){return t.map(function(t){return{lat:t.lat+r,lng:t.lng+o}})}var n,i=t.latlng,r=i.lat-this._tempDragCoord.lat,o=i.lng-this._tempDragCoord.lng;n=this.isPolygon()?this._layer._latlngs.map(e,this):e(this._layer._latlngs),this._layer.setLatLngs(n).redraw(),this._tempDragCoord=i,this._layer.fire("pm:drag")}};e.default=i},function(t,e,n){var i;((i=n(1))&&i.__esModule?i:{default:i}).default.LayerGroup=L.Class.extend({initialize:function(t){var e=this;this._layerGroup=t,this._layers=this.findLayers(),this._layers.forEach(function(t){return e._initLayer(t)}),this._layerGroup.on("layeradd",function(t){t.target._pmTempLayer||(e._layers=e.findLayers(),t.layer.pm&&e._initLayer(t.layer),t.target.pm.enabled())})},findLayers:function(){var t=this._layerGroup.getLayers();return(t=t.filter(function(t){return!!t.pm})).filter(function(t){return!t._pmTempLayer})},_initLayer:function(e){var n=this;["pm:edit","pm:update","pm:remove","pm:dragstart","pm:drag","pm:dragend","pm:snap","pm:unsnap","pm:cut","pm:intersect","pm:raiseMarkers","pm:markerdragend","pm:markerdragstart","pm:vertexadded","pm:vertexremoved","pm:centerplaced"].forEach(function(t){e.on(t,n._fireEvent,n)}),e.pm._layerGroup=this._layerGroup},_fireEvent:function(t){this._layerGroup.fireEvent(t.type,t)},toggleEdit:function(e){this._options=e,this._layers.forEach(function(t){t.pm.toggleEdit(e)})},enable:function(e){this._options=e,this._layers.forEach(function(t){t.pm.enable(e)})},disable:function(){this._layers.forEach(function(t){t.pm.disable()})},enabled:function(){return!!this._layers.find(function(t){return t.pm.enabled()})},dragging:function(){return!!this._layers.find(function(t){return t.pm.dragging()})},getOptions:function(){return this._options}})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Marker=r.default.extend({initialize:function(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enable:function(t){var e=0<arguments.length&&void 0!==t?t:{draggable:!0,snappable:!0};this.options=e,this._map=this._layer._map,this.enabled()||(this._enabled=!0,this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this),this.options.draggable&&this._layer.dragging.enable(),this.options.snappable&&this._initSnappableMarkers())},enabled:function(){return this._enabled},disable:function(){this._enabled=!1,this._layer.dragging.disable(),this._layer.off("contextmenu",this._removeMarker,this),this._layerEdited&&this._layer.fire("pm:update",{}),this._layerEdited=!1},_removeMarker:function(t){var e=t.target;e.remove(),e.fire("pm:remove")},_onDragEnd:function(t){t.target.fire("pm:edit"),this._layerEdited=!0},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,t.off("drag",this._handleSnapping,this),t.on("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.on("dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)}})},function(t,e,n){var i=o(n(4)),r=o(n(1));function o(t){return t&&t.__esModule?t:{default:t}}r.default.Line=r.default.extend({initialize:function(t){this._layer=t,this._enabled=!1},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enable:function(t){L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this._layer.on("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.draggable&&this._initDraggableLayer(),this.options.allowSelfIntersection||this._handleLayerStyle())},_onLayerRemove:function(t){this.disable(t.target)},enabled:function(){return this._enabled},disable:function(t){var e=0<arguments.length&&void 0!==t?t:this._layer;if(!this.enabled())return!1;if(e.pm._dragging)return!1;e.pm._enabled=!1,e.pm._markerGroup.clearLayers(),e.off("mousedown"),e.off("mouseup"),this._layer.off("remove",this._onLayerRemove),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval);var n=e._path?e._path:this._layer._renderer._container;return L.DomUtil.removeClass(n,"leaflet-pm-draggable"),this.hasSelfIntersection()&&L.DomUtil.removeClass(n,"leaflet-pm-invalid"),this._layerEdited&&this._layer.fire("pm:update",{}),!(this._layerEdited=!1)},hasSelfIntersection:function(){return 0<(0,i.default)(this._layer.toGeoJSON()).features.length},_handleSelfIntersectionOnVertexRemoval:function(){this._handleLayerStyle(!0),this.hasSelfIntersection()&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle:function(t){var e=this._layer._path?this._layer._path:this._layer._renderer._container;if(this.hasSelfIntersection()){if(L.DomUtil.hasClass(e,"leaflet-pm-invalid"))return;t?(L.DomUtil.addClass(e,"leaflet-pm-invalid"),window.setTimeout(function(){L.DomUtil.removeClass(e,"leaflet-pm-invalid")},200)):L.DomUtil.addClass(e,"leaflet-pm-invalid"),this._layer.fire("pm:intersect",{intersection:(0,i.default)(this._layer.toGeoJSON())})}else L.DomUtil.removeClass(e,"leaflet-pm-invalid")},_initMarkers:function(){var o=this,t=this._map,e=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup);function n(i){var r=i.map(o._createMarker,o);return i.map(function(t,e){var n;return n=o.isPolygon()?(e+1)%i.length:e+1,o._createMiddleMarker(r[e],r[n])}),r}this._markers=[],this.isPolygon()?this._markers=e.map(n,this):this._markers=n(e),this.options.snappable&&this._initSnappableMarkers()},_createMarker:function(t){var e=new L.Marker(t,{draggable:!this.options.preventVertexEdit,icon:L.divIcon({className:"marker-icon"})});return e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on("contextmenu",this._removeMarker,this),this._markerGroup.addLayer(e),e},_createMiddleMarker:function(e,n){var i=this;if(!e||!n)return!1;var t=this._calcMiddleLatLng(e.getLatLng(),n.getLatLng()),r=this._createMarker(t),o=L.divIcon({className:"marker-icon marker-icon-middle"});return r.setIcon(o),e._middleMarkerNext=r,(n._middleMarkerPrev=r).on("click",function(){var t=L.divIcon({className:"marker-icon"});r.setIcon(t),i._addMarker(r,e,n)}),r.on("movestart",function(){r.on("moveend",function(){var t=L.divIcon({className:"marker-icon"});r.setIcon(t),r.off("moveend")}),i._addMarker(r,e,n)}),r},_addMarker:function(t,e,n){t.off("movestart"),t.off("click");var i=t.getLatLng(),r=this._layer._latlngs,o=this.findMarkerIndex(this._markers,n),s=o.ringIndex,a=o.index,u=-1<s?r[s]:r,l=-1<s?this._markers[s]:this._markers;u.splice(a,0,i),l.splice(a,0,t),this._layer.setLatLngs(r),this._createMiddleMarker(e,t),this._createMiddleMarker(t,n),this._fireEdit(),this._layer.fire("pm:vertexadded",{layer:this._layer,marker:t,index:a,ringIndex:s}),this.options.snappable&&this._initSnappableMarkers()},_removeMarker:function(t){if(!this.options.allowSelfIntersection){var e=this._layer.getLatLngs();this._coordsBeforeEdit=JSON.parse(JSON.stringify(e))}var n=t.target,i=this._layer.getLatLngs(),r=this.findMarkerIndex(this._markers,n),o=r.ringIndex,s=r.index,a=-1<o?i[o]:i,u=-1<o?this._markers[o]:this._markers;if(-1!==this.findMarkerIndex(this._markers,n).index){var l,h;if(a.splice(s,1),this._layer.setLatLngs(i),a.length<=1&&(i.splice(o,1),this._layer.setLatLngs(i),this.disable(),this.enable(this.options)),i.length<1&&this._layer.remove(),n._middleMarkerPrev&&this._markerGroup.removeLayer(n._middleMarkerPrev),n._middleMarkerNext&&this._markerGroup.removeLayer(n._middleMarkerNext),this._markerGroup.removeLayer(n),this.isPolygon()?(l=(s+1)%u.length,h=(s+(u.length-1))%u.length):(h=s-1<0?void 0:s-1,l=s+1>=u.length?void 0:s+1),l!==h){var c=u[h],p=u[l];this._createMiddleMarker(c,p)}u.splice(s,1),this._fireEdit(),this._layer.fire("pm:vertexremoved",{layer:this._layer,marker:n,index:s,ringIndex:o})}},findMarkerIndex:function(t,e){var n,i;return this.isPolygon()?i=t.findIndex(function(t){return-1<(n=t.findIndex(function(t){return e._leaflet_id===t._leaflet_id}))}):n=t.findIndex(function(t){return e._leaflet_id===t._leaflet_id}),{index:n,ringIndex:i}},updatePolygonCoordsFromMarkerDrag:function(t){var e=this._layer.getLatLngs(),n=this.findMarkerIndex(this._markers,t),i=n.ringIndex,r=n.index;(-1<i?e[i]:e).splice(r,1,t.getLatLng()),this._layer.setLatLngs(e).redraw()},_onMarkerDrag:function(t){var e=t.target;if(-1!==this.findMarkerIndex(this._markers,e).index){this.updatePolygonCoordsFromMarkerDrag(e);var n=this.findMarkerIndex(this._markers,e),i=n.ringIndex,r=n.index,o=-1<i?this._markers[i]:this._markers,s=(r+1)%o.length,a=(r+o.length-1)%o.length,u=e.getLatLng(),l=o[a].getLatLng(),h=o[s].getLatLng();if(e._middleMarkerNext){var c=this._calcMiddleLatLng(u,h);e._middleMarkerNext.setLatLng(c)}if(e._middleMarkerPrev){var p=this._calcMiddleLatLng(u,l);e._middleMarkerPrev.setLatLng(p)}this.options.allowSelfIntersection||this._handleLayerStyle()}},_onMarkerDragEnd:function(t){var e=t.target,n=this.findMarkerIndex(this._markers,e),i=n.ringIndex,r=n.index;if(!this.options.allowSelfIntersection&&this.hasSelfIntersection())return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),void this._handleLayerStyle();this._layer.fire("pm:markerdragend",{markerEvent:t,ringIndex:i,index:r}),this._fireEdit()},_onMarkerDragStart:function(t){var e=t.target,n=this.findMarkerIndex(this._markers,e),i=n.ringIndex,r=n.index;this._layer.fire("pm:markerdragstart",{markerEvent:t,ringIndex:i,index:r}),this.options.allowSelfIntersection||(this._coordsBeforeEdit=this._layer.getLatLngs())},_fireEdit:function(){this._layerEdited=!0,this._layer.fire("pm:edit")},_calcMiddleLatLng:function(t,e){var n=this._map,i=n.project(t),r=n.project(e);return n.unproject(i._add(r)._divideBy(2))}})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Poly=r.default.Line.extend({})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Rectangle=r.default.Poly.extend({_initMarkers:function(){var t=this._map,e=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup),this._markers=[],this._markers[0]=e.map(this._createMarker,this),this._cornerMarkers=this._markers[0],this.options.snappable&&this._initSnappableMarkers()},_createMarker:function(t,e){var n=new L.Marker(t,{draggable:!this.options.preventVertexEdit,icon:L.divIcon({className:"marker-icon"})});return n._origLatLng=t,n._index=e,n._pmTempLayer=!0,n.on("dragstart",this._onMarkerDragStart,this),n.on("drag",this._onMarkerDrag,this),n.on("dragend",this._onMarkerDragEnd,this),n.on("pm:snap",this._adjustRectangleForMarkerSnap,this),this.options.preventMarkerRemoval||n.on("contextmenu",this._removeMarker,this),this._markerGroup.addLayer(n),n},_removeMarker:function(){return null},_onMarkerDragStart:function(t){var e=t.target,n=this._findCorners();e._oppositeCornerLatLng=n[(e._index+2)%4],e._snapped=!1,this._layer.fire("pm:markerdragstart",{markerEvent:t})},_onMarkerDrag:function(t){var e=t.target;void 0!==e._index&&(e._snapped||this._adjustRectangleForMarkerMove(e))},_onMarkerDragEnd:function(t){var e=this._findCorners();this._adjustAllMarkers(e),this._cornerMarkers.forEach(function(t){delete t._oppositeCornerLatLng}),this._layer.setLatLngs(e),this._layer.redraw(),this._layer.fire("pm:markerdragend",{markerEvent:t}),this._fireEdit()},_adjustRectangleForMarkerMove:function(t){L.extend(t._origLatLng,t._latlng);var e=t.getLatLng();this._layer.setBounds(L.latLngBounds(e,t._oppositeCornerLatLng)),this._adjustAdjacentMarkers(t),this._layer.redraw()},_adjustRectangleForMarkerSnap:function(t){if(this.options.snappable){var e=t.target;this._adjustRectangleForMarkerMove(e)}},_adjustAllMarkers:function(n){n.length&&4==n.length?this._cornerMarkers.forEach(function(t,e){t.setLatLng(n[e])}):console.error("_adjustAllMarkers() requires an array of EXACTLY 4 LatLng coordinates")},_adjustAdjacentMarkers:function(t){if(t&&t.getLatLng&&t._oppositeCornerLatLng){var n=t.getLatLng(),i=t._oppositeCornerLatLng,r=[];this._findCorners().forEach(function(t){t.equals(n)||t.equals(i)||r.push(t)});var o=0;2==r.length&&this._cornerMarkers.forEach(function(t){var e=t.getLatLng();e.equals(n)||e.equals(i)||(t.setLatLng(r[o]),o+=1)})}else console.error("_adjustAdjacentMarkers() requires a valid Marker object")},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}})},function(t,e,n){var i,r=(i=n(1))&&i.__esModule?i:{default:i};r.default.Circle=r.default.extend({initialize:function(t){this._layer=t,this._enabled=!1},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enabled:function(){return this._enabled},enable:function(t){var e=this;L.Util.setOptions(this,t),this._map=this._layer._map,this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this._layer.on("remove",function(t){e.disable(t.target)})},disable:function(t){var e=0<arguments.length&&void 0!==t?t:this._layer;if(!this.enabled())return!1;if(e.pm._dragging)return!1;e.pm._enabled=!1,e.pm._layerGroup.clearLayers(),e.off("mousedown"),e.off("mouseup");var n=e._path;return L.DomUtil.removeClass(n,"leaflet-pm-draggable"),this._layerEdited&&this._layer.fire("pm:update",{}),!(this._layerEdited=!1)},_initMarkers:function(){var t=this._map;this._layerGroup&&this._layerGroup.clearLayers(),this._layerGroup=new L.LayerGroup,t.addLayer(this._layerGroup);var e=this._layer.getLatLng(),n=this._layer._radius,i=this._getLatLngOnCircle(e,n);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(i),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker),this.options.snappable&&this._initSnappableMarkers()},_getLatLngOnCircle:function(t,e){var n=this._map.project(t),i=L.point(n.x+e,n.y);return this._map.unproject(i)},_resizeCircle:function(){this._syncHintLine(),this._syncCircleRadius()},_moveCircle:function(t){var e=t.latlng;this._layer.setLatLng(e);var n=this._layer._radius,i=this._getLatLngOnCircle(e,n);this._outerMarker.setLatLng(i),this._syncHintLine(),this._layer.fire("pm:centerplaced",{layer:this._layer,latlng:e})},_onMarkerDragStart:function(t){this._layer.fire("pm:markerdragstart",{markerEvent:t})},_onMarkerDragEnd:function(t){this._fireEdit(),this._layer.fire("pm:markerdragend",{markerEvent:t})},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),n=t.distanceTo(e);this._layer.setRadius(n)},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_createHintLine:function(t,e){var n=t.getLatLng(),i=e.getLatLng();this._hintline=L.polyline([n,i],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline)},_createCenterMarker:function(t){var e=this._createMarker(t);return e.on("move",this._moveCircle,this),e},_createOuterMarker:function(t){var e=this._createMarker(t);return this.options.preventVertexEdit&&e.dragging.disable(),e.on("move",this._resizeCircle,this),e},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("dragend",this._onMarkerDragEnd,this),this._layerGroup.addLayer(e),e},_fireEdit:function(){this._layer.fire("pm:edit"),this._layerEdited=!0}})},function(t,e){},function(t,e){}],b.c=v,b.d=function(t,e,n){b.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},b.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return b.d(e,"a",e),e},b.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},b.p="",b(b.s=7),B.SVG.include({_updatecurve:function(t){var e=this._curvePointsToPath(t._points);if(this._setPath(t,e),t.options.animate){var n=t._path,i=n.getTotalLength();t.options.dashArray||(n.style.strokeDasharray=i+" "+i),t._initialUpdate&&(n.animate([{strokeDashoffset:i},{strokeDashoffset:0}],t.options.animate),t._initialUpdate=!1)}return e},_curvePointsToPath:function(t){for(var e=void 0,n="",i=0;i<t.length;i++)"string"==typeof(e=t[i])||e instanceof String?n+=e:n+=e.x+","+e.y+" ";return n||"M0 0"}});var x=B.Path.extend({options:{},initialize:function(t,e){t.mid||(t.mid=this.getMidPoint(t.from,t.to,t.from.deep?t.from.deep:4,t.from.slide)),B.setOptions(this,e),this._initialUpdate=!0,this.setPath(t)},onAdd:function(t){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this),t.on("zoom",function(){})},getPath:function(){return this._coords},setPath:function(t){return this._setPath(t),this.redraw()},getBounds:function(){return this._bounds},getMidPoint:function(t,e,n,i){var r=3.14;"RIGHT_ROUND"===(3<arguments.length&&void 0!==i?i:"LEFT_ROUND")&&(r*=-1);var o=t,s=e.lng-o.lng,a=e.lat-o.lat,u=Math.sqrt(Math.pow(s,2)+Math.pow(a,2)),l=Math.atan2(a,s),h=r/(n||4),c=u/2/Math.cos(h),p=l+h,f=c*Math.cos(p)+o.lng;return[c*Math.sin(p)+o.lat,f]},_setPath:function(t){this._coords=t,this._bounds=this._computeBounds()},_computeBounds:function(){var t=new B.LatLngBounds;return t.extend(this._coords.from),t.extend(this._coords.to),t.extend(this._coords.mid),t},getCenter:function(){return this._bounds.getCenter()},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updatecurve(this)},_project:function(){this._points=[],this._points.push("M");var t=this._map.latLngToLayerPoint(this._coords.from);this._points.push(t),this._coords.mid&&(this._points.push("Q"),t=this._map.latLngToLayerPoint(this._coords.mid),this._points.push(t)),t=this._map.latLngToLayerPoint(this._coords.to),this._points.push(t)}}),E=52.35987755982988,I=3.141592653589793,S=6378245,M=.006693421622965943,C=function(t,e){var n=2*(t=+t)-100+3*(e=+e)+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*I)+20*Math.sin(2*t*I))/3,n+=2*(20*Math.sin(e*I)+40*Math.sin(e/3*I))/3,n+=2*(160*Math.sin(e/12*I)+320*Math.sin(e*I/30))/3},P=function(t,e){var n=300+(t=+t)+2*(e=+e)+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*I)+20*Math.sin(2*t*I))/3,n+=2*(20*Math.sin(t*I)+40*Math.sin(t/3*I))/3,n+=2*(150*Math.sin(t/12*I)+300*Math.sin(t/30*I))/3},N=function(t,e){e=+e;return!(73.66<(t=+t)&&t<135.05&&3.86<e&&e<53.55)},O={bd09togcj02:function(t,e){var n=(t=+t)-.0065,i=(e=+e)-.006,r=Math.sqrt(n*n+i*i)-2e-5*Math.sin(i*E),o=Math.atan2(i,n)-3e-6*Math.cos(n*E);return[r*Math.cos(o),r*Math.sin(o)]},gcj02tobd09:function(t,e){e=+e,t=+t;var n=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*E),i=Math.atan2(e,t)+3e-6*Math.cos(t*E);return[n*Math.cos(i)+.0065,n*Math.sin(i)+.006]},wgs84togcj02:function(t,e){if(N(t=+t,e=+e))return[t,e];var n=C(t-105,e-35),i=P(t-105,e-35),r=e/180*I,o=Math.sin(r);o=1-M*o*o;var s=Math.sqrt(o);return n=180*n/(S*(1-M)/(o*s)*I),[t+(i=180*i/(S/s*Math.cos(r)*I)),e+n]},gcj02towgs84:function(t,e){if(N(t=+t,e=+e))return[t,e];var n=C(t-105,e-35),i=P(t-105,e-35),r=e/180*I,o=Math.sin(r);o=1-M*o*o;var s=Math.sqrt(o);return n=180*n/(S*(1-M)/(o*s)*I),[2*t-(t+(i=180*i/(S/s*Math.cos(r)*I))),2*e-(e+n)]}},T=B.Renderer.extend({options:{padding:.1,width:0,height:0,zIndex:0,className:""},initialize:function(t){B.Renderer.prototype.initialize.call(this,t),this._initContainer()},_initContainer:function(){this._divContainer=B.DomUtil.create("div","leaflet-layer "+this.options.className),this._container=document.createElement("canvas"),this.container=this._container,this._divContainer.appendChild(this.container),this.options.zIndex&&(this._divContainer.style.zIndex=this.options.zIndex),this._ctx=this.container.getContext("2d"),this.ctx=this._ctx,B.DomUtil.addClass(this._container,"leaflet-zoom-animated")},getContainer:function(){return this._container},setZIndex:function(t){this.options.zIndex=t,this._divContainer.style.zIndex=t},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&B.DomUtil.addClass(this._divContainer,"leaflet-zoom-animated")),this.getPane().appendChild(this._divContainer),this.clear()},onRemove:function(){B.DomUtil.remove(this._divContainer)},_update:function(){var t=this.options.padding,e=this._map.getSize();this.options.width&&this.options.height&&(e.x=this.options.width,e.y=this.options.height);var n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new B.Bounds(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},clear:function(){if(this._map&&(!this._map._animatingZoom||!this._bounds)){B.Renderer.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=B.Browser.retina?2:1;B.DomUtil.setPosition(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",B.Browser.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y)}}}),k=B.Layer.extend({options:{color:"rgba(250,113,122,0.8)",type:"circle",speed:.15,max:20,latlng:null,name:""},beforeAdd:function(t){this._renderer=this._getRenderer(t),t.hasLayer(this._renderer)||t.addLayer(this._renderer)},onAdd:function(){this.update()},onRemove:function(){this._renderer.clear(),this.drawFrame&&B.Util.cancelAnimFrame(this.drawFrame)},_getRenderer:function(t){var e=t._paneRenderers.flashMarker;return e||(e=new T({pane:this.options.pane}),t._paneRenderers.flashMarker=e),e},initialize:function(t,e){B.setOptions(this,e),this.latlng=t,this.name=this.options.name||"",this.size=0},getEvents:function(){return{moveend:this.update,viewreset:this.update}},update:function(){var e=this;this._map&&(this._renderer.clear(),this.drawFrame&&B.Util.cancelAnimFrame(this.drawFrame),function t(){e.drawFrame=B.Util.requestAnimFrame(t),e.draw()}())},draw:function(){var t=this._renderer.ctx;t.fillStyle="rgba(0,0,0,.93)";var e=t.globalCompositeOperation;switch(t.globalCompositeOperation="destination-in",t.fillRect(0,0,this._renderer.getContainer().width,this._renderer.getContainer().height),t.globalCompositeOperation=e,t.save(),t.beginPath(),this.options.type){case"circle":this._drawCircle(t);break;case"ellipse":this._drawEllipse(t)}t.closePath(),t.restore(),this.size+=this.options.speed,this.size>this.options.max&&(this.size=0)},_drawCircle:function(t){var e=this._map.latLngToLayerPoint(this.latlng);t.strokeStyle=this.options.color,t.arc(e.x,e.y,this.size,0,2*Math.PI),t.stroke()},_drawEllipse:function(t){var e=this._map.latLngToLayerPoint(this.latlng),n=e.x,i=e.y,r=this.size,o=this.size/2,s=r/2*.5522848,a=o/2*.5522848,u=n-r/2,l=i-o/2,h=n+r/2,c=i+o/2;t.strokeStyle=this.options.color,t.moveTo(u,i),t.bezierCurveTo(u,i-a,n-s,l,n,l),t.bezierCurveTo(n+s,l,h,i-a,h,i),t.bezierCurveTo(h,i+a,n+s,c,n,c),t.bezierCurveTo(n-s,c,u,i+a,u,i),t.stroke()}}),R=B.DivOverlay.extend({options:{latlng:null,text:"",opacity:1,offset:[8,0]},initialize:function(t){B.setOptions(this,t),this.setLatLng(this.options.latlng),this.setContent(this.options.text)},onAdd:function(t){B.DivOverlay.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity)},_initLayout:function(){var t="leaflet-label "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._container=B.DomUtil.create("div",t),this._contentNode=this._container},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=B.point(this.options.offset),n=this._getAnchor();this._zoomAnimated?B.DomUtil.setPosition(this._container,t.add(n)):e=e.add(t).add(n);var i=e.y-this._container.clientHeight/2,r=e.x;this._container.style.top=i+"px",this._container.style.left=r+"px"},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&B.DomUtil.setOpacity(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)}});var D=B.Marker.extend({statics:{notStartedState:0,endedState:1,pausedState:2,runState:3},options:{autostart:!1,loop:!1,bCenter:!1},initialize:function(t,e,n){B.Marker.prototype.initialize.call(this,t[0],n),this._latlngs=t.map(function(t){return B.latLng(t)}),e instanceof Array?this._durations=e:this._durations=this._createDurations(this._latlngs,e),this._currentDuration=0,this._currentIndex=0,this._state=D.notStartedState,this._startTime=0,this._startTimeStamp=0,this._pauseStartTime=0,this._animId=0,this._animRequested=!1,this._currentLine=[],this._stations={}},isRunning:function(){return this._state===D.runState},isEnded:function(){return this._state===D.endedState},isStarted:function(){return this._state!==D.notStartedState},isPaused:function(){return this._state===D.pausedState},start:function(){this.isRunning()||(this.isPaused()?this.resume():(this._loadLine(0),this._startAnimation(),this.fire("start")))},resume:function(){this.isPaused()&&(this._currentLine[0]=this.getLatLng(),this._currentDuration-=this._pauseStartTime-this._startTime,this._startAnimation())},pause:function(){this.isRunning()&&(this._pauseStartTime=Date.now(),this._state=D.pausedState,this._stopAnimation(),this._updatePosition())},stop:function(t){this.isEnded()||(this._stopAnimation(),void 0===t&&(t=0,this._updatePosition()),this._state=D.endedState,this.fire("end",{elapsedTime:t}))},addLatLng:function(t,e){this._latlngs.push(B.latLng(t)),this._durations.push(e)},moveTo:function(t,e){this._stopAnimation(),this._latlngs=[this.getLatLng(),B.latLng(t)],this._durations=[e],this._state=D.notStartedState,this.start(),this.options.loop=!1},addStation:function(t,e){t>this._latlngs.length-2||t<1||(this._stations[t]=e)},onAdd:function(t){B.Marker.prototype.onAdd.call(this,t),!this.options.autostart||this.isStarted()?this.isRunning()&&this._resumeAnimation():this.start()},onRemove:function(t){B.Marker.prototype.onRemove.call(this,t),this._stopAnimation()},_createDurations:function(t,e){for(var n=t.length-1,i=[],r=0,o=0,s=0;s<n;s++)o=t[s+1].distanceTo(t[s]),i.push(o),r+=o;for(var a=e/r,u=[],l=0;l<i.length;l++)u.push(i[l]*a);return u},_startAnimation:function(){this._state=D.runState,this._animId=B.Util.requestAnimFrame(function(t){this._startTime=Date.now(),this._startTimeStamp=t,this._animate(t)},this,!0),this._animRequested=!0},_resumeAnimation:function(){this._animRequested||(this._animRequested=!0,this._animId=B.Util.requestAnimFrame(function(t){this._animate(t)},this,!0))},_stopAnimation:function(){this._animRequested&&(B.Util.cancelAnimFrame(this._animId),this._animRequested=!1)},_updatePosition:function(){var t=Date.now()-this._startTime;this._animate(this._startTimeStamp+t,!0)},_loadLine:function(t){this._currentIndex=t,this._currentDuration=this._durations[t],this._currentLine=this._latlngs.slice(t,t+2),this.fire("pointChange",{index:t,marker:this,p1:this._currentLine[0],p2:this._currentLine[1]})},_updateLine:function(t){var e=t-this._startTimeStamp;if(e<=this._currentDuration)return e;for(var n=this._currentIndex,i=this._currentDuration,r=void 0;i<e;){if(e-=i,void 0!==(r=this._stations[n+1])){if(e<r)return this.setLatLng(this._latlngs[n+1]),null;e-=r}if(++n>=this._latlngs.length-1){if(!this.options.loop)return this.setLatLng(this._latlngs[this._latlngs.length-1]),this.stop(e),null;n=0,this.fire("loop",{elapsedTime:e})}i=this._durations[n]}return this._loadLine(n),this._startTimeStamp=t-e,this._startTime=Date.now()-e,e},_animate:function(t,e){this._animRequested=!1;var n=this._updateLine(t);if(!this.isEnded()){if(null!=n){var i=(r=this._currentLine[0],o=this._currentLine[1],s=this._currentDuration,a=1<(a=0<(a=n/s)?a:0)?1:a,B.latLng(r.lat+a*(o.lat-r.lat),r.lng+a*(o.lng-r.lng)));this.options.bCenter&&this._map.panTo(i),this.setLatLng(i)}var r,o,s,a;e||(this._animId=B.Util.requestAnimFrame(this._animate,this,!1),this._animRequested=!0)}}}),A=B.Evented.extend({options:{polygonStyle:{color:"red",fillOpacity:.2,interactive:!1},labelStyle:{offset:[8,0]}},initialize:function(t,e){B.setOptions(this,e),this._map=t,this._enabled=!1,this._defaultCursor=this._map._container.style.cursor,this._allLayers=new B.LayerGroup,this._map.addLayer(this._allLayers)},enable:function(){this._enabled||(this._enabled=!0,this._map.doubleClickZoom.disable(),this._map._container.style.cursor="crosshair",this._map.on("click",this._clicked,this),this._map.on("mousemove",this._moving,this),this._map.on("dblclick",this._closePath,this),this._start())},disable:function(){this._enabled&&(this._enabled=!1,this._map.doubleClickZoom.enable(),this._map._container.style.cursor=this._defaultCursor,this._map.off("click",this._clicked,this),this._map.off("mousemove",this._moving,this),this._map.off("dblclick",this._closePath,this))},clear:function(){this._allLayers.clearLayers()},_start:function(){this._clickPoints=[],this._tempLayer=null,this._tempLines=null,this._tempLabel=null},_closePath:function(){var t=new B.FeatureGroup;this._allLayers.addLayer(t),this._drawPath(this._clickPoints,t,!0),this._clearTemp(),this._start(),this.fire("finish")},_clearTemp:function(){this._tempLayer&&(this._map.removeLayer(this._tempLayer),this._tempLayer=null),this._tempLines&&(this._map.removeLayer(this._tempLines),this._tempLines=null),this._tempLabel&&(this._map.removeLayer(this._tempLabel),this._tempLabel=null)},_clicked:function(t){this._map&&this._map.clearMeasure();var e=t.latlng;if(0<this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(e.equals(n))return void this._closePath()}this._clickPoints.push(e),this._drawTempLayer(this._clickPoints)},_moving:function(t){var e=t.latlng;if(this._clickPoints&&0!==this._clickPoints.length){this._tempLines||(this._tempLines=new B.FeatureGroup,this._map.addLayer(this._tempLines)),this._tempLines.clearLayers();var n=this._clickPoints.length,i=this._clickPoints[0],r=B.Util.clone(this.options.polygonStyle);r.dashArray=[5,5];var o=new B.Polyline([i,e],r);if(this._tempLines.addLayer(o),2<=n){var s=this._clickPoints[n-1],a=new B.Polyline([s,e],r);this._tempLines.addLayer(a)}this._tempLabel?this._tempLabel.setLatLng(e):(this._tempLabel=new R({latlng:e,text:"双击结束",offset:[10,10]}),this._map.addLayer(this._tempLabel))}},_drawTempLayer:function(t){this._tempLayer||(this._tempLayer=new B.FeatureGroup,this._map.addLayer(this._tempLayer)),this._tempLayer.clearLayers(),this._drawPath(t,this._tempLayer)},_drawPath:function(t,e,n){var i=this;if(t&&!(t.length<2)){var r,o=t.length,s=B.Util.clone(this.options.polygonStyle);if(2===o){if(n)return;var a=new B.Polyline(t,s);e.addLayer(a)}else{var u=new B.Polygon(t,s);if(e.addLayer(u),n){var l=this.geodesicArea(t);l=parseInt(l/1e6*1e4)/1e4;var h=document.createElement("span");h.className="measure-close",r=e,h.onclick=function(){i._allLayers.removeLayer(r)},h.innerHTML="X",B.DomEvent.disableClickPropagation(h);var c=document.createElement("span");c.innerHTML="总面积："+l+"平方千米",c.appendChild(h);var p=B.Util.clone(this.options.labelStyle);p.latlng=t[o-1],p.text=c;var f=new R(p);e.addLayer(f)}}}},geodesicArea:function(t){function e(t){return t*Math.PI/180}var n=void 0,i=void 0,r=void 0,o=void 0,s=void 0,a=0,u=t.length;if(2<u){for(var l=0;l<u;l++)s=l===u-2?(r=u-2,o=u-1,0):l===u-1?(r=u-1,o=0,1):(o=(r=l)+1,l+2),n=t[r],i=t[o],a+=(e(t[s].lng)-e(n.lng))*Math.sin(e(i.lat));a=6378137*a*6378137/2}return Math.abs(a)}}),F=B.Evented.extend({options:{circleMarker:{color:"red",radius:5,fillColor:"#ffffff",weight:1,fillOpacity:1,interactive:!1},lineStyle:{color:"red",interactive:!1},labelStyle:{offset:[8,0]}},initialize:function(t,e){B.setOptions(this,e),this._map=t,this._enabled=!1,this._defaultCursor=this._map._container.style.cursor,this._allLayers=new B.LayerGroup,this._map.addLayer(this._allLayers)},enable:function(){this._enabled||(this._enabled=!0,this._map.doubleClickZoom.disable(),this._map._container.style.cursor="crosshair",this._map.on("click",this._clicked,this),this._map.on("mousemove",this._moving,this),this._map.on("dblclick",this._closePath,this),this._start())},disable:function(){this._enabled&&(this._enabled=!1,this._map.doubleClickZoom.enable(),this._map._container.style.cursor=this._defaultCursor,this._map.off("click",this._clicked,this),this._map.off("mousemove",this._moving,this),this._map.off("dblclick",this._closePath,this))},clear:function(){this._allLayers.clearLayers()},_start:function(){this._clickPoints=[],this._tempLayer=null,this._tempLine=null,this._tempLabel=null},_closePath:function(){var t=new B.FeatureGroup;this._allLayers.addLayer(t),this._drawPath(this._clickPoints,t,!0),this._clearTemp(),this._start(),this.fire("finish")},_clearTemp:function(){this._tempLayer&&(this._map.removeLayer(this._tempLayer),this._tempLayer=null),this._tempLine&&(this._map.removeLayer(this._tempLine),this._tempLine=null),this._tempLabel&&(this._map.removeLayer(this._tempLabel),this._tempLabel=null)},_clicked:function(t){this._map&&this._map.clearMeasure();var e=t.latlng;if(0<this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(e.equals(n))return void this._closePath()}this._clickPoints.push(e),this._drawTempLayer(this._clickPoints)},_moving:function(t){var e=t.latlng;if(this._clickPoints&&0!==this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(this._tempLine)this._tempLine.setLatLngs([n,e]);else{var i=B.Util.clone(this.options.lineStyle);i.dashArray=[5,5],this._tempLine=new B.Polyline([n,e],i),this._map.addLayer(this._tempLine)}this._tempLabel?this._tempLabel.setLatLng(e):(this._tempLabel=new R({latlng:e,text:"双击结束",offset:[10,10]}),this._map.addLayer(this._tempLabel))}},_drawTempLayer:function(t){this._tempLayer||(this._tempLayer=new B.FeatureGroup,this._map.addLayer(this._tempLayer)),this._tempLayer.clearLayers(),this._drawPath(t,this._tempLayer)},_drawPath:function(t,n,e){var i=this;if(t&&0!==t.length){var r=t.length;if(1<r){var o=new B.Polyline(t,this.options.lineStyle);n.addLayer(o)}for(var s=0,a=0;a<r;a++){var u=t[a],l=new B.CircleMarker(u,this.options.circleMarker);n.addLayer(l);var h="";if(0===a&&(h="开始"),0<a){var c=t[a-1];s+=this._map.distance(c,u);var p=parseInt(s)/1e3;a===r-1&&e?function(){var t,e=document.createElement("span");e.className="measure-close",t=n,e.onclick=function(){i._allLayers.removeLayer(t)},e.innerHTML="X",B.DomEvent.disableClickPropagation(e),(h=document.createElement("span")).innerHTML="总长："+p+"公里",h.appendChild(e)}():h=p+"公里"}var f=B.Util.clone(this.options.labelStyle);f.latlng=u,f.text=h;var d=new R(f);n.addLayer(d)}}}}),G="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function U(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function j(t,e){return t(e={exports:{}},e.exports),e.exports}var q,z,V,Y,H,X,J=j(function(t,e){t.exports=function r(o,s,a){function u(n,t){if(!s[n]){if(!o[n]){var e=U;if(!t&&e)return e(n,!0);if(l)return l(n,!0);throw new Error("Cannot find module '"+n+"'")}var i=s[n]={exports:{}};o[n][0].call(i.exports,function(t){var e=o[n][1][t];return u(e||t)},i,i.exports,r,o,s,a)}return s[n].exports}for(var l=U,t=0;t<a.length;t++)u(a[t]);return u}({1:[function(t,e,n){var i=t("mgrs");function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"===(void 0===t?"undefined":g(t)))this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&void 0===e){var i=t.split(",");this.x=parseFloat(i[0],10),this.y=parseFloat(i[1],10),this.z=parseFloat(i[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}r.fromMGRS=function(t){return new r(i.toPoint(t))},r.prototype.toMGRS=function(t){return i.forward([this.x,this.y],t)},e.exports=r},{mgrs:67}],2:[function(t,e,n){var o=t("./parseCode"),s=t("./extend"),i=t("./projections"),a=t("./deriveConstants");function u(t,e){if(!(this instanceof u))return new u(t);e=e||function(t){if(t)throw t};var n=o(t);if("object"===(void 0===n?"undefined":g(n))){var i=a(n),r=u.projections.get(i.projName);r?(s(this,i),s(this,r),this.init(),e(null,this)):e(t)}else e(t)}(u.projections=i).start(),e.exports=u},{"./deriveConstants":33,"./extend":34,"./parseCode":37,"./projections":39}],3:[function(t,e,n){e.exports=function(t,e,n){var i,r,o,s=n.x,a=n.y,u=n.z||0;for(o=0;o<3;o++)if(!e||2!==o||void 0!==n.z)switch(r=0===o?(i=s,"x"):1===o?(i=a,"y"):(i=u,"z"),t.axis[o]){case"e":n[r]=i;break;case"w":n[r]=-i;break;case"n":n[r]=i;break;case"s":n[r]=-i;break;case"u":void 0!==n[r]&&(n.z=i);break;case"d":void 0!==n[r]&&(n.z=-i);break;default:return null}return n}},{}],4:[function(t,e,n){var i=Math.PI/2,r=t("./sign");e.exports=function(t){return Math.abs(t)<i?t:t-r(t)*Math.PI}},{"./sign":21}],5:[function(t,e,n){var i=2*Math.PI,r=t("./sign");e.exports=function(t){return Math.abs(t)<=3.14159265359?t:t-r(t)*i}},{"./sign":21}],6:[function(t,e,n){e.exports=function(t){return 1<Math.abs(t)&&(t=1<t?1:-1),Math.asin(t)}},{}],7:[function(t,e,n){e.exports=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))}},{}],8:[function(t,e,n){e.exports=function(t){return.375*t*(1+.25*t*(1+.46875*t))}},{}],9:[function(t,e,n){e.exports=function(t){return.05859375*t*t*(1+.75*t)}},{}],10:[function(t,e,n){e.exports=function(t){return t*t*t*(35/3072)}},{}],11:[function(t,e,n){e.exports=function(t,e,n){var i=e*n;return t/Math.sqrt(1-i*i)}},{}],12:[function(t,e,n){e.exports=function(t,e,n,i,r){var o,s;o=t/e;for(var a=0;a<15;a++)if(s=(t-(e*o-n*Math.sin(2*o)+i*Math.sin(4*o)-r*Math.sin(6*o)))/(e-2*n*Math.cos(2*o)+4*i*Math.cos(4*o)-6*r*Math.cos(6*o)),o+=s,Math.abs(s)<=1e-10)return o;return NaN}},{}],13:[function(t,e,n){var l=Math.PI/2;e.exports=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return e<0?-1*l:l;for(var i,r,o,s,a=Math.asin(.5*e),u=0;u<30;u++)if(r=Math.sin(a),o=Math.cos(a),s=t*r,i=Math.pow(1-s*s,2)/(2*o)*(e/(1-t*t)-r/(1-s*s)+.5/t*Math.log((1-s)/(1+s))),a+=i,Math.abs(i)<=1e-10)return a;return NaN}},{}],14:[function(t,e,n){e.exports=function(t,e,n,i,r){return t*r-e*Math.sin(2*r)+n*Math.sin(4*r)-i*Math.sin(6*r)}},{}],15:[function(t,e,n){e.exports=function(t,e,n){var i=t*e;return n/Math.sqrt(1-i*i)}},{}],16:[function(t,e,n){var a=Math.PI/2;e.exports=function(t,e){for(var n,i,r=.5*t,o=a-2*Math.atan(e),s=0;s<=15;s++)if(n=t*Math.sin(o),i=a-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-o,o+=i,Math.abs(i)<=1e-10)return o;return-9999}},{}],17:[function(t,e,n){var i=.01068115234375;e.exports=function(t){var e=[];e[0]=1-t*(.25+t*(.046875+t*(.01953125+t*i))),e[1]=t*(.75-t*(.046875+t*(.01953125+t*i)));var n=t*t;return e[2]=n*(.46875-t*(.013020833333333334+.007120768229166667*t)),n*=t,e[3]=n*(.3645833333333333-.005696614583333333*t),e[4]=n*t*.3076171875,e}},{}],18:[function(t,e,n){var u=t("./pj_mlfn");e.exports=function(t,e,n){for(var i=1/(1-e),r=t,o=20;o;--o){var s=Math.sin(r),a=1-e*s*s;if(a=(u(r,s,Math.cos(r),n)-t)*(a*Math.sqrt(a))*i,r-=a,Math.abs(a)<1e-10)return r}return r}},{"./pj_mlfn":19}],19:[function(t,e,n){e.exports=function(t,e,n,i){return n*=e,e*=e,i[0]*t-n*(i[1]+e*(i[2]+e*(i[3]+e*i[4])))}},{}],20:[function(t,e,n){e.exports=function(t,e){var n;return 1e-7<t?(1-t*t)*(e/(1-(n=t*e)*n)-.5/t*Math.log((1-n)/(1+n))):2*e}},{}],21:[function(t,e,n){e.exports=function(t){return t<0?-1:1}},{}],22:[function(t,e,n){e.exports=function(t,e){return Math.pow((1-t)/(1+t),e)}},{}],23:[function(t,e,n){e.exports=function(t){var e={x:t[0],y:t[1]};return 2<t.length&&(e.z=t[2]),3<t.length&&(e.m=t[3]),e}},{}],24:[function(t,e,n){var o=Math.PI/2;e.exports=function(t,e,n){var i=t*n,r=.5*t;return i=Math.pow((1-i)/(1+i),r),Math.tan(.5*(o-e))/i}},{}],25:[function(t,e,n){n.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},n.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},n.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},n.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},n.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},n.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},n.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},n.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},n.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},n.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},n.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},n.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},n.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},n.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},n.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},n.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(t,e,n){n.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},n.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},n.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},n.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},n.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},n.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},n.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},n.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},n.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},n.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},n.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},n.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},n.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},n.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},n.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},n.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},n.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},n.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},n.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},n.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},n.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},n.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},n.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},n.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},n.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},n.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},n.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},n.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},n.hough={a:6378270,rf:297,ellipseName:"Hough"},n.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},n.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},n.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},n.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},n.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},n.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},n.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},n.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},n.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},n.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},n.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},n.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},n.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},n.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(t,e,n){n.greenwich=0,n.lisbon=-9.131906111111,n.paris=2.337229166667,n.bogota=-74.080916666667,n.madrid=-3.687938888889,n.rome=12.452333333333,n.bern=7.439583333333,n.jakarta=106.807719444444,n.ferro=-17.666666666667,n.brussels=4.367975,n.stockholm=18.058277777778,n.athens=23.7163375,n.oslo=10.722916666667},{}],28:[function(t,e,n){n.ft={to_meter:.3048},n["us-ft"]={to_meter:1200/3937}},{}],29:[function(t,e,n){var i=t("./Proj"),r=t("./transform"),o=i("WGS84");function s(t,e,n){var i;return Array.isArray(n)?(i=r(t,e,n),3===n.length?[i.x,i.y,i.z]:[i.x,i.y]):r(t,e,n)}function a(t){return t instanceof i?t:t.oProj?t.oProj:i(t)}e.exports=function(e,n,t){e=a(e);var i,r=!1;void 0===n?(n=e,e=o,r=!0):void 0===n.x&&!Array.isArray(n)||(t=n,n=e,e=o,r=!0);return n=a(n),t?s(e,n,t):(i={forward:function(t){return s(e,n,t)},inverse:function(t){return s(n,e,t)}},r&&(i.oProj=n),i)}},{"./Proj":2,"./transform":65}],30:[function(t,e,n){var x=Math.PI/2,i=484813681109536e-20,E=.3826834323650898,r=function t(e){if(!(this instanceof t))return new t(e);if(this.datum_type=4,e){if(e.datumCode&&"none"===e.datumCode&&(this.datum_type=5),e.datum_params){for(var n=0;n<e.datum_params.length;n++)e.datum_params[n]=parseFloat(e.datum_params[n]);0===e.datum_params[0]&&0===e.datum_params[1]&&0===e.datum_params[2]||(this.datum_type=1),3<e.datum_params.length&&(0===e.datum_params[3]&&0===e.datum_params[4]&&0===e.datum_params[5]&&0===e.datum_params[6]||(this.datum_type=2,e.datum_params[3]*=i,e.datum_params[4]*=i,e.datum_params[5]*=i,e.datum_params[6]=e.datum_params[6]/1e6+1))}this.datum_type=e.grids?3:this.datum_type,this.a=e.a,this.b=e.b,this.es=e.es,this.ep2=e.ep2,this.datum_params=e.datum_params,3===this.datum_type&&(this.grids=e.grids)}};r.prototype={compare_datums:function(t){return this.datum_type===t.datum_type&&(!(this.a!==t.a||5e-11<Math.abs(this.es-t.es))&&(1===this.datum_type?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]:2===this.datum_type?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]&&this.datum_params[3]===t.datum_params[3]&&this.datum_params[4]===t.datum_params[4]&&this.datum_params[5]===t.datum_params[5]&&this.datum_params[6]===t.datum_params[6]:3!==this.datum_type&&3!==t.datum_type||this.nadgrids===t.nadgrids))},geodetic_to_geocentric:function(t){var e,n,i,r,o,s,a,u=t.x,l=t.y,h=t.z?t.z:0;if(l<-x&&-1.001*x<l)l=-x;else if(x<l&&l<1.001*x)l=x;else if(l<-x||x<l)return null;return u>Math.PI&&(u-=2*Math.PI),o=Math.sin(l),a=Math.cos(l),s=o*o,r=this.a/Math.sqrt(1-this.es*s),e=(r+h)*a*Math.cos(u),n=(r+h)*a*Math.sin(u),i=(r*(1-this.es)+h)*o,t.x=e,t.y=n,t.z=i,0},geocentric_to_geodetic:function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_=t.x,m=t.y,v=t.z?t.z:0;if(e=Math.sqrt(_*_+m*m),n=Math.sqrt(_*_+m*m+v*v),e/this.a<1e-12){if(d=0,n/this.a<1e-12)return g=x,void(y=-this.b)}else d=Math.atan2(m,_);for(i=v/n,r=e/n,o=1/Math.sqrt(1-this.es*(2-this.es)*r*r),u=r*(1-this.es)*o,l=i*o,f=0;f++,a=this.a/Math.sqrt(1-this.es*l*l),y=e*u+v*l-a*(1-this.es*l*l),s=this.es*a/(a+y),o=1/Math.sqrt(1-s*(2-s)*r*r),p=(c=i*o)*u-(h=r*(1-s)*o)*l,u=h,l=c,1e-24<p*p&&f<30;);return g=Math.atan(c/Math.abs(h)),t.x=d,t.y=g,t.z=y,t},geocentric_to_geodetic_noniter:function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m=t.x,v=t.y,b=t.z?t.z:0;if(m=parseFloat(m),v=parseFloat(v),b=parseFloat(b),_=!1,0!==m)e=Math.atan2(v,m);else if(0<v)e=x;else if(v<0)e=-x;else if(_=!0,(e=0)<b)n=x;else{if(!(b<0))return n=x,void(i=-this.b);n=-x}return o=m*m+v*v,r=Math.sqrt(o),s=1.0026*b,u=Math.sqrt(s*s+o),p=r/u,c=(h=s/u)*h*h,a=b+this.b*this.ep2*c,y=r-this.a*this.es*p*p*p,l=Math.sqrt(a*a+y*y),f=a/l,d=y/l,g=this.a/Math.sqrt(1-this.es*f*f),i=E<=d?r/d-g:d<=-E?r/-d-g:b/f+g*(this.es-1),!1===_&&(n=Math.atan(f/d)),t.x=e,t.y=n,t.z=i,t},geocentric_to_wgs84:function(t){if(1===this.datum_type)t.x+=this.datum_params[0],t.y+=this.datum_params[1],t.z+=this.datum_params[2];else if(2===this.datum_type){var e=this.datum_params[0],n=this.datum_params[1],i=this.datum_params[2],r=this.datum_params[3],o=this.datum_params[4],s=this.datum_params[5],a=this.datum_params[6],u=a*(t.x-s*t.y+o*t.z)+e,l=a*(s*t.x+t.y-r*t.z)+n,h=a*(-o*t.x+r*t.y+t.z)+i;t.x=u,t.y=l,t.z=h}},geocentric_from_wgs84:function(t){if(1===this.datum_type)t.x-=this.datum_params[0],t.y-=this.datum_params[1],t.z-=this.datum_params[2];else if(2===this.datum_type){var e=this.datum_params[0],n=this.datum_params[1],i=this.datum_params[2],r=this.datum_params[3],o=this.datum_params[4],s=this.datum_params[5],a=this.datum_params[6],u=(t.x-e)/a,l=(t.y-n)/a,h=(t.z-i)/a;t.x=u+s*l-o*h,t.y=-s*u+l+r*h,t.z=o*u-r*l+h}}},e.exports=r},{}],31:[function(t,e,n){var p=.006694379990141316;e.exports=function(t,e,n){var i,r,o;function s(t){return 1===t||2===t}if(t.compare_datums(e))return n;if(5===t.datum_type||5===e.datum_type)return n;var a=t.a,u=t.es,l=e.a,h=e.es,c=t.datum_type;if(3===c)if(0===this.apply_gridshift(t,0,n))t.a=6378137,t.es=p;else{if(!t.datum_params)return t.a=a,t.es=t.es,n;for(i=1,r=0,o=t.datum_params.length;r<o;r++)i*=t.datum_params[r];if(0===i)return t.a=a,t.es=t.es,n;c=3<t.datum_params.length?2:1}return 3===e.datum_type&&(e.a=6378137,e.es=p),(t.es!==e.es||t.a!==e.a||s(c)||s(e.datum_type))&&(t.geodetic_to_geocentric(n),s(t.datum_type)&&t.geocentric_to_wgs84(n),s(e.datum_type)&&e.geocentric_from_wgs84(n),e.geocentric_to_geodetic(n)),3===e.datum_type&&this.apply_gridshift(e,1,n),t.a=a,t.es=u,e.a=l,e.es=h,n}},{}],32:[function(t,e,n){var i=t("./global"),r=t("./projString"),o=t("./wkt");function s(t){var e=this;if(2===arguments.length){var n=arguments[1];"string"==typeof n?"+"===n.charAt(0)?s[t]=r(arguments[1]):s[t]=o(arguments[1]):s[t]=n}else if(1===arguments.length){if(Array.isArray(t))return t.map(function(t){Array.isArray(t)?s.apply(e,t):s(t)});if("string"==typeof t){if(t in s)return s[t]}else"EPSG"in t?s["EPSG:"+t.EPSG]=t:"ESRI"in t?s["ESRI:"+t.ESRI]=t:"IAU2000"in t?s["IAU2000:"+t.IAU2000]=t:console.log(t);return}}i(s),e.exports=s},{"./global":35,"./projString":38,"./wkt":66}],33:[function(t,e,n){var i=t("./constants/Datum"),r=t("./constants/Ellipsoid"),o=t("./extend"),s=t("./datum");e.exports=function(t){if(t.datumCode&&"none"!==t.datumCode){var e=i[t.datumCode];e&&(t.datum_params=e.towgs84?e.towgs84.split(","):null,t.ellps=e.ellipse,t.datumName=e.datumName?e.datumName:t.datumCode)}if(!t.a){var n=r[t.ellps]?r[t.ellps]:r.WGS84;o(t,n)}return t.rf&&!t.b&&(t.b=(1-1/t.rf)*t.a),(0===t.rf||Math.abs(t.a-t.b)<1e-10)&&(t.sphere=!0,t.b=t.a),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=(t.a2-t.b2)/t.a2,t.e=Math.sqrt(t.es),t.R_A&&(t.a*=1-t.es*(.16666666666666666+t.es*(.04722222222222222+.022156084656084655*t.es)),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=0),t.ep2=(t.a2-t.b2)/t.b2,t.k0||(t.k0=1),t.axis||(t.axis="enu"),t.datum||(t.datum=s(t)),t}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":30,"./extend":34}],34:[function(t,e,n){e.exports=function(t,e){var n,i;if(t=t||{},!e)return t;for(i in e)void 0!==(n=e[i])&&(t[i]=n);return t}},{}],35:[function(t,e,n){e.exports=function(t){t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t.WGS84=t["EPSG:4326"],t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}},{}],36:[function(t,e,n){var i=t("./core");i.defaultDatum="WGS84",i.Proj=t("./Proj"),i.WGS84=new i.Proj("WGS84"),i.Point=t("./Point"),i.toPoint=t("./common/toPoint"),i.defs=t("./defs"),i.transform=t("./transform"),i.mgrs=t("mgrs"),i.version=t("../package.json").version,t("./includedProjections")(i),e.exports=i},{"../package.json":68,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":29,"./defs":32,"./includedProjections":"hTEDpn","./transform":65,mgrs:67}],37:[function(t,e,n){var i=t("./defs"),r=t("./wkt"),o=t("./projString");e.exports=function(t){{if("string"!=typeof t)return t;if(t in i)return i[t];if(n=t,["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"].reduce(function(t,e){return t+1+n.indexOf(e)},0))return r(t);if("+"===t[0])return o(t)}var n}},{"./defs":32,"./projString":38,"./wkt":66}],38:[function(t,e,n){var a=.017453292519943295,u=t("./constants/PrimeMeridian"),l=t("./constants/units");e.exports=function(t){var e,n,i,r={},o={};t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).forEach(function(t){var e=t.split("=");e.push(!0),o[e[0].toLowerCase()]=e[1]});var s={proj:"projName",datum:"datumCode",rf:function(t){r.rf=parseFloat(t)},lat_0:function(t){r.lat0=t*a},lat_1:function(t){r.lat1=t*a},lat_2:function(t){r.lat2=t*a},lat_ts:function(t){r.lat_ts=t*a},lon_0:function(t){r.long0=t*a},lon_1:function(t){r.long1=t*a},lon_2:function(t){r.long2=t*a},alpha:function(t){r.alpha=parseFloat(t)*a},lonc:function(t){r.longc=t*a},x_0:function(t){r.x0=parseFloat(t)},y_0:function(t){r.y0=parseFloat(t)},k_0:function(t){r.k0=parseFloat(t)},k:function(t){r.k0=parseFloat(t)},a:function(t){r.a=parseFloat(t)},b:function(t){r.b=parseFloat(t)},r_a:function(){r.R_A=!0},zone:function(t){r.zone=parseInt(t,10)},south:function(){r.utmSouth=!0},towgs84:function(t){r.datum_params=t.split(",").map(function(t){return parseFloat(t)})},to_meter:function(t){r.to_meter=parseFloat(t)},units:function(t){r.units=t,l[t]&&(r.to_meter=l[t].to_meter)},from_greenwich:function(t){r.from_greenwich=t*a},pm:function(t){r.from_greenwich=(u[t]?u[t]:parseFloat(t))*a},nadgrids:function(t){"@null"===t?r.datumCode="none":r.nadgrids=t},axis:function(t){var e="ewnsud";3===t.length&&-1!==e.indexOf(t.substr(0,1))&&-1!==e.indexOf(t.substr(1,1))&&-1!==e.indexOf(t.substr(2,1))&&(r.axis=t)}};for(e in o)n=o[e],e in s?"function"==typeof(i=s[e])?i(n):r[i]=n:r[e]=n;return"string"==typeof r.datumCode&&"WGS84"!==r.datumCode&&(r.datumCode=r.datumCode.toLowerCase()),r}},{"./constants/PrimeMeridian":27,"./constants/units":28}],39:[function(t,e,n){var i=[t("./projections/merc"),t("./projections/longlat")],r={},o=[];function s(t,e){var n=o.length;return t.names?((o[n]=t).names.forEach(function(t){r[t.toLowerCase()]=n}),this):(console.log(e),!0)}n.add=s,n.get=function(t){if(!t)return!1;var e=t.toLowerCase();return void 0!==r[e]&&o[r[e]]?o[r[e]]:void 0},n.start=function(){i.forEach(s)}},{"./projections/longlat":51,"./projections/merc":52}],40:[function(t,e,n){var i=t("../common/msfnz"),u=t("../common/qsfnz"),l=t("../common/adjust_lon"),h=t("../common/asinz");n.init=function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=i(this.e3,this.sin_po,this.cos_po),this.qs1=u(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=i(this.e3,this.sin_po,this.cos_po),this.qs2=u(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=u(this.e3,this.sin_po,this.cos_po),1e-10<Math.abs(this.lat1-this.lat2)?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},n.forward=function(t){var e=t.x,n=t.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var i=u(this.e3,this.sin_phi,this.cos_phi),r=this.a*Math.sqrt(this.c-this.ns0*i)/this.ns0,o=this.ns0*l(e-this.long0),s=r*Math.sin(o)+this.x0,a=this.rh-r*Math.cos(o)+this.y0;return t.x=s,t.y=a,t},n.inverse=function(t){var e,n,i,r,o,s;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,i=0<=this.ns0?(e=Math.sqrt(t.x*t.x+t.y*t.y),1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),-1),(r=0)!==e&&(r=Math.atan2(i*t.x,i*t.y)),i=e*this.ns0/this.a,s=this.sphere?Math.asin((this.c-i*i)/(2*this.ns0)):(n=(this.c-i*i)/this.ns0,this.phi1z(this.e3,n)),o=l(r/this.ns0+this.long0),t.x=o,t.y=s,t},n.phi1z=function(t,e){var n,i,r,o,s,a=h(.5*e);if(t<1e-10)return a;for(var u=t*t,l=1;l<=25;l++)if(n=Math.sin(a),i=Math.cos(a),s=.5*(o=1-(r=t*n)*r)*o/i*(e/(1-u)-n/o+.5/t*Math.log((1-r)/(1+r))),a+=s,Math.abs(s)<=1e-7)return a;return null},n.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],41:[function(t,e,n){var C=t("../common/adjust_lon"),P=Math.PI/2,N=1e-10,O=t("../common/mlfn"),T=t("../common/e0fn"),k=t("../common/e1fn"),R=t("../common/e2fn"),D=t("../common/e3fn"),A=t("../common/gN"),I=t("../common/asinz"),L=t("../common/imlfn");n.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},n.forward=function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m,v,b,x,E,I=t.x,L=t.y,w=Math.sin(t.y),S=Math.cos(t.y),M=C(I-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=N?(t.x=this.x0+this.a*(P-L)*Math.sin(M),t.y=this.y0-this.a*(P-L)*Math.cos(M)):Math.abs(this.sin_p12+1)<=N?(t.x=this.x0+this.a*(P+L)*Math.sin(M),t.y=this.y0+this.a*(P+L)*Math.cos(M)):(m=this.sin_p12*w+this.cos_p12*S*Math.cos(M),y=Math.acos(m),_=y/Math.sin(y),t.x=this.x0+this.a*_*S*Math.sin(M),t.y=this.y0+this.a*_*(this.cos_p12*w-this.sin_p12*S*Math.cos(M))):(e=T(this.es),n=k(this.es),i=R(this.es),r=D(this.es),Math.abs(this.sin_p12-1)<=N?(o=this.a*O(e,n,i,r,P),s=this.a*O(e,n,i,r,L),t.x=this.x0+(o-s)*Math.sin(M),t.y=this.y0-(o-s)*Math.cos(M)):Math.abs(this.sin_p12+1)<=N?(o=this.a*O(e,n,i,r,P),s=this.a*O(e,n,i,r,L),t.x=this.x0+(o+s)*Math.sin(M),t.y=this.y0+(o+s)*Math.cos(M)):(a=w/S,u=A(this.a,this.e,this.sin_p12),l=A(this.a,this.e,w),h=Math.atan((1-this.es)*a+this.es*u*this.sin_p12/(l*S)),c=Math.atan2(Math.sin(M),this.cos_p12*Math.tan(h)-this.sin_p12*Math.cos(M)),v=0===c?Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.abs(Math.abs(c)-Math.PI)<=N?-Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.asin(Math.sin(M)*Math.cos(h)/Math.sin(c)),p=this.e*this.sin_p12/Math.sqrt(1-this.es),f=this.e*this.cos_p12*Math.cos(c)/Math.sqrt(1-this.es),y=u*v*(1-(b=v*v)*(g=f*f)*(1-g)/6+(x=b*v)/8*(d=p*f)*(1-2*g)+(E=x*v)/120*(g*(4-7*g)-3*p*p*(1-7*g))-E*v/48*d),t.x=this.x0+y*Math.sin(c),t.y=this.y0+y*Math.cos(c))),t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_,m,v,b,x,E;if(t.x-=this.x0,t.y-=this.y0,this.sphere){if((e=Math.sqrt(t.x*t.x+t.y*t.y))>2*P*this.a)return;return n=e/this.a,i=Math.sin(n),r=Math.cos(n),o=this.long0,Math.abs(e)<=N?s=this.lat0:(s=I(r*this.sin_p12+t.y*i*this.cos_p12/e),a=Math.abs(this.lat0)-P,o=Math.abs(a)<=N?0<=this.lat0?C(this.long0+Math.atan2(t.x,-t.y)):C(this.long0-Math.atan2(-t.x,t.y)):C(this.long0+Math.atan2(t.x*i,e*this.cos_p12*r-t.y*this.sin_p12*i))),t.x=o,t.y=s,t}return u=T(this.es),l=k(this.es),h=R(this.es),c=D(this.es),Math.abs(this.sin_p12-1)<=N?(p=this.a*O(u,l,h,c,P),e=Math.sqrt(t.x*t.x+t.y*t.y),s=L((p-e)/this.a,u,l,h,c),o=C(this.long0+Math.atan2(t.x,-1*t.y))):Math.abs(this.sin_p12+1)<=N?(p=this.a*O(u,l,h,c,P),e=Math.sqrt(t.x*t.x+t.y*t.y),s=L((e-p)/this.a,u,l,h,c),o=C(this.long0+Math.atan2(t.x,t.y))):(e=Math.sqrt(t.x*t.x+t.y*t.y),g=Math.atan2(t.x,t.y),f=A(this.a,this.e,this.sin_p12),y=Math.cos(g),_=this.e*this.cos_p12*y,m=-_*_/(1-this.es),v=3*this.es*(1-m)*this.sin_p12*this.cos_p12*y/(1-this.es),x=(b=e/f)-m*(1+m)*Math.pow(b,3)/6-v*(1+3*m)*Math.pow(b,4)/24,E=1-m*x*x/2-b*x*x*x/6,d=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*y),o=C(this.long0+Math.asin(Math.sin(g)*Math.sin(x)/Math.cos(d))),s=Math.atan((1-this.es*E*this.sin_p12/Math.sin(d))*Math.tan(d)/(1-this.es))),t.x=o,t.y=s,t},n.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(t,e,n){var f=t("../common/mlfn"),i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),d=t("../common/gN"),g=t("../common/adjust_lon"),y=t("../common/adjust_lat"),_=t("../common/imlfn"),m=Math.PI/2;n.init=function(){this.sphere||(this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.ml0=this.a*f(this.e0,this.e1,this.e2,this.e3,this.lat0))},n.forward=function(t){var e,n,i=t.x,r=t.y;if(i=g(i-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(i)),n=this.a*(Math.atan2(Math.tan(r),Math.cos(i))-this.lat0);else{var o=Math.sin(r),s=Math.cos(r),a=d(this.a,this.e,o),u=Math.tan(r)*Math.tan(r),l=i*Math.cos(r),h=l*l,c=this.es*s*s/(1-this.es),p=this.a*f(this.e0,this.e1,this.e2,this.e3,r);e=a*l*(1-h*u*(1/6-(8-u+8*c)*h/120)),n=p-this.ml0+a*o/s*h*(.5+(5-u+6*c)*h/24)}return t.x=e+this.x0,t.y=n+this.y0,t},n.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i=t.x/this.a,r=t.y/this.a;if(this.sphere){var o=r+this.lat0;e=Math.asin(Math.sin(o)*Math.cos(i)),n=Math.atan2(Math.tan(i),Math.cos(o))}else{var s=this.ml0/this.a+r,a=_(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-m)<=1e-10)return t.x=this.long0,t.y=m,r<0&&(t.y*=-1),t;var u=d(this.a,this.e,Math.sin(a)),l=u*u*u/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(a),2),c=i*this.a/u,p=c*c;e=a-u*Math.tan(a)/l*c*c*(.5-(1+3*h)*c*c/24),n=c*(1-p*(h/3+(1+3*h)*h*p/15))/Math.cos(a)}return t.x=g(n+this.long0),t.y=y(e),t},n.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],43:[function(t,e,n){var a=t("../common/adjust_lon"),u=t("../common/qsfnz"),i=t("../common/msfnz"),r=t("../common/iqsfnz");n.init=function(){this.sphere||(this.k0=i(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},n.forward=function(t){var e,n,i=t.x,r=t.y,o=a(i-this.long0);if(this.sphere)e=this.x0+this.a*o*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(r)/Math.cos(this.lat_ts);else{var s=u(this.e,Math.sin(r));e=this.x0+this.a*this.k0*o,n=this.y0+this.a*s*.5/this.k0}return t.x=e,t.y=n,t},n.inverse=function(t){var e,n;return t.x-=this.x0,t.y-=this.y0,this.sphere?(e=a(this.long0+t.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(n=r(this.e,2*t.y*this.k0/this.a),e=a(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=n,t},n.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],44:[function(t,e,n){var o=t("../common/adjust_lon"),s=t("../common/adjust_lat");n.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},n.forward=function(t){var e=t.x,n=t.y,i=o(e-this.long0),r=s(n-this.lat0);return t.x=this.x0+this.a*i*this.rc,t.y=this.y0+this.a*r,t},n.inverse=function(t){var e=t.x,n=t.y;return t.x=o(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=s(this.lat0+(n-this.y0)/this.a),t},n.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],45:[function(t,e,n){var i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),a=t("../common/msfnz"),u=t("../common/mlfn"),l=t("../common/adjust_lon"),h=t("../common/adjust_lat"),c=t("../common/imlfn");n.init=function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=a(this.e,this.sinphi,this.cosphi),this.ml1=u(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<1e-10?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=a(this.e,this.sinphi,this.cosphi),this.ml2=u(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=u(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},n.forward=function(t){var e,n=t.x,i=t.y;if(this.sphere)e=this.a*(this.g-i);else{var r=u(this.e0,this.e1,this.e2,this.e3,i);e=this.a*(this.g-r)}var o=this.ns*l(n-this.long0),s=this.x0+e*Math.sin(o),a=this.y0+this.rh-e*Math.cos(o);return t.x=s,t.y=a,t},n.inverse=function(t){var e,n,i,r;t.x-=this.x0,t.y=this.rh-t.y+this.y0,e=0<=this.ns?(n=Math.sqrt(t.x*t.x+t.y*t.y),1):(n=-Math.sqrt(t.x*t.x+t.y*t.y),-1);var o=0;if(0!==n&&(o=Math.atan2(e*t.x,e*t.y)),this.sphere)return r=l(this.long0+o/this.ns),i=h(this.g-n/this.a),t.x=r,t.y=i,t;var s=this.g-n/this.a;return i=c(s,this.e0,this.e1,this.e2,this.e3),r=l(this.long0+o/this.ns),t.x=r,t.y=i,t},n.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],46:[function(t,e,n){var o=Math.PI/4,s=t("../common/srat"),a=Math.PI/2;n.init=function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+o)/(Math.pow(Math.tan(.5*this.lat0+o),this.C)*s(this.e*t,this.ratexp))},n.forward=function(t){var e=t.x,n=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+o),this.C)*s(this.e*Math.sin(n),this.ratexp))-a,t.x=this.C*e,t},n.inverse=function(t){for(var e=t.x/this.C,n=t.y,i=Math.pow(Math.tan(.5*n+o)/this.K,1/this.C),r=20;0<r&&(n=2*Math.atan(i*s(this.e*Math.sin(t.y),-.5*this.e))-a,!(Math.abs(n-t.y)<1e-14));--r)t.y=n;return r?(t.x=e,t.y=n,t):null},n.names=["gauss"]},{"../common/srat":22}],47:[function(t,e,n){var h=t("../common/adjust_lon"),a=t("../common/asinz");n.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},n.forward=function(t){var e,n,i,r,o,s,a,u=t.x,l=t.y;return i=h(u-this.long0),e=Math.sin(l),n=Math.cos(l),r=Math.cos(i),o=this.sin_p14*e+this.cos_p14*n*r,a=0<o||Math.abs(o)<=1e-10?(s=this.x0+1*this.a*n*Math.sin(i)/o,this.y0+1*this.a*(this.cos_p14*e-this.sin_p14*n*r)/o):(s=this.x0+this.infinity_dist*n*Math.sin(i),this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*n*r)),t.x=s,t.y=a,t},n.inverse=function(t){var e,n,i,r,o,s;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=(e=Math.sqrt(t.x*t.x+t.y*t.y))?(r=Math.atan2(e,this.rc),n=Math.sin(r),i=Math.cos(r),s=a(i*this.sin_p14+t.y*n*this.cos_p14/e),o=Math.atan2(t.x*n,e*this.cos_p14*i-t.y*this.sin_p14*n),h(this.long0+o)):(s=this.phic0,0),t.x=o,t.y=s,t},n.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],48:[function(t,e,n){var c=t("../common/adjust_lon");n.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},n.forward=function(t){var e,n,i,r,o,s,a,u=t.x,l=t.y,h=c(u-this.long0);return e=Math.pow((1+this.e*Math.sin(l))/(1-this.e*Math.sin(l)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(l/2+this.s45),this.alfa)/e)-this.s45),i=-h*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(i)),o=Math.asin(Math.cos(n)*Math.sin(i)/Math.cos(r)),s=this.n*o,a=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=a*Math.cos(s)/1,t.x=a*Math.sin(s)/1,this.czech||(t.y*=-1,t.x*=-1),t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l=t.x;t.x=t.y,t.y=l,this.czech||(t.y*=-1,t.x*=-1),s=Math.sqrt(t.x*t.x+t.y*t.y),o=Math.atan2(t.y,t.x),r=o/Math.sin(this.s0),i=2*(Math.atan(Math.pow(this.ro0/s,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(i)-Math.sin(this.ad)*Math.cos(i)*Math.cos(r)),n=Math.asin(Math.cos(i)*Math.sin(r)/Math.cos(e)),t.x=this.long0-n/this.alfa,a=e;for(var h=u=0;t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(u=1),a=t.y,h+=1,0===u&&h<15;);return 15<=h?null:t},n.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],49:[function(t,e,n){var f=Math.PI/2,d=Math.PI/4,g=1e-10,y=t("../common/qsfnz"),_=t("../common/adjust_lon");n.S_POLE=1,n.N_POLE=2,n.EQUIT=3,n.OBLIQ=4,n.init=function(){var t,e=Math.abs(this.lat0);if(Math.abs(e-f)<g?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(e)<g?this.mode=this.EQUIT:this.mode=this.OBLIQ,0<this.es)switch(this.qp=y(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=y(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},n.forward=function(t){var e,n,i,r,o,s,a,u,l,h,c=t.x,p=t.y;if(c=_(c-this.long0),this.sphere){if(o=Math.sin(p),h=Math.cos(p),i=Math.cos(c),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+h*i:1+this.sinph0*o+this.cosph0*h*i)<=g)return null;n=Math.sqrt(2/n),e=n*h*Math.sin(c),n*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*h*i}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(i=-i),Math.abs(p+this.phi0)<g)return null;n=d-.5*p,n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)),e=n*Math.sin(c),n*=i}}else{switch(l=u=a=0,i=Math.cos(c),r=Math.sin(c),o=Math.sin(p),s=y(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(a=s/this.qp,u=Math.sqrt(1-a*a)),this.mode){case this.OBLIQ:l=1+this.sinb1*a+this.cosb1*u*i;break;case this.EQUIT:l=1+u*i;break;case this.N_POLE:l=f+p,s=this.qp-s;break;case this.S_POLE:l=p-f,s=this.qp+s}if(Math.abs(l)<g)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:l=Math.sqrt(2/l),n=this.mode===this.OBLIQ?this.ymf*l*(this.cosb1*a-this.sinb1*u*i):(l=Math.sqrt(2/(1+u*i)))*a*this.ymf,e=this.xmf*l*u*r;break;case this.N_POLE:case this.S_POLE:0<=s?(e=(l=Math.sqrt(s))*r,n=i*(this.mode===this.S_POLE?l:-l)):e=n=0}}return t.x=this.a*e+this.x0,t.y=this.a*n+this.y0,t},n.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,n,i,r,o,s,a,u=t.x/this.a,l=t.y/this.a;if(this.sphere){var h,c=0,p=0;if(h=Math.sqrt(u*u+l*l),1<(n=.5*h))return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(p=Math.sin(n),c=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(h)<=g?0:Math.asin(l*p/h),u*=p,l=c*h;break;case this.OBLIQ:n=Math.abs(h)<=g?this.phi0:Math.asin(c*this.sinph0+l*p*this.cosph0/h),u*=p*this.cosph0,l=(c-Math.sin(n)*this.sinph0)*h;break;case this.N_POLE:l=-l,n=f-n;break;case this.S_POLE:n-=f}e=0!==l||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(u,l):0}else{if(a=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(u/=this.dd,l*=this.dd,(s=Math.sqrt(u*u+l*l))<g)return t.x=0,t.y=this.phi0,t;r=2*Math.asin(.5*s/this.rq),i=Math.cos(r),u*=r=Math.sin(r),l=this.mode===this.OBLIQ?(a=i*this.sinb1+l*r*this.cosb1/s,o=this.qp*a,s*this.cosb1*i-l*this.sinb1*r):(a=l*r/s,o=this.qp*a,s*i)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),!(o=u*u+l*l))return t.x=0,t.y=this.phi0,t;a=1-o/this.qp,this.mode===this.S_POLE&&(a=-a)}e=Math.atan2(u,l),n=this.authlat(Math.asin(a),this.apa)}return t.x=_(this.long0+e),t.y=n,t},n.P00=.3333333333333333,n.P01=.17222222222222222,n.P02=.10257936507936508,n.P10=.06388888888888888,n.P11=.0664021164021164,n.P20=.016415012942191543,n.authset=function(t){var e,n=[];return n[0]=t*this.P00,e=t*t,n[0]+=e*this.P01,n[1]=e*this.P10,e*=t,n[0]+=e*this.P02,n[1]+=e*this.P11,n[2]=e*this.P20,n},n.authlat=function(t,e){var n=t+t;return t+e[0]*Math.sin(n)+e[1]*Math.sin(n+n)+e[2]*Math.sin(n+n+n)},n.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],50:[function(t,e,n){var h=t("../common/msfnz"),c=t("../common/tsfnz"),l=Math.PI/2,a=t("../common/sign"),p=t("../common/adjust_lon"),f=t("../common/phi2z");n.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<1e-10)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),n=Math.cos(this.lat1),i=h(this.e,e,n),r=c(this.e,this.lat1,e),o=Math.sin(this.lat2),s=Math.cos(this.lat2),a=h(this.e,o,s),u=c(this.e,this.lat2,o),l=c(this.e,this.lat0,Math.sin(this.lat0));1e-10<Math.abs(this.lat1-this.lat2)?this.ns=Math.log(i/a)/Math.log(r/u):this.ns=e,isNaN(this.ns)&&(this.ns=e),this.f0=i/(this.ns*Math.pow(r,this.ns)),this.rh=this.a*this.f0*Math.pow(l,this.ns),this.title||(this.title="Lambert Conformal Conic")}},n.forward=function(t){var e=t.x,n=t.y;Math.abs(2*Math.abs(n)-Math.PI)<=1e-10&&(n=a(n)*(l-2e-10));var i,r,o=Math.abs(Math.abs(n)-l);if(1e-10<o)i=c(this.e,n,Math.sin(n)),r=this.a*this.f0*Math.pow(i,this.ns);else{if((o=n*this.ns)<=0)return null;r=0}var s=this.ns*p(e-this.long0);return t.x=this.k0*(r*Math.sin(s))+this.x0,t.y=this.k0*(this.rh-r*Math.cos(s))+this.y0,t},n.inverse=function(t){var e,n,i,r,o,s=(t.x-this.x0)/this.k0,a=this.rh-(t.y-this.y0)/this.k0;n=0<this.ns?(e=Math.sqrt(s*s+a*a),1):(e=-Math.sqrt(s*s+a*a),-1);var u=0;if(0!==e&&(u=Math.atan2(n*s,n*a)),0!==e||0<this.ns){if(n=1/this.ns,i=Math.pow(e/(this.a*this.f0),n),-9999===(r=f(this.e,i)))return null}else r=-l;return o=p(u/this.ns+this.long0),t.x=o,t.y=r,t},n.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],51:[function(t,e,n){function i(t){return t}n.init=function(){},n.forward=i,n.inverse=i,n.names=["longlat","identity"]},{}],52:[function(t,e,n){var i=t("../common/msfnz"),a=Math.PI/2,u=57.29577951308232,l=t("../common/adjust_lon"),h=Math.PI/4,c=t("../common/tsfnz"),s=t("../common/phi2z");n.init=function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=i(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},n.forward=function(t){var e,n,i=t.x,r=t.y;if(90<r*u&&r*u<-90&&180<i*u&&i*u<-180)return null;if(Math.abs(Math.abs(r)-a)<=1e-10)return null;if(this.sphere)e=this.x0+this.a*this.k0*l(i-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(h+.5*r));else{var o=Math.sin(r),s=c(this.e,r,o);e=this.x0+this.a*this.k0*l(i-this.long0),n=this.y0-this.a*this.k0*Math.log(s)}return t.x=e,t.y=n,t},n.inverse=function(t){var e,n,i=t.x-this.x0,r=t.y-this.y0;if(this.sphere)n=a-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(-9999===(n=s(this.e,o)))return null}return e=l(this.long0+i/(this.a*this.k0)),t.x=e,t.y=n,t},n.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],53:[function(t,e,n){var s=t("../common/adjust_lon");n.init=function(){},n.forward=function(t){var e=t.x,n=t.y,i=s(e-this.long0),r=this.x0+this.a*i,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return t.x=r,t.y=o,t},n.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e=s(this.long0+t.x/this.a),n=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=n,t},n.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],54:[function(t,e,n){var l=t("../common/adjust_lon");n.init=function(){},n.forward=function(t){for(var e=t.x,n=t.y,i=l(e-this.long0),r=n,o=Math.PI*Math.sin(n);;0){var s=-(r+Math.sin(r)-o)/(1+Math.cos(r));if(r+=s,Math.abs(s)<1e-10)break}r/=2,Math.PI/2-Math.abs(n)<1e-10&&(i=0);var a=.900316316158*this.a*i*Math.cos(r)+this.x0,u=1.4142135623731*this.a*Math.sin(r)+this.y0;return t.x=a,t.y=u,t},n.inverse=function(t){var e,n;t.x-=this.x0,t.y-=this.y0,n=t.y/(1.4142135623731*this.a),.999999999999<Math.abs(n)&&(n=.999999999999),e=Math.asin(n);var i=l(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));i<-Math.PI&&(i=-Math.PI),i>Math.PI&&(i=Math.PI),n=(2*e+Math.sin(2*e))/Math.PI,1<Math.abs(n)&&(n=1);var r=Math.asin(n);return t.x=i,t.y=r,t},n.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],55:[function(t,e,n){var C=484813681109536e-20;n.iterations=1,n.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},n.forward=function(t){var e,n=t.x,i=t.y,r=i-this.lat0,o=n-this.long0,s=r/C*1e-5,a=o,u=1,l=0;for(e=1;e<=10;e++)u*=s,l+=this.A[e]*u;var h,c=l,p=a,f=1,d=0,g=0,y=0;for(e=1;e<=6;e++)h=d*c+f*p,f=f*c-d*p,d=h,g=g+this.B_re[e]*f-this.B_im[e]*d,y=y+this.B_im[e]*f+this.B_re[e]*d;return t.x=y*this.a+this.x0,t.y=g*this.a+this.y0,t},n.inverse=function(t){var e,n,i=t.x,r=t.y,o=i-this.x0,s=r-this.y0,a=s/this.a,u=o/this.a,l=1,h=0,c=0,p=0;for(e=1;e<=6;e++)n=h*a+l*u,l=l*a-h*u,h=n,c=c+this.C_re[e]*l-this.C_im[e]*h,p=p+this.C_im[e]*l+this.C_re[e]*h;for(var f=0;f<this.iterations;f++){var d,g=c,y=p,_=a,m=u;for(e=2;e<=6;e++)d=y*c+g*p,g=g*c-y*p,y=d,_+=(e-1)*(this.B_re[e]*g-this.B_im[e]*y),m+=(e-1)*(this.B_im[e]*g+this.B_re[e]*y);g=1,y=0;var v=this.B_re[1],b=this.B_im[1];for(e=2;e<=6;e++)d=y*c+g*p,g=g*c-y*p,y=d,v+=e*(this.B_re[e]*g-this.B_im[e]*y),b+=e*(this.B_im[e]*g+this.B_re[e]*y);var x=v*v+b*b;c=(_*v+m*b)/x,p=(m*v-_*b)/x}var E=c,I=p,L=1,w=0;for(e=1;e<=9;e++)L*=E,w+=this.D[e]*L;var S=this.lat0+w*C*1e5,M=this.long0+I;return t.x=M,t.y=S,t},n.names=["New_Zealand_Map_Grid","nzmg"]},{}],56:[function(t,e,n){var g=t("../common/tsfnz"),y=t("../common/adjust_lon"),l=t("../common/phi2z"),f=Math.PI/2,d=Math.PI/4;n.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),n=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var i,r,o=g(this.e,this.lat0,t),s=this.bl/e*Math.sqrt((1-this.es)/(1-n*n));if(s*s<1&&(s=1),isNaN(this.longc)){var a=g(this.e,this.lat1,Math.sin(this.lat1)),u=g(this.e,this.lat2,Math.sin(this.lat2));0<=this.lat0?this.el=(s+Math.sqrt(s*s-1))*Math.pow(o,this.bl):this.el=(s-Math.sqrt(s*s-1))*Math.pow(o,this.bl);var l=Math.pow(a,this.bl),h=Math.pow(u,this.bl);i=this.el/l,r=.5*(i-1/i);var c=(this.el*this.el-h*l)/(this.el*this.el+h*l),p=(h-l)/(h+l),f=y(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(c*Math.tan(.5*this.bl*f)/p)/this.bl,this.long0=y(this.long0);var d=y(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*d)/r),this.alpha=Math.asin(s*Math.sin(this.gamma0))}else i=0<=this.lat0?s+Math.sqrt(s*s-1):s-Math.sqrt(s*s-1),this.el=i*Math.pow(o,this.bl),r=.5*(i-1/i),this.gamma0=Math.asin(Math.sin(this.alpha)/s),this.long0=this.longc-Math.asin(r*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:0<=this.lat0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(s*s-1),Math.cos(this.alpha))},n.forward=function(t){var e,n,i,r=t.x,o=t.y,s=y(r-this.long0);if(Math.abs(Math.abs(o)-f)<=1e-10)i=0<o?-1:1,n=this.al/this.bl*Math.log(Math.tan(d+i*this.gamma0*.5)),e=-1*i*f*this.al/this.bl;else{var a=g(this.e,o,Math.sin(o)),u=this.el/Math.pow(a,this.bl),l=.5*(u-1/u),h=.5*(u+1/u),c=Math.sin(this.bl*s),p=(l*Math.sin(this.gamma0)-c*Math.cos(this.gamma0))/h;n=Math.abs(Math.abs(p)-1)<=1e-10?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-p)/(1+p))/this.bl,e=Math.abs(Math.cos(this.bl*s))<=1e-10?this.al*this.bl*s:this.al*Math.atan2(l*Math.cos(this.gamma0)+c*Math.sin(this.gamma0),Math.cos(this.bl*s))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+n):(e-=this.uc,t.x=this.x0+n*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-n*Math.sin(this.alpha)),t},n.inverse=function(t){var e,n;this.no_rot?(n=t.y-this.y0,e=t.x-this.x0):(n=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var i=Math.exp(-1*this.bl*n/this.al),r=.5*(i-1/i),o=.5*(i+1/i),s=Math.sin(this.bl*e/this.al),a=(s*Math.cos(this.gamma0)+r*Math.sin(this.gamma0))/o,u=Math.pow(this.el/Math.sqrt((1+a)/(1-a)),1/this.bl);return Math.abs(a-1)<1e-10?(t.x=this.long0,t.y=f):Math.abs(1+a)<1e-10?(t.x=this.long0,t.y=-1*f):(t.y=l(this.e,u),t.x=y(this.long0-Math.atan2(r*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},n.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],57:[function(t,e,n){var i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),y=t("../common/adjust_lon"),u=t("../common/adjust_lat"),_=t("../common/mlfn"),m=1e-10,l=t("../common/gN");n.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.ml0=this.a*_(this.e0,this.e1,this.e2,this.e3,this.lat0)},n.forward=function(t){var e,n,i,r=t.x,o=t.y,s=y(r-this.long0);if(i=s*Math.sin(o),this.sphere)n=Math.abs(o)<=m?(e=this.a*s,-1*this.a*this.lat0):(e=this.a*Math.sin(i)/Math.tan(o),this.a*(u(o-this.lat0)+(1-Math.cos(i))/Math.tan(o)));else if(Math.abs(o)<=m)e=this.a*s,n=-1*this.ml0;else{var a=l(this.a,this.e,Math.sin(o))/Math.tan(o);e=a*Math.sin(i),n=this.a*_(this.e0,this.e1,this.e2,this.e3,o)-this.ml0+a*(1-Math.cos(i))}return t.x=e+this.x0,t.y=n+this.y0,t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l;if(i=t.x-this.x0,r=t.y-this.y0,this.sphere)if(Math.abs(r+this.a*this.lat0)<=m)e=y(i/this.a+this.long0),n=0;else{var h;for(s=this.lat0+r/this.a,a=i*i/this.a/this.a+s*s,u=s,o=20;o;--o)if(h=Math.tan(u),u+=l=-1*(s*(u*h+1)-u-.5*(u*u+a)*h)/((u-s)/h-1),Math.abs(l)<=m){n=u;break}e=y(this.long0+Math.asin(i*Math.tan(u)/this.a)/Math.sin(n))}else if(Math.abs(r+this.ml0)<=m)n=0,e=y(this.long0+i/this.a);else{var c,p,f,d,g;for(s=(this.ml0+r)/this.a,a=i*i/this.a/this.a+s*s,u=s,o=20;o;--o)if(g=this.e*Math.sin(u),c=Math.sqrt(1-g*g)*Math.tan(u),p=this.a*_(this.e0,this.e1,this.e2,this.e3,u),f=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),d=p/this.a,l=(s*(c*d+1)-d-.5*c*(d*d+a))/(this.es*Math.sin(2*u)*(d*d+a-2*s*d)/(4*c)+(s-d)*(c*f-2/Math.sin(2*u))-f),u-=l,Math.abs(l)<=m){n=u;break}c=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),e=y(this.long0+Math.asin(i*c/this.a)/Math.sin(n))}return t.x=e,t.y=n,t},n.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],58:[function(t,e,n){var h=t("../common/adjust_lon"),o=t("../common/adjust_lat"),i=t("../common/pj_enfn"),c=t("../common/pj_mlfn"),s=t("../common/pj_inv_mlfn"),a=Math.PI/2,u=t("../common/asinz");n.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=i(this.es)},n.forward=function(t){var e,n,i=t.x,r=t.y;if(i=h(i-this.long0),this.sphere){if(this.m)for(var o=this.n*Math.sin(r),s=20;s;--s){var a=(this.m*r+Math.sin(r)-o)/(this.m+Math.cos(r));if(r-=a,Math.abs(a)<1e-10)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*i*(this.m+Math.cos(r)),n=this.a*this.C_y*r}else{var u=Math.sin(r),l=Math.cos(r);n=this.a*c(r,u,l,this.en),e=this.a*i*l/Math.sqrt(1-this.es*u*u)}return t.x=e,t.y=n,t},n.inverse=function(t){var e,n,i,r;return t.x-=this.x0,i=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,i/=this.C_x*(this.m+Math.cos(e)),this.m?e=u((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=u(Math.sin(e)/this.n)),i=h(i+this.long0),e=o(e)):(e=s(t.y/this.a,this.es,this.en),(r=Math.abs(e))<a?(r=Math.sin(e),n=this.long0+t.x*Math.sqrt(1-this.es*r*r)/(this.a*Math.cos(e)),i=h(n)):r-1e-10<a&&(i=this.long0)),t.x=i,t.y=e,t},n.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],59:[function(t,e,n){n.init=function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),n=this.a,i=this.rf,r=1/i,o=2*r-Math.pow(r,2),s=this.e=Math.sqrt(o);this.R=this.k0*n*Math.sqrt(1-o)/(1-o*Math.pow(e,2)),this.alpha=Math.sqrt(1+o/(1-o)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),u=Math.log(Math.tan(Math.PI/4+t/2)),l=Math.log((1+s*e)/(1-s*e));this.K=a-this.alpha*u+this.alpha*s/2*l},n.forward=function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),i=-this.alpha*(e+n)+this.K,r=2*(Math.atan(Math.exp(i))-Math.PI/4),o=this.alpha*(t.x-this.lambda0),s=Math.atan(Math.sin(o)/(Math.sin(this.b0)*Math.tan(r)+Math.cos(this.b0)*Math.cos(o))),a=Math.asin(Math.cos(this.b0)*Math.sin(r)-Math.sin(this.b0)*Math.cos(r)*Math.cos(o));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*s+this.x0,t},n.inverse=function(t){for(var e=t.x-this.x0,n=t.y-this.y0,i=e/this.R,r=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),o=Math.asin(Math.cos(this.b0)*Math.sin(r)+Math.sin(this.b0)*Math.cos(r)*Math.cos(i)),s=Math.atan(Math.sin(i)/(Math.cos(this.b0)*Math.cos(i)-Math.sin(this.b0)*Math.tan(r))),a=this.lambda0+s/this.alpha,u=0,l=o,h=-1e3,c=0;1e-7<Math.abs(l-h);){if(20<++c)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+o/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(l))/2)),h=l,l=2*Math.atan(Math.exp(u))-Math.PI/2}return t.x=a,t.y=l,t},n.names=["somerc"]},{}],60:[function(t,e,n){var p=Math.PI/2,f=1e-10,i=t("../common/sign"),r=t("../common/msfnz"),d=t("../common/tsfnz"),u=t("../common/phi2z"),g=t("../common/adjust_lon");n.ssfn_=function(t,e,n){return e*=n,Math.tan(.5*(p+t))*Math.pow((1-e)/(1+e),.5*n)},n.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=f&&(this.k0=.5*(1+i(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=f&&(0<this.lat0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=f&&(this.k0=.5*this.cons*r(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/d(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=r(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-p,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},n.forward=function(t){var e,n,i,r,o,s,a=t.x,u=t.y,l=Math.sin(u),h=Math.cos(u),c=g(a-this.long0);return Math.abs(Math.abs(a-this.long0)-Math.PI)<=f&&Math.abs(u+this.lat0)<=f?(t.x=NaN,t.y=NaN,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*l+this.coslat0*h*Math.cos(c)),t.x=this.a*e*h*Math.sin(c)+this.x0,t.y=this.a*e*(this.coslat0*l-this.sinlat0*h*Math.cos(c))+this.y0,t):(n=2*Math.atan(this.ssfn_(u,l,this.e))-p,r=Math.cos(n),i=Math.sin(n),Math.abs(this.coslat0)<=f?(o=d(this.e,u*this.con,this.con*l),s=2*this.a*this.k0*o/this.cons,t.x=this.x0+s*Math.sin(a-this.long0),t.y=this.y0-this.con*s*Math.cos(a-this.long0)):(Math.abs(this.sinlat0)<f?(e=2*this.a*this.k0/(1+r*Math.cos(c)),t.y=e*i):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*i+this.cosX0*r*Math.cos(c))),t.y=e*(this.cosX0*i-this.sinX0*r*Math.cos(c))+this.y0),t.x=e*r*Math.sin(c)+this.x0),t)},n.inverse=function(t){var e,n,i,r,o;t.x-=this.x0,t.y-=this.y0;var s=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var a=2*Math.atan(s/(.5*this.a*this.k0));return e=this.long0,n=this.lat0,s<=f?(t.x=e,t.y=n,t):(n=Math.asin(Math.cos(a)*this.sinlat0+t.y*Math.sin(a)*this.coslat0/s),e=Math.abs(this.coslat0)<f?0<this.lat0?g(this.long0+Math.atan2(t.x,-1*t.y)):g(this.long0+Math.atan2(t.x,t.y)):g(this.long0+Math.atan2(t.x*Math.sin(a),s*this.coslat0*Math.cos(a)-t.y*this.sinlat0*Math.sin(a))),t.x=e,t.y=n,t)}if(Math.abs(this.coslat0)<=f){if(s<=f)return n=this.lat0,e=this.long0,t.x=e,t.y=n,t;t.x*=this.con,t.y*=this.con,i=s*this.cons/(2*this.a*this.k0),n=this.con*u(this.e,i),e=this.con*g(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else r=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s<=f?o=this.X0:(o=Math.asin(Math.cos(r)*this.sinX0+t.y*Math.sin(r)*this.cosX0/s),e=g(this.long0+Math.atan2(t.x*Math.sin(r),s*this.cosX0*Math.cos(r)-t.y*this.sinX0*Math.sin(r)))),n=-1*u(this.e,Math.tan(.5*(p+o)));return t.x=e,t.y=n,t},n.names=["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],61:[function(t,e,n){var a=t("./gauss"),u=t("../common/adjust_lon");n.init=function(){a.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},n.forward=function(t){var e,n,i,r;return t.x=u(t.x-this.long0),a.forward.apply(this,[t]),e=Math.sin(t.y),n=Math.cos(t.y),i=Math.cos(t.x),r=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*n*i),t.x=r*n*Math.sin(t.x),t.y=r*(this.cosc0*e-this.sinc0*n*i),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},n.inverse=function(t){var e,n,i,r,o;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,o=Math.sqrt(t.x*t.x+t.y*t.y)){var s=2*Math.atan2(o,this.R2);e=Math.sin(s),n=Math.cos(s),r=Math.asin(n*this.sinc0+t.y*e*this.cosc0/o),i=Math.atan2(t.x*e,o*this.cosc0*n-t.y*this.sinc0*e)}else r=this.phic0,i=0;return t.x=i,t.y=r,a.inverse.apply(this,[t]),t.x=u(t.x+this.long0),t},n.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":46}],62:[function(t,e,n){var i=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),s=t("../common/e3fn"),_=t("../common/mlfn"),L=t("../common/adjust_lon"),w=Math.PI/2,S=t("../common/sign"),M=t("../common/asinz");n.init=function(){this.e0=i(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=s(this.es),this.ml0=this.a*_(this.e0,this.e1,this.e2,this.e3,this.lat0)},n.forward=function(t){var e,n,i,r=t.x,o=t.y,s=L(r-this.long0),a=Math.sin(o),u=Math.cos(o);if(this.sphere){var l=u*Math.sin(s);if(Math.abs(Math.abs(l)-1)<1e-10)return 93;n=.5*this.a*this.k0*Math.log((1+l)/(1-l)),e=Math.acos(u*Math.cos(s)/Math.sqrt(1-l*l)),o<0&&(e=-e),i=this.a*this.k0*(e-this.lat0)}else{var h=u*s,c=Math.pow(h,2),p=this.ep2*Math.pow(u,2),f=Math.tan(o),d=Math.pow(f,2);e=1-this.es*Math.pow(a,2);var g=this.a/Math.sqrt(e),y=this.a*_(this.e0,this.e1,this.e2,this.e3,o);n=this.k0*g*h*(1+c/6*(1-d+p+c/20*(5-18*d+Math.pow(d,2)+72*p-58*this.ep2)))+this.x0,i=this.k0*(y-this.ml0+g*f*(c*(.5+c/24*(5-d+9*p+4*Math.pow(p,2)+c/30*(61-58*d+Math.pow(d,2)+600*p-330*this.ep2)))))+this.y0}return t.x=n,t.y=i,t},n.inverse=function(t){var e,n,i,r,o,s;if(this.sphere){var a=Math.exp(t.x/(this.a*this.k0)),u=.5*(a-1/a),l=this.lat0+t.y/(this.a*this.k0),h=Math.cos(l);e=Math.sqrt((1-h*h)/(1+u*u)),o=M(e),l<0&&(o=-o),s=0==u&&0===h?this.long0:L(Math.atan2(u,h)+this.long0)}else{var c=t.x-this.x0,p=t.y-this.y0;for(e=(this.ml0+p/this.k0)/this.a,n=e,r=0;i=(e+this.e1*Math.sin(2*n)-this.e2*Math.sin(4*n)+this.e3*Math.sin(6*n))/this.e0-n,n+=i,!(Math.abs(i)<=1e-10);r++)if(6<=r)return 95;if(Math.abs(n)<w){var f=Math.sin(n),d=Math.cos(n),g=Math.tan(n),y=this.ep2*Math.pow(d,2),_=Math.pow(y,2),m=Math.pow(g,2),v=Math.pow(m,2);e=1-this.es*Math.pow(f,2);var b=this.a/Math.sqrt(e),x=b*(1-this.es)/e,E=c/(b*this.k0),I=Math.pow(E,2);o=n-b*g*I/x*(.5-I/24*(5+3*m+10*y-4*_-9*this.ep2-I/30*(61+90*m+298*y+45*v-252*this.ep2-3*_))),s=L(this.long0+E*(1-I/6*(1+2*m+y-I/20*(5-2*y+28*m-3*_+8*this.ep2+24*v)))/d)}else o=w*S(p),s=this.long0}return t.x=s,t.y=o,t},n.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],63:[function(t,e,n){var i=t("./tmerc");n.dependsOn="tmerc",n.init=function(){this.zone&&(this.lat0=0,this.long0=.017453292519943295*(6*Math.abs(this.zone)-183),this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,i.init.apply(this),this.forward=i.forward,this.inverse=i.inverse)},n.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":62}],64:[function(t,e,n){var _=t("../common/adjust_lon"),m=Math.PI/2,v=t("../common/asinz");n.init=function(){this.R=this.a},n.forward=function(t){var e,n,i=t.x,r=t.y,o=_(i-this.long0);Math.abs(r)<=1e-10&&(e=this.x0+this.R*o,n=this.y0);var s=v(2*Math.abs(r/Math.PI));(Math.abs(o)<=1e-10||Math.abs(Math.abs(r)-m)<=1e-10)&&(e=this.x0,n=0<=r?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var a=.5*Math.abs(Math.PI/o-o/Math.PI),u=a*a,l=Math.sin(s),h=Math.cos(s),c=h/(l+h-1),p=c*c,f=c*(2/l-1),d=f*f,g=Math.PI*this.R*(a*(c-d)+Math.sqrt(u*(c-d)*(c-d)-(d+u)*(p-d)))/(d+u);o<0&&(g=-g),e=this.x0+g;var y=u+c;return g=Math.PI*this.R*(f*y-a*Math.sqrt((d+u)*(1+u)-y*y))/(d+u),n=0<=r?this.y0+g:this.y0-g,t.x=e,t.y=n,t},n.inverse=function(t){var e,n,i,r,o,s,a,u,l,h,c,p,f;return t.x-=this.x0,t.y-=this.y0,c=Math.PI*this.R,i=t.x/c,r=t.y/c,o=i*i+r*r,s=-Math.abs(r)*(1+o),f=r*r/(u=-2*s+1+2*r*r+o*o)+(2*(a=s-2*r*r+i*i)*a*a/u/u/u-9*s*a/u/u)/27,l=(s-a*a/3/u)/u,h=2*Math.sqrt(-l/3),c=3*f/l/h,1<Math.abs(c)&&(c=0<=c?1:-1),p=Math.acos(c)/3,n=0<=t.y?(-h*Math.cos(p+Math.PI/3)-a/3/u)*Math.PI:-(-h*Math.cos(p+Math.PI/3)-a/3/u)*Math.PI,e=Math.abs(i)<1e-10?this.long0:_(this.long0+Math.PI*(o-1+Math.sqrt(1+2*(i*i-r*r)+o*o))/2/i),t.x=e,t.y=n,t},n.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],65:[function(t,e,n){var s=.017453292519943295,a=57.29577951308232,u=t("./datum_transform"),l=t("./adjust_axis"),h=t("./Proj"),c=t("./common/toPoint");e.exports=function t(e,n,i){var r;function o(t,e){return(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode}return Array.isArray(i)&&(i=c(i)),e.datum&&n.datum&&(o(e,n)||o(n,e))&&(r=new h("WGS84"),t(e,r,i),e=r),"enu"!==e.axis&&l(e,!1,i),"longlat"===e.projName?(i.x*=s,i.y*=s):(e.to_meter&&(i.x*=e.to_meter,i.y*=e.to_meter),e.inverse(i)),e.from_greenwich&&(i.x+=e.from_greenwich),i=u(e.datum,n.datum,i),n.from_greenwich&&(i.x-=n.from_greenwich),"longlat"===n.projName?(i.x*=a,i.y*=a):(n.forward(i),n.to_meter&&(i.x/=n.to_meter,i.y/=n.to_meter)),"enu"!==n.axis&&l(n,!0,i),i}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":31}],66:[function(t,e,n){var i=.017453292519943295,s=t("./extend");function r(t,e,n){t[e]=n.map(function(t){var e={};return a(t,e),e}).reduce(function(t,e){return s(t,e)},{})}function a(t,e){var n;Array.isArray(t)?("PARAMETER"===(n=t.shift())&&(n=t.shift()),1===t.length?Array.isArray(t[0])?(e[n]={},a(t[0],e[n])):e[n]=t[0]:t.length?"TOWGS84"===n?e[n]=t:(e[n]={},-1<["UNIT","PRIMEM","VERT_DATUM"].indexOf(n)?(e[n]={name:t[0].toLowerCase(),convert:t[1]},3===t.length&&(e[n].auth=t[2])):"SPHEROID"===n?(e[n]={name:t[0],a:t[1],rf:t[2]},4===t.length&&(e[n].auth=t[3])):-1<["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(n)?(t[0]=["name",t[0]],r(e,n,t)):t.every(function(t){return Array.isArray(t)})?r(e,n,t):a(t,e[n])):e[n]=!0):e[t]=!0}function u(t,e){var n=e[0],i=e[1];!(n in t)&&i in t&&(t[n]=t[i],3===e.length&&(t[n]=e[2](t[n])))}function l(t){return t*i}e.exports=function(t,e){var n=JSON.parse((","+t).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]').replace(/,\["VERTCS".+/,"")),i=n.shift(),r=n.shift();n.unshift(["name",r]),n.unshift(["type",i]),n.unshift("output");var o={};return a(n,o),function(n){"GEOGCS"===n.type?n.projName="longlat":"LOCAL_CS"===n.type?(n.projName="identity",n.local=!0):"object"===g(n.PROJECTION)?n.projName=Object.keys(n.PROJECTION)[0]:n.projName=n.PROJECTION;n.UNIT&&(n.units=n.UNIT.name.toLowerCase(),"metre"===n.units&&(n.units="meter"),n.UNIT.convert&&(n.to_meter=parseFloat(n.UNIT.convert,10)));n.GEOGCS&&(n.GEOGCS.DATUM?n.datumCode=n.GEOGCS.DATUM.name.toLowerCase():n.datumCode=n.GEOGCS.name.toLowerCase(),"d_"===n.datumCode.slice(0,2)&&(n.datumCode=n.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==n.datumCode&&"new_zealand_1949"!==n.datumCode||(n.datumCode="nzgd49"),"wgs_1984"===n.datumCode&&("Mercator_Auxiliary_Sphere"===n.PROJECTION&&(n.sphere=!0),n.datumCode="wgs84"),"_ferro"===n.datumCode.slice(-6)&&(n.datumCode=n.datumCode.slice(0,-6)),"_jakarta"===n.datumCode.slice(-8)&&(n.datumCode=n.datumCode.slice(0,-8)),~n.datumCode.indexOf("belge")&&(n.datumCode="rnb72"),n.GEOGCS.DATUM&&n.GEOGCS.DATUM.SPHEROID&&(n.ellps=n.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===n.ellps.toLowerCase().slice(0,13)&&(n.ellps="intl"),n.a=n.GEOGCS.DATUM.SPHEROID.a,n.rf=parseFloat(n.GEOGCS.DATUM.SPHEROID.rf,10)),~n.datumCode.indexOf("osgb_1936")&&(n.datumCode="osgb36"));n.b&&!isFinite(n.b)&&(n.b=n.a);function t(t){var e=n.to_meter||1;return parseFloat(t,10)*e}function e(t){return u(n,t)}[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",l],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",l],["x0","false_easting",t],["y0","false_northing",t],["long0","central_meridian",l],["lat0","latitude_of_origin",l],["lat0","standard_parallel_1",l],["lat1","standard_parallel_1",l],["lat2","standard_parallel_2",l],["alpha","azimuth",l],["srsCode","name"]].forEach(e),n.long0||!n.longc||"Albers_Conic_Equal_Area"!==n.projName&&"Lambert_Azimuthal_Equal_Area"!==n.projName||(n.long0=n.longc);n.lat_ts||!n.lat1||"Stereographic_South_Pole"!==n.projName&&"Polar Stereographic (variant B)"!==n.projName||(n.lat0=l(0<n.lat1?90:-90),n.lat_ts=n.lat1)}(o.output),s(e,o.output)}},{"./extend":34}],67:[function(t,e,n){var i=6,m="AJSAJS",v="AFAFAF",b=65,x=73,E=79,I=86,L=90;function y(t){return t*(Math.PI/180)}function w(t){return t/Math.PI*180}function S(t){var e=t.northing,n=t.easting,i=t.zoneLetter,r=t.zoneNumber;if(r<0||60<r)return null;var o,s,a,u,l,h,c,p,f,d=.00669438,g=(1-Math.sqrt(1-d))/(1+Math.sqrt(1-d)),y=n-5e5,_=e;i<"N"&&(_-=1e7),c=6*(r-1)-180+3,o=d/(1-d),f=(p=_/.9996/6367449.145945056)+(3*g/2-27*g*g*g/32)*Math.sin(2*p)+(21*g*g/16-55*g*g*g*g/32)*Math.sin(4*p)+151*g*g*g/96*Math.sin(6*p),s=6378137/Math.sqrt(1-d*Math.sin(f)*Math.sin(f)),a=Math.tan(f)*Math.tan(f),u=o*Math.cos(f)*Math.cos(f),l=6378137*(1-d)/Math.pow(1-d*Math.sin(f)*Math.sin(f),1.5),h=y/(.9996*s);var m=f-s*Math.tan(f)/l*(h*h/2-(5+3*a+10*u-4*u*u-9*o)*h*h*h*h/24+(61+90*a+298*u+45*a*a-252*o-3*u*u)*h*h*h*h*h*h/720);m=w(m);var v,b=(h-(1+2*a+u)*h*h*h/6+(5-2*u+28*a-3*u*u+8*o+24*a*a)*h*h*h*h*h/120)/Math.cos(f);if(b=c+w(b),t.accuracy){var x=S({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});v={top:x.lat,right:x.lon,bottom:m,left:b}}else v={lat:m,lon:b};return v}function M(t){var e=t%i;return 0===e&&(e=i),e}function r(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,n=t.length,i=null,r="",o=0;!/[A-Z]/.test(e=t.charAt(o));){if(2<=o)throw"MGRSPoint bad conversion from: "+t;r+=e,o++}var s=parseInt(r,10);if(0===o||n<o+3)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(o++);if(a<="A"||"B"===a||"Y"===a||"Z"<=a||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;i=t.substring(o,o+=2);for(var u=M(s),l=function(t,e){var n=m.charCodeAt(e-1),i=1e5,r=!1;for(;n!==t.charCodeAt(0);){if(++n===x&&n++,n===E&&n++,L<n){if(r)throw"Bad character: "+t;n=b,r=!0}i+=1e5}return i}(i.charAt(0),u),h=function(t,e){if("V"<t)throw"MGRSPoint given invalid Northing "+t;var n=v.charCodeAt(e-1),i=0,r=!1;for(;n!==t.charCodeAt(0);){if(++n===x&&n++,n===E&&n++,I<n){if(r)throw"Bad character: "+t;n=b,r=!0}i+=1e5}return i}(i.charAt(1),u);h<C(a);)h+=2e6;var c=n-o;if(c%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var p,f,d,g=c/2,y=0,_=0;return 0<g&&(p=1e5/Math.pow(10,g),f=t.substring(o,o+g),y=parseFloat(f)*p,d=t.substring(o+g),_=parseFloat(d)*p),{easting:y+l,northing:_+h,zoneLetter:a,zoneNumber:s,accuracy:p}}function C(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(0<=e)return e;throw"Invalid zone letter: "+t}n.forward=function(t,e){return e=e||5,function(t,e){var n="00000"+t.easting,i="00000"+t.northing;return t.zoneNumber+t.zoneLetter+function(t,e,n){var i=M(n),r=Math.floor(t/1e5),o=Math.floor(e/1e5)%20;return function(t,e,n){var i=n-1,r=m.charCodeAt(i),o=v.charCodeAt(i),s=r+t-1,a=o+e,u=!1;L<s&&(s=s-L+b-1,u=!0);(s===x||r<x&&x<s||(x<s||r<x)&&u)&&s++;(s===E||r<E&&E<s||(E<s||r<E)&&u)&&++s===x&&s++;L<s&&(s=s-L+b-1);u=I<a&&(a=a-I+b-1,!0);(a===x||o<x&&x<a||(x<a||o<x)&&u)&&a++;(a===E||o<E&&E<a||(E<a||o<E)&&u)&&++a===x&&a++;I<a&&(a=a-I+b-1);return String.fromCharCode(s)+String.fromCharCode(a)}(r,o,i)}(t.easting,t.northing,t.zoneNumber)+n.substr(n.length-5,e)+i.substr(i.length-5,e)}(function(t){var e,n,i,r,o,s,a,u,l=t.lat,h=t.lon,c=.00669438,p=y(l),f=y(h);u=Math.floor((h+180)/6)+1,180===h&&(u=60);56<=l&&l<64&&3<=h&&h<12&&(u=32);72<=l&&l<84&&(0<=h&&h<9?u=31:9<=h&&h<21?u=33:21<=h&&h<33?u=35:33<=h&&h<42&&(u=37));a=y(6*(u-1)-180+3),e=c/(1-c),n=6378137/Math.sqrt(1-c*Math.sin(p)*Math.sin(p)),i=Math.tan(p)*Math.tan(p),r=e*Math.cos(p)*Math.cos(p),o=Math.cos(p)*(f-a),s=6378137*(.9983242984503243*p-.002514607064228144*Math.sin(2*p)+2639046602129982e-21*Math.sin(4*p)-35*c*c*c/3072*Math.sin(6*p));var d=.9996*n*(o+(1-i+r)*o*o*o/6+(5-18*i+i*i+72*r-58*e)*o*o*o*o*o/120)+5e5,g=.9996*(s+n*Math.tan(p)*(o*o/2+(5-i+9*r+4*r*r)*o*o*o*o/24+(61-58*i+i*i+600*r-330*e)*o*o*o*o*o*o/720));l<0&&(g+=1e7);return{northing:Math.round(g),easting:Math.round(d),zoneNumber:u,zoneLetter:function(t){var e="Z";t<=84&&72<=t?e="X":t<72&&64<=t?e="W":t<64&&56<=t?e="V":t<56&&48<=t?e="U":t<48&&40<=t?e="T":t<40&&32<=t?e="S":t<32&&24<=t?e="R":t<24&&16<=t?e="Q":t<16&&8<=t?e="P":t<8&&0<=t?e="N":t<0&&-8<=t?e="M":t<-8&&-16<=t?e="L":t<-16&&-24<=t?e="K":t<-24&&-32<=t?e="J":t<-32&&-40<=t?e="H":t<-40&&-48<=t?e="G":t<-48&&-56<=t?e="F":t<-56&&-64<=t?e="E":t<-64&&-72<=t?e="D":t<-72&&-80<=t&&(e="C");return e}(l)}}({lat:t[1],lon:t[0]}),e)},n.inverse=function(t){var e=S(r(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat,e.lon,e.lat]:[e.left,e.bottom,e.right,e.top]},n.toPoint=function(t){var e=S(r(t.toUpperCase()));return e.lat&&e.lon?[e.lon,e.lat]:[(e.left+e.right)/2,(e.top+e.bottom)/2]}},{}],68:[function(t,e,n){e.exports={name:"proj4",version:"2.3.10",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"~0.0.2"}}},{}],"./includedProjections":[function(t,e,n){e.exports=t("hTEDpn")},{}],hTEDpn:[function(t,e,n){var i=[t("./lib/projections/tmerc"),t("./lib/projections/utm"),t("./lib/projections/sterea"),t("./lib/projections/stere"),t("./lib/projections/somerc"),t("./lib/projections/omerc"),t("./lib/projections/lcc"),t("./lib/projections/krovak"),t("./lib/projections/cass"),t("./lib/projections/laea"),t("./lib/projections/aea"),t("./lib/projections/gnom"),t("./lib/projections/cea"),t("./lib/projections/eqc"),t("./lib/projections/poly"),t("./lib/projections/nzmg"),t("./lib/projections/mill"),t("./lib/projections/sinu"),t("./lib/projections/moll"),t("./lib/projections/eqdc"),t("./lib/projections/vandg"),t("./lib/projections/aeqd")];e.exports=function(e){i.forEach(function(t){e.Proj.projections.add(t)})}},{"./lib/projections/aea":40,"./lib/projections/aeqd":41,"./lib/projections/cass":42,"./lib/projections/cea":43,"./lib/projections/eqc":44,"./lib/projections/eqdc":45,"./lib/projections/gnom":47,"./lib/projections/krovak":48,"./lib/projections/laea":49,"./lib/projections/lcc":50,"./lib/projections/mill":53,"./lib/projections/moll":54,"./lib/projections/nzmg":55,"./lib/projections/omerc":56,"./lib/projections/poly":57,"./lib/projections/sinu":58,"./lib/projections/somerc":59,"./lib/projections/stere":60,"./lib/projections/sterea":61,"./lib/projections/tmerc":62,"./lib/projections/utm":63,"./lib/projections/vandg":64}]},{},[36])(36)}),W={};W._isProj4Obj=function(t){return void 0!==t.inverse&&void 0!==t.forward},W.Projection=B.Class.extend({initialize:function(t,e,n){var i=W._isProj4Obj(t);this._proj=i?t:this._projFromCodeDef(t,e),this.bounds=i?e:n},project:function(t){if(t){var e=this._proj.forward([t.lng,t.lat]);return new B.Point(e[0],e[1])}},unproject:function(t,e){if(t){var n=this._proj.inverse([t.x,t.y]);return new B.LatLng(n[1],n[0],e)}},_projFromCodeDef:function(t,e){if(e)J.defs(t,e);else if(void 0===J.defs[t]){var n=t.split(":");if(3<n.length&&(t=n[n.length-3]+":"+n[n.length-1]),void 0===J.defs[t])throw"No projection definition for code "+t}return J(t)}}),W.CRS=B.Class.extend({statics:{},wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,r=e.lat*n,o=Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos((e.lng-t.lng)*n);return this.R*Math.acos(Math.min(o,1))},includes:B.CRS,options:{transformation:new B.Transformation(1,0,-1,0)},initialize:function(t,e,n){var i,r;if(W._isProj4Obj(t)?(i=t.srsCode,r=e||{},this.projection=new W.Projection(t,r.bounds)):(i=t,r=n||{},this.projection=new W.Projection(i,e,r.bounds)),B.Util.setOptions(this,r),this.code=i,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new B.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var o=this.options.resolutions.length-1;0<=o;o--)this.options.resolutions[o]&&(this._scales[o]=1/this.options.resolutions[o])}this.infinite=!this.options.bounds},scale:function(t){var e,n=Math.floor(t);return t===n?this._scales[t]:(e=this._scales[n])+(this._scales[n+1]-e)*(t-n)},zoom:function(t){var e,n=this._closestElement(this._scales,t),i=this._scales.indexOf(n);return t===n?i:(e=i+1,(t-n)/(this._scales[e]-n)+i)},_closestElement:function(t,e){for(var n,i=t.length;i--;)t[i]<=e&&(void 0===n||n<t[i])&&(n=t[i]);return n}}),W.GeoJSON=B.GeoJSON.extend({initialize:function(t,e){if(t.crs&&"name"===t.crs.type){var n=new W.CRS(t.crs.properties.name);(e=e||{}).coordsToLatLng=function(t){var e=B.point(t[0],t[1]);return n.projection.unproject(e)}}B.GeoJSON.prototype.initialize.call(this,t,e)}}),W.geoJson=function(t,e){return new W.GeoJSON(t,e)},G.h337=(q={defaultRadius:40,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},z=function(){function t(t){this._coordinator={},this._data=[],this._radi=[],this._min=0,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)}var h=q.defaultRadius;return t.prototype={_organiseData:function(t,e){var n=t[this._xField],i=t[this._yField],r=this._radi,o=this._data,s=this._max,a=this._min,u=t[this._valueField]||1,l=t.radius||this._cfgRadius||h;return o[n]||(o[n]=[],r[n]=[]),o[n][i]?o[n][i]+=u:(o[n][i]=u,r[n][i]=l),o[n][i]>s?(e?this.setDataMax(o[n][i]):this._max=o[n][i],!1):{x:n,y:i,value:u,radius:l,min:a,max:s}},_unOrganizeData:function(){var t=[],e=this._data,n=this._radi;for(var i in e)for(var r in e[i])t.push({x:i,y:r,radius:n[i][r],value:e[i][r]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(t){if(0<t.length)for(var e=t,n=e.length;n--;)this.addData.call(this,e[n]);else{var i=this._organiseData(t,!0);i&&this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[i]})}return this},setData:function(t){var e=t.data,n=e.length;this._data=[],this._radi=[];for(var i=0;i<n;i++)this._organiseData(e[i],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},t}(),V=function(){function o(t){var e=t.gradient||t.defaultGradient,n=document.createElement("canvas"),i=n.getContext("2d");n.width=256,n.height=1;var r=i.createLinearGradient(0,0,256,1);for(var o in e)r.addColorStop(o,e[o]);return i.fillStyle=r,i.fillRect(0,0,256,1),i.getImageData(0,0,256,1).data}function d(t,e){var n=document.createElement("canvas"),i=n.getContext("2d"),r=t,o=t;if(n.width=n.height=2*t,1==e)i.beginPath(),i.arc(r,o,t,0,2*Math.PI,!1),i.fillStyle="rgba(0,0,0,1)",i.fill();else{var s=i.createRadialGradient(r,o,t*e,r,o,t);s.addColorStop(0,"rgba(0,0,0,1)"),s.addColorStop(1,"rgba(0,0,0,0)"),i.fillStyle=s,i.fillRect(0,0,2*t,2*t)}return n}function t(t){var e=t.container,n=this.shadowCanvas=document.createElement("canvas"),i=this.canvas=t.canvas||document.createElement("canvas"),r=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});i.className="heatmap-canvas",this._width=i.width=n.width=+r.width.replace(/px/,""),this._height=i.height=n.height=+r.height.replace(/px/,""),this.shadowCtx=n.getContext("2d"),this.ctx=i.getContext("2d"),i.style.cssText=n.style.cssText="position:absolute;left:0;top:0;",e.style.position="relative",e.appendChild(i),this._palette=o(t),this._templates={},this._setStyles(t)}return t.prototype={renderPartial:function(t){this._drawAlpha(t),this._colorize()},renderAll:function(t){this._clear(),this._drawAlpha(function(t){for(var e=[],n=t.min,i=t.max,r=t.radi,o=(t=t.data,Object.keys(t)),s=o.length;s--;)for(var a=o[s],u=Object.keys(t[a]),l=u.length;l--;){var h=u[l],c=t[a][h],p=r[a][h];e.push({x:a,y:h,value:c,radius:p})}return{min:n,max:i,data:e}}(t)),this._colorize()},_updateGradient:function(t){this._palette=o(t)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,e){this._width=t,this._height=e,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=e},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var e=this._min=t.min,n=this._max=t.max,i=(t=t.data||[]).length,r=1-this._blur;i--;){var o,s=t[i],a=s.x,u=s.y,l=s.radius,h=Math.min(s.value,n),c=a-l,p=u-l,f=this.shadowCtx;this._templates[l]?o=this._templates[l]:this._templates[l]=o=d(l,r),f.globalAlpha=(h-e)/(n-e),f.drawImage(o,c,p),c<this._renderBoundaries[0]&&(this._renderBoundaries[0]=c),p<this._renderBoundaries[1]&&(this._renderBoundaries[1]=p),c+2*l>this._renderBoundaries[2]&&(this._renderBoundaries[2]=c+2*l),p+2*l>this._renderBoundaries[3]&&(this._renderBoundaries[3]=p+2*l)}},_colorize:function(){var t=this._renderBoundaries[0],e=this._renderBoundaries[1],n=this._renderBoundaries[2]-t,i=this._renderBoundaries[3]-e,r=this._width,o=this._height,s=this._opacity,a=this._maxOpacity,u=this._minOpacity,l=this._useGradientOpacity;t<0&&(t=0),e<0&&(e=0),r<t+n&&(n=r-t),o<e+i&&(i=o-e);for(var h=this.shadowCtx.getImageData(t,e,n,i),c=h.data,p=c.length,f=this._palette,d=3;d<p;d+=4){var g,y=c[d],_=4*y;if(_)g=0<s?s:y<a?y<u?u:y:a,c[d-3]=f[_],c[d-2]=f[1+_],c[d-1]=f[2+_],c[d]=l?f[3+_]:g}this.ctx.putImageData(h,t,e),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var e=this.shadowCtx.getImageData(t.x,t.y,1,1).data[3],n=this._max,i=this._min;return Math.abs(n-i)*(e/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},t}(),Y=function(){var t=!1;return"canvas2d"===q.defaultRenderer&&(t=V),t}(),H={merge:function(){for(var t={},e=arguments.length,n=0;n<e;n++){var i=arguments[n];for(var r in i)t[r]=i[r]}return t}},X=function(){var a=(t.prototype={on:function(t,e,n){var i=this.cStore;i[t]||(i[t]=[]),i[t].push(function(t){return e.call(n,t)})},emit:function(t,e){var n=this.cStore;if(n[t])for(var i=n[t].length,r=0;r<i;r++)(0,n[t][r])(e)}},t);function t(){this.cStore={}}function e(){var e,t,n,i,r=this._config=H.merge(q,arguments[0]||{});if(this._coordinator=new a,r.plugin){var o=r.plugin;if(!q.plugins[o])throw new Error("Plugin '"+o+"' not found. Maybe it was not registered.");var s=q.plugins[o];this._renderer=new s.renderer(r),this._store=new s.store(r)}else this._renderer=new Y(r),this._store=new z(r);t=(e=this)._renderer,n=e._coordinator,i=e._store,n.on("renderpartial",t.renderPartial,t),n.on("renderall",t.renderAll,t),n.on("extremachange",function(t){e._config.onExtremaChange&&e._config.onExtremaChange({min:t.min,max:t.max,gradient:e._config.gradient||e._config.defaultGradient})}),i.setCoordinator(n)}return e.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=H.merge(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},e}(),{create:function(t){return new X(t)},register:function(t,e){q.plugins[t]=e}});var K={},Z=B.Layer.extend({initialize:function(t){this.cfg=t,this._el=B.DomUtil.create("div","leaflet-zoom-hide"),this._data=[],this._max=1,this._min=0,this.cfg.container=this._el},onAdd:function(t){var e=t.getSize();this._map=t,this._width=e.x,this._height=e.y,this._el.style.width=e.x+"px",this._el.style.height=e.y+"px",this._el.style.position="absolute",this._origin=this._map.layerPointToLatLng(new B.Point(0,0)),t.getPanes().overlayPane.appendChild(this._el),this._heatmap||(this._heatmap=K.create(this.cfg)),t.on("moveend",this._reset,this),this._draw()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._el),t.off("moveend",this._reset,this)},_draw:function(){if(this._map){var t=this._map.getPanes().mapPane._leaflet_pos;this._el.style[Z.CSS_TRANSFORM]="translate("+-Math.round(t.x)+"px,"+-Math.round(t.y)+"px)",this._update()}},_update:function(){var t,e,n,i={max:this._max,min:this._min,data:[]};if(t=this._map.getBounds(),e=this._map.getZoom(),n=Math.pow(2,e),0!=this._data.length){for(var r=[],o=this.cfg.scaleRadius?n:1,s=0,a=0,u=this.cfg.valueField,l=this._data.length;l--;){var h=this._data[l],c=h[u],p=h.latlng;if(t.contains(p)){s=Math.max(c,s),a=Math.min(c,a);var f,d=this._map.latLngToContainerPoint(p),g={x:Math.round(d.x),y:Math.round(d.y)};g[u]=c,f=h.radius?h.radius*o:(this.cfg.radius||2)*o,g.radius=f,r.push(g)}}this.cfg.useLocalExtrema&&(i.max=s,i.min=a),i.data=r,this._heatmap.setData(i)}else this._heatmap&&this._heatmap.setData(i)},setData:function(t){this._max=t.max||this._max,this._min=t.min||this._min;for(var e=this.cfg.latField||"lat",n=this.cfg.lngField||"lng",i=this.cfg.valueField||"value",r=(t=t.data).length,o=[];r--;){var s=t[r],a={latlng:new B.LatLng(s[e],s[n])};a[i]=s[i],s.radius&&(a.radius=s.radius),o.push(a)}this._data=o,this._draw()},addData:function(t){if(0<t.length)for(var e=t.length;e--;)this.addData(t[e]);else{var n=this.cfg.latField||"lat",i=this.cfg.lngField||"lng",r=this.cfg.valueField||"value",o=t,s={latlng:new B.LatLng(o[n],o[i])};s[r]=o[r],this._max=Math.max(this._max,s[r]),this._min=Math.min(this._min,s[r]),o.radius&&(s.radius=o.radius),this._data.push(s),this._draw()}},_reset:function(){this._origin=this._map.layerPointToLatLng(new B.Point(0,0));var t=this._map.getSize();this._width===t.x&&this._height===t.y||(this._width=t.x,this._height=t.y,this._el.style.width=this._width+"px",this._el.style.height=this._height+"px",this._heatmap._renderer.setDimensions(this._width,this._height)),this._draw()}});Z.CSS_TRANSFORM=function(){for(var t=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],n=0;n<e.length;n++){var i=e[n];if(void 0!==t.style[i])return i}return e[0]}();j(function(t,e){var n,i;n=function(u){var t=u.Control.extend({includes:u.Evented?u.Evented.prototype:u.Mixin.Events,options:{position:"bottomright",toggleDisplay:!1,zoomLevelOffset:-5,zoomLevelFixed:!1,centerFixed:!1,zoomAnimation:!1,autoToggleDisplay:!1,minimized:!1,width:150,height:150,collapsedWidth:19,collapsedHeight:19,aimingRectOptions:{color:"#ff7800",weight:1,clickable:!1},shadowRectOptions:{color:"#000000",weight:1,clickable:!1,opacity:0,fillOpacity:0},strings:{hideText:"Hide MiniMap",showText:"Show MiniMap"},mapOptions:{}},initialize:function(t,e){u.Util.setOptions(this,e),this.options.aimingRectOptions.clickable=!1,this.options.shadowRectOptions.clickable=!1,this._layer=t},onAdd:function(t){this._mainMap=t,this._container=u.DomUtil.create("div","leaflet-control-minimap"),this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",u.DomEvent.disableClickPropagation(this._container),u.DomEvent.on(this._container,"mousewheel",u.DomEvent.stopPropagation);var e={attributionControl:!1,dragging:!this.options.centerFixed,zoomControl:!1,zoomAnimation:this.options.zoomAnimation,autoToggleDisplay:this.options.autoToggleDisplay,touchZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),scrollWheelZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),doubleClickZoom:this.options.centerFixed?"center":!this._isZoomLevelFixed(),boxZoom:!this._isZoomLevelFixed(),crs:t.options.crs};return e=u.Util.extend(this.options.mapOptions,e),this._miniMap=new u.Map(this._container,e),this._miniMap.addLayer(this._layer),this._mainMapMoving=!1,this._miniMapMoving=!1,this._userToggledDisplay=!1,this._minimized=!1,this.options.toggleDisplay&&this._addToggleButton(),this._miniMap.whenReady(u.Util.bind(function(){this._aimingRect=u.rectangle(this._mainMap.getBounds(),this.options.aimingRectOptions).addTo(this._miniMap),this._shadowRect=u.rectangle(this._mainMap.getBounds(),this.options.shadowRectOptions).addTo(this._miniMap),this._mainMap.on("moveend",this._onMainMapMoved,this),this._mainMap.on("move",this._onMainMapMoving,this),this._miniMap.on("movestart",this._onMiniMapMoveStarted,this),this._miniMap.on("move",this._onMiniMapMoving,this),this._miniMap.on("moveend",this._onMiniMapMoved,this)},this)),this._container},addTo:function(t){u.Control.prototype.addTo.call(this,t);var e=this.options.centerFixed||this._mainMap.getCenter();return this._miniMap.setView(e,this._decideZoom(!0)),this._setDisplay(this.options.minimized),this},onRemove:function(){this._mainMap.off("moveend",this._onMainMapMoved,this),this._mainMap.off("move",this._onMainMapMoving,this),this._miniMap.off("moveend",this._onMiniMapMoved,this),this._miniMap.removeLayer(this._layer)},changeLayer:function(t){this._miniMap.removeLayer(this._layer),this._layer=t,this._miniMap.addLayer(this._layer)},_addToggleButton:function(){this._toggleDisplayButton=this.options.toggleDisplay?this._createButton("",this._toggleButtonInitialTitleText(),"leaflet-control-minimap-toggle-display leaflet-control-minimap-toggle-display-"+this.options.position,this._container,this._toggleDisplayButtonClicked,this):void 0,this._toggleDisplayButton.style.width=this.options.collapsedWidth+"px",this._toggleDisplayButton.style.height=this.options.collapsedHeight+"px"},_toggleButtonInitialTitleText:function(){return this.options.minimized?this.options.strings.showText:this.options.strings.hideText},_createButton:function(t,e,n,i,r,o){var s=u.DomUtil.create("a",n,i);s.innerHTML=t,s.href="#",s.title=e;var a=u.DomEvent.stopPropagation;return u.DomEvent.on(s,"click",a).on(s,"mousedown",a).on(s,"dblclick",a).on(s,"click",u.DomEvent.preventDefault).on(s,"click",r,o),s},_toggleDisplayButtonClicked:function(){this._userToggledDisplay=!0,this._minimized?this._restore():this._minimize()},_setDisplay:function(t){t!==this._minimized&&(this._minimized?this._restore():this._minimize())},_minimize:function(){this.options.toggleDisplay?(this._container.style.width=this.options.collapsedWidth+"px",this._container.style.height=this.options.collapsedHeight+"px",this._toggleDisplayButton.className+=" minimized-"+this.options.position,this._toggleDisplayButton.title=this.options.strings.showText):this._container.style.display="none",this._minimized=!0,this._onToggle()},_restore:function(){this.options.toggleDisplay?(this._container.style.width=this.options.width+"px",this._container.style.height=this.options.height+"px",this._toggleDisplayButton.className=this._toggleDisplayButton.className.replace("minimized-"+this.options.position,""),this._toggleDisplayButton.title=this.options.strings.hideText):this._container.style.display="block",this._minimized=!1,this._onToggle()},_onMainMapMoved:function(){if(this._miniMapMoving)this._miniMapMoving=!1;else{var t=this.options.centerFixed||this._mainMap.getCenter();this._mainMapMoving=!0,this._miniMap.setView(t,this._decideZoom(!0)),this._setDisplay(this._decideMinimized())}this._aimingRect.setBounds(this._mainMap.getBounds())},_onMainMapMoving:function(){this._aimingRect.setBounds(this._mainMap.getBounds())},_onMiniMapMoveStarted:function(){if(!this.options.centerFixed){var t=this._aimingRect.getBounds(),e=this._miniMap.latLngToContainerPoint(t.getSouthWest()),n=this._miniMap.latLngToContainerPoint(t.getNorthEast());this._lastAimingRectPosition={sw:e,ne:n}}},_onMiniMapMoving:function(){this.options.centerFixed||!this._mainMapMoving&&this._lastAimingRectPosition&&(this._shadowRect.setBounds(new u.LatLngBounds(this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.sw),this._miniMap.containerPointToLatLng(this._lastAimingRectPosition.ne))),this._shadowRect.setStyle({opacity:1,fillOpacity:.3}))},_onMiniMapMoved:function(){this._mainMapMoving?this._mainMapMoving=!1:(this._miniMapMoving=!0,this._mainMap.setView(this._miniMap.getCenter(),this._decideZoom(!1)),this._shadowRect.setStyle({opacity:0,fillOpacity:0}))},_isZoomLevelFixed:function(){var t=this.options.zoomLevelFixed;return this._isDefined(t)&&this._isInteger(t)},_decideZoom:function(t){if(this._isZoomLevelFixed())return t?this.options.zoomLevelFixed:this._mainMap.getZoom();if(t)return this._mainMap.getZoom()+this.options.zoomLevelOffset;var e,n=this._miniMap.getZoom()-this._mainMap.getZoom(),i=this._miniMap.getZoom()-this.options.zoomLevelOffset;return n>this.options.zoomLevelOffset&&this._mainMap.getZoom()<this._miniMap.getMinZoom()-this.options.zoomLevelOffset?this._miniMap.getZoom()>this._lastMiniMapZoom?(e=this._mainMap.getZoom()+1,this._miniMap.setZoom(this._miniMap.getZoom()-1)):e=this._mainMap.getZoom():e=i,this._lastMiniMapZoom=this._miniMap.getZoom(),e},_decideMinimized:function(){return this._userToggledDisplay?this._minimized:this.options.autoToggleDisplay?!!this._mainMap.getBounds().contains(this._miniMap.getBounds()):this._minimized},_isInteger:function(t){return"number"==typeof t},_isDefined:function(t){return void 0!==t},_onToggle:function(){u.Util.requestAnimFrame(function(){u.DomEvent.on(this._container,"transitionend",this._fireToggleEvents,this),u.Browser.any3d||u.Util.requestAnimFrame(this._fireToggleEvents,this)},this)},_fireToggleEvents:function(){u.DomEvent.off(this._container,"transitionend",this._fireToggleEvents,this);var t={minimized:this._minimized};this.fire(this._minimized?"minimize":"restore",t),this.fire("toggle",t)}});return u.Map.mergeOptions({miniMapControl:!1}),u.Map.addInitHook(function(){this.options.miniMapControl&&(this.miniMapControl=(new t).addTo(this))}),t},i=window,t.exports=n(B),void 0!==i&&i.L&&(i.L.Control.MiniMap=n(L),i.L.control.minimap=function(t,e){return new i.L.Control.MiniMap(t,e)})});var Q=Object.freeze({Bezier:x,Coordtransform:O,FlashMarker:k,Label:R,MovingMarker:D,SeCanvas:T,MeasureAreaTool:A,MeasurePathTool:F,Proj:W,HeatmapOverlay:Z}),$={serviceUrl:"",token:"",styleVersion:30291022};function tt(t){t&&(t.serviceUrl&&($.serviceUrl=t.serviceUrl),t.token&&($.token=t.token))}var et="/sevs/v5/api/",nt="/seis/v5/api/",it="/api/v1/",rt={deleteUser:{url:nt+"user/{0}?op=delete",type:"GET"},register:{url:nt+"register",type:"POST"},logout:{url:nt+"login?op=delete",type:"GET"},login:{url:nt+"login",type:"POST"},noCodeLogin:{url:nt+"nocode_login",type:"POST"},createKey:{url:nt+"key",type:"GET"},getCaptcha:{url:nt+"captcha",type:"GET"},keyCheck:{url:nt+"key_check",type:"GET"},getUserList:{url:nt+"user",type:"GET"},createUser:{url:nt+"user",type:"post"},getUser:{url:nt+"user/{0}",type:"GET"},updateUser:{url:nt+"user/{0}",type:"POST"},updatePassword:{url:nt+"user/password",type:"post"},getGroupList:{url:nt+"group",type:"GET"},createGroup:{url:nt+"group",type:"post"},getGroup:{url:nt+"group/{0}?op=get_ex",type:"GET"},deleteGroup:{url:nt+"group/{0}?op=delete",type:"GET"},updateGroup:{url:nt+"group/{0}?op=update_ex",type:"post"},getResourceList:{url:nt+"resource",type:"GET"},getServiceConfig:{url:et+"config",type:"GET"},scaleset:{url:et+"crs/scaleset",type:"GET"},mapThumbnail:{url:et+"map/thumbnail",type:"GET"},crsInfo:{url:et+"crs/info",type:"GET"},crs:{url:et+"crs/list",type:"GET"},queryAllTag:{url:et+"datasource",type:"GET"},createTag:{url:et+"datasource",type:"POST"},queryTag:{url:et+"datasource/{0}",type:"GET"},updateTag:{url:et+"datasource/{0}",type:"POST"},deleteTag:{url:et+"datasource/{0}",type:"DELETE"},queryDir:{url:et+"dir",type:"GET"},queryLayerListSummary:{url:et+"layer/list/summary",type:"GET"},queryLayerListInfo:{url:et+"layer/list/info",type:"GET"},queryLayerInfo:{url:et+"layer/info",type:"GET"},queryLayerPreview:{url:et+"layer/preview",type:"GET"},queryAllDataset:{url:et+"dataset",type:"GET"},queryAllPublicDataset:{url:et+"dataset/public",type:"GET"},createDataset:{url:et+"dataset",type:"POST"},queryDataset:{url:et+"dataset/{0}",type:"GET"},updateDataset:{url:et+"dataset/{0}",type:"POST"},deleteDataset:{url:et+"dataset/{0}",type:"DELETE"},datasetInfo:{url:et+"dataset/info",type:"POST"},datasetInfo1:{url:et+"dataset/info",type:"GET"},getFieldDistinct:{url:et+"dataset/util?op=get_field_distinct",type:"post"},fieldStatistics:{url:et+"dataset/util?op=statistics",type:"post"},getMapList:{url:et+"map",type:"GET"},getPublicMapList:{url:et+"map/public",type:"GET"},getMap:{url:et+"map/{0}",type:"GET"},updateMap:{url:et+"map/{0}",type:"POST"},deleteMap:{url:et+"map/{0}?op=delete",type:"GET"},saveMap:{url:et+"map",type:"post"},getMapData:{url:et+"render",type:"post"},getMapServiceList:{url:et+"map/service",type:"GET"},createMapService:{url:et+"map/service",type:"post"},getMapService:{url:et+"map/service/{0}",type:"GET"},updateMapService:{url:et+"map/service/{0}",type:"post"},deleteMapService:{url:et+"map/service/{0}?op=delete",type:"GET"},projection:{url:et+"import/projection",type:"GET"},createImportMission:{url:et+"import/mission",type:"POST"},files:{url:et+"datasource/server_file",type:"GET"},getMissionInfos:{url:et+"import/mission",type:"GET"},startImportMission:{url:et+"import/start",type:"POST"},stopImportMission:{url:et+"import/stop",type:"POST"},deleteImportMission:{url:et+"import/mission/{0}",type:"DELETE"},queryImportMission:{url:et+"import/mission/{0}",type:"GET"},gjbImport:{url:et+"gjb/import",type:"post"},getMapsheetBytagid:{url:et+"gjb/mapsheet/datasourceid",type:"GET"},getMapsheetByfile:{url:et+"gjb/mapsheet/gjbfile",type:"GET"},updateGjb:{url:et+"gjb/update",type:"post"},metadataList:{url:et+"gjb/metadata/{0}",type:"GET"},createMetadata:{url:et+"gjb/metadata/{0}",type:"post"},updateMetadata:{url:et+"gjb/metadata/{0}",type:"post"},deleteMetadata:{url:et+"gjb/metadata/{0}?op=delete",type:"GET"},importGjbRecord:{url:et+"import/gjbrecord",type:"POST"},importOnline:{url:et+"import/online",type:"POST"},createExport:{url:et+"export/vector",type:"post"},exportMissionList:{url:et+"export/vector",type:"GET"},exportMissionStart:{url:et+"export/process",type:"GET"},uploadShpExport:{url:et+"export/uploadshp",type:"GET"},exportDownload:{url:et+"export/download",type:"GET"},createAddressService:{url:et+"addr/service",type:"POST"},addressSearch:{url:et+"addr/search",type:"GET"},searchDetail:{url:et+"addr/search/{0}",type:"GET"},queryFulltextRecord:{url:et+"fulltext/record",type:"GET"},fulltextAdddataset:{url:et+"fulltext/adddataset",type:"POST"},fulltextAddIndex:{url:et+"fulltext/addindex",type:"POST"},fulltextDeleteIndex:{url:et+"fulltext/deleteindex",type:"POST"},fulltextDefaultIndex:{url:et+"fulltext/defaultindex",type:"GET"},fulltextSearch:{url:et+"fulltext/search",type:"POST"},fulltextLocation:{url:et+"fulltext/location",type:"POST"},query:{url:et+"query",type:"post"},unlock:{url:et+"edit/lock?op=unlock",type:"POST"},unlockAll:{url:et+"edit/lock?op=unlock_all",type:"POST"},lock:{url:et+"edit/lock?op=lock",type:"POST"},batchFeatures:{url:et+"edit",type:"POST"},getSymbolLibList:{url:et+"symbolic_library",type:"GET"},createSymbolLib:{url:et+"symbolic_library",type:"post"},getSymbolLib:{url:et+"symbolic_library/{0}",type:"GET"},updateSymbolLib:{url:et+"symbolic_library/{0}",type:"post"},deleteSymbolLib:{url:et+"symbolic_library/{0}?op=delete",type:"GET"},getDtPVInfo:{url:et+"se_pv/query?cmd=getdatainfo",type:"GET"},queryPV:{url:et+"se_pv/query",type:"POST"},datasetList:{url:it+"datasets/batch",type:"POST"},datasetView:{url:it+"datasets/render",type:"POST"},datasetQuery:{url:it+"dataset/query",type:"POST"}};function ot(t,e){var n=$.serviceUrl;if(!n||!rt[t])return"";var i=$.token,r="";return r="/"===n.charAt(n.length-1)?(n=n.substring(0,n.length-1))+rt[t].url:n+rt[t].url,r=e?-1!==r.indexOf("?")?r+"&access_token="+i:r+"?access_token="+i:-1!==r.indexOf("?")?r+"&token="+i:r+"?token="+i}var st={SUCCESS:"$SUCCESS",SUCCESS_CLOUD:0};function at(t,e){var n=(e=e||{}).success,i=e.error;try{var r=!1!==e.async,o=e.type||"GET";o=o.toUpperCase();var s=e.contentType||"application/json;charset=UTF-8",a=e.data||null,u=e.dataType||"json",l=void 0;if((l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).onload=function(){if(n)if(u&&0<=u.indexOf("json")){var t="[object String]"===Object.prototype.toString.call(l.response);n(t?JSON.parse(l.response):l.response)}else n(l.response)},l.onerror=function(){i&&i()},"GET"===o||"DELETE"===o){if(a&&a instanceof Object){var h="";for(var c in a)h=h+c+"="+a[c]+"&";if(h)h=h.slice(0,-1),t=-1===t.indexOf("?")?t+"?"+h:t+"&"+h}a=null,"GET"===o&&(t=t.replace(/#/g,"%23"))}return l.open(o,t,r),l.responseType=u,l.setRequestHeader("Content-Type",s),l.send(a),l}catch(t){i&&i()}return null}function ut(t,e){var n=ot(t,(e=e||{}).isCloudVer);if(!n)return!1;if(/\{\d+?\}/.test(n)){if(!e||!e.data||!e.data.id)return!1;n=function(t){if(!t)return null;for(var e=t.split(/\{\d+?\}/),n=0;n<e.length&&void 0!==arguments[n+1];n++)e[n]+=arguments[n+1];return e.join("")}(n,e.data.id),delete e.data.id}var i,r=rt[i=t]?rt[i].type:"";return e.type=r,e&&e.data&&"POST"===r.toUpperCase()&&(e.data=JSON.stringify(e.data)),at(n,e)}var lt={GENERAL:0,BOUNDS:1,IDS:2,STATE:3,CIRCLE:4,EMPTY:5,EQUALS:10,DISJOINT:11,TOUCHES:12,WITHIN:13,OVERLAPS:14,CROSSES:15,INTERSECTS:16,CONTAINS:17};function ht(t){if(!(t&&t.data&&t.data.query_define&&t.data.view_bbox&&t.data.dataset_list&&0!==t.data.dataset_list.length))return null;var e=t.data.query_define;return e.crs||(e.crs={crsid:"EPSG:4326",proj4:"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",wkt:'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]]'}),ut("getMapData",t)}function ct(t){return t&&t.data&&t.data.bounds&&t.data.datasets&&0!==t.data.datasets.length?(t.isCloudVer=!0,ut("datasetView",t)):null}function pt(t){if(!(t&&t.data&&t.data.query_define&&t.data.dataset_list&&0!==t.data.dataset_list.length))return null;var e=t.data.query_define;return e.crs||(e.crs={crsid:"EPSG:4326",proj4:"+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",wkt:'GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.01745329251994328,AUTHORITY["EPSG","9122"]],AUTHORITY["EPSG","4326"]]'}),t.data.effective_dataset_count||(t.data.effective_dataset_count=t.data.dataset_list.length),ut("query",t)}function ft(t){return t&&t.data&&t.data.dataset_list&&0!==t.data.dataset_list.length?(t.data.query_define={type:lt.IDS},pt(t)):null}function dt(t){return t&&t.data&&t.data.dataset_list&&0!==t.data.dataset_list.length?(t.isCloudVer=!0,ut("datasetQuery",t)):null}var gt,yt=Object.freeze({render:ht,renderForCloud:ct,query:pt,queryByIds:ft,queryBySql:function(t){return t&&t.data&&t.data.dataset_list&&0!==t.data.dataset_list.length?(t.data.query_define={type:lt.GENERAL},pt(t)):null},queryBySpatial:function(t){return t&&t.data&&t.data.dataset_list&&0!==t.data.dataset_list.length&&t.data.query_define&&t.data.query_define.feature?pt(t):null},queryByFilter:dt}),_t=j(function(t){function c(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function a(t,e,n,i,r,o){return c((s=c(c(e,t),c(i,o)))<<(a=r)|s>>>32-a,n);var s,a}function p(t,e,n,i,r,o,s){return a(e&n|~e&i,t,e,r,o,s)}function f(t,e,n,i,r,o,s){return a(e&i|n&~i,t,e,r,o,s)}function d(t,e,n,i,r,o,s){return a(e^n^i,t,e,r,o,s)}function g(t,e,n,i,r,o,s){return a(n^(e|~i),t,e,r,o,s)}function u(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var n,i,r,o,s,a=1732584193,u=-271733879,l=-1732584194,h=271733878;for(n=0;n<t.length;n+=16)a=p(i=a,r=u,o=l,s=h,t[n],7,-680876936),h=p(h,a,u,l,t[n+1],12,-389564586),l=p(l,h,a,u,t[n+2],17,606105819),u=p(u,l,h,a,t[n+3],22,-1044525330),a=p(a,u,l,h,t[n+4],7,-176418897),h=p(h,a,u,l,t[n+5],12,1200080426),l=p(l,h,a,u,t[n+6],17,-1473231341),u=p(u,l,h,a,t[n+7],22,-45705983),a=p(a,u,l,h,t[n+8],7,1770035416),h=p(h,a,u,l,t[n+9],12,-1958414417),l=p(l,h,a,u,t[n+10],17,-42063),u=p(u,l,h,a,t[n+11],22,-1990404162),a=p(a,u,l,h,t[n+12],7,1804603682),h=p(h,a,u,l,t[n+13],12,-40341101),l=p(l,h,a,u,t[n+14],17,-1502002290),a=f(a,u=p(u,l,h,a,t[n+15],22,1236535329),l,h,t[n+1],5,-165796510),h=f(h,a,u,l,t[n+6],9,-1069501632),l=f(l,h,a,u,t[n+11],14,643717713),u=f(u,l,h,a,t[n],20,-373897302),a=f(a,u,l,h,t[n+5],5,-701558691),h=f(h,a,u,l,t[n+10],9,38016083),l=f(l,h,a,u,t[n+15],14,-660478335),u=f(u,l,h,a,t[n+4],20,-405537848),a=f(a,u,l,h,t[n+9],5,568446438),h=f(h,a,u,l,t[n+14],9,-1019803690),l=f(l,h,a,u,t[n+3],14,-187363961),u=f(u,l,h,a,t[n+8],20,1163531501),a=f(a,u,l,h,t[n+13],5,-1444681467),h=f(h,a,u,l,t[n+2],9,-51403784),l=f(l,h,a,u,t[n+7],14,1735328473),a=d(a,u=f(u,l,h,a,t[n+12],20,-1926607734),l,h,t[n+5],4,-378558),h=d(h,a,u,l,t[n+8],11,-2022574463),l=d(l,h,a,u,t[n+11],16,1839030562),u=d(u,l,h,a,t[n+14],23,-35309556),a=d(a,u,l,h,t[n+1],4,-1530992060),h=d(h,a,u,l,t[n+4],11,1272893353),l=d(l,h,a,u,t[n+7],16,-155497632),u=d(u,l,h,a,t[n+10],23,-1094730640),a=d(a,u,l,h,t[n+13],4,681279174),h=d(h,a,u,l,t[n],11,-358537222),l=d(l,h,a,u,t[n+3],16,-722521979),u=d(u,l,h,a,t[n+6],23,76029189),a=d(a,u,l,h,t[n+9],4,-640364487),h=d(h,a,u,l,t[n+12],11,-421815835),l=d(l,h,a,u,t[n+15],16,530742520),a=g(a,u=d(u,l,h,a,t[n+2],23,-995338651),l,h,t[n],6,-198630844),h=g(h,a,u,l,t[n+7],10,1126891415),l=g(l,h,a,u,t[n+14],15,-1416354905),u=g(u,l,h,a,t[n+5],21,-57434055),a=g(a,u,l,h,t[n+12],6,1700485571),h=g(h,a,u,l,t[n+3],10,-1894986606),l=g(l,h,a,u,t[n+10],15,-1051523),u=g(u,l,h,a,t[n+1],21,-2054922799),a=g(a,u,l,h,t[n+8],6,1873313359),h=g(h,a,u,l,t[n+15],10,-30611744),l=g(l,h,a,u,t[n+6],15,-1560198380),u=g(u,l,h,a,t[n+13],21,1309151649),a=g(a,u,l,h,t[n+4],6,-145523070),h=g(h,a,u,l,t[n+11],10,-1120210379),l=g(l,h,a,u,t[n+2],15,718787259),u=g(u,l,h,a,t[n+9],21,-343485551),a=c(a,i),u=c(u,r),l=c(l,o),h=c(h,s);return[a,u,l,h]}function l(t){var e,n="",i=32*t.length;for(e=0;e<i;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function h(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var i=8*t.length;for(e=0;e<i;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function i(t){var e,n,i="0123456789abcdef",r="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),r+=i.charAt(e>>>4&15)+i.charAt(15&e);return r}function n(t){return unescape(encodeURIComponent(t))}function r(t){return l(u(h(e=n(t)),8*e.length));var e}function o(t,e){return function(t,e){var n,i,r=h(t),o=[],s=[];for(o[15]=s[15]=void 0,16<r.length&&(r=u(r,8*t.length)),n=0;n<16;n+=1)o[n]=909522486^r[n],s[n]=1549556828^r[n];return i=u(o.concat(h(e)),512+8*e.length),l(u(s.concat(i),640))}(n(t),n(e))}function e(t,e,n){return e?n?o(e,t):i(o(e,t)):n?r(t):i(r(t))}var s;s=G,t.exports?t.exports=e:s.md5=e}),mt={register:function(t){if(!t||!t.data)return!1;var e=t.data;return!!(e.account&&e.email&&e.name&&e.password)&&ut("register",t)},login:function(t){if(!t||!t.data)return!1;var e=t.data;if(!(e.user_name&&e.verify_code&&e.verify_string&&e.password))return!1;var n=_t(e.password),i=e.user_name+"_"+n+"_"+e.verify_string,r=_t(i);return t.data={user_name:e.user_name,verify_code:e.verify_code,encode_result:r,verify_string:e.verify_string},ut("login",t)},noCodeLogin:function(t){if(!t||!t.data)return!1;var e=t.data;if(!e.user_name||!e.password)return!1;var n=_t(e.password),i=e.user_name+"_"+n+"_ABC12",r=_t(i);return t.data={user_name:e.user_name,verify_code:"uuid",encode_result:r,verify_string:"ABC12"},ut("noCodeLogin",t)},logout:function(t){return ut("logout",t)},keyCheck:function(t){return ut("keyCheck",t)}},vt=Object.freeze({ajax:at,httpRequest:ut,StatusEnum:st,setConfig:tt,getConfig:function(){return $},Query:yt,User:mt,getRequestUrl:ot});B.Map.mergeOptions({isCloudVer:!1,pageCount:2e4,edit:{tolerance:16,autoPanForEdit:!0}}),B.Map.include((f(gt={isCloudVer:function(){return this.options.isCloudVer},pageCount:function(){return this.options.pageCount},addDataset:function(t){return this.seManager.datasets||(this.seManager.datasets=[]),!(!t||this.existDatasetById(t.id))&&(this.seManager.datasets.push(t),!0)},existDatasetById:function(e){return this.seManager.datasets&&this.seManager.datasets.some(function(t){return t.id==e})},findDatasetById:function(t){for(var e=this.seManager.datasets?this.seManager.datasets.length:0,n=0;n<e;n++)if(this.seManager.datasets[n].id==t)return this.seManager.datasets[n];return null},getDatasetIndexById:function(t){for(var e=this.seManager.datasets?this.seManager.datasets.length:0,n=0;n<e;n++)if(this.seManager.datasets[n].id==t)return n;return-1},removeDataset:function(t){var e=this.getDatasetIndexById(t);return 0<=e&&(this.seManager.datasets.splice(e,1),!0)},addCloudLayers:function(t,e){this.seManager&&this.seManager.addDtDataForCloud(t,e)},addCloudLayersExt:function(t,e){this.seManager&&this.seManager.addDtDataForCloudExt(t,e)},setEditLayer:function(t){return this.seManager&&this.seManager.setEditLayer(t)},getEditLayer:function(){return this.seManager&&this.seManager.getEditLayer()},addFeatures:function(t){return!!t&&(this.seManager&&this.seManager._editManager&&this.seManager._editManager.addFeatures(t))},modifyFeatures:function(t){return!!t&&(this.seManager&&this.seManager._editManager&&this.seManager._editManager.modifyFeatures(t))},editManager:function(){return this.seManager&&this.seManager._editManager},deleteFeatures:function(t){return!!t&&(this.seManager&&this.seManager._editManager&&this.seManager._editManager.deleteFeatures(t))},modifyFeaturesAttribute:function(t,e,n){var i=this.findDatasetById(t);return!!i&&i.modifyAttributes(e,n)},endEdit:function(){return this.seManager&&this.seManager._editManager&&this.seManager._editManager.finishEdit()},undo:function(){return this.seManager&&this.seManager._editManager&&this.seManager._editManager.undo()},redo:function(){return this.seManager&&this.seManager._editManager&&this.seManager._editManager.redo()},getVectorLayers:function(){return this.seManager&&this.seManager.getVectorLayers()},refresh:function(){return this.seManager&&this.seManager.refresh()},changePage:function(t){return this.seManager&&this.seManager.changePage(t)},clearSelection:function(){return this.seManager&&this.seManager.clearSelection()},getSelection:function(){return this.seManager&&this.seManager.getSelections()},removeVectorLayer:function(t,e){var n=this.seManager&&this.seManager.getVectorServiceByLayerId(t);if(!n)return!1;var i=this.getLayerById(t),r=n.removeLayer(t);if(r&&e){var o=i&&i.dataset?i.dataset.id:null;this.removeDataset(o)}return r&&(this.removeSelectionByLayerId(t),this.refresh()),r},removeAllVectorLayer:function(){var e=this,t=this.getVectorLayers();t&&t.forEach(function(t){e.removeVectorLayer(t.getID(),!0)})},getLayerById:function(t){return this.seManager&&this.seManager.getLayerById(t)},removeSelectionByLayerId:function(t){return this.seManager&&this.seManager.removeSelectionByLayerId(t)}},"getVectorLayers",function(t){return this.seManager&&this.seManager.getVectorLayers(t)}),f(gt,"getVectorLayerIndexByLayerId",function(t){var e=this.getVectorLayers();if(e&&void 0!==t)for(var n=e?e.length:0,i=0;i<n;i++)if(e[i].getID()===t)return i;return-1}),f(gt,"editManager",function(){return this.seManager&&this.seManager._editManager}),f(gt,"getAllDatasetEditFeatures",function(){var n=null;return this.seManager.datasets&&this.seManager.datasets.forEach(function(t){var e=t.getEditFeatures();e&&(n=n||[]).push(e)}),n}),f(gt,"clearAllDatasetFeatures",function(e){this.seManager.datasets&&this.seManager.datasets.forEach(function(t){t.clearData(e)})}),f(gt,"setAction",function(t){this.seManager&&this.seManager.setAction(t)}),f(gt,"getAction",function(){return this.seManager&&this.seManager.getAction()}),f(gt,"showIdentifyFeatures",function(t){this.seManager&&this.seManager.showIdentifyFeatures(t)}),f(gt,"clearMeasure",function(){this.seManager&&this.seManager.clearMeasure()}),f(gt,"updateDatasetFields",function(e,n){var t=this.findDatasetById(e);if(!t)return!1;var i=t.updateFields(n);if(i){var r=this.getVectorLayers(!0);return r&&r.forEach(function(t){t.dataset.getID()==e&&t.dataset.setFieldInfos(n)}),this.editManager().updateHistorysProperties(e)}return i}),f(gt,"combineFeatures",function(t,e){var n=this.editManager();return!!n&&n.combineFeatures(t,e)}),gt));var bt={getUid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}).toLowerCase()},create:Object.create||function(t){return xt.prototype=t,new xt},setOptions:function(t,e){for(var n in t.options||(t.options=t.options?this.create(t.options):{}),e)t.options[n]=e[n];return t.options},extend:function(t){var e,n=void 0,i=void 0,r=void 0;for(i=1,e=arguments.length;i<e;i++)for(n in r=arguments[i])t[n]=r[n];return t},clone:function(t){if(!t)return null;var e=JSON.stringify(t);return JSON.parse(e)},poundToPixel:function(t){return t/72*96},pixelToPound:function(t){return t/96*72},deg2Rad:function(t){return t*Math.PI/180},rad2Deg:function(t){return 180*t/Math.PI},char2buf:function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;i++)n[i]=t[i].charCodeAt();return e},getPolylineMidPoint:function(t,e,n,i,r){var o=e;if(o<2)return!1;for(var s=0,a=0;a<o-1;a++)s+=Math.sqrt((t[a+1].x-t[a].x)*(t[a+1].x-t[a].x)+(t[a+1].y-t[a].y)*(t[a+1].y-t[a].y));var u=s/2;if((u+=i)<0||s<u)return!1;for(var l=0,h=0,c=1;c<o;c++){var p=Math.sqrt(Math.pow(t[c].x-t[c-1].x,2)+Math.pow(t[c].y-t[c-1].y,2));if(h=(l+=p)-u,Math.abs(h)<1e-5){if(n.x=t[c].x,n.y=t[c].y,r)n.a=360*Math.random();else if(c===o-1)n.a=this.getFastAngle(t[c-1].x,t[c-c].y,t[c].x,t[c].y);else{var f=(Math.atan((t[c].y-t[c-1].y)/(t[c].x-t[c-1].x))+Math.atan((t[c+1].y-t[c].y)/(t[c+1].x-t[c].x)))/2;n.a=f}return!0}if(0<h)return n.x=t[c-1].x+(p-h)*(t[c].x-t[c-1].x)/p,n.y=t[c-1].y+(p-h)*(t[c].y-t[c-1].y)/p,n.a=r?360*Math.random():this.getFastAngle(t[c-1].x,t[c-1].y,t[c].x,t[c].y),!0}return!1},getFastAngle:function(t,e,n,i){var r=void 0;return Math.abs(t-n)<1e-5?(r=90,i===e&&(r=0),i<e&&(r+=180)):Math.abs(i-e)<1e-5?r=t<n?0:180:(r=Math.atan((i-e)/(n-t)),r*=180/Math.PI,t<n?i<=e&&(r+=360):r+=180),r},getPolylineDecroPoints:function(t,e,n,i,r,o,s){var a=n;if(a<2)return!1;var u=i.length;if(u<1)return!1;for(var l=r,h=0,c=0,p=0,f=0,d=0,g=0,y=0;y<a-1;y++)if(h=c,l<(c+=Math.sqrt(Math.pow(e[y+1].x-e[y].x,2)+Math.pow(e[y+1].y-e[y].y,2)))){var _=0;_=s?Math.random()%360:y===a-1?this.getFastAngle(e[y-1].x,e[y-1].y,e[y].x,e[y].y):this.getFastAngle(e[y].x,e[y].y,e[y+1].x,e[y+1].y);do{var m={x:0,y:0,a:0};m.a=_;var v=this.deg2Rad(_);p=l-h,f=Math.cos(v),d=Math.sin(v),m.x=e[y].x+p*f,m.y=e[y].y+p*d,t.push(m),l+=i[g%u],g++}while(l<c)}return!0},getCenter:function(t){if(!t||t.length<3)return null;var e=void 0,n=void 0,i=void 0,r=void 0,o=void 0,s=0,a=0,u=0,l=t.length;for(e=0,n=l-1;e<l;n=e++)i=t[e],r=t[n],o=i.y*r.x-r.y*i.x,a+=(i.x+r.x)*o,u+=(i.y+r.y)*o,s+=3*o;return 0===s?t[0]:{x:a/s,y:u/s}},getPolygonBox:function(t){if(!t||0===t.length)return null;var e=t[0].x,n=t[0].y,i=t[0].x,r=t[0].y;return t.forEach(function(t){t.x<e?e=t.x:t.x>i&&(i=t.x),t.y<n?n=t.y:t.y>r&&(r=t.y)}),[e,n,i,r]}};function xt(){}var Et={points:null,polyCount:null,subCount:0},It=(c(Lt,[{key:"points",get:function(){return this.options.points},set:function(t){this.options.points=t}},{key:"polyCount",get:function(){return this.options.polyCount},set:function(t){this.options.polyCount=t}},{key:"subCount",get:function(){return this.options.subCount},set:function(t){this.options.subCount=t}}]),Lt);function Lt(t){h(this,Lt),this.options=bt.extend({},Et,t)}var wt=6371008.8,St={meters:wt,metres:wt,millimeters:1e3*wt,millimetres:1e3*wt,centimeters:100*wt,centimetres:100*wt,kilometers:wt/1e3,kilometres:wt/1e3,miles:wt/1609.344,nauticalmiles:wt/1852,inches:39.37*wt,yards:wt/1.0936,feet:3.28084*wt,radians:1,degrees:wt/111325},Mt={meters:1,metres:1,millimeters:1e3,millimetres:1e3,centimeters:100,centimetres:100,kilometers:.001,kilometres:.001,miles:1/1609.344,nauticalmiles:1/1852,inches:39.37,yards:1/1.0936,feet:3.28084,radians:1/wt,degrees:1/111325},Ct={meters:1,metres:1,millimeters:1e6,millimetres:1e6,centimeters:1e4,centimetres:1e4,kilometers:1e-6,kilometres:1e-6,acres:247105e-9,miles:386e-9,yards:1.195990046,feet:10.763910417,inches:1550.003100006};function Pt(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.bbox,r=n.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&$t(i),r&&te(r);var o={type:"Feature"};return r&&(o.id=r),i&&(o.bbox=i),o.properties=e||{},o.geometry=t,o}function Nt(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i,r=n.bbox;if(!t)throw new Error("type is required");if(!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");switch(r&&$t(r),t){case"Point":i=Ot(e).geometry;break;case"LineString":i=Dt(e).geometry;break;case"Polygon":i=kt(e).geometry;break;case"MultiPoint":i=Gt(e).geometry;break;case"MultiLineString":i=Bt(e).geometry;break;case"MultiPolygon":i=Ut(e).geometry;break;default:throw new Error(t+" is invalid")}return r&&(i.bbox=r),i}function Ot(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Zt(t[0])||!Zt(t[1]))throw new Error("coordinates must contain numbers");return Pt({type:"Point",coordinates:t},e,n)}function Tt(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return Ft(t.map(function(t){return Ot(t,e)}),n)}function kt(t,e,n){if(!t)throw new Error("coordinates is required");for(var i=0;i<t.length;i++){var r=t[i];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var o=0;o<r[r.length-1].length;o++){if(0===i&&0===o&&!Zt(r[0][0])||!Zt(r[0][1]))throw new Error("coordinates must contain numbers");if(r[r.length-1][o]!==r[0][o])throw new Error("First and last Position are not equivalent.")}}return Pt({type:"Polygon",coordinates:t},e,n)}function Rt(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return Ft(t.map(function(t){return kt(t,e)}),n)}function Dt(t,e,n){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!Zt(t[0][1])||!Zt(t[0][1]))throw new Error("coordinates must contain numbers");return Pt({type:"LineString",coordinates:t},e,n)}function At(t,e,n){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");return Ft(t.map(function(t){return Dt(t,e)}),n)}function Ft(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&$t(n),i&&te(i);var r={type:"FeatureCollection"};return i&&(r.id=i),n&&(r.bbox=n),r.features=t,r}function Bt(t,e,n){if(!t)throw new Error("coordinates is required");return Pt({type:"MultiLineString",coordinates:t},e,n)}function Gt(t,e,n){if(!t)throw new Error("coordinates is required");return Pt({type:"MultiPoint",coordinates:t},e,n)}function Ut(t,e,n){if(!t)throw new Error("coordinates is required");return Pt({type:"MultiPolygon",coordinates:t},e,n)}function jt(t,e,n){if(!t)throw new Error("geometries is required");if(!Array.isArray(t))throw new Error("geometries must be an Array");return Pt({type:"GeometryCollection",geometries:t},e,n)}function qt(t,e){if(null==t||isNaN(t))throw new Error("num is required");if(e&&!(0<=e))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function zt(t,e){if(null==t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=St[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t*n}function Vt(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var n=St[e||"kilometers"];if(!n)throw new Error(e+" units is invalid");return t/n}function Yt(t,e){return Xt(Vt(t,e))}function Ht(t){if(null==t)throw new Error("bearing is required");var e=t%360;return e<0&&(e+=360),e}function Xt(t){if(null==t)throw new Error("radians is required");return 180*(t%(2*Math.PI))/Math.PI}function Jt(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function Wt(t,e,n){if(null==t)throw new Error("length is required");if(!(0<=t))throw new Error("length must be a positive number");return zt(Vt(t,e),n||"kilometers")}function Kt(t,e,n){if(null==t)throw new Error("area is required");if(!(0<=t))throw new Error("area must be a positive number");var i=Ct[e||"meters"];if(!i)throw new Error("invalid original units");var r=Ct[n||"kilometers"];if(!r)throw new Error("invalid final units");return t/i*r}function Zt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Qt(t){return!!t&&t.constructor===Object}function $t(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!Zt(t))throw new Error("bbox must only contain numbers")})}function te(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var ee=Object.freeze({earthRadius:wt,factors:St,unitsFactors:Mt,areaFactors:Ct,feature:Pt,geometry:Nt,point:Ot,points:Tt,polygon:kt,polygons:Rt,lineString:Dt,lineStrings:At,featureCollection:Ft,multiLineString:Bt,multiPoint:Gt,multiPolygon:Ut,geometryCollection:jt,round:qt,radiansToLength:zt,lengthToRadians:Vt,lengthToDegrees:Yt,bearingToAzimuth:Ht,radiansToDegrees:Xt,degreesToRadians:Jt,convertLength:Wt,convertArea:Kt,isNumber:Zt,isObject:Qt,validateBBox:$t,validateId:te,radians2degrees:function(){throw new Error("method has been renamed to `radiansToDegrees`")},degrees2radians:function(){throw new Error("method has been renamed to `degreesToRadians`")},distanceToDegrees:function(){throw new Error("method has been renamed to `lengthToDegrees`")},distanceToRadians:function(){throw new Error("method has been renamed to `lengthToRadians`")},radiansToDistance:function(){throw new Error("method has been renamed to `radiansToLength`")},bearingToAngle:function(){throw new Error("method has been renamed to `bearingToAzimuth`")},convertDistance:function(){throw new Error("method has been renamed to `convertLength`")}});function ne(t,e,n){if(null!==t)for(var i,r,o,s,a,u,l,h,c=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,y=d?t.features.length:1,_=0;_<y;_++){a=(h=!!(l=d?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var m=0;m<a;m++){var v=0,b=0;if(null!==(s=h?l.geometries[m]:l)){u=s.coordinates;var x=s.type;switch(c=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":e(u,p,_,v,b),p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++)e(u[i],p,_,v,b),p++,"MultiPoint"===x&&v++;"LineString"===x&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(r=0;r<u[i].length-c;r++)e(u[i][r],p,_,v,b),p++;"MultiLineString"===x&&v++,"Polygon"===x&&b++}"Polygon"===x&&v++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for("MultiPolygon"===x&&(b=0),r=0;r<u[i].length;r++){for(o=0;o<u[i][r].length-c;o++)e(u[i][r][o],p,_,v,b),p++;b++}v++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)ne(s.geometries[i],e,n);break;default:throw new Error("Unknown Geometry Type")}}}}}function ie(t,o,s,e){var a=s;return ne(t,function(t,e,n,i,r){a=0===e&&void 0===s?t:o(a,t,e,n,i,r)},e),a}function re(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length;n++)e(t.features[n].properties,n);break;case"Feature":e(t.properties,0)}}function oe(t,n,i){var r=i;return re(t,function(t,e){r=0===e&&void 0===i?t:n(r,t,e)}),r}function se(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length;n++)e(t.features[n],n)}function ae(t,n,i){var r=i;return se(t,function(t,e){r=0===e&&void 0===i?t:n(r,t,e)}),r}function ue(t){var e=[];return ne(t,function(t){e.push(t)}),e}function le(t,e){var n,i,r,o,s,a,u,l,h,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(n=0;n<g;n++){for(a=f?t.features[n].geometry:d?t.geometry:t,l=f?t.features[n].properties:d?t.properties:{},h=f?t.features[n].bbox:d?t.bbox:void 0,c=f?t.features[n].id:d?t.id:void 0,s=(u=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=u?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":e(o,p,l,h,c);break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)e(o.geometries[i],p,l,h,c);break;default:throw new Error("Unknown Geometry Type")}else e(null,p,l,h,c);p++}}function he(t,o,s){var a=s;return le(t,function(t,e,n,i,r){a=0===e&&void 0===s?t:o(a,t,e,n,i,r)}),a}function ce(t,a){le(t,function(t,n,i,e,r){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return void a(Pt(t,i,{bbox:e,id:r}),n,0)}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}t.coordinates.forEach(function(t,e){a(Pt({type:o,coordinates:t},i),n,e)})})}function pe(t,i,r){var o=r;return ce(t,function(t,e,n){o=0===e&&0===n&&void 0===r?t:i(o,t,e,n)}),o}function fe(t,c){ce(t,function(a,u,l){var h=0;if(a.geometry){var t=a.geometry.type;"Point"!==t&&"MultiPoint"!==t&&ie(a,function(t,e,n,i,r,o){var s=Dt([t,e],a.properties);return c(s,u,l,o,h),h++,e})}})}function de(t,o,s){var a=s,u=!1;return fe(t,function(t,e,n,i,r){a=!1===u&&void 0===s?t:o(a,t,e,n,i,r),u=!0}),a}function ge(t,s){if(!t)throw new Error("geojson is required");ce(t,function(t,e,n){if(null!==t.geometry){var i=t.geometry.type,r=t.geometry.coordinates;switch(i){case"LineString":s(t,e,n,0,0);break;case"Polygon":for(var o=0;o<r.length;o++)s(Dt(r[o],t.properties),e,n,o)}}})}function ye(t,r,o){var s=o;return ge(t,function(t,e,n,i){s=0===e&&void 0===o?t:r(s,t,e,n,i)}),s}var _e=Object.freeze({coordEach:ne,coordReduce:ie,propEach:re,propReduce:oe,featureEach:se,featureReduce:ae,coordAll:ue,geomEach:le,geomReduce:he,flattenEach:ce,flattenReduce:pe,segmentEach:fe,segmentReduce:de,lineEach:ge,lineReduce:ye});function me(t){var e=[1/0,1/0,-1/0,-1/0];return ne(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}function ve(t){if(!t)throw new Error("obj is required");var e=be(t);if(1<e.length&&Zt(e[0])&&Zt(e[1]))return e;throw new Error("Coordinate is not a valid Point")}function be(t){if(!t)throw new Error("obj is required");var e;if(t.length?e=t:t.coordinates?e=t.coordinates:t.geometry&&t.geometry.coordinates&&(e=t.geometry.coordinates),e)return xe(e),e;throw new Error("No valid coordinates")}function xe(t){if(1<t.length&&Zt(t[0])&&Zt(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return xe(t[0]);throw new Error("coordinates must only contain numbers")}function Ee(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function Ie(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function Le(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var i=0;i<t.features.length;i++){var r=t.features[i];if(!r||"Feature"!==r.type||!r.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}}function we(t){if(!t)throw new Error("geojson is required");if(void 0!==t.geometry)return t.geometry;if(t.coordinates||t.geometries)return t;throw new Error("geojson must be a valid Feature or Geometry Object")}function Se(){throw new Error("invariant.getGeomType has been deprecated in v5.0 in favor of invariant.getType")}function Me(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}var Ce=Object.freeze({getCoord:ve,getCoords:be,containsNumber:xe,geojsonType:Ee,featureOf:Ie,collectionOf:Le,getGeom:we,getGeomType:Se,getType:Me}),Pe={successCallback:null,verbose:!1},Ne={};function Oe(t,e,n){n=n||{};for(var i=Object.keys(Pe),r=0;r<i.length;r++){var o=i[r],s=n[o];s=null!=s?s:Pe[o],Ne[o]=s}Ne.verbose&&console.log("MarchingSquaresJS-isoContours: computing isocontour for "+e);var a=function(h){var c=[],p=0;h.rows,h.cols;return h.cells.forEach(function(t,l){t.forEach(function(t,e){if(void 0!==t&&(5!==(u=t).cval&&10!==u.cval)&&!ke(t)){var n=function(t,e,n){var i,r,o,s=t.length,a=[],u=[0,0,1,1,0,0,0,0,-1,0,1,1,-1,0,-1,0],l=[0,-1,0,0,1,1,1,1,0,-1,0,0,0,-1,0,0],h=["none","bottom","right","right","top","top","top","top","left","bottom","right","right","left","bottom","left","none"],c=(t[e][n],t[e][n]),p=c.cval,f=De(c,o=["none","left","bottom","left","right","none","bottom","left","top","top","none","top","right","right","bottom","none"][p]);a.push([n+f[0],e+f[1]]),f=De(c,o=h[p]),a.push([n+f[0],e+f[1]]),Re(c);var d=n+u[p],g=e+l[p],y=p;for(;0<=d&&0<=g&&g<s&&(d!=n||g!=e)&&void 0!==(c=t[g][d]);){if(0===(p=c.cval)||15===p)return{path:a,info:"mergeable"};o=h[p],i=u[p],r=l[p],5!==p&&10!==p||(5===p?c.flipped?r=(i=-1===l[y]?(o="left",-1):(o="right",1),0):-1===u[y]&&(o="bottom",i=0,r=-1):10===p&&(c.flipped?r=-1===u[y]?(o="top",i=0,1):(o="bottom",i=0,-1):1===l[y]&&(o="left",i=-1,r=0))),f=De(c,o),a.push([d+f[0],g+f[1]]),Re(c),d+=i,g+=r,y=p}return{path:a,info:"closed"}}(h.cells,l,e),i=!1;if("mergeable"===n.info)for(var r=n.path[n.path.length-1][0],o=n.path[n.path.length-1][1],s=p-1;0<=s;s--)if(Math.abs(c[s][0][0]-r)<=1e-7&&Math.abs(c[s][0][1]-o)<=1e-7){for(var a=n.path.length-2;0<=a;--a)c[s].unshift(n.path[a]);i=!0;break}i||(c[p++]=n.path)}var u})}),c}(function(t,e){for(var n=t.length-1,i=t[0].length-1,r={rows:n,cols:i,cells:[]},o=0;o<n;++o){r.cells[o]=[];for(var s=0;s<i;++s){var a=0,u=t[o+1][s],l=t[o+1][s+1],h=t[o][s+1],c=t[o][s];if(!(isNaN(u)||isNaN(l)||isNaN(h)||isNaN(c))){a|=e<=u?8:0,a|=e<=l?4:0,a|=e<=h?2:0;var p,f,d,g,y=!1;if(5===(a|=e<=c?1:0)||10===a){var _=(u+l+h+c)/4;5===a&&_<e?(a=10,y=!0):10===a&&_<e&&(a=5,y=!0)}if(0!==a&&15!==a)p=f=d=g=.5,1===a?(d=1-Te(e,u,c),f=1-Te(e,h,c)):2===a?(f=Te(e,c,h),g=1-Te(e,l,h)):3===a?(d=1-Te(e,u,c),g=1-Te(e,l,h)):4===a?(p=Te(e,u,l),g=Te(e,h,l)):5===a?(p=Te(e,u,l),g=Te(e,h,l),f=1-Te(e,h,c),d=1-Te(e,u,c)):6===a?(f=Te(e,c,h),p=Te(e,u,l)):7===a?(d=1-Te(e,u,c),p=Te(e,u,l)):8===a?(d=Te(e,c,u),p=1-Te(e,l,u)):9===a?(f=1-Te(e,h,c),p=1-Te(e,l,u)):10===a?(p=1-Te(e,l,u),g=1-Te(e,l,h),f=Te(e,c,h),d=Te(e,c,u)):11===a?(p=1-Te(e,l,u),g=1-Te(e,l,h)):12===a?(d=Te(e,c,u),g=Te(e,h,l)):13===a?(f=1-Te(e,h,c),g=Te(e,h,l)):14===a?(d=Te(e,c,u),f=Te(e,c,h)):console.log("MarchingSquaresJS-isoContours: Illegal cval detected: "+a),r.cells[o][s]={cval:a,flipped:y,top:p,right:g,bottom:f,left:d}}}}return r}(t,e));return"function"==typeof Ne.successCallback&&Ne.successCallback(a),a}function Te(t,e,n){return(t-e)/(n-e)}function ke(t){return 0===t.cval||15===t.cval}function Re(t){ke(t)||5===t.cval||10===t.cval||(t.cval=15)}function De(t,e){return"top"===e?[t.top,1]:"bottom"===e?[t.bottom,0]:"right"===e?[1,t.right]:"left"===e?[0,t.left]:void 0}function Ae(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;Le(t,"Point","input must contain Points");for(var o,s,a=(o=i,s={},se(t,function(t){var e=be(t)[1];s[e]||(s[e]=[]),s[e].push(t)}),Object.keys(s).map(function(t){return s[t].sort(function(t,e){return be(t)[0]-be(e)[0]})}).sort(function(t,e){return o?be(t[0])[1]-be(e[0])[1]:be(e[0])[1]-be(t[0])[1]})),u=[],l=0;l<a.length;l++){for(var h=a[l],c=[],p=0;p<h.length;p++){var f=h[p];f.properties[n]?c.push(f.properties[n]):c.push(0),!0===r&&(f.properties.matrixPosition=[l,p])}u.push(c)}return u}var Fe=function t(e,n,i,r,o){i=i||0;r=r||e.length-1;o=o||Ge;for(;i<r;){if(600<r-i){var s=r-i+1,a=n-i+1,u=Math.log(s),l=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*l*(s-l)/s)*(a-s/2<0?-1:1),c=Math.max(i,Math.floor(n-a*l/s+h)),p=Math.min(r,Math.floor(n+(s-a)*l/s+h));t(e,n,c,p,o)}var f=e[n],d=i,g=r;for(Be(e,i,n),0<o(e[r],f)&&Be(e,i,r);d<g;){for(Be(e,d,g),d++,g--;o(e[d],f)<0;)d++;for(;0<o(e[g],f);)g--}0===o(e[i],f)?Be(e,i,g):Be(e,++g,r),g<=n&&(i=g+1),n<=g&&(r=g-1)}};function Be(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Ge(t,e){return t<e?-1:e<t?1:0}var Ue=je;function je(t,e){if(!(this instanceof je))return new je(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function qe(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function ze(t,e){Ve(t,0,t.children.length,e,t)}function Ve(t,e,n,i,r){(r=r||Qe(null)).minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],Ye(r,t.leaf?i(o):o);return r}function Ye(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function He(t,e){return t.minX-e.minX}function Xe(t,e){return t.minY-e.minY}function Je(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function We(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Ke(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Ze(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Qe(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function $e(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,Fe(t,o,e,n,r),s.push(e,o,o,n))}function tn(t,e){return t(e={exports:{}},e.exports),e.exports}je.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!Ze(t,e))return n;for(var r,o,s,a,u=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],Ze(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):Ke(t,a)?this._all(s,n):u.push(s));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Ze(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],Ze(t,s=e.leaf?n(o):o)){if(e.leaf||Ke(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Qe([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),u=[],l=[];s||u.length;){if(s||(s=u.pop(),i=u[u.length-1],n=l.pop(),o=!0),s.leaf&&-1!==(r=qe(t,s.children,e)))return s.children.splice(r,1),u.push(s),this._condense(u),this;o||s.leaf||!Ke(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(u.push(s),l.push(n),n=0,s=(i=s).children[0])}return this},toBBox:function(t){return t},compareMinX:He,compareMinY:Xe,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return ze(r=Qe(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=Qe([])).leaf=!1,r.height=i;var a,u,l,h,c=Math.ceil(o/s),p=c*Math.ceil(Math.sqrt(s));for($e(t,e,n,p,this.compareMinX),a=e;a<=n;a+=p)for($e(t,a,l=Math.min(a+p-1,n),c,this.compareMinY),u=a;u<=l;u+=c)h=Math.min(u+c-1,l),r.children.push(this._build(t,u,h,i-1));return ze(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,u,l,h,c,p,f;i.push(e),!e.leaf&&i.length-1!==n;){for(h=c=1/0,r=0,o=e.children.length;r<o;r++)u=Je(s=e.children[r]),p=t,f=s,(l=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-u)<c?(c=l,h=u<h?u:h,a=s):l===c&&u<h&&(h=u,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),Ye(s,r);0<=e&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=Qe(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,ze(n,this.toBBox),ze(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=Qe([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ze(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,u,l,h,c,p,f,d,g,y;for(u=l=1/0,i=e;i<=n-e;i++)r=Ve(t,0,i,this.toBBox),o=Ve(t,i,n,this.toBBox),c=r,p=o,void 0,f=Math.max(c.minX,p.minX),d=Math.max(c.minY,p.minY),g=Math.min(c.maxX,p.maxX),y=Math.min(c.maxY,p.maxY),s=Math.max(0,g-f)*Math.max(0,y-d),a=Je(r)+Je(o),s<u?(u=s,h=i,l=a<l?a:l):s===u&&a<l&&(l=a,h=i);return h},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:He,r=t.leaf?this.compareMinY:Xe;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=Ve(t,0,e,s),u=Ve(t,n-e,n,s),l=We(a)+We(u);for(r=e;r<n-e;r++)o=t.children[r],Ye(a,t.leaf?s(o):o),l+=We(a);for(r=n-e-1;e<=r;r--)o=t.children[r],Ye(u,t.leaf?s(o):o),l+=We(u);return l},_adjustParentBBoxes:function(t,e,n){for(var i=n;0<=i;i--)Ye(e[i],t)},_condense:function(t){for(var e,n=t.length-1;0<=n;n--)0===t[n].children.length?0<n?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():ze(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var en=function(t,e,n){var i=t*e,r=nn*t,o=r-(r-t),s=t-o,a=nn*e,u=a-(a-e),l=e-u,h=s*l-(i-o*u-s*u-o*l);if(n)return n[0]=h,n[1]=i,n;return[h,i]},nn=+(Math.pow(2,27)+1);function rn(t,e){var n=0|t.length,i=0|e.length;if(1==n&&1==i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);if(r)return[r,n];return[n]}(t[0],e[0]);var r,o,s=new Array(n+i),a=0,u=0,l=0,h=Math.abs,c=t[u],p=h(c),f=e[l],d=h(f);p<d?(o=c,(u+=1)<n&&(c=t[u],p=h(c))):(o=f,(l+=1)<i&&(f=e[l],d=h(f))),u<n&&p<d||i<=l?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=e[l],d=h(f)));for(var g,y,_=r+o,m=_-r,v=o-m,b=v,x=_;u<n&&l<i;)p<d?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=e[l],d=h(f))),(v=(o=b)-(m=(_=r+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g;for(;u<n;)(v=(o=b)-(m=(_=(r=c)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(u+=1)<n&&(c=t[u]);for(;l<i;)(v=(o=b)-(m=(_=(r=f)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(l+=1)<i&&(f=e[l]);return b&&(s[a++]=b),x&&(s[a++]=x),a||(s[a++]=0),s.length=a,s}var on=function(t,e,n){var i=t+e,r=i-t,o=e-r,s=t-(i-r);if(n)return n[0]=s+o,n[1]=i,n;return[s+o,i]};function sn(t,e){var n=t.length;if(1===n){var i=en(t[0],e);return i[0]?i:[i[1]]}var r=new Array(2*n),o=[.1,.1],s=[.1,.1],a=0;en(t[0],e,o),o[0]&&(r[a++]=o[0]);for(var u=1;u<n;++u){en(t[u],e,s);var l=o[1];on(l,s[0],o),o[0]&&(r[a++]=o[0]);var h=s[1],c=o[1],p=h+c,f=c-(p-h);o[1]=p,f&&(r[a++]=f)}return o[1]&&(r[a++]=o[1]),0===a&&(r[a++]=0),r.length=a,r}function an(t,e){var n=0|t.length,i=0|e.length;if(1==n&&1==i)return function(t,e){var n=t+e,i=n-t,r=t-(n-i)+(e-i);if(r)return[r,n];return[n]}(t[0],-e[0]);var r,o,s=new Array(n+i),a=0,u=0,l=0,h=Math.abs,c=t[u],p=h(c),f=-e[l],d=h(f);p<d?(o=c,(u+=1)<n&&(c=t[u],p=h(c))):(o=f,(l+=1)<i&&(f=-e[l],d=h(f))),u<n&&p<d||i<=l?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=-e[l],d=h(f)));for(var g,y,_=r+o,m=_-r,v=o-m,b=v,x=_;u<n&&l<i;)p<d?(r=c,(u+=1)<n&&(c=t[u],p=h(c))):(r=f,(l+=1)<i&&(f=-e[l],d=h(f))),(v=(o=b)-(m=(_=r+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g;for(;u<n;)(v=(o=b)-(m=(_=(r=c)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(u+=1)<n&&(c=t[u]);for(;l<i;)(v=(o=b)-(m=(_=(r=f)+o)-r))&&(s[a++]=v),b=x-((g=x+_)-(y=g-x))+(_-y),x=g,(l+=1)<i&&(f=-e[l]);return b&&(s[a++]=b),x&&(s[a++]=x),a||(s[a++]=0),s.length=a,s}var un=tn(function(o){function h(t,e){for(var n=new Array(t.length-1),i=1;i<t.length;++i)for(var r=n[i-1]=new Array(t.length-1),o=0,s=0;o<t.length;++o)o!==e&&(r[s++]=t[i][o]);return n}function c(t){if(1===t.length)return t[0];if(2===t.length)return["sum(",t[0],",",t[1],")"].join("");var e=t.length>>1;return["sum(",c(t.slice(0,e)),",",c(t.slice(e)),")"].join("")}function p(t){if(2===t.length)return[["sum(prod(",t[0][0],",",t[1][1],"),prod(-",t[0][1],",",t[1][0],"))"].join("")];for(var e=[],n=0;n<t.length;++n)e.push(["scale(",c(p(h(t,n))),",",1&n?"-":"",t[0][n],")"].join(""));return e}function s(t){for(var e=[],n=[],i=function(t){for(var e=new Array(t),n=0;n<t;++n){e[n]=new Array(t);for(var i=0;i<t;++i)e[n][i]=["m",i,"[",t-n-1,"]"].join("")}return e}(t),r=[],o=0;o<t;++o)0==(1&o)?e.push.apply(e,p(h(i,o))):n.push.apply(n,p(h(i,o))),r.push("m"+o);var s=c(e),a=c(n),u="orientation"+t+"Exact",l=["function ",u,"(",r.join(),"){var p=",s,",n=",a,",d=sub(p,n);return d[d.length-1];};return ",u].join("");return new Function("sum","prod","scale","sub",l)(rn,en,sn,an)}var u=s(3),x=s(4),a=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,n){var i,r=(t[1]-n[1])*(e[0]-n[0]),o=(t[0]-n[0])*(e[1]-n[1]),s=r-o;if(0<r){if(o<=0)return s;i=r+o}else{if(!(r<0))return s;if(0<=o)return s;i=-(r+o)}var a=33306690738754716e-32*i;return a<=s||s<=-a?s:u(t,e,n)},function(t,e,n,i){var r=t[0]-i[0],o=e[0]-i[0],s=n[0]-i[0],a=t[1]-i[1],u=e[1]-i[1],l=n[1]-i[1],h=t[2]-i[2],c=e[2]-i[2],p=n[2]-i[2],f=o*l,d=s*u,g=s*a,y=r*l,_=r*u,m=o*a,v=h*(f-d)+c*(g-y)+p*(_-m),b=7771561172376103e-31*((Math.abs(f)+Math.abs(d))*Math.abs(h)+(Math.abs(g)+Math.abs(y))*Math.abs(c)+(Math.abs(_)+Math.abs(m))*Math.abs(p));return b<v||b<-v?v:x(t,e,n,i)}];!function(){for(;a.length<=5;)a.push(s(a.length));for(var t=[],e=["slow"],n=0;n<=5;++n)t.push("a"+n),e.push("o"+n);var i=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(n=2;n<=5;++n)i.push("case ",n,":return o",n,"(",t.slice(0,n).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),e.push(i.join(""));var r=Function.apply(void 0,e);for(o.exports=r.apply(void 0,[function(t){var e=a[t.length];return(e=e||(a[t.length]=s(t.length))).apply(void 0,t)}].concat(a)),n=0;n<=5;++n)o.exports[n]=a[n]}()}),ln=function(i){var t=i.length;if(t<3){for(var e=new Array(t),n=0;n<t;++n)e[n]=n;return 2===t&&i[0][0]===i[1][0]&&i[0][1]===i[1][1]?[0]:e}var r=new Array(t);for(n=0;n<t;++n)r[n]=n;r.sort(function(t,e){var n=i[t][0]-i[e][0];return n||i[t][1]-i[e][1]});var o=[r[0],r[1]],s=[r[0],r[1]];for(n=2;n<t;++n){for(var a=r[n],u=i[a],l=o.length;1<l&&hn(i[o[l-2]],i[o[l-1]],u)<=0;)--l,o.pop();for(o.push(a),l=s.length;1<l&&0<=hn(i[s[l-2]],i[s[l-1]],u);)--l,s.pop();s.push(a)}e=new Array(s.length+o.length-2);for(var h=0,c=(n=0,o.length);n<c;++n)e[h++]=o[n];for(var p=s.length-2;0<p;--p)e[h++]=s[p];return e},hn=un[3];var cn=fn,pn=fn;function fn(t,e){if(!(this instanceof fn))return new fn(t,e);if(this.data=t||[],this.length=this.data.length,this.compare=e||dn,0<this.length)for(var n=(this.length>>1)-1;0<=n;n--)this._down(n)}function dn(t,e){return t<e?-1:e<t?1:0}fn.prototype={push:function(t){this.data.push(t),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var t=this.data[0];return this.length--,0<this.length&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),t}},peek:function(){return this.data[0]},_up:function(t){for(var e=this.data,n=this.compare,i=e[t];0<t;){var r=t-1>>1,o=e[r];if(0<=n(i,o))break;e[t]=o,t=r}e[t]=i},_down:function(t){for(var e=this.data,n=this.compare,i=this.length>>1,r=e[t];t<i;){var o=1+(t<<1),s=o+1,a=e[o];if(s<this.length&&n(e[s],a)<0&&(a=e[o=s]),0<=n(a,r))break;e[t]=a,t=o}e[t]=r}},cn.default=pn;var gn=function(t,e){for(var n=t[0],i=t[1],r=!1,o=0,s=e.length-1;o<e.length;s=o++){var a=e[o][0],u=e[o][1],l=e[s][0],h=e[s][1];i<u!=i<h&&n<(l-a)*(i-u)/(h-u)+a&&(r=!r)}return r},yn=un[3],_n=vn,mn=vn;function vn(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;for(var i,r=function(t){for(var e=t[0],n=t[0],i=t[0],r=t[0],o=0;o<t.length;o++){var s=t[o];s[0]<e[0]&&(e=s),s[0]>i[0]&&(i=s),s[1]<n[1]&&(n=s),s[1]>r[1]&&(r=s)}var a=[e,n,i,r],u=a.slice();for(o=0;o<t.length;o++)gn(t[o],a)||u.push(t[o]);var l=ln(u),h=[];for(o=0;o<l.length;o++)h.push(u[l[o]]);return h}(t),o=Ue(16,["[0]","[1]","[0]","[1]"]).load(t),s=[],a=0;a<r.length;a++){var u=r[a];o.remove(u),i=Sn(u,i),s.push(i)}var l=Ue(16);for(a=0;a<s.length;a++)l.insert(wn(s[a]));for(var h=e*e,c=n*n;s.length;){var p=s.shift(),f=p.p,d=p.next.p,g=Mn(f,d);if(!(g<c)){var y=g/h;(u=bn(o,p.prev.p,f,d,p.next.next.p,y,l))&&Math.min(Mn(u,f),Mn(u,d))<=y&&(s.push(p),s.push(Sn(u,p)),o.remove(u),l.remove(p),l.insert(wn(p)),l.insert(wn(p.next)))}}p=i;for(var _=[];_.push(p.p),(p=p.next)!==i;);return _.push(p.p),_}function bn(t,e,n,i,r,o,s){for(var a=new cn(null,xn),u=t.data;u;){for(var l=0;l<u.children.length;l++){var h=u.children[l],c=u.leaf?Cn(h,n,i):En(n,i,h);o<c||a.push({node:h,dist:c})}for(;a.length&&!a.peek().node.children;){var p=a.pop(),f=p.node,d=Cn(f,e,n),g=Cn(f,i,r);if(p.dist<d&&p.dist<g&&Ln(n,f,s)&&Ln(i,f,s))return f}u=(u=a.pop())&&u.node}return null}function xn(t,e){return t.dist-e.dist}function En(t,e,n){if(In(t,n)||In(e,n))return 0;var i=Pn(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===i)return 0;var r=Pn(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===r)return 0;var o=Pn(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var s=Pn(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(i,r,o,s)}function In(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function Ln(t,e,n){for(var i,r,o,s,a=Math.min(t[0],e[0]),u=Math.min(t[1],e[1]),l=Math.max(t[0],e[0]),h=Math.max(t[1],e[1]),c=n.search({minX:a,minY:u,maxX:l,maxY:h}),p=0;p<c.length;p++)if(i=c[p].p,r=c[p].next.p,o=t,i!==(s=e)&&r!==o&&0<yn(i,r,o)!=0<yn(i,r,s)&&0<yn(o,s,i)!=0<yn(o,s,r))return!1;return!0}function wn(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function Sn(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,(n.prev=e).next.prev=n,e.next=n):(n.prev=n).next=n,n}function Mn(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function Cn(t,e,n){var i=e[0],r=e[1],o=n[0]-i,s=n[1]-r;if(0!==o||0!==s){var a=((t[0]-i)*o+(t[1]-r)*s)/(o*o+s*s);1<a?(i=n[0],r=n[1]):0<a&&(i+=o*a,r+=s*a)}return(o=t[0]-i)*o+(s=t[1]-r)*s}function Pn(t,e,n,i,r,o,s,a){var u,l,h,c,p=n-t,f=i-e,d=s-r,g=a-o,y=t-r,_=e-o,m=p*p+f*f,v=p*d+f*g,b=d*d+g*g,x=p*y+f*_,E=d*y+g*_,I=m*b-v*v,L=I,w=I;0==I?(l=0,L=1,c=E,w=b):(c=m*E-v*x,(l=v*E-b*x)<0?(l=0,c=E,w=b):L<l&&(l=L,c=E+v,w=b)),c<0?-x<(c=0)?l=0:m<-x?l=L:(l=-x,L=m):w<c&&(c=w,v-x<0?l=0:m<v-x?l=L:(l=v-x,L=m));var S=(1-(h=0===c?0:c/w))*r+h*s-((1-(u=0===l?0:l/L))*t+u*n),M=(1-h)*o+h*a-((1-u)*e+u*i);return S*S+M*M}function Nn(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.concavity||1/0,i=[];if(ne(t,function(t){i.push([t[0],t[1]])}),!i.length)return null;var r=_n(i,n);return 3<r.length?kt([r]):null}function On(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.ignoreBoundary;if(!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r,o,s=ve(t),a=be(e),u=e.geometry?e.geometry.type:e.type,l=e.bbox;if(l&&!1==(r=s,(o=l)[0]<=r[0]&&o[1]<=r[1]&&o[2]>=r[0]&&o[3]>=r[1]))return!1;"Polygon"===u&&(a=[a]);for(var h=0,c=!1;h<a.length&&!c;h++)if(Tn(s,a[h][0],i)){for(var p=!1,f=1;f<a[h].length&&!p;)Tn(s,a[h][f],!i)&&(p=!0),f++;p||(c=!0)}return c}function Tn(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],u=e[o][0],l=e[o][1];if(t[1]*(s-u)+a*(u-t[0])+l*(t[0]-s)==0&&(s-t[0])*(u-t[0])<=0&&(a-t[1])*(l-t[1])<=0)return!n;a>t[1]!=l>t[1]&&t[0]<(u-s)*(t[1]-a)/(l-a)+s&&(i=!i)}return i}function kn(t,e){var n=[];return le(e,function(e){se(t,function(t){On(t,e)&&n.push(t)})}),Ft(n)}function Rn(t,n){if("FeatureCollection"!==t.type)throw new Error("points must be a FeatureCollection");var o=!1;return Ft(function(t){if(t.length<3)return[];t.sort(An);var e,n,i,r,o,s,a=t.length-1,u=t[a].x,l=t[0].x,h=t[a].y,c=h;for(;a--;)t[a].y<h&&(h=t[a].y),t[a].y>c&&(c=t[a].y);var p,f=l-u,d=c-h,g=d<f?f:d,y=.5*(l+u),_=.5*(c+h),m=[new Dn({x:y-20*g,y:_-g,__sentinel:!0},{x:y,y:_+20*g,__sentinel:!0},{x:y+20*g,y:_-g,__sentinel:!0})],v=[],b=[];a=t.length;for(;a--;){for(b.length=0,p=m.length;p--;)0<(f=t[a].x-m[p].x)&&f*f>m[p].r?(v.push(m[p]),m.splice(p,1)):(d=t[a].y-m[p].y,f*f+d*d>m[p].r||(b.push(m[p].a,m[p].b,m[p].b,m[p].c,m[p].c,m[p].a),m.splice(p,1)));for(Fn(b),p=b.length;p;)n=b[--p],e=b[--p],i=t[a],r=n.x-e.x,o=n.y-e.y,s=2*(r*(i.y-n.y)-o*(i.x-n.x)),1e-12<Math.abs(s)&&m.push(new Dn(e,n,i))}Array.prototype.push.apply(v,m),a=v.length;for(;a--;)(v[a].a.__sentinel||v[a].b.__sentinel||v[a].c.__sentinel)&&v.splice(a,1);return v}(t.features.map(function(t){var e={x:t.geometry.coordinates[0],y:t.geometry.coordinates[1]};return n?e.z=t.properties[n]:3===t.geometry.coordinates.length&&(o=!0,e.z=t.geometry.coordinates[2]),e})).map(function(t){var e=[t.a.x,t.a.y],n=[t.b.x,t.b.y],i=[t.c.x,t.c.y],r={};return o?(e.push(t.a.z),n.push(t.b.z),i.push(t.c.z)):r={a:t.a.z,b:t.b.z,c:t.c.z},kt([[e,n,i,e]],r)}))}function Dn(t,e,n){this.a=t,this.b=e,this.c=n;var i,r,o=e.x-t.x,s=e.y-t.y,a=n.x-t.x,u=n.y-t.y,l=o*(t.x+e.x)+s*(t.y+e.y),h=a*(t.x+n.x)+u*(t.y+n.y),c=2*(o*(n.y-e.y)-s*(n.x-e.x));this.x=(u*l-s*h)/c,this.y=(o*h-a*l)/c,i=this.x-t.x,r=this.y-t.y,this.r=i*i+r*r}function An(t,e){return e.x-t.x}function Fn(t){var e,n,i,r,o,s=t.length;t:for(;s;)for(n=t[--s],e=t[--s],i=s;i;)if(o=t[--i],e===(r=t[--i])&&n===o||e===o&&n===r){t.splice(s,2),t.splice(i,2),s-=2;continue t}}function Bn(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.units,r=ve(t),o=ve(e),s=Jt(o[1]-r[1]),a=Jt(o[0]-r[0]),u=Jt(r[1]),l=Jt(o[1]),h=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(u)*Math.cos(l);return zt(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),i)}function Gn(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return Un(t);case"FeatureCollection":return e=t,n={type:"FeatureCollection"},Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:n[t]=e[t]}}),n.features=e.features.map(function(t){return Un(t)}),n;case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return jn(t);default:throw new Error("unknown GeoJSON type")}var e,n}function Un(e){var n={type:"Feature"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"properties":case"geometry":return;default:n[t]=e[t]}}),n.properties=function n(i){var r={};if(!i)return r;Object.keys(i).forEach(function(t){var e=i[t];"object"==typeof e?null===e?r[t]=null:e.length?r[t]=e.map(function(t){return t}):r[t]=n(e):r[t]=e});return r}(e.properties),n.geometry=jn(e.geometry),n}function jn(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),"GeometryCollection"===t.type?e.geometries=t.geometries.map(function(t){return jn(t)}):e.coordinates=function e(t){if("object"!=typeof t[0])return t.slice();return t.map(function(t){return e(t)})}(t.coordinates),e}_n.default=mn;function qn(t){return t}var zn=function(t){if(null==t)return qn;var o,s,a=t.scale[0],u=t.scale[1],l=t.translate[0],h=t.translate[1];return function(t,e){e||(o=s=0);var n=2,i=t.length,r=new Array(i);for(r[0]=(o+=t[0])*a+l,r[1]=(s+=t[1])*u+h;n<i;)r[n]=t[n],++n;return r}},Vn=function(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n};function Yn(t,e){var o=zn(t.transform),s=t.arcs;function r(t,e){e.length&&e.pop();for(var n=s[t<0?~t:t],i=0,r=n.length;i<r;++i)e.push(o(n[i],i));t<0&&Vn(e,r)}function a(t){return o(t)}function u(t){for(var e=[],n=0,i=t.length;n<i;++n)r(t[n],e);return e.length<2&&e.push(e[0]),e}function n(t){for(var e=u(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(n)}return function t(e){var n,i=e.type;switch(i){case"GeometryCollection":return{type:i,geometries:e.geometries.map(t)};case"Point":n=a(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(a);break;case"LineString":n=u(e.arcs);break;case"MultiLineString":n=e.arcs.map(u);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:i,coordinates:n}}(e)}function Hn(u,r){var o={},l={},h={},s=[],a=-1;function t(t,e){for(var n in t){var i=t[n];delete e[i.start],delete i.start,delete i.end,i.forEach(function(t){o[t<0?~t:t]=1}),s.push(i)}}return r.forEach(function(t,e){var n,i=u.arcs[t<0?~t:t];i.length<3&&!i[1][0]&&!i[1][1]&&(n=r[++a],r[a]=t,r[e]=n)}),r.forEach(function(t){var e,n,i=function(t){var e,n=u.arcs[t<0?~t:t],i=n[0];u.transform?(e=[0,0],n.forEach(function(t){e[0]+=t[0],e[1]+=t[1]})):e=n[n.length-1];return t<0?[e,i]:[i,e]}(t),r=i[0],o=i[1];if(e=h[r])if(delete h[e.end],e.push(t),e.end=o,n=l[o]){delete l[n.start];var s=n===e?e:e.concat(n);l[s.start=e.start]=h[s.end=n.end]=s}else l[e.start]=h[e.end]=e;else if(e=l[o])if(delete l[e.start],e.unshift(t),e.start=r,n=h[r]){delete h[n.end];var a=n===e?e:n.concat(e);l[a.start=n.start]=h[a.end=e.end]=a}else l[e.start]=h[e.end]=e;else l[(e=[t]).start=r]=h[e.end=o]=e}),t(h,l),t(l,h),r.forEach(function(t){o[t<0?~t:t]||s.push([t])}),s}var Xn=function(t){return Yn(t,function(a,t){var u={},n=[],i=[];function r(e){e.forEach(function(t){t.forEach(function(t){(u[t=t<0?~t:t]||(u[t]=[])).push(e)})}),n.push(e)}function l(t){return function(t){for(var e,n=-1,i=t.length,r=t[i-1],o=0;++n<i;)e=r,r=t[n],o+=e[0]*r[1]-e[1]*r[0];return Math.abs(o)}(Yn(a,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach(function t(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"Polygon":r(e.arcs);break;case"MultiPolygon":e.arcs.forEach(r)}}),n.forEach(function(t){if(!t._){var e=[],n=[t];for(t._=1,i.push(e);t=n.pop();)e.push(t),t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].forEach(function(t){t._||(t._=1,n.push(t))})})})}}),n.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:i.map(function(t){var e,n=[];if(t.forEach(function(t){t.forEach(function(t){t.forEach(function(t){u[t<0?~t:t].length<2&&n.push(t)})})}),1<(e=(n=Hn(a,n)).length))for(var i,r,o=1,s=l(n[0]);o<e;++o)(i=l(n[o]))>s&&(r=n[0],n[0]=n[o],n[o]=r,s=i);return n})}}.apply(this,arguments))};function Jn(r,o,s,t,a){3===arguments.length&&(t=Array,a=null);for(var u=new t(r=1<<Math.max(4,Math.ceil(Math.log(r)/Math.LN2))),l=r-1,e=0;e<r;++e)u[e]=a;return{add:function(t){for(var e=o(t)&l,n=u[e],i=0;n!=a;){if(s(n,t))return!0;if(++i>=r)throw new Error("full hashset");n=u[e=e+1&l]}return u[e]=t,!0},has:function(t){for(var e=o(t)&l,n=u[e],i=0;n!=a;){if(s(n,t))return!0;if(++i>=r)break;n=u[e=e+1&l]}return!1},values:function(){for(var t=[],e=0,n=u.length;e<n;++e){var i=u[e];i!=a&&t.push(i)}return t}}}function Wn(o,s,a,t,u,e){3===arguments.length&&(t=e=Array,u=null);for(var l=new t(o=1<<Math.max(4,Math.ceil(Math.log(o)/Math.LN2))),h=new e(o),c=o-1,n=0;n<o;++n)l[n]=u;return{set:function(t,e){for(var n=s(t)&c,i=l[n],r=0;i!=u;){if(a(i,t))return h[n]=e;if(++r>=o)throw new Error("full hashmap");i=l[n=n+1&c]}return l[n]=t,h[n]=e},maybeSet:function(t,e){for(var n=s(t)&c,i=l[n],r=0;i!=u;){if(a(i,t))return h[n];if(++r>=o)throw new Error("full hashmap");i=l[n=n+1&c]}return l[n]=t,h[n]=e},get:function(t,e){for(var n=s(t)&c,i=l[n],r=0;i!=u;){if(a(i,t))return h[n];if(++r>=o)break;i=l[n=n+1&c]}return e},keys:function(){for(var t=[],e=0,n=l.length;e<n;++e){var i=l[e];i!=u&&t.push(i)}return t}}}function Kn(t,e){return t[0]===e[0]&&t[1]===e[1]}function Zn(t){ti[0]=t[0],ti[1]=t[1];var e=ei[0]^ei[1];return 2147483647&(e=e<<5^e>>7^ei[2]^ei[3])}function Qn(t){var e,n,i,r,o=t.coordinates,s=t.lines,a=t.rings,u=function(){for(var t=Wn(1.4*o.length,x,E,Int32Array,-1,Int32Array),e=new Int32Array(o.length),n=0,i=o.length;n<i;++n)e[n]=t.maybeSet(n,n);return e}(),l=new Int32Array(o.length),h=new Int32Array(o.length),c=new Int32Array(o.length),p=new Int8Array(o.length),f=0;for(e=0,n=o.length;e<n;++e)l[e]=h[e]=c[e]=-1;for(e=0,n=s.length;e<n;++e){var d=s[e],g=d[0],y=d[1];for(i=u[g],r=u[++g],++f,p[i]=1;++g<=y;)b(e,i,i=r,r=u[g]);++f,p[r]=1}for(e=0,n=o.length;e<n;++e)l[e]=-1;for(e=0,n=a.length;e<n;++e){var _=a[e],m=_[0]+1,v=_[1];for(b(e,u[v-1],i=u[m-1],r=u[m]);++m<=v;)b(e,i,i=r,r=u[m])}function b(t,e,n,i){if(l[n]!==t){l[n]=t;var r=h[n];if(0<=r){var o=c[n];r===e&&o===i||r===i&&o===e||(++f,p[n]=1)}else h[n]=e,c[n]=i}}function x(t){return Zn(o[t])}function E(t,e){return Kn(o[t],o[e])}l=h=c=null;var I,L=Jn(1.4*f,Zn,Kn);for(e=0,n=o.length;e<n;++e)p[I=u[e]]&&L.add(o[I]);return L}var $n=new ArrayBuffer(16),ti=new Float64Array($n),ei=new Uint32Array($n);function ni(t,e,n,i){ii(t,e,n),ii(t,e,e+i),ii(t,e+i,n)}function ii(t,e,n){for(var i,r=e+(n---e>>1);e<r;++e,--n)i=t[e],t[e]=t[n],t[n]=i}function ri(t){var e,n,i={};for(e in t)i[e]=null==(n=t[e])?{type:null}:("FeatureCollection"===n.type?function(t){var e={type:"GeometryCollection",geometries:t.features.map(oi)};null!=t.bbox&&(e.bbox=t.bbox);return e}:"Feature"===n.type?oi:si)(n);return i}function oi(t){var e,n=si(t.geometry);for(e in null!=t.id&&(n.id=t.id),null!=t.bbox&&(n.bbox=t.bbox),t.properties){n.properties=t.properties;break}return n}function si(t){if(null==t)return{type:null};var e="GeometryCollection"===t.type?{type:"GeometryCollection",geometries:t.geometries.map(si)}:"Point"===t.type||"MultiPoint"===t.type?{type:t.type,coordinates:t.coordinates}:{type:t.type,arcs:t.coordinates};return null!=t.bbox&&(e.bbox=t.bbox),e}var ai=function(t,e){var n=function(t){var i=1/0,r=1/0,o=-1/0,s=-1/0;function e(t){null!=t&&n.hasOwnProperty(t.type)&&n[t.type](t)}var n={GeometryCollection:function(t){t.geometries.forEach(e)},Point:function(t){a(t.coordinates)},MultiPoint:function(t){t.coordinates.forEach(a)},LineString:function(t){u(t.arcs)},MultiLineString:function(t){t.arcs.forEach(u)},Polygon:function(t){t.arcs.forEach(u)},MultiPolygon:function(t){t.arcs.forEach(l)}};function a(t){var e=t[0],n=t[1];e<i&&(i=e),o<e&&(o=e),n<r&&(r=n),s<n&&(s=n)}function u(t){t.forEach(a)}function l(t){t.forEach(u)}for(var h in t)e(t[h]);return i<=o&&r<=s?[i,r,o,s]:void 0}(t=ri(t)),i=0<e&&n&&function(t,e,n){var c=e[0],p=e[1],i=e[2],r=e[3],f=i-c?(n-1)/(i-c):1,d=r-p?(n-1)/(r-p):1;function o(t){return[Math.round((t[0]-c)*f),Math.round((t[1]-p)*d)]}function s(t,e){for(var n,i,r,o,s,a=-1,u=0,l=t.length,h=new Array(l);++a<l;)n=t[a],o=Math.round((n[0]-c)*f),s=Math.round((n[1]-p)*d),o===i&&s===r||(h[u++]=[i=o,r=s]);for(h.length=u;u<e;)u=h.push([h[0][0],h[0][1]]);return h}function a(t){return s(t,2)}function u(t){return s(t,4)}function l(t){return t.map(u)}function h(t){null!=t&&g.hasOwnProperty(t.type)&&g[t.type](t)}var g={GeometryCollection:function(t){t.geometries.forEach(h)},Point:function(t){t.coordinates=o(t.coordinates)},MultiPoint:function(t){t.coordinates=t.coordinates.map(o)},LineString:function(t){t.arcs=a(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(a)},Polygon:function(t){t.arcs=l(t.arcs)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};for(var y in t)h(t[y]);return{scale:[1/f,1/d],translate:[c,p]}}(t,n,e),r=function(t){var e,n,i,r,h=t.coordinates,o=t.lines,s=t.rings,a=o.length+s.length;for(delete t.lines,delete t.rings,i=0,r=o.length;i<r;++i)for(e=o[i];e=e.next;)++a;for(i=0,r=s.length;i<r;++i)for(n=s[i];n=n.next;)++a;var l=Wn(2*a*1.4,Zn,Kn),c=t.arcs=[];for(i=0,r=o.length;i<r;++i)for(e=o[i];u(e),e=e.next;);for(i=0,r=s.length;i<r;++i)if((n=s[i]).next)for(;u(n),n=n.next;);else p(n);function u(t){var e,n,i,r,o,s,a,u;if(i=l.get(e=h[t[0]]))for(a=0,u=i.length;a<u;++a)if(f(r=i[a],t))return t[0]=r[0],void(t[1]=r[1]);if(o=l.get(n=h[t[1]]))for(a=0,u=o.length;a<u;++a)if(d(s=o[a],t))return t[1]=s[0],void(t[0]=s[1]);i?i.push(t):l.set(e,[t]),o?o.push(t):l.set(n,[t]),c.push(t)}function p(t){var e,n,i,r,o;if(n=l.get(h[t[0]]))for(r=0,o=n.length;r<o;++r){if(g(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(y(i,t))return t[0]=i[1],void(t[1]=i[0])}if(n=l.get(e=h[t[0]+_(t)]))for(r=0,o=n.length;r<o;++r){if(g(i=n[r],t))return t[0]=i[0],void(t[1]=i[1]);if(y(i,t))return t[0]=i[1],void(t[1]=i[0])}n?n.push(t):l.set(e,[t]),c.push(t)}function f(t,e){var n=t[0],i=e[0],r=t[1];if(n-r!=i-e[1])return!1;for(;n<=r;++n,++i)if(!Kn(h[n],h[i]))return!1;return!0}function d(t,e){var n=t[0],i=e[0],r=t[1],o=e[1];if(n-r!=i-o)return!1;for(;n<=r;++n,--o)if(!Kn(h[n],h[o]))return!1;return!0}function g(t,e){var n=t[0],i=e[0],r=t[1]-n;if(r!=e[1]-i)return!1;for(var o=_(t),s=_(e),a=0;a<r;++a)if(!Kn(h[n+(a+o)%r],h[i+(a+s)%r]))return!1;return!0}function y(t,e){var n=t[0],i=e[0],r=t[1],o=e[1],s=r-n;if(s!=o-i)return!1;for(var a=_(t),u=s-_(e),l=0;l<s;++l)if(!Kn(h[n+(l+a)%s],h[o-(l+u)%s]))return!1;return!0}function _(t){for(var e=t[0],n=t[1],i=e,r=i,o=h[i];++i<n;){var s=h[i];(s[0]<o[0]||s[0]===o[0]&&s[1]<o[1])&&(r=i,o=s)}return r-e}return t}(function(t){var e,n,i,r=Qn(t),o=t.coordinates,s=t.lines,a=t.rings;for(n=0,i=s.length;n<i;++n)for(var u=s[n],l=u[0],h=u[1];++l<h;)r.has(o[l])&&(e={0:l,1:u[1]},u[1]=l,u=u.next=e);for(n=0,i=a.length;n<i;++n)for(var c=a[n],p=c[0],f=p,d=c[1],g=r.has(o[p]);++f<d;)r.has(o[f])&&(g?(e={0:f,1:c[1]},c[1]=f,c=c.next=e):(ni(o,p,d,d-f),o[d]=o[p],g=!0,f=p));return t}(function(t){var r=-1,o=[],s=[],a=[];function e(t){t&&n.hasOwnProperty(t.type)&&n[t.type](t)}var n={GeometryCollection:function(t){t.geometries.forEach(e)},LineString:function(t){t.arcs=i(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(i)},Polygon:function(t){t.arcs=t.arcs.map(u)},MultiPolygon:function(t){t.arcs=t.arcs.map(l)}};function i(t){for(var e=0,n=t.length;e<n;++e)a[++r]=t[e];var i={0:r-n+1,1:r};return o.push(i),i}function u(t){for(var e=0,n=t.length;e<n;++e)a[++r]=t[e];var i={0:r-n+1,1:r};return s.push(i),i}function l(t){return t.map(u)}for(var h in t)e(t[h]);return{type:"Topology",coordinates:a,lines:o,rings:s,objects:t}}(t))),o=r.coordinates,s=Wn(1.4*r.arcs.length,ui,li);function a(t){t&&u.hasOwnProperty(t.type)&&u[t.type](t)}t=r.objects,r.bbox=n,r.arcs=r.arcs.map(function(t,e){return s.set(t,e),o.slice(t[0],t[1]+1)}),delete r.coordinates,o=null;var u={GeometryCollection:function(t){t.geometries.forEach(a)},LineString:function(t){t.arcs=l(t.arcs)},MultiLineString:function(t){t.arcs=t.arcs.map(l)},Polygon:function(t){t.arcs=t.arcs.map(l)},MultiPolygon:function(t){t.arcs=t.arcs.map(h)}};function l(t){var e=[];do{var n=s.get(t);e.push(t[0]<t[1]?n:~n)}while(t=t.next);return e}function h(t){return t.map(l)}for(var c in t)a(t[c]);return i&&(r.transform=i,r.arcs=function(t){for(var e=-1,n=t.length;++e<n;){for(var i,r,o=t[e],s=0,a=1,u=o.length,l=o[0],h=l[0],c=l[1];++s<u;)i=(l=o[s])[0],r=l[1],i===h&&r===c||(o[a++]=[i-h,r-c],h=i,c=r);1===a&&(o[a++]=[0,0]),o.length=a}return t}(r.arcs)),r};function ui(t){var e,n=t[0],i=t[1];return i<n&&(e=n,n=i,i=e),n+31*i}function li(t,e){var n,i=t[0],r=t[1],o=e[0],s=e[1];return r<i&&(n=i,i=r,r=n),s<o&&(n=o,o=s,s=n),i===o&&r===s}function hi(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Me(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=Gn(t));var i=[],r=ye(t,function(t,e){var n=function(t,e){var n,i=t.geometry.coordinates,r=e.geometry.coordinates,o=ci(i[0]),s=ci(i[i.length-1]),a=ci(r[0]),u=ci(r[r.length-1]);if(o===u)n=r.concat(i.slice(1));else if(a===s)n=i.concat(r.slice(1));else if(o===a)n=i.slice(1).reverse().concat(r);else{if(s!==u)return null;n=i.concat(r.reverse().slice(1))}return Dt(n)}(t,e);return n||(i.push(t),e)});return r&&i.push(r),i.length?1===i.length?i[0]:Bt(i.map(function(t){return t.coordinates})):null}function ci(t){return t[0].toString()+","+t[1].toString()}function pi(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Me(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=Gn(t));var i=function(t){var e={};ce(t,function(t){e[t.geometry.type]=!0});var n=Object.keys(e);return 1===n.length?n[0]:null}(t);if(!i)throw new Error("geojson must be homogenous");switch(i){case"LineString":return hi(t,e);case"Polygon":return function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if("FeatureCollection"!==Me(t))throw new Error("geojson must be a FeatureCollection");if(!t.features.length)throw new Error("geojson is empty");!1!==n&&void 0!==n||(t=Gn(t));var i=[];ce(t,function(t){i.push(t.geometry)});var r=ai({geoms:jt(i).geometry});return Xn(r,r.objects.geoms.geometries)}(t,e);default:throw new Error(i+" is not supported")}}function fi(t,e){var n="object"==typeof e?e.mutate:e;if(!t)throw new Error("geojson is required");var i=Me(t),r=[];switch(i){case"LineString":r=di(t);break;case"MultiLineString":case"Polygon":be(t).forEach(function(t){r.push(di(t))});break;case"MultiPolygon":be(t).forEach(function(t){var e=[];t.forEach(function(t){e.push(di(t))}),r.push(e)});break;case"Point":return t;case"MultiPoint":var o={};be(t).forEach(function(t){var e=t.join("-");o.hasOwnProperty(e)||(r.push(t),o[e]=!0)});break;default:throw new Error(i+" geometry not supported")}return t.coordinates?!0===n?(t.coordinates=r,t):{type:i,coordinates:r}:!0===n?(t.geometry.coordinates=r,t):Pt({type:i,coordinates:r},t.properties,t.bbox,t.id)}function di(t){var e,n,i,r,o,s=be(t);if(2===s.length&&(e=s[0],n=s[1],e[0]!==n[0]||e[1]!==n[1]))return s;var a=[],u=s.length-1;a.push(s[0]);for(var l=1;l<u;l++)i=s[l-1],r=s[l],gi(i,o=s[l+1],r)||a.push(r);return a.push(o),a}function gi(t,e,n){var i=n[0],r=n[1],o=t[0],s=t[1],a=e[0],u=e[1],l=a-o,h=u-s;return 0==(i-o)*h-(r-s)*l&&(Math.abs(l)>=Math.abs(h)?0<l?o<=i&&i<=a:a<=i&&i<=o:0<h?s<=r&&r<=u:u<=r&&r<=s)}function yi(t,e,n){var i=e.x,r=e.y,o=n.x-i,s=n.y-r;if(0!==o||0!==s){var a=((t.x-i)*o+(t.y-r)*s)/(o*o+s*s);1<a?(i=n.x,r=n.y):0<a&&(i+=o*a,r+=s*a)}return(o=t.x-i)*o+(s=t.y-r)*s}function _i(t,e){var n=t.length-1,i=[t[0]];return function t(e,n,i,r,o){for(var s,a=r,u=n+1;u<i;u++){var l=yi(e[u],e[n],e[i]);a<l&&(s=u,a=l)}r<a&&(1<s-n&&t(e,n,s,r,o),o.push(e[s]),1<i-s&&t(e,s,i,r,o))}(t,0,n,e,i),i.push(t[n]),i}function mi(t,e,n){if(t.length<=2)return t;var i=void 0!==e?e*e:1;return t=_i(t=n?t:function(t,e){for(var n,i,r,o,s,a=t[0],u=[a],l=1,h=t.length;l<h;l++)n=t[l],r=a,void 0,o=(i=n).x-r.x,s=i.y-r.y,e<o*o+s*s&&(u.push(n),a=n);return a!==n&&u.push(n),u}(t,i),i)}function vi(t,e,n){return mi(t.map(function(t){return{x:t[0],y:t[1],z:t[2]}}),e,n).map(function(t){return t.z?[t.x,t.y,t.z]:[t.x,t.y]})}function bi(t,i,r){return t.map(function(t){var e=t.map(function(t){return{x:t[0],y:t[1]}});if(e.length<4)throw new Error("invalid polygon");for(var n=mi(e,i,r).map(function(t){return[t.x,t.y]});!xi(n);)n=mi(e,i-=.01*i,r).map(function(t){return[t.x,t.y]});return n[n.length-1][0]===n[0][0]&&n[n.length-1][1]===n[0][1]||n.push(n[0]),n})}function xi(t){return!(t.length<3)&&!(3===t.length&&t[2][0]===t[0][0]&&t[2][1]===t[0][1])}function Ei(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length;for(var e=this.delay=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){n=this.centers[e],i=this.centers[e+1];var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}function Ii(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.resolution||1e4,i=e.sharpness||.85;if(!t)throw new Error("line is required");if(!Zt(n))throw new Error("resolution must be an number");if(!Zt(i))throw new Error("sharpness must be an number");for(var r=[],o=new Ei({points:we(t).coordinates.map(function(t){return{x:t[0],y:t[1]}}),duration:n,sharpness:i}),s=0;s<o.duration;s+=10){var a=o.pos(s);Math.floor(s/100)%2==0&&r.push([a.x,a.y])}return Dt(r,t.properties)}function Li(t){$t(t);var e=Number(t[0]),n=Number(t[1]),i=Number(t[2]),r=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var o=[e,n];return kt([[o,[i,n],[i,r],[e,r],o]])}function wi(t){return Li(me(t))}function Si(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=Bn(t.slice(0,2),[i,n]);if(Bn(t.slice(0,2),[e,r])<=o){var s=(n+r)/2;return[e,s-(i-e)/2,i,s+(i-e)/2]}var a=(e+i)/2;return[a-(r-n)/2,n,a+(r-n)/2,r]}function Mi(t,e,n,i){if(!Qt(i=i||{}))throw new Error("options is invalid");var r=i.units,o=i.properties,s=ve(t),a=Jt(s[0]),u=Jt(s[1]),l=Jt(n),h=Vt(e,r),c=Math.asin(Math.sin(u)*Math.cos(h)+Math.cos(u)*Math.sin(h)*Math.cos(l));return Ot([Xt(a+Math.atan2(Math.sin(l)*Math.sin(h)*Math.cos(u),Math.cos(h)-Math.sin(u)*Math.sin(c))),Xt(c)],o)}function Ci(t,e,n){var i=(n=n||{}).steps||64,r=n.properties;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof i)throw new Error("steps must be a number");i=i||64,r=r||t.properties||{};for(var o=[],s=0;s<i;s++)o.push(Mi(t,e,-360*s/i,n).geometry.coordinates);return o.push(o[0]),kt([o],r)}function Pi(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");if(!0===n.final)return(Pi(e,t)+180)%360;var i=ve(t),r=ve(e),o=Jt(i[0]),s=Jt(r[0]),a=Jt(i[1]),u=Jt(r[1]),l=Math.sin(s-o)*Math.cos(u),h=Math.cos(a)*Math.sin(u)-Math.sin(a)*Math.cos(u)*Math.cos(s-o);return Xt(Math.atan2(l,h))}function Ni(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.properties;if(!t)throw new Error("geojson is required");var i=me(t);return Ot([(i[0]+i[2])/2,(i[1]+i[3])/2],n)}function Oi(t,e){var n=0,i=0,r=0;return ne(t,function(t){n+=t[0],i+=t[1],r++},!0),Ot([n/r,i/r],e)}function Ti(e){var n=[];return"FeatureCollection"===e.type?se(e,function(e){ne(e,function(t){n.push(Ot(t,e.properties))})}):ne(e,function(t){n.push(Ot(t,e.properties))}),Ft(n)}Ei.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);t<Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))&&(e.push(i),n=r)}return e},Ei.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},Ei.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(1<=n)return this.points[this.length-1];var i,r,o,s,a,u,l,h,c=Math.floor((this.points.length-1)*n),p=(this.length-1)*n-c;return i=p,r=this.points[c],o=this.controls[c][1],s=this.controls[c+1][0],a=this.points[c+1],h=[(l=(u=i)*u)*u,3*l*(1-u),3*u*(1-u)*(1-u),(1-u)*(1-u)*(1-u)],{x:a.x*h[0]+s.x*h[1]+o.x*h[2]+r.x*h[3],y:a.y*h[0]+s.y*h[1]+o.y*h[2]+r.y*h[3],z:a.z*h[0]+s.z*h[1]+o.z*h[2]+r.z*h[3]}};var ki=Di,Ri=Di;function Di(t,e,n){n=n||2;var i,r,o,s,a,u,l,h=e&&e.length,c=h?e[0]*n:t.length,p=Ai(t,0,c,n,!0),f=[];if(!p)return f;if(h&&(p=function(t,e,n,i){var r,o,s,a,u,l=[];for(r=0,o=e.length;r<o;r++)s=e[r]*i,a=r<o-1?e[r+1]*i:t.length,(u=Ai(t,s,a,i,!1))===u.next&&(u.steiner=!0),l.push(Hi(u));for(l.sort(zi),r=0;r<l.length;r++)Vi(l[r],n),n=Fi(n,n.next);return n}(t,e,p,n)),t.length>80*n){i=o=t[0],r=s=t[1];for(var d=n;d<c;d+=n)(a=t[d])<i&&(i=a),(u=t[d+1])<r&&(r=u),o<a&&(o=a),s<u&&(s=u);l=0!==(l=Math.max(o-i,s-r))?1/l:0}return Bi(p,f,n,i,r,l),f}function Ai(t,e,n,i,r){var o,s;if(r===0<nr(t,e,n,i))for(o=e;o<n;o+=i)s=$i(o,t[o],t[o+1],s);else for(o=n-i;e<=o;o-=i)s=$i(o,t[o],t[o+1],s);return s&&Wi(s,s.next)&&(tr(s),s=s.next),s}function Fi(t,e){if(!t)return t;e=e||t;var n,i=t;do{if(n=!1,i.steiner||!Wi(i,i.next)&&0!==Ji(i.prev,i,i.next))i=i.next;else{if(tr(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Bi(t,e,n,i,r,o,s){if(t){!s&&o&&function(t,e,n,i){var r=t;for(;null===r.z&&(r.z=Yi(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next,r!==t;);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,u,l=1;do{for(n=t,o=t=null,s=0;n;){for(s++,i=n,e=a=0;e<l&&(a++,i=i.nextZ);e++);for(u=l;0<a||0<u&&i;)0!==a&&(0===u||!i||n.z<=i.z)?(n=(r=n).nextZ,a--):(i=(r=i).nextZ,u--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,l*=2}while(1<s)}(r)}(t,i,r,o);for(var a,u,l=t;t.prev!==t.next;)if(a=t.prev,u=t.next,o?Ui(t,i,r,o):Gi(t))e.push(a.i/n),e.push(t.i/n),e.push(u.i/n),tr(t),t=u.next,l=u.next;else if((t=u)===l){s?1===s?Bi(t=ji(t,e,n),e,n,i,r,o,2):2===s&&qi(t,e,n,i,r,o):Bi(Fi(t),e,n,i,r,o,1);break}}}function Gi(t){var e=t.prev,n=t,i=t.next;if(0<=Ji(e,n,i))return!1;for(var r=t.next.next;r!==t.prev;){if(Xi(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=Ji(r.prev,r,r.next))return!1;r=r.next}return!0}function Ui(t,e,n,i){var r=t.prev,o=t,s=t.next;if(0<=Ji(r,o,s))return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,u=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,l=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,h=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,c=Yi(a,u,e,n,i),p=Yi(l,h,e,n,i),f=t.nextZ;f&&f.z<=p;){if(f!==t.prev&&f!==t.next&&Xi(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=Ji(f.prev,f,f.next))return!1;f=f.nextZ}for(f=t.prevZ;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&Xi(r.x,r.y,o.x,o.y,s.x,s.y,f.x,f.y)&&0<=Ji(f.prev,f,f.next))return!1;f=f.prevZ}return!0}function ji(t,e,n){var i=t;do{var r=i.prev,o=i.next.next;!Wi(r,o)&&Ki(r,i,i.next,o)&&Zi(r,o)&&Zi(o,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(o.i/n),tr(i),tr(i.next),i=t=o),i=i.next}while(i!==t);return i}function qi(t,e,n,i,r,o){var s,a,u=t;do{for(var l=u.next.next;l!==u.prev;){if(u.i!==l.i&&(a=l,(s=u).next.i!==a.i&&s.prev.i!==a.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ki(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(s,a)&&Zi(s,a)&&Zi(a,s)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;for(;n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next,n!==t;);return i}(s,a))){var h=Qi(u,l);return u=Fi(u,u.next),h=Fi(h,h.next),Bi(u,e,n,i,r,o),void Bi(h,e,n,i,r,o)}l=l.next}u=u.next}while(u!==t)}function zi(t,e){return t.x-e.x}function Vi(t,e){if(e=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&s<a){if((s=a)===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===s)return n.prev;var u,l=n,h=n.x,c=n.y,p=1/0;i=n.next;for(;i!==l;)r>=i.x&&i.x>=h&&r!==i.x&&Xi(o<c?r:s,o,h,c,o<c?s:r,o,i.x,i.y)&&((u=Math.abs(o-i.y)/(r-i.x))<p||u===p&&i.x>n.x)&&Zi(i,t)&&(n=i,p=u),i=i.next;return n}(t,e)){var n=Qi(e,t);Fi(n,n.next)}}function Yi(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Hi(t){for(var e=t,n=t;e.x<n.x&&(n=e),(e=e.next)!==t;);return n}function Xi(t,e,n,i,r,o,s,a){return 0<=(r-s)*(e-a)-(t-s)*(o-a)&&0<=(t-s)*(i-a)-(n-s)*(e-a)&&0<=(n-s)*(o-a)-(r-s)*(i-a)}function Ji(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Wi(t,e){return t.x===e.x&&t.y===e.y}function Ki(t,e,n,i){return!!(Wi(t,e)&&Wi(n,i)||Wi(t,i)&&Wi(n,e))||0<Ji(t,e,n)!=0<Ji(t,e,i)&&0<Ji(n,i,t)!=0<Ji(n,i,e)}function Zi(t,e){return Ji(t.prev,t,t.next)<0?0<=Ji(t,e,t.next)&&0<=Ji(t,t.prev,e):Ji(t,e,t.prev)<0||Ji(t,t.next,e)<0}function Qi(t,e){var n=new er(t.i,t.x,t.y),i=new er(e.i,e.x,e.y),r=t.next,o=e.prev;return(t.next=e).prev=t,(n.next=r).prev=n,(i.next=n).prev=i,(o.next=i).prev=o,i}function $i(t,e,n,i){var r=new er(t,e,n);return i?(r.next=i.next,(r.prev=i).next.prev=r,i.next=r):(r.prev=r).next=r,r}function tr(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function er(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function nr(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}function ir(t){var i=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);0<r&&(i+=t[r-1].length,n.holes.push(i))}return n}(t),r=ki(i.vertices,i.holes,2),e=[],o=[];r.forEach(function(t,e){var n=r[e];o.push([i.vertices[2*n],i.vertices[2*n+1]])});for(var n=0;n<o.length;n+=3){var s=o.slice(n,n+3);s.push(o[n]),e.push(kt([s]))}return e}function rr(i,t){if(!i)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");var r,o=1/0;return se(t,function(t,e){var n=Bn(i,t);n<o&&((r=Gn(t)).properties.featureIndex=e,r.properties.distanceToPoint=n,o=n)}),r}function or(t,e,n,i,r){!function t(e,n,i,r,o){for(;i<r;){if(600<r-i){var s=r-i+1,a=n-i+1,u=Math.log(s),l=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*l*(s-l)/s)*(a-s/2<0?-1:1),c=Math.max(i,Math.floor(n-a*l/s+h)),p=Math.min(r,Math.floor(n+(s-a)*l/s+h));t(e,n,c,p,o)}var f=e[n],d=i,g=r;for(sr(e,i,n),0<o(e[r],f)&&sr(e,i,r);d<g;){for(sr(e,d,g),d++,g--;o(e[d],f)<0;)d++;for(;0<o(e[g],f);)g--}0===o(e[i],f)?sr(e,i,g):sr(e,++g,r),g<=n&&(i=g+1),n<=g&&(r=g-1)}}(t,e,n||0,i||t.length-1,r||ar)}function sr(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function ar(t,e){return t<e?-1:e<t?1:0}function ur(t,e){if(!(this instanceof ur))return new ur(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function lr(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function hr(t,e){cr(t,0,t.children.length,e,t)}function cr(t,e,n,i,r){(r=r||vr(null)).minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],pr(r,t.leaf?i(o):o);return r}function pr(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function fr(t,e){return t.minX-e.minX}function dr(t,e){return t.minY-e.minY}function gr(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function yr(t){return t.maxX-t.minX+(t.maxY-t.minY)}function _r(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function mr(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function vr(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function br(t,e,n,i,r){for(var o,s=[e,n];s.length;)(n=s.pop())-(e=s.pop())<=i||(or(t,o=e+Math.ceil((n-e)/i/2)*i,e,n,r),s.push(e,o,o,n))}function xr(t){var e=ur(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=Er(e)).bbox=e}else t.bbox=t.bbox?t.bbox:Ir(t);return ur.prototype.insert.call(this,t)},e.load=function(t){var n=[];return Array.isArray(t)?t.forEach(function(t){var e=Er(t);e.bbox=t,n.push(e)}):se(t,function(t){t.bbox=t.bbox?t.bbox:Ir(t),n.push(t)}),ur.prototype.load.call(this,n)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=Er(e)).bbox=e}return ur.prototype.remove.call(this,t)},e.clear=function(){return ur.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:ur.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return ur.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:ur.prototype.all.call(this)}},e.toJSON=function(){return ur.prototype.toJSON.call(this)},e.fromJSON=function(t){return ur.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:Ir(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}function Er(t){var e=[t[0],t[1]],n=[t[0],t[3]],i=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],i,n,e]]}}}function Ir(t){var e=[1/0,1/0,-1/0,-1/0];return ne(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}function Lr(t){if(!t)throw new Error("geojson is required");var e=[];return ce(t,function(t){!function(n,i){var t=[],e=n.geometry;switch(e.type){case"Polygon":t=be(e);break;case"LineString":t=[be(e)]}t.forEach(function(t){var e,l,h;(e=t,l=n.properties,h=[],e.reduce(function(t,e){var n,i,r,o,s,a,u=Dt([t,e],l);return u.bbox=(i=e,r=(n=t)[0],o=n[1],s=i[0],a=i[1],[r<s?r:s,o<a?o:a,s<r?r:s,a<o?o:a]),h.push(u),e}),h).forEach(function(t){t.id=i.length,i.push(t)})})}(t,e)}),Ft(e)}function wr(t,e){var r={},o=[];if("LineString"===t.type&&(t=Pt(t)),"LineString"===e.type&&(e=Pt(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var n=Sr(t,e);return n&&o.push(n),Ft(o)}var s=xr();return s.load(Lr(e)),se(Lr(t),function(i){se(s.search(i),function(t){var e=Sr(i,t);if(e){var n=be(e).join(",");r[n]||(r[n]=!0,o.push(e))}})}),Ft(o)}function Sr(t,e){var n=be(t),i=be(e);if(2!==n.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=n[0][0],o=n[0][1],s=n[1][0],a=n[1][1],u=i[0][0],l=i[0][1],h=i[1][0],c=i[1][1],p=(c-l)*(s-r)-(h-u)*(a-o);if(0==p)return null;var f=((h-u)*(o-l)-(c-l)*(r-u))/p,d=((s-r)*(o-l)-(a-o)*(r-u))/p;return 0<=f&&f<=1&&0<=d&&d<=1?Ot([r+f*(s-r),o+f*(a-o)]):null}function Mr(t,p,f){if(!Qt(f=f||{}))throw new Error("options is invalid");var e=t.geometry?t.geometry.type:t.type;if("LineString"!==e&&"MultiLineString"!==e)throw new Error("lines must be LineString or MultiLineString");var d=Ot([1/0,1/0],{dist:1/0}),g=0;return ce(t,function(t){for(var e=be(t),n=0;n<e.length-1;n++){var i=Ot(e[n]);i.properties.dist=Bn(p,i,f);var r=Ot(e[n+1]);r.properties.dist=Bn(p,r,f);var o=Bn(i,r,f),s=Math.max(i.properties.dist,r.properties.dist),a=Pi(i,r),u=Mi(p,s,a+90,f),l=Mi(p,s,a-90,f),h=wr(Dt([u.geometry.coordinates,l.geometry.coordinates]),Dt([i.geometry.coordinates,r.geometry.coordinates])),c=null;0<h.features.length&&((c=h.features[0]).properties.dist=Bn(p,c,f),c.properties.location=g+Bn(i,c,f)),i.properties.dist<d.properties.dist&&((d=i).properties.index=n,d.properties.location=g),r.properties.dist<d.properties.dist&&((d=r).properties.index=n+1,d.properties.location=g+o),c&&c.properties.dist<d.properties.dist&&((d=c).properties.index=n),g+=o}}),d}function Cr(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i,r=n.final;if(!t)throw new Error("start point is required");if(!e)throw new Error("end point is required");return 180<(i=r?Pr(ve(e),ve(t)):Pr(ve(t),ve(e)))?-(360-i):i}function Pr(t,e){var n=Jt(t[1]),i=Jt(e[1]),r=Jt(e[0]-t[0]);r>Math.PI&&(r-=2*Math.PI),r<-Math.PI&&(r+=2*Math.PI);var o=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(n/2+Math.PI/4));return(Xt(Math.atan2(r,o))+360)%360}function Nr(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("from point is required");if(!e)throw new Error("to point is required");var r=ve(t),o=ve(e);return o[0]+=180<o[0]-r[0]?-360:180<r[0]-o[0]?360:0,Wt(function(t,e,n){var i=n=void 0===n?wt:Number(n),r=t[1]*Math.PI/180,o=e[1]*Math.PI/180,s=o-r,a=Math.abs(e[0]-t[0])*Math.PI/180;a>Math.PI&&(a-=2*Math.PI);var u=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(r/2+Math.PI/4)),l=1e-11<Math.abs(u)?s/u:Math.cos(r);return Math.sqrt(s*s+l*l*a*a)*i}(r,o),"meters",i)}function Or(t,e){return kr(t,"mercator",e)}function Tr(t,e){return kr(t,"wgs84",e)}function kr(t,n,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var i=e.mutate;if(!t)throw new Error("geojson is required");return Array.isArray(t)&&Zt(t[0])?t="mercator"===n?Rr(t):Dr(t):(!0!==i&&(t=Gn(t)),ne(t,function(t){var e="mercator"===n?Rr(t):Dr(t);t[0]=e[0],t[1]=e[1]})),t}function Rr(t){var e,n=Math.PI/180,i=20037508.342789244,r=[6378137*(Math.abs(t[0])<=180?t[0]:t[0]-360*((e=t[0])<0?-1:0<e?1:0))*n,6378137*Math.log(Math.tan(.25*Math.PI+.5*t[1]*n))];return r[0]>i&&(r[0]=i),r[0]<-i&&(r[0]=-i),r[1]>i&&(r[1]=i),r[1]<-i&&(r[1]=-i),r}function Dr(t){var e=180/Math.PI;return[t[0]*e/6378137,(.5*Math.PI-2*Math.atan(Math.exp(-t[1]/6378137)))*e]}Di.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(nr(t,0,o,n));if(r)for(var a=0,u=e.length;a<u;a++){var l=e[a]*n,h=a<u-1?e[a+1]*n:t.length;s-=Math.abs(nr(t,l,h,n))}var c=0;for(a=0;a<i.length;a+=3){var p=i[a]*n,f=i[a+1]*n,d=i[a+2]*n;c+=Math.abs((t[p]-t[d])*(t[1+f]-t[1+p])-(t[p]-t[f])*(t[1+d]-t[1+p]))}return 0===s&&0===c?0:Math.abs((c-s)/s)},Di.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);0<r&&(i+=t[r-1].length,n.holes.push(i))}return n},ki.default=Ri,ur.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!mr(t,e))return n;for(var r,o,s,a,u=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],mr(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):_r(t,a)?this._all(s,n):u.push(s));e=u.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!mr(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],mr(t,s=e.leaf?n(o):o)){if(e.leaf||_r(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=vr([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,s=this.data,a=this.toBBox(t),u=[],l=[];s||u.length;){if(s||(s=u.pop(),i=u[u.length-1],n=l.pop(),o=!0),s.leaf&&-1!==(r=lr(t,s.children,e)))return s.children.splice(r,1),u.push(s),this._condense(u),this;o||s.leaf||!_r(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(u.push(s),l.push(n),n=0,s=(i=s).children[0])}return this},toBBox:function(t){return t},compareMinX:fr,compareMinY:dr,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,s=this._maxEntries;if(o<=s)return hr(r=vr(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,i-1))),(r=vr([])).leaf=!1,r.height=i;var a,u,l,h,c=Math.ceil(o/s),p=c*Math.ceil(Math.sqrt(s));for(br(t,e,n,p,this.compareMinX),a=e;a<=n;a+=p)for(br(t,a,l=Math.min(a+p-1,n),c,this.compareMinY),u=a;u<=l;u+=c)h=Math.min(u+c-1,l),r.children.push(this._build(t,u,h,i-1));return hr(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,u,l,h,c,p,f;i.push(e),!e.leaf&&i.length-1!==n;){for(h=c=1/0,r=0,o=e.children.length;r<o;r++)u=gr(s=e.children[r]),p=t,f=s,(l=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-u)<c?(c=l,h=u<h?u:h,a=s):l===c&&u<h&&(h=u,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),pr(s,r);0<=e&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),s=vr(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,hr(n,this.toBBox),hr(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(t,e){this.data=vr([t,e]),this.data.height=t.height+1,this.data.leaf=!1,hr(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,a,u,l,h,c,p,f,d,g,y;for(u=l=1/0,i=e;i<=n-e;i++)r=cr(t,0,i,this.toBBox),o=cr(t,i,n,this.toBBox),c=r,p=o,void 0,f=Math.max(c.minX,p.minX),d=Math.max(c.minY,p.minY),g=Math.min(c.maxX,p.maxX),y=Math.min(c.maxY,p.maxY),s=Math.max(0,g-f)*Math.max(0,y-d),a=gr(r)+gr(o),s<u?(u=s,h=i,l=a<l?a:l):s===u&&a<l&&(l=a,h=i);return h},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:fr,r=t.leaf?this.compareMinY:dr;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,a=cr(t,0,e,s),u=cr(t,n-e,n,s),l=yr(a)+yr(u);for(r=e;r<n-e;r++)o=t.children[r],pr(a,t.leaf?s(o):o),l+=yr(a);for(r=n-e-1;e<=r;r--)o=t.children[r],pr(u,t.leaf?s(o):o),l+=yr(u);return l},_adjustParentBBoxes:function(t,e,n){for(var i=n;0<=i;i--)pr(e[i],t)},_condense:function(t){for(var e,n=t.length-1;0<=n;n--)0===t[n].children.length?0<n?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():hr(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Ar=Object.freeze({toMercator:Or,toWgs84:Tr});function Fr(t,e,r){if(!Qt(r=r||{}))throw new Error("options is invalid");if(!t)throw new Error("pt is required");if(Array.isArray(t)?t=Ot(t):"Point"===t.type?t=Pt(t):Ie(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=Dt(e):"LineString"===e.type?e=Pt(e):Ie(e,"LineString","line");var o=1/0,s=t.geometry.coordinates;return fe(e,function(t){var e=t.geometry.coordinates[0],n=t.geometry.coordinates[1],i=function(t,e,n,i){var r=i.mercator,o=!0!==r?Bn(e,t,i):Br(e,t,i),s=Ht(!0!==r?Pi(e,t):Cr(e,t)),a=Ht(!0!==r?Pi(e,n):Cr(e,n)),u=Math.abs(s-a);if(90<u)return o;var l=(a+180)%360,h=Ht(!0!==r?Pi(n,t):Cr(n,t)),c=Math.abs(h-l);180<c&&(c=Math.abs(c-360));return 90<c?!0!==r?Bn(t,n,i):Br(t,n,i):!0!==r?o*Math.sin(Jt(u)):function(t,e,n,i){var r=0;(180<=Math.abs(t[0])||180<=Math.abs(e[0])||180<=Math.abs(n[0]))&&(r=0<t[0]||0<e[0]||0<n[0]?-180:180);var o=Ot(n),s=Or([t[0]+r,t[1]]),a=Or([e[0]+r,e[1]]),u=Or([n[0]+r,n[1]]),l=Tr(function(t,e,n){var i=t[0],r=t[1],o=e[0],s=e[1],a=n[0],u=n[1],l=o-i,h=s-r,c=((a-i)*l+(u-r)*h)/(l*l+h*h);return[i+c*l,r+c*h]}(s,a,u));0!==r&&(l[0]-=r);return Nr(o,l,i)}(e,n,t,i)}(s,e,n,r);i<o&&(o=i)}),o}function Br(t,e,n){var i=n.units,r=0;180<=Math.abs(t[0])&&(r=0<t[0]?-180:180),180<=Math.abs(e[0])&&(r=0<e[0]?-180:180);function o(t){return t*t}var s=Or([t[0]+r,t[1]]),a=Or([e[0]+r,e[1]]),u=o(s[0]-a[0])+o(s[1]-a[1]);return Wt(Math.sqrt(u),"meters",i)}function Gr(t,e,n,i,r,o,s,a){var u,l,h,c,p={x:null,y:null,onLine1:!1,onLine2:!1};return 0==(u=(a-o)*(n-t)-(s-r)*(i-e))?null!==p.x&&null!==p.y&&p:(c=(n-t)*(l=e-o)-(i-e)*(h=t-r),l=((s-r)*l-(a-o)*h)/u,h=c/u,p.x=t+l*(n-t),p.y=e+l*(i-e),0<=l&&l<=1&&(p.onLine1=!0),0<=h&&h<=1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y])}function Ur(t){for(var e,n="FeatureCollection"===(e=t).type?e:"Feature"===e.type?Ft([e]):Ft([Pt(e)]),i=Ni(n),r=!1,o=0;!r&&o<n.features.length;){var s,a=n.features[o].geometry,u=!1;if("Point"===a.type)i.geometry.coordinates[0]===a.coordinates[0]&&i.geometry.coordinates[1]===a.coordinates[1]&&(r=!0);else if("MultiPoint"===a.type){var l=!1;for(s=0;!l&&s<a.coordinates.length;)i.geometry.coordinates[0]===a.coordinates[s][0]&&i.geometry.coordinates[1]===a.coordinates[s][1]&&(l=r=!0),s++}else if("LineString"===a.type)for(s=0;!u&&s<a.coordinates.length-1;)jr(i.geometry.coordinates[0],i.geometry.coordinates[1],a.coordinates[s][0],a.coordinates[s][1],a.coordinates[s+1][0],a.coordinates[s+1][1])&&(r=u=!0),s++;else if("MultiLineString"===a.type)for(var h=0;h<a.coordinates.length;){u=!1,s=0;for(var c=a.coordinates[h];!u&&s<c.length-1;)jr(i.geometry.coordinates[0],i.geometry.coordinates[1],c[s][0],c[s][1],c[s+1][0],c[s+1][1])&&(r=u=!0),s++;h++}else"Polygon"!==a.type&&"MultiPolygon"!==a.type||On(i,a)&&(r=!0);o++}if(r)return i;var p=Ft([]);for(o=0;o<n.features.length;o++)p.features=p.features.concat(Ti(n.features[o]).features);return Ot(rr(i,p).geometry.coordinates)}function jr(t,e,n,i,r,o){return Math.sqrt((r-n)*(r-n)+(o-i)*(o-i))===Math.sqrt((t-n)*(t-n)+(e-i)*(e-i))+Math.sqrt((r-t)*(r-t)+(o-e)*(o-e))}function qr(t){return he(t,function(t,e){return t+function t(e){var n,i=0;switch(e.type){case"Polygon":return Vr(e.coordinates);case"MultiPolygon":for(n=0;n<e.coordinates.length;n++)i+=Vr(e.coordinates[n]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0;case"GeometryCollection":for(n=0;n<e.geometries.length;n++)i+=t(e.geometries[n]);return i}}(e)},0)}var zr=6378137;function Vr(t){var e=0;if(t&&0<t.length){e+=Math.abs(Yr(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(Yr(t[n]))}return e}function Yr(t){var e,n,i,r,o,s,a=0,u=t.length;if(2<u){for(s=0;s<u;s++)o=s===u-2?(i=u-2,r=u-1,0):s===u-1?(i=u-1,r=0,1):(r=(i=s)+1,s+2),e=t[i],n=t[r],a+=(Hr(t[o][0])-Hr(e[0]))*Math.sin(Hr(n[1]));a=a*zr*zr/2}return a}function Hr(t){return t*Math.PI/180}function Xr(t,i){if(!Qt(i=i||{}))throw new Error("options is invalid");if(!t)throw new Error("geojson is required");return de(t,function(t,e){var n=e.geometry.coordinates;return t+Bn(n[0],n[1],i)},0)}function Jr(t,e,n,i){if(!Qt(i=i||{}))throw new Error("options is invalid");var r,o=[];if("Feature"===t.type)r=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");r=t.coordinates}for(var s,a,u,l=0,h=0;h<r.length&&!(l<=e&&h===r.length-1);h++){if(e<l&&0===o.length){if(!(s=e-l))return o.push(r[h]),Dt(o);a=Pi(r[h],r[h-1])-180,u=Mi(r[h],s,a,i),o.push(u.geometry.coordinates)}if(n<=l)return(s=n-l)?(a=Pi(r[h],r[h-1])-180,u=Mi(r[h],s,a,i),o.push(u.geometry.coordinates)):o.push(r[h]),Dt(o);if(e<=l&&o.push(r[h]),h===r.length-1)return Dt(o);l+=Bn(r[h],r[h+1],i)}return Dt(r[r.length-1])}function Wr(t,e,n){var i=(n=n||{}).ignoreEndVertices;if(!Qt(n))throw new Error("invalid options");if(!t)throw new Error("pt is required");if(!e)throw new Error("line is required");for(var r=ve(t),o=be(e),s=0;s<o.length-1;s++){var a=!1;if(i&&(0===s&&(a="start"),s===o.length-2&&(a="end"),0===s&&s+1===o.length-1&&(a="both")),Kr(o[s],o[s+1],r,a))return!0}return!1}function Kr(t,e,n,i){var r=n[0],o=n[1],s=t[0],a=t[1],u=e[0],l=e[1],h=u-s,c=l-a;return 0==(n[0]-s)*c-(n[1]-a)*h&&(i?"start"===i?Math.abs(h)>=Math.abs(c)?0<h?s<r&&r<=u:u<=r&&r<s:0<c?a<o&&o<=l:l<=o&&o<a:"end"===i?Math.abs(h)>=Math.abs(c)?0<h?s<=r&&r<u:u<r&&r<=s:0<c?a<=o&&o<l:l<o&&o<=a:"both"===i?Math.abs(h)>=Math.abs(c)?0<h?s<r&&r<u:u<r&&r<s:0<c?a<o&&o<l:l<o&&o<a:void 0:Math.abs(h)>=Math.abs(c)?0<h?s<=r&&r<=u:u<=r&&r<=s:0<c?a<=o&&o<=l:l<=o&&o<=a)}function Zr(t,e){var n=Me(t),i=Me(e),r=we(t),o=we(e);switch(n){case"Point":switch(i){case"MultiPoint":return function(t,e){var n,i=!1;for(n=0;n<e.coordinates.length;n++)if($r(e.coordinates[n],t.coordinates)){i=!0;break}return i}(r,o);case"LineString":return Wr(r,o,{ignoreEndVertices:!0});case"Polygon":return On(r,o,{ignoreBoundary:!0});default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"MultiPoint":return function(t,e){for(var n=0;n<t.coordinates.length;n++){for(var i=!1,r=0;r<e.coordinates.length;r++)$r(t.coordinates[n],e.coordinates[r])&&(i=!0);if(!i)return!1}return!0}(r,o);case"LineString":return function(t,e){for(var n=!1,i=0;i<t.coordinates.length;i++){if(!Wr(t.coordinates[i],e))return!1;n=n||Wr(t.coordinates[i],e,{ignoreEndVertices:!0})}return n}(r,o);case"Polygon":return function(t,e){for(var n=!0,i=0;i<t.coordinates.length;i++){var r=On(t.coordinates[1],e);if(!r){n=!1;break}r=On(t.coordinates[1],e,{ignoreBoundary:!0})}return n&&r}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"LineString":return function(t,e){for(var n=0;n<t.coordinates.length;n++)if(!Wr(t.coordinates[n],e))return!1;return!0}(r,o);case"Polygon":return function(t,e){var n=me(e),i=me(t);if(!Qr(n,i))return!1;for(var r=!1,o=0;o<t.coordinates.length-1;o++){if(!On(t.coordinates[o],e))return!1;if(!(r=r||On(t.coordinates[o],e,{ignoreBoundary:!0}))){var s=(a=t.coordinates[o],u=t.coordinates[o+1],[(a[0]+u[0])/2,(a[1]+u[1])/2]);r=On(s,e,{ignoreBoundary:!0})}}var a,u;return r}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Polygon":return function(t,e){var n=me(t);if(!Qr(me(e),n))return!1;for(var i=0;i<t.coordinates[0].length;i++)if(!On(t.coordinates[0][i],e))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Qr(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function $r(t,e){return t[0]===e[0]&&t[1]===e[1]}function to(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.mask,r=n.properties,o=[];if(null==e)throw new Error("cellSide is required");if(!Zt(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(i&&-1===["Polygon","MultiPolygon"].indexOf(Me(i)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],a=t[1],u=t[2],l=t[3],h=e/Bn([s,a],[u,a],n)*(u-s),c=e/Bn([s,a],[s,l],n)*(l-a),p=u-s,f=l-a,d=Math.floor(p/h),g=(f-Math.floor(f/c)*c)/2,y=s+(p-d*h)/2;y<=u;){for(var _=a+g;_<=l;){var m=Ot([y,_],r);i?Zr(m,i)&&o.push(m):o.push(m),_+=c}y+=h}return Ft(o)}function eo(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.precision,i=e.coordinates,r=e.mutate;if(n=null==n||isNaN(n)?6:n,i=null==i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof n)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==r&&void 0!==r||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,n);return ne(t,function(t){!function(t,e,n){t.length>n&&t.splice(n,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,o,i)}),t}function no(t,p,e){if("Polygon"!==t.geometry.type)throw new Error("The input feature must be a Polygon");void 0===e&&(e=1);var f=t.geometry.coordinates,d=[],g={};if(e){for(var n=[],i=0;i<f.length;i++)for(var r=0;r<f[i].length-1;r++)n.push(c(i,r));var o=Ue();o.load(n)}for(var s=0;s<f.length;s++)for(var a=0;a<f[s].length-1;a++){if(e)o.search(c(s,a)).forEach(function(t){var e=t.ring,n=t.edge;h(s,a,e,n)});else for(var u=0;u<f.length;u++)for(var l=0;l<f[u].length-1;l++)h(s,a,u,l)}return p||(d={type:"Feature",geometry:{type:"MultiPoint",coordinates:d}}),d;function h(t,e,n,i){var r,o,s=f[t][e],a=f[t][e+1],u=f[n][i],l=f[n][i+1],h=function(t,e,n,i){if(io(t,n)||io(t,i)||io(e,n)||io(i,n))return null;var r=t[0],o=t[1],s=e[0],a=e[1],u=n[0],l=n[1],h=i[0],c=i[1],p=(r-s)*(l-c)-(o-a)*(u-h);return 0==p?null:[((r*a-o*s)*(u-h)-(r-s)*(u*c-l*h))/p,((r*a-o*s)*(l-c)-(o-a)*(u*c-l*h))/p]}(s,a,u,l);if(null!==h&&(r=a[0]!==s[0]?(h[0]-s[0])/(a[0]-s[0]):(h[1]-s[1])/(a[1]-s[1]),o=l[0]!==u[0]?(h[0]-u[0])/(l[0]-u[0]):(h[1]-u[1])/(l[1]-u[1]),!(1<=r||r<=0||1<=o||o<=0))){var c=!g[h];c&&(g[h]=!0),p?d.push(p(h,t,e,s,a,r,n,i,u,l,o,c)):d.push(h)}}function c(t,e){var n,i,r,o,s=f[t][e],a=f[t][e+1];return i=s[0]<a[0]?(n=s[0],a[0]):(n=a[0],s[0]),o=s[1]<a[1]?(r=s[1],a[1]):(r=a[1],s[1]),{minX:n,minY:r,maxX:i,maxY:o,ring:t,edge:e}}}function io(t,e){if(!t||!e)return!1;if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!io(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}function ro(t){if("Feature"!=t.type)throw new Error("The input must a geojson object of type Feature");if(void 0===t.geometry||null==t.geometry)throw new Error("The input must a geojson object with a non-empty geometry");if("Polygon"!=t.geometry.type)throw new Error("The input must be a geojson Polygon");for(var e=t.geometry.coordinates.length,n=[],i=0;i<e;i++){var r=t.geometry.coordinates[i];lo(r[0],r[r.length-1])||r.push(r[0]),n.push.apply(n,r.slice(0,r.length-1))}if(!function(t){for(var e={},n=1,i=0,r=t.length;i<r;++i){if(e.hasOwnProperty(t[i])){n=0;break}e[t[i]]=1}return n}(n))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var o=n.length,s=no(t,function(t,e,n,i,r,o,s,a,u,l,h,c){return[t,e,n,i,r,o,s,a,u,l,h,c]}),a=s.length;if(0==a){var u=[];for(i=0;i<e;i++)u.push(kt([t.geometry.coordinates[i]],{parent:-1,winding:uo(t.geometry.coordinates[i])}));var l=Ft(u);return A(),F(),l}var h=[],c=[];for(i=0;i<e;i++){h.push([]);for(var p=0;p<t.geometry.coordinates[i].length-1;p++)h[i].push([new oo(t.geometry.coordinates[i][(p+1).modulo(t.geometry.coordinates[i].length-1)],1,[i,p],[i,(p+1).modulo(t.geometry.coordinates[i].length-1)],void 0)]),c.push(new so(t.geometry.coordinates[i][p],[i,(p-1).modulo(t.geometry.coordinates[i].length-1)],[i,p],void 0,void 0,!1,!0))}for(i=0;i<a;i++)h[s[i][1]][s[i][2]].push(new oo(s[i][0],s[i][5],[s[i][1],s[i][2]],[s[i][6],s[i][7]],void 0)),s[i][11]&&c.push(new so(s[i][0],[s[i][1],s[i][2]],[s[i][6],s[i][7]],void 0,void 0,!0,!0));var f=c.length;for(i=0;i<h.length;i++)for(p=0;p<h[i].length;p++)h[i][p].sort(function(t,e){return t.param<e.param?-1:1});var d=[];for(i=0;i<f;i++)d.push({minX:c[i].coord[0],minY:c[i].coord[1],maxX:c[i].coord[0],maxY:c[i].coord[1],index:i});var g=Ue();for(g.load(d),i=0;i<h.length;i++)for(p=0;p<h[i].length;p++)for(var y=0;y<h[i][p].length;y++){m=y==h[i][p].length-1?h[i][(p+1).modulo(t.geometry.coordinates[i].length-1)][0].coord:h[i][p][y+1].coord;var _=g.search({minX:m[0],minY:m[1],maxX:m[0],maxY:m[1]})[0];h[i][p][y].nxtIsectAlongEdgeIn=_.index}for(i=0;i<h.length;i++)for(p=0;p<h[i].length;p++)for(y=0;y<h[i][p].length;y++){var m=h[i][p][y].coord,v=(_=g.search({minX:m[0],minY:m[1],maxX:m[0],maxY:m[1]})[0]).index;v<o?c[v].nxtIsectAlongRingAndEdge2=h[i][p][y].nxtIsectAlongEdgeIn:lo(c[v].ringAndEdge1,h[i][p][y].ringAndEdgeIn)?c[v].nxtIsectAlongRingAndEdge1=h[i][p][y].nxtIsectAlongEdgeIn:c[v].nxtIsectAlongRingAndEdge2=h[i][p][y].nxtIsectAlongEdgeIn}var b=[];for(p=i=0;p<e;p++){var x=i;for(y=0;y<t.geometry.coordinates[p].length-1;y++)c[i].coord[0]<c[x].coord[0]&&(x=i),i++;var E=c[x].nxtIsectAlongRingAndEdge2;for(y=0;y<c.length;y++)if(c[y].nxtIsectAlongRingAndEdge1==x||c[y].nxtIsectAlongRingAndEdge2==x){var I=y;break}var L=ao([c[I].coord,c[x].coord,c[E].coord],!0)?1:-1;b.push({isect:x,parent:-1,winding:L})}for(b.sort(function(t,e){return c[t.isect].coord>c[e.isect].coord?-1:1}),u=[];0<b.length;){var w=b.pop(),S=w.isect,M=w.parent,C=w.winding,P=u.length,N=[c[S].coord],O=S;if(c[S].ringAndEdge1Walkable)var T=c[S].ringAndEdge1,k=c[S].nxtIsectAlongRingAndEdge1;else T=c[S].ringAndEdge2,k=c[S].nxtIsectAlongRingAndEdge2;for(;!lo(c[S].coord,c[k].coord);){N.push(c[k].coord);var R=void 0;for(i=0;i<b.length;i++)if(b[i].isect==k){R=i;break}if(null!=R&&b.splice(R,1),lo(T,c[k].ringAndEdge1)){if(T=c[k].ringAndEdge2,c[k].ringAndEdge2Walkable=!1,c[k].ringAndEdge1Walkable){var D={isect:k};ao([c[O].coord,c[k].coord,c[c[k].nxtIsectAlongRingAndEdge2].coord],1==C)?(D.parent=M,D.winding=-C):(D.parent=P,D.winding=C),b.push(D)}k=c[O=k].nxtIsectAlongRingAndEdge2}else{if(T=c[k].ringAndEdge1,c[k].ringAndEdge1Walkable=!1,c[k].ringAndEdge2Walkable){D={isect:k};ao([c[O].coord,c[k].coord,c[c[k].nxtIsectAlongRingAndEdge1].coord],1==C)?(D.parent=M,D.winding=-C):(D.parent=P,D.winding=C),b.push(D)}k=c[O=k].nxtIsectAlongRingAndEdge1}}N.push(c[k].coord),u.push(kt([N],{index:P,parent:M,winding:C,netWinding:void 0}))}function A(){for(var t=[],e=0;e<l.features.length;e++)-1==l.features[e].properties.parent&&t.push(e);if(1<t.length)for(e=0;e<t.length;e++){for(var n=-1,i=0;i<l.features.length;i++)t[e]!=i&&On(l.features[t[e]].geometry.coordinates[0][0],l.features[i],{ignoreBoundary:!0})&&qr(l.features[i])<1/0&&(n=i);l.features[t[e]].properties.parent=n}}function F(){for(var t=0;t<l.features.length;t++)if(-1==l.features[t].properties.parent){var e=l.features[t].properties.winding;B(t,l.features[t].properties.netWinding=e)}}function B(t,e){for(var n=0;n<l.features.length;n++)if(l.features[n].properties.parent==t){var i=e+l.features[n].properties.winding;B(n,l.features[n].properties.netWinding=i)}}return l=Ft(u),A(),F(),l}var oo=function(t,e,n,i,r){this.coord=t,this.param=e,this.ringAndEdgeIn=n,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=r},so=function(t,e,n,i,r,o,s){this.coord=t,this.ringAndEdge1=e,this.ringAndEdge2=n,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=r,this.ringAndEdge1Walkable=o,this.ringAndEdge2Walkable=s};function ao(t,e){if(void 0===e&&(e=!0),3!=t.length)throw new Error("This function requires an array of three points [x,y]");return 0<=(t[1][0]-t[0][0])*(t[2][1]-t[0][1])-(t[1][1]-t[0][1])*(t[2][0]-t[0][0])==e}function uo(t){for(var e=0,n=0;n<t.length-1;n++)t[n][0]<t[e][0]&&(e=n);if(ao([t[(e-1).modulo(t.length-1)],t[e],t[(e+1).modulo(t.length-1)]],!0))var i=1;else i=-1;return i}function lo(t,e){if(!t||!e)return!1;if(t.length!=e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!lo(t[n],e[n]))return!1}else if(t[n]!=e[n])return!1;return!0}Number.prototype.modulo=function(t){return(this%t+t)%t};function ho(t,e){this.lon=t,this.lat=e,this.x=co*t,this.y=co*e}var co=Math.PI/180,po=180/Math.PI;ho.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},ho.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new ho(e,t)};function fo(){this.coords=[],this.length=0}fo.prototype.move_to=function(t){this.length++,this.coords.push(t)};function go(t){this.properties=t||{},this.geometries=[]}go.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},go.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},i=0;i<this.geometries.length;i++){if(0===this.geometries[i].coords.length)return"LINESTRING(empty)";this.geometries[i].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};function yo(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new ho(t.x,t.y),this.end=new ho(e.x,e.y),this.properties=n||{};var i=this.start.x-this.end.x,r=this.start.y-this.end.y,o=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)}function _o(i,t){var r=[],o=xr();return ce(t,function(t){if(r.forEach(function(t,e){t.id=e}),r.length){var e=o.search(t);if(e.features.length){var n=vo(t,e);r=r.filter(function(t){return t.id!==n.id}),o.remove(n),se(mo(n,t),function(t){r.push(t),o.insert(t)})}}else(r=mo(i,t).features).forEach(function(t){t.bbox||(t.bbox=Si(me(t)))}),o.load(Ft(r))}),Ft(r)}function mo(t,o){var s=[],e=be(t)[0],n=be(t)[t.geometry.coordinates.length-1];if(bo(e,ve(o))||bo(n,ve(o)))return Ft([t]);var i=xr(),r=Lr(t);i.load(r);var a=i.search(o);if(!a.features.length)return Ft([t]);var u=vo(o,a),l=ae(r,function(t,e,n){var i=be(e)[1],r=ve(o);return n===u.id?(t.push(r),s.push(Dt(t)),bo(r,i)?[r]:[r,i]):(t.push(i),t)},[e]);return 1<l.length&&s.push(Dt(l)),Ft(s)}function vo(n,t){if(!t.features.length)throw new Error("lines must contain features");if(1===t.features.length)return t.features[0];var i,r=1/0;return se(t,function(t){var e=Mr(t,n).properties.dist;e<r&&(i=t,r=e)}),i}function bo(t,e){return t[0]===e[0]&&t[1]===e[1]}function xo(t,e,n,i,r){if(!Qt(r=r||{}))throw new Error("options is invalid");var o=r.steps,s=r.units;if(!t)throw new Error("center is required");if(!e)throw new Error("radius is required");if(null==n)throw new Error("bearing1 is required");if(null==i)throw new Error("bearing2 is required");if("object"!=typeof r)throw new Error("options must be an object");o=o||64;var a=Eo(n),u=Eo(i),l=t.properties;if(a===u)return Dt(Ci(t,e,r).geometry.coordinates[0],l);for(var h=a,c=a<u?u:u+360,p=h,f=[],d=0;p<c;)f.push(Mi(t,e,p,s).geometry.coordinates),p=h+360*++d/o;return c<p&&f.push(Mi(t,e,c,s).geometry.coordinates),Dt(f,l)}function Eo(t){var e=t%360;return e<0&&(e+=360),e}function Io(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.properties,i=Me(t),r=be(t);if(n=n||t.properties||{},!r.length)throw new Error("polygon must contain coordinates");switch(i){case"Polygon":return Lo(r,n);case"MultiPolygon":var o=[];return r.forEach(function(t){o.push(Lo(t,n))}),Ft(o);default:throw new Error("geom "+i+" not supported")}}function Lo(t,e){return 1<t.length?Bt(t,e):Dt(t[0],e)}function wo(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.properties,i=e.autoComplete,r=e.orderCoords;if(!t)throw new Error("lines is required");switch(i=void 0===i||i,r=void 0===r||r,Me(t)){case"FeatureCollection":case"GeometryCollection":var o=[];return(t.features?t.features:t.geometries).forEach(function(t){o.push(be(So(t,{},i,r)))}),Ut(o,n)}return So(t,n,i,r)}function So(t,e,a,u){e=e||t.properties||{};var n=be(t),i=Me(t);if(!n.length)throw new Error("line must contain coordinates");switch(i){case"LineString":return a&&(n=Mo(n)),kt([n],e);case"MultiLineString":var l=[],h=0;return n.forEach(function(t){if(a&&(t=Mo(t)),u){var e=(n=me(Dt(t)),i=n[0],r=n[1],o=n[2],s=n[3],Math.abs(i-o)*Math.abs(r-s));h<e?(l.unshift(t),h=e):l.push(t)}else l.push(t);var n,i,r,o,s}),kt(l,e);default:throw new Error("geometry type "+i+" is not supported")}}function Mo(t){var e=t[0],n=e[0],i=e[1],r=t[t.length-1],o=r[0],s=r[1];return n===o&&i===s||t.push(e),t}yo.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),i=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=po*Math.atan2(o,Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));return[po*Math.atan2(r,i),s]},yo.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var i=1/(t-1),r=0;r<t;++r){var o=i*r,s=this.interpolate(o);n.push(s)}for(var a=!1,u=0,l=e&&e.offset?e.offset:10,h=180-l,c=-180+l,p=360-l,f=1;f<n.length;++f){var d=n[f-1][0],g=n[f][0],y=Math.abs(g-d);p<y&&(h<g&&d<c||h<d&&g<c)?a=!0:u<y&&(u=y)}var _=[];if(a&&u<l){var m=[];_.push(m);for(var v=0;v<n.length;++v){var b=parseFloat(n[v][0]);if(0<v&&Math.abs(b-n[v-1][0])>p){var x=parseFloat(n[v-1][0]),E=parseFloat(n[v-1][1]),I=parseFloat(n[v][0]),L=parseFloat(n[v][1]);if(-180<x&&x<c&&180===I&&v+1<n.length&&-180<n[v-1][0]&&n[v-1][0]<c){m.push([-180,n[v][1]]),v++,m.push([n[v][0],n[v][1]]);continue}if(h<x&&x<180&&-180===I&&v+1<n.length&&n[v-1][0]>h&&n[v-1][0]<180){m.push([180,n[v][1]]),v++,m.push([n[v][0],n[v][1]]);continue}if(x<c&&h<I){var w=x;x=I,I=w;var S=E;E=L,L=S}if(h<x&&I<c&&(I+=360),x<=180&&180<=I&&x<I){var M=(180-x)/(I-x),C=M*L+(1-M)*E;m.push([n[v-1][0]>h?180:-180,C]),(m=[]).push([n[v-1][0]>h?-180:180,C]),_.push(m)}else m=[],_.push(m);m.push([b,n[v][1]])}else m.push([n[v][0],n[v][1]])}}else{var P=[];_.push(P);for(var N=0;N<n.length;++N)P.push([n[N][0],n[N][1]])}for(var O=new go(this.properties),T=0;T<_.length;++T){var k=new fo;O.geometries.push(k);for(var R=_[T],D=0;D<R.length;++D)k.move_to(R[D])}return O};var Co=Po;function Po(t,e,n){var i,r,o,s,a,u=t.length,l=Oo(t[0],e),h=[];for(n=n||[],i=1;i<u;i++){for(r=t[i-1],s=a=Oo(o=t[i],e);;){if(!(l|s)){h.push(r),s!==a?(h.push(o),i<u-1&&(n.push(h),h=[])):i===u-1&&h.push(o);break}if(l&s)break;l?l=Oo(r=No(r,o,l,e),e):s=Oo(o=No(r,o,s,e),e)}l=a}return h.length&&n.push(h),n}function No(t,e,n,i){return 8&n?[t[0]+(e[0]-t[0])*(i[3]-t[1])/(e[1]-t[1]),i[3]]:4&n?[t[0]+(e[0]-t[0])*(i[1]-t[1])/(e[1]-t[1]),i[1]]:2&n?[i[2],t[1]+(e[1]-t[1])*(i[2]-t[0])/(e[0]-t[0])]:1&n?[i[0],t[1]+(e[1]-t[1])*(i[0]-t[0])/(e[0]-t[0])]:null}function Oo(t,e){var n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function To(t,e){for(var n=[],i=0;i<t.length;i++){var r=Co.polygon(t[i],e);0<r.length&&(r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]||r.push(r[0]),4<=r.length&&n.push(r))}return n}(Po.polyline=Po).polygon=function(t,e){var n,i,r,o,s,a,u;for(i=1;i<=8;i*=2){for(n=[],r=t[t.length-1],o=!(Oo(r,e)&i),s=0;s<t.length;s++)a=t[s],(u=!(Oo(a,e)&i))!==o&&n.push(No(r,a,i,e)),u&&n.push(a),r=a,o=u;if(!(t=n).length)break}return n};var ko=Array.prototype.slice;function Ro(t){return"[object Arguments]"===Object.prototype.toString.call(t)}function Do(t,e,n){return n=n||{},t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?(n.strict,t===e):function(t,e,n){var i,r;if(Ao(t)||Ao(e))return!1;if(t.prototype!==e.prototype)return!1;if(Ro(t))return!!Ro(e)&&(t=ko.call(t),e=ko.call(e),Do(t,e,n));if(Fo(t)){if(!Fo(e))return!1;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}try{var o=Object.keys(t),s=Object.keys(e)}catch(t){return!1}if(o.length!==s.length)return!1;for(o.sort(),s.sort(),i=o.length-1;0<=i;i--)if(o[i]!==s[i])return!1;for(i=o.length-1;0<=i;i--)if(r=o[i],!Do(t[r],e[r],n))return!1;return typeof t==typeof e}(t,e,n))}function Ao(t){return null==t}function Fo(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(0<t.length&&"number"!=typeof t[0]))}function Bo(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var o,s=n.tolerance||0,a=[],u=xr();return u.load(Lr(t)),fe(e,function(i){var r=!1;se(u.search(i),function(t){if(!1===r){var e=be(i).sort(),n=be(t).sort();Do(e,n)?(r=!0,o=o?Go(o,i):i):(0===s?Wr(e[0],t)&&Wr(e[1],t):Mr(t,e[0]).properties.dist<=s&&Mr(t,e[1]).properties.dist<=s)?(r=!0,o=o?Go(o,i):i):(0===s?Wr(n[0],i)&&Wr(n[1],i):Mr(i,n[0]).properties.dist<=s&&Mr(i,n[1]).properties.dist<=s)&&(o=o?Go(o,t):t)}}),!1===r&&o&&(a.push(o),o=void 0)}),o&&a.push(o),Ft(a)}function Go(t,e){var n=be(e),i=be(t),r=i[0],o=i[i.length-1],s=t.geometry.coordinates;return Do(n[0],r)?s.unshift(n[1]):Do(n[0],o)?s.push(n[1]):Do(n[1],r)?s.unshift(n[0]):Do(n[1],o)&&s.push(n[0]),t}function Uo(t){var e=t%360;return e<0&&(e+=360),e}function jo(t,e,n,i){if(!Qt(i=i||{}))throw new Error("options is invalid");var r=i.units,o=i.properties;if(!t)throw new Error("origin is required");if(null==e)throw new Error("distance is required");if(null==n)throw new Error("bearing is required");if(!(0<=e))throw new Error("distance must be greater than 0");var s=Wt(e,r,"meters"),a=ve(t),u=function(t,e,n,i){i=void 0===i?wt:Number(i);var r=e/i,o=t[0]*Math.PI/180,s=Jt(t[1]),a=Jt(n),u=r*Math.cos(a),l=s+u;Math.abs(l)>Math.PI/2&&(l=0<l?Math.PI-l:-Math.PI-l);var h=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),c=1e-11<Math.abs(h)?u/h:Math.cos(s),p=r*Math.sin(a)/c;return[(180*(o+p)/Math.PI+540)%360-180,180*l/Math.PI]}(a,s,n);return u[0]+=180<u[0]-a[0]?-360:180<a[0]-u[0]?360:0,Ot(u,o)}function qo(t,e,n,i,r,o){for(var s=0;s<t.length;s++){var a=t[s],u=t[s+1];s===t.length-1&&(u=t[0]),i=zo(a,u,e),n<=0&&0<i?zo(e,a,r)<0||(r=a):0<n&&i<=0&&(0<zo(e,a,o)||(o=a)),n=i}return[r,o]}function zo(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function Vo(t){if(!t)throw new Error("line is required");var e=t.geometry?t.geometry.type:t.type;if(!Array.isArray(t)&&"LineString"!==e)throw new Error("geometry must be a LineString");for(var n,i,r=be(t),o=0,s=1;s<r.length;)n=i||r[0],o+=((i=r[s])[0]-n[0])*(i[1]+n[1]),s++;return 0<o}function Yo(t,e){switch("Feature"===t.type?t.geometry.type:t.type){case"GeometryCollection":return le(t,function(t){Yo(t,e)}),t;case"LineString":return Ho(be(t),e),t;case"Polygon":return Xo(be(t),e),t;case"MultiLineString":return be(t).forEach(function(t){Ho(t,e)}),t;case"MultiPolygon":return be(t).forEach(function(t){Xo(t,e)}),t;case"Point":case"MultiPoint":return t}}function Ho(t,e){Vo(t)===e&&t.reverse()}function Xo(t,e){Vo(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)Vo(t[n])===e&&t[n].reverse()}function Jo(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.zProperty||"elevation",i=e.flip,r=e.flags;Le(t,"Point","input must contain Points");for(var o,s,a=(o=i,s={},se(t,function(t){var e=be(t)[1];s[e]||(s[e]=[]),s[e].push(t)}),Object.keys(s).map(function(t){return s[t].sort(function(t,e){return be(t)[0]-be(e)[0]})}).sort(function(t,e){return o?be(t[0])[1]-be(e[0])[1]:be(e[0])[1]-be(t[0])[1]})),u=[],l=0;l<a.length;l++){for(var h=a[l],c=[],p=0;p<h.length;p++){var f=h[p];f.properties[n]?c.push(f.properties[n]):c.push(0),!0===r&&(f.properties.matrixPosition=[l,p])}u.push(c)}return u}var Wo={successCallback:null,verbose:!1,polygons:!1},Ko={};function Zo(t,e,n,i){i=i||{};for(var r=Object.keys(Wo),o=0;o<r.length;o++){var s=r[o],a=i[s];a=null!=a?a:Wo[s],Ko[s]=a}Ko.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+e+":"+(e+n)+"]");var u,l,h,c=function(t,e,n){for(var i=t.length-1,r=t[0].length-1,o={rows:i,cols:r,cells:[]},s=e+Math.abs(n),a=0;a<i;++a){o.cells[a]=[];for(var u=0;u<r;++u){var l=0,h=t[a+1][u],c=t[a+1][u+1],p=t[a][u+1],f=t[a][u];if(!(isNaN(h)||isNaN(c)||isNaN(p)||isNaN(f))){l|=h<e?0:s<h?128:64,l|=c<e?0:s<c?32:16,l|=p<e?0:s<p?8:4;var d=+(l|=f<e?0:s<f?2:1),g=0;if(17===l||18===l||33===l||34===l||38===l||68===l||72===l||98===l||102===l||132===l||136===l||137===l||152===l||153===l){var y=(h+c+p+f)/4;g=s<y?2:y<e?0:1,34===l?1===g?l=35:0===g&&(l=136):136===l?1===g?(l=35,g=4):0===g&&(l=34):17===l?1===g?(l=155,g=4):0===g&&(l=153):68===l?1===g?(l=103,g=4):0===g&&(l=102):153===l?1===g&&(l=155):102===l?1===g&&(l=103):152===l?g<2&&(l=156,g=1):137===l?g<2&&(l=139,g=1):98===l?g<2&&(l=99,g=1):38===l?g<2&&(l=39,g=1):18===l?0<g?(l=156,g=4):l=152:33===l?0<g?(l=139,g=4):l=137:72===l?0<g?(l=99,g=4):l=98:132===l&&(0<g?(l=39,g=4):l=38)}if(0!=l&&170!=l){var _,m,v,b,x,E,I,L;_=m=v=b=x=E=I=L=.5;var w=[];1===l?(v=1-zs(e,p,f),L=1-zs(e,h,f),w.push(Fs[l])):169===l?(v=zs(s,f,p),L=zs(s,f,h),w.push(Fs[l])):4===l?(E=1-zs(e,c,p),b=zs(e,f,p),w.push(Ds[l])):166===l?(E=zs(s,p,c),b=1-zs(s,p,f),w.push(Ds[l])):16===l?(x=zs(e,p,c),m=zs(e,h,c),w.push(Rs[l])):154===l?(x=1-zs(s,c,p),m=1-zs(s,c,h),w.push(Rs[l])):64===l?(I=zs(e,f,h),_=1-zs(e,c,h),w.push(Gs[l])):106===l?(I=1-zs(s,h,f),_=zs(s,h,c),w.push(Gs[l])):168===l?(b=zs(s,f,p),v=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),w.push(As[l]),w.push(Fs[l])):2===l?(b=1-zs(e,p,f),v=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),w.push(As[l]),w.push(Fs[l])):162===l?(x=zs(s,p,c),E=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),w.push(As[l]),w.push(Fs[l])):8===l?(x=1-zs(e,c,p),E=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),w.push(Rs[l]),w.push(Ds[l])):138===l?(x=1-zs(e,c,p),E=1-zs(s,c,p),_=1-zs(s,c,h),m=1-zs(e,c,h),w.push(Rs[l]),w.push(Ds[l])):32===l?(x=zs(s,p,c),E=zs(e,p,c),_=zs(e,h,c),m=zs(s,h,c),w.push(Rs[l]),w.push(Ds[l])):42===l?(L=1-zs(s,h,f),I=1-zs(e,h,f),_=zs(e,h,c),m=zs(s,h,c),w.push(Bs[l]),w.push(Gs[l])):128===l&&(L=zs(e,f,h),I=zs(s,f,h),_=1-zs(s,c,h),m=1-zs(e,c,h),w.push(Bs[l]),w.push(Gs[l])),5===l?(E=1-zs(e,c,p),L=1-zs(e,h,f),w.push(Ds[l])):165===l?(E=zs(s,p,c),L=zs(s,f,h),w.push(Ds[l])):20===l?(b=zs(e,f,p),m=zs(e,h,c),w.push(As[l])):150===l?(b=1-zs(s,p,f),m=1-zs(s,c,h),w.push(As[l])):80===l?(x=zs(e,p,c),I=zs(e,f,h),w.push(Rs[l])):90===l?(x=1-zs(s,c,p),I=1-zs(s,h,f),w.push(Rs[l])):65===l?(v=1-zs(e,p,f),_=1-zs(e,c,h),w.push(Fs[l])):105===l?(v=zs(s,f,p),_=zs(s,h,c),w.push(Fs[l])):160===l?(x=zs(s,p,c),E=zs(e,p,c),L=zs(e,f,h),I=zs(s,f,h),w.push(Rs[l]),w.push(Ds[l])):10===l?(x=1-zs(e,c,p),E=1-zs(s,c,p),L=1-zs(s,h,f),I=1-zs(e,h,f),w.push(Rs[l]),w.push(Ds[l])):130===l?(b=1-zs(e,p,f),v=1-zs(s,p,f),_=1-zs(s,c,h),m=1-zs(e,c,h),w.push(As[l]),w.push(Fs[l])):40===l?(b=zs(s,f,p),v=zs(e,f,p),_=zs(e,h,c),m=zs(s,h,c),w.push(As[l]),w.push(Fs[l])):101===l?(E=zs(s,p,c),_=zs(s,h,c),w.push(Ds[l])):69===l?(E=1-zs(e,c,p),_=1-zs(e,c,h),w.push(Ds[l])):149===l?(L=zs(s,f,h),m=1-zs(s,c,h),w.push(Bs[l])):21===l?(L=1-zs(e,h,f),m=zs(e,h,c),w.push(Bs[l])):86===l?(b=1-zs(s,p,f),I=1-zs(s,h,f),w.push(As[l])):84===l?(b=zs(e,f,p),I=zs(e,f,h),w.push(As[l])):89===l?(x=1-zs(s,c,p),v=zs(s,f,p),w.push(Fs[l])):81===l?(x=zs(e,p,c),v=1-zs(e,p,f),w.push(Fs[l])):96===l?(x=zs(s,p,c),E=zs(e,p,c),I=zs(e,f,h),_=zs(s,h,c),w.push(Rs[l]),w.push(Ds[l])):74===l?(x=1-zs(e,c,p),E=1-zs(s,c,p),I=1-zs(s,h,f),_=1-zs(e,c,h),w.push(Rs[l]),w.push(Ds[l])):24===l?(x=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),m=zs(e,h,c),w.push(Rs[l]),w.push(Fs[l])):146===l?(x=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),m=1-zs(s,c,h),w.push(Rs[l]),w.push(Fs[l])):6===l?(E=1-zs(e,c,p),b=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),w.push(Ds[l]),w.push(As[l])):164===l?(E=zs(s,p,c),b=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),w.push(Ds[l]),w.push(As[l])):129===l?(v=1-zs(e,p,f),L=zs(s,f,h),_=1-zs(s,c,h),m=1-zs(e,c,h),w.push(Fs[l]),w.push(Bs[l])):41===l?(v=zs(s,f,p),L=1-zs(e,h,f),_=zs(e,h,c),m=zs(s,h,c),w.push(Fs[l]),w.push(Bs[l])):66===l?(b=1-zs(e,p,f),v=1-zs(s,p,f),I=1-zs(s,h,f),_=1-zs(e,c,h),w.push(As[l]),w.push(Fs[l])):104===l?(b=zs(s,f,p),v=zs(e,f,p),I=zs(e,f,h),_=zs(s,h,c),w.push(Fs[l]),w.push(Us[l])):144===l?(x=zs(e,p,c),L=zs(e,f,h),I=zs(s,f,h),m=1-zs(s,c,h),w.push(Rs[l]),w.push(Gs[l])):26===l?(x=1-zs(s,c,p),L=1-zs(s,h,f),I=1-zs(e,h,f),m=zs(e,h,c),w.push(Rs[l]),w.push(Gs[l])):36===l?(E=zs(s,p,c),b=zs(e,f,p),_=zs(e,h,c),m=zs(s,h,c),w.push(Ds[l]),w.push(As[l])):134===l?(E=1-zs(e,c,p),b=1-zs(s,p,f),_=1-zs(s,c,h),m=1-zs(e,c,h),w.push(Ds[l]),w.push(As[l])):9===l?(x=1-zs(e,c,p),E=1-zs(s,c,p),v=zs(s,f,p),L=1-zs(e,h,f),w.push(Rs[l]),w.push(Ds[l])):161===l?(x=zs(s,p,c),E=zs(e,p,c),v=1-zs(e,p,f),L=zs(s,f,h),w.push(Rs[l]),w.push(Ds[l])):37===l?(E=zs(s,p,c),L=1-zs(e,h,f),_=zs(e,h,c),m=zs(s,h,c),w.push(Ds[l]),w.push(Bs[l])):133===l?(E=1-zs(e,c,p),L=zs(s,f,h),_=1-zs(s,c,h),m=1-zs(e,c,h),w.push(Ds[l]),w.push(Bs[l])):148===l?(b=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),m=1-zs(s,c,h),w.push(As[l]),w.push(Gs[l])):22===l?(b=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),m=zs(e,h,c),w.push(As[l]),w.push(Gs[l])):82===l?(x=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),I=1-zs(s,h,f),w.push(Rs[l]),w.push(Fs[l])):88===l?(x=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),I=zs(e,f,h),w.push(Rs[l]),w.push(Fs[l])):73===l?(x=1-zs(e,c,p),E=1-zs(s,c,p),v=zs(s,f,p),_=1-zs(e,c,h),w.push(Rs[l]),w.push(Ds[l])):97===l?(x=zs(s,p,c),E=zs(e,p,c),v=1-zs(e,p,f),_=zs(s,h,c),w.push(Rs[l]),w.push(Ds[l])):145===l?(x=zs(e,p,c),v=1-zs(e,p,f),L=zs(s,f,h),m=1-zs(s,c,h),w.push(Rs[l]),w.push(Bs[l])):25===l?(x=1-zs(s,c,p),v=zs(s,f,p),L=1-zs(e,h,f),m=zs(e,h,c),w.push(Rs[l]),w.push(Bs[l])):70===l?(E=1-zs(e,c,p),b=1-zs(s,p,f),I=1-zs(s,h,f),_=1-zs(e,c,h),w.push(Ds[l]),w.push(As[l])):100===l?(E=zs(s,p,c),b=zs(e,f,p),I=zs(e,f,h),_=zs(s,h,c),w.push(Ds[l]),w.push(As[l])):34===l?(m=0===g?(x=1-zs(e,c,p),E=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),_=1-zs(s,c,h),1-zs(e,c,h)):(x=zs(s,p,c),E=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),_=zs(e,h,c),zs(s,h,c)),w.push(Rs[l]),w.push(Ds[l]),w.push(Bs[l]),w.push(Gs[l])):35===l?(m=4===g?(x=1-zs(e,c,p),E=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),_=1-zs(s,c,h),1-zs(e,c,h)):(x=zs(s,p,c),E=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),_=zs(e,h,c),zs(s,h,c)),w.push(Rs[l]),w.push(Ds[l]),w.push(Fs[l]),w.push(Gs[l])):136===l?(m=0===g?(x=zs(s,p,c),E=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),_=zs(e,h,c),zs(s,h,c)):(x=1-zs(e,c,p),E=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),_=1-zs(s,c,h),1-zs(e,c,h)),w.push(Rs[l]),w.push(Ds[l]),w.push(Bs[l]),w.push(Gs[l])):153===l?(m=0===g?(x=zs(e,p,c),v=1-zs(e,p,f),L=1-zs(e,h,f),zs(e,h,c)):(x=1-zs(s,c,p),v=zs(s,f,p),L=zs(s,f,h),1-zs(s,c,h)),w.push(Rs[l]),w.push(Fs[l])):102===l?(_=0===g?(E=1-zs(e,c,p),b=zs(e,f,p),I=zs(e,f,h),1-zs(e,c,h)):(E=zs(s,p,c),b=1-zs(s,p,f),I=1-zs(s,h,f),zs(s,h,c)),w.push(Ds[l]),w.push(Gs[l])):155===l?(m=4===g?(x=zs(e,p,c),v=1-zs(e,p,f),L=1-zs(e,h,f),zs(e,h,c)):(x=1-zs(s,c,p),v=zs(s,f,p),L=zs(s,f,h),1-zs(s,c,h)),w.push(Rs[l]),w.push(Bs[l])):103===l?(_=4===g?(E=1-zs(e,c,p),b=zs(e,f,p),I=zs(e,f,h),1-zs(e,c,h)):(E=zs(s,p,c),b=1-zs(s,p,f),I=1-zs(s,h,f),zs(s,h,c)),w.push(Ds[l]),w.push(As[l])):152===l?(m=0===g?(x=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),zs(e,h,c)):(x=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),1-zs(s,c,h)),w.push(Rs[l]),w.push(As[l]),w.push(Fs[l])):156===l?(m=4===g?(x=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),zs(e,h,c)):(x=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),1-zs(s,c,h)),w.push(Rs[l]),w.push(Fs[l]),w.push(Gs[l])):137===l?(m=0===g?(x=zs(s,p,c),E=zs(e,p,c),v=1-zs(e,p,f),L=1-zs(e,h,f),_=zs(e,h,c),zs(s,h,c)):(x=1-zs(e,c,p),E=1-zs(s,c,p),v=zs(s,f,p),L=zs(s,f,h),_=1-zs(s,c,h),1-zs(e,c,h)),w.push(Rs[l]),w.push(Ds[l]),w.push(Fs[l])):139===l?(m=4===g?(x=zs(s,p,c),E=zs(e,p,c),v=1-zs(e,p,f),L=1-zs(e,h,f),_=zs(e,h,c),zs(s,h,c)):(x=1-zs(e,c,p),E=1-zs(s,c,p),v=zs(s,f,p),L=zs(s,f,h),_=1-zs(s,c,h),1-zs(e,c,h)),w.push(Rs[l]),w.push(Ds[l]),w.push(Bs[l])):98===l?(_=0===g?(x=1-zs(e,c,p),E=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),I=zs(e,f,h),1-zs(e,c,h)):(x=zs(s,p,c),E=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),I=1-zs(s,h,f),zs(s,h,c)),w.push(Rs[l]),w.push(Ds[l]),w.push(Gs[l])):99===l?(_=4===g?(x=1-zs(e,c,p),E=1-zs(s,c,p),b=zs(s,f,p),v=zs(e,f,p),I=zs(e,f,h),1-zs(e,c,h)):(x=zs(s,p,c),E=zs(e,p,c),b=1-zs(e,p,f),v=1-zs(s,p,f),I=1-zs(s,h,f),zs(s,h,c)),w.push(Rs[l]),w.push(Ds[l]),w.push(Fs[l])):38===l?(m=0===g?(E=1-zs(e,c,p),b=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),_=1-zs(s,c,h),1-zs(e,c,h)):(E=zs(s,p,c),b=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),_=zs(e,h,c),zs(s,h,c)),w.push(Ds[l]),w.push(Bs[l]),w.push(Gs[l])):39===l?(m=4===g?(E=1-zs(e,c,p),b=zs(e,f,p),L=zs(e,f,h),I=zs(s,f,h),_=1-zs(s,c,h),1-zs(e,c,h)):(E=zs(s,p,c),b=1-zs(s,p,f),L=1-zs(s,h,f),I=1-zs(e,h,f),_=zs(e,h,c),zs(s,h,c)),w.push(Ds[l]),w.push(As[l]),w.push(Gs[l])):85===l&&(_=L=v=E=0,m=I=b=x=1),(_<0||1<_||m<0||1<m||x<0||1<x||b<0||1<b||L<0||1<L||I<0||1<I)&&console.log("MarchingSquaresJS-isoBands: "+l+" "+d+" "+h+","+c+","+p+","+f+" "+g+" "+_+" "+m+" "+x+" "+E+" "+b+" "+v+" "+L+" "+I),o.cells[a][u]={cval:l,cval_real:d,flipped:g,topleft:_,topright:m,righttop:x,rightbottom:E,bottomright:b,bottomleft:v,leftbottom:L,lefttop:I,edges:w}}}}}return o}(t,e,n);return u=Ko.polygons?(Ko.verbose&&console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"),l=[],h=0,c.cells.forEach(function(t,i){t.forEach(function(t,e){if(void 0!==t){var n=qs[t.cval](t);"object"==typeof n&&Vs(n)?"object"==typeof n[0]&&Vs(n[0])?"object"==typeof n[0][0]&&Vs(n[0][0])?n.forEach(function(t){t.forEach(function(t){t[0]+=e,t[1]+=i}),l[h++]=t}):(n.forEach(function(t){t[0]+=e,t[1]+=i}),l[h++]=n):console.log("MarchingSquaresJS-isoBands: bandcell polygon with malformed coordinates"):console.log("MarchingSquaresJS-isoBands: bandcell polygon with null coordinates")}})}),l):(Ko.verbose&&console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),function(t){for(var e=[],n=t.rows,i=t.cols,r=[],o=0;o<n;o++)for(var s=0;s<i;s++)if(void 0!==t.cells[o][s]&&0<t.cells[o][s].edges.length){var a=Hs(t.cells[o][s]),u=null,l=s,h=o;null!==a&&r.push([a.p[0]+l,a.p[1]+h]);do{if(null===(u=Xs(t.cells[h][l],a.x,a.y,a.o)))break;if(r.push([u.p[0]+l,u.p[1]+h]),l+=u.x,h+=u.y,a=u,h<0||n<=h||l<0||i<=l||void 0===t.cells[h][l]){l-=u.x,h-=u.y;var c=Ys(t,l,h,u.x,u.y,u.o);if(null===c)break;c.path.forEach(function(t){r.push(t)}),l=c.i,h=c.j,a=c}}while(void 0!==t.cells[h][l]&&0<t.cells[h][l].edges.length);e.push(r),r=[],0<t.cells[o][s].edges.length&&s--}return e}(c)),"function"==typeof Ko.successCallback&&Ko.successCallback(u),u}var Qo=64,$o=16,ts=4,es=1,ns=[],is=[],rs=[],os=[],ss=[],as=[],us=[],ls=[],hs=[],cs=[],ps=[],fs=[],ds=[],gs=[],ys=[],_s=[],ms=[],vs=[],bs=[],xs=[],Es=[],Is=[],Ls=[],ws=[];us[85]=cs[85]=-1,ls[85]=ps[85]=0,hs[85]=fs[85]=1,bs[85]=Is[85]=1,xs[85]=Ls[85]=0,Es[85]=ws[85]=1,ns[85]=os[85]=0,is[85]=ss[85]=-1,rs[85]=ys[85]=0,_s[85]=ds[85]=0,ms[85]=gs[85]=1,as[85]=vs[85]=1,Is[1]=Is[169]=0,Ls[1]=Ls[169]=-1,ws[1]=ws[169]=0,ds[1]=ds[169]=-1,gs[1]=gs[169]=0,ys[1]=ys[169]=0,cs[4]=cs[166]=0,ps[4]=ps[166]=-1,fs[4]=fs[166]=1,_s[4]=_s[166]=1,ms[4]=ms[166]=0,vs[4]=vs[166]=0,us[16]=us[154]=0,ls[16]=ls[154]=1,hs[16]=hs[154]=1,os[16]=os[154]=1,ss[16]=ss[154]=0,as[16]=as[154]=1,bs[64]=bs[106]=0,xs[64]=xs[106]=1,Es[64]=Es[106]=0,ns[64]=ns[106]=-1,is[64]=is[106]=0,rs[64]=rs[106]=1,bs[2]=bs[168]=0,xs[2]=xs[168]=-1,Es[2]=Es[168]=1,Is[2]=Is[168]=0,Ls[2]=Ls[168]=-1,ws[2]=ws[168]=0,ds[2]=ds[168]=-1,gs[2]=gs[168]=0,ys[2]=ys[168]=0,_s[2]=_s[168]=-1,ms[2]=ms[168]=0,vs[2]=vs[168]=1,us[8]=us[162]=0,ls[8]=ls[162]=-1,hs[8]=hs[162]=0,cs[8]=cs[162]=0,ps[8]=ps[162]=-1,fs[8]=fs[162]=1,ds[8]=ds[162]=1,gs[8]=gs[162]=0,ys[8]=ys[162]=1,_s[8]=_s[162]=1,ms[8]=ms[162]=0,vs[8]=vs[162]=0,us[32]=us[138]=0,ls[32]=ls[138]=1,hs[32]=hs[138]=1,cs[32]=cs[138]=0,ps[32]=ps[138]=1,fs[32]=fs[138]=0,ns[32]=ns[138]=1,is[32]=is[138]=0,rs[32]=rs[138]=0,os[32]=os[138]=1,ss[32]=ss[138]=0,as[32]=as[138]=1,Is[128]=Is[42]=0,Ls[128]=Ls[42]=1,ws[128]=ws[42]=1,bs[128]=bs[42]=0,xs[128]=xs[42]=1,Es[128]=Es[42]=0,ns[128]=ns[42]=-1,is[128]=is[42]=0,rs[128]=rs[42]=1,os[128]=os[42]=-1,ss[128]=ss[42]=0,as[128]=as[42]=0,cs[5]=cs[165]=-1,ps[5]=ps[165]=0,fs[5]=fs[165]=0,Is[5]=Is[165]=1,Ls[5]=Ls[165]=0,ws[5]=ws[165]=0,_s[20]=_s[150]=0,ms[20]=ms[150]=1,vs[20]=vs[150]=1,os[20]=os[150]=0,ss[20]=ss[150]=-1,as[20]=as[150]=1,us[80]=us[90]=-1,ls[80]=ls[90]=0,hs[80]=hs[90]=1,bs[80]=bs[90]=1,xs[80]=xs[90]=0,Es[80]=Es[90]=1,ds[65]=ds[105]=0,gs[65]=gs[105]=1,ys[65]=ys[105]=0,ns[65]=ns[105]=0,is[65]=is[105]=-1,rs[65]=rs[105]=0,us[160]=us[10]=-1,ls[160]=ls[10]=0,hs[160]=hs[10]=1,cs[160]=cs[10]=-1,ps[160]=ps[10]=0,fs[160]=fs[10]=0,Is[160]=Is[10]=1,Ls[160]=Ls[10]=0,ws[160]=ws[10]=0,bs[160]=bs[10]=1,xs[160]=xs[10]=0,Es[160]=Es[10]=1,_s[130]=_s[40]=0,ms[130]=ms[40]=1,vs[130]=vs[40]=1,ds[130]=ds[40]=0,gs[130]=gs[40]=1,ys[130]=ys[40]=0,ns[130]=ns[40]=0,is[130]=is[40]=-1,rs[130]=rs[40]=0,os[130]=os[40]=0,ss[130]=ss[40]=-1,as[130]=as[40]=1,cs[37]=cs[133]=0,ps[37]=ps[133]=1,fs[37]=fs[133]=1,Is[37]=Is[133]=0,Ls[37]=Ls[133]=1,ws[37]=ws[133]=0,ns[37]=ns[133]=-1,is[37]=is[133]=0,rs[37]=rs[133]=0,os[37]=os[133]=1,ss[37]=ss[133]=0,as[37]=as[133]=0,_s[148]=_s[22]=-1,ms[148]=ms[22]=0,vs[148]=vs[22]=0,Is[148]=Is[22]=0,Ls[148]=Ls[22]=-1,ws[148]=ws[22]=1,bs[148]=bs[22]=0,xs[148]=xs[22]=1,Es[148]=Es[22]=1,os[148]=os[22]=-1,ss[148]=ss[22]=0,as[148]=as[22]=1,us[82]=us[88]=0,ls[82]=ls[88]=-1,hs[82]=hs[88]=1,_s[82]=_s[88]=1,ms[82]=ms[88]=0,vs[82]=vs[88]=1,ds[82]=ds[88]=-1,gs[82]=gs[88]=0,ys[82]=ys[88]=1,bs[82]=bs[88]=0,xs[82]=xs[88]=-1,Es[82]=Es[88]=0,us[73]=us[97]=0,ls[73]=ls[97]=1,hs[73]=hs[97]=0,cs[73]=cs[97]=0,ps[73]=ps[97]=-1,fs[73]=fs[97]=0,ds[73]=ds[97]=1,gs[73]=gs[97]=0,ys[73]=ys[97]=0,ns[73]=ns[97]=1,is[73]=is[97]=0,rs[73]=rs[97]=1,us[145]=us[25]=0,ls[145]=ls[25]=-1,hs[145]=hs[25]=0,ds[145]=ds[25]=1,gs[145]=gs[25]=0,ys[145]=ys[25]=1,Is[145]=Is[25]=0,Ls[145]=Ls[25]=1,ws[145]=ws[25]=1,os[145]=os[25]=-1,ss[145]=ss[25]=0,as[145]=as[25]=0,cs[70]=cs[100]=0,ps[70]=ps[100]=1,fs[70]=fs[100]=0,_s[70]=_s[100]=-1,ms[70]=ms[100]=0,vs[70]=vs[100]=1,bs[70]=bs[100]=0,xs[70]=xs[100]=-1,Es[70]=Es[100]=1,ns[70]=ns[100]=1,is[70]=is[100]=0,rs[70]=rs[100]=0,cs[101]=cs[69]=0,ps[101]=ps[69]=1,fs[101]=fs[69]=0,ns[101]=ns[69]=1,is[101]=is[69]=0,rs[101]=rs[69]=0,Is[149]=Is[21]=0,Ls[149]=Ls[21]=1,ws[149]=ws[21]=1,os[149]=os[21]=-1,ss[149]=ss[21]=0,as[149]=as[21]=0,_s[86]=_s[84]=-1,ms[86]=ms[84]=0,vs[86]=vs[84]=1,bs[86]=bs[84]=0,xs[86]=xs[84]=-1,Es[86]=Es[84]=1,us[89]=us[81]=0,ls[89]=ls[81]=-1,hs[89]=hs[81]=0,ds[89]=ds[81]=1,gs[89]=gs[81]=0,ys[89]=ys[81]=1,us[96]=us[74]=0,ls[96]=ls[74]=1,hs[96]=hs[74]=0,cs[96]=cs[74]=-1,ps[96]=ps[74]=0,fs[96]=fs[74]=1,bs[96]=bs[74]=1,xs[96]=xs[74]=0,Es[96]=Es[74]=0,ns[96]=ns[74]=1,is[96]=is[74]=0,rs[96]=rs[74]=1,us[24]=us[146]=0,ls[24]=ls[146]=-1,hs[24]=hs[146]=1,_s[24]=_s[146]=1,ms[24]=ms[146]=0,vs[24]=vs[146]=1,ds[24]=ds[146]=0,gs[24]=gs[146]=1,ys[24]=ys[146]=1,os[24]=os[146]=0,ss[24]=ss[146]=-1,as[24]=as[146]=0,cs[6]=cs[164]=-1,ps[6]=ps[164]=0,fs[6]=fs[164]=1,_s[6]=_s[164]=-1,ms[6]=ms[164]=0,vs[6]=vs[164]=0,Is[6]=Is[164]=0,Ls[6]=Ls[164]=-1,ws[6]=ws[164]=1,bs[6]=bs[164]=1,xs[6]=xs[164]=0,Es[6]=Es[164]=0,ds[129]=ds[41]=0,gs[129]=gs[41]=1,ys[129]=ys[41]=1,Is[129]=Is[41]=0,Ls[129]=Ls[41]=1,ws[129]=ws[41]=0,ns[129]=ns[41]=-1,is[129]=is[41]=0,rs[129]=rs[41]=0,os[129]=os[41]=0,ss[129]=ss[41]=-1,as[129]=as[41]=0,_s[66]=_s[104]=0,ms[66]=ms[104]=1,vs[66]=vs[104]=0,ds[66]=ds[104]=-1,gs[66]=gs[104]=0,ys[66]=ys[104]=1,bs[66]=bs[104]=0,xs[66]=xs[104]=-1,Es[66]=Es[104]=0,ns[66]=ns[104]=0,is[66]=is[104]=-1,rs[66]=rs[104]=1,us[144]=us[26]=-1,ls[144]=ls[26]=0,hs[144]=hs[26]=0,Is[144]=Is[26]=1,Ls[144]=Ls[26]=0,ws[144]=ws[26]=1,bs[144]=bs[26]=0,xs[144]=xs[26]=1,Es[144]=Es[26]=1,os[144]=os[26]=-1,ss[144]=ss[26]=0,as[144]=as[26]=1,cs[36]=cs[134]=0,ps[36]=ps[134]=1,fs[36]=fs[134]=1,_s[36]=_s[134]=0,ms[36]=ms[134]=1,vs[36]=vs[134]=0,ns[36]=ns[134]=0,is[36]=is[134]=-1,rs[36]=rs[134]=1,os[36]=os[134]=1,ss[36]=ss[134]=0,as[36]=as[134]=0,us[9]=us[161]=-1,ls[9]=ls[161]=0,hs[9]=hs[161]=0,cs[9]=cs[161]=0,ps[9]=ps[161]=-1,fs[9]=fs[161]=0,ds[9]=ds[161]=1,gs[9]=gs[161]=0,ys[9]=ys[161]=0,Is[9]=Is[161]=1,Ls[9]=Ls[161]=0,ws[9]=ws[161]=1,us[136]=0,ls[136]=1,hs[136]=1,cs[136]=0,ps[136]=1,fs[136]=0,_s[136]=-1,ms[136]=0,vs[136]=1,ds[136]=-1,gs[136]=0,ys[136]=0,Is[136]=0,Ls[136]=-1,ws[136]=0,bs[136]=0,xs[136]=-1,Es[136]=1,ns[136]=1,is[136]=0,rs[136]=0,os[136]=1,ss[136]=0,as[136]=1,us[34]=0,ls[34]=-1,hs[34]=0,cs[34]=0,ps[34]=-1,fs[34]=1,_s[34]=1,ms[34]=0,vs[34]=0,ds[34]=1,gs[34]=0,ys[34]=1,Is[34]=0,Ls[34]=1,ws[34]=1,bs[34]=0,xs[34]=1,Es[34]=0,ns[34]=-1,is[34]=0,rs[34]=1,os[34]=-1,ss[34]=0,as[34]=0,us[35]=0,ls[35]=1,hs[35]=1,cs[35]=0,ps[35]=-1,fs[35]=1,_s[35]=1,ms[35]=0,vs[35]=0,ds[35]=-1,gs[35]=0,ys[35]=0,Is[35]=0,Ls[35]=-1,ws[35]=0,bs[35]=0,xs[35]=1,Es[35]=0,ns[35]=-1,is[35]=0,rs[35]=1,os[35]=1,ss[35]=0,as[35]=1,us[153]=0,ls[153]=1,hs[153]=1,ds[153]=-1,gs[153]=0,ys[153]=0,Is[153]=0,Ls[153]=-1,ws[153]=0,os[153]=1,ss[153]=0,as[153]=1,cs[102]=0,ps[102]=-1,fs[102]=1,_s[102]=1,ms[102]=0,vs[102]=0,bs[102]=0,xs[102]=1,Es[102]=0,ns[102]=-1,is[102]=0,rs[102]=1,us[155]=0,ls[155]=-1,hs[155]=0,ds[155]=1,gs[155]=0,ys[155]=1,Is[155]=0,Ls[155]=1,ws[155]=1,os[155]=-1,ss[155]=0,as[155]=0,cs[103]=0,ps[103]=1,fs[103]=0,_s[103]=-1,ms[103]=0,vs[103]=1,bs[103]=0,xs[103]=-1,Es[103]=1,ns[103]=1,is[103]=0,rs[103]=0,us[152]=0,ls[152]=1,hs[152]=1,_s[152]=-1,ms[152]=0,vs[152]=1,ds[152]=-1,gs[152]=0,ys[152]=0,Is[152]=0,Ls[152]=-1,ws[152]=0,bs[152]=0,xs[152]=-1,Es[152]=1,os[152]=1,ss[152]=0,as[152]=1,us[156]=0,ls[156]=-1,hs[156]=1,_s[156]=1,ms[156]=0,vs[156]=1,ds[156]=-1,gs[156]=0,ys[156]=0,Is[156]=0,Ls[156]=-1,ws[156]=0,bs[156]=0,xs[156]=1,Es[156]=1,os[156]=-1,ss[156]=0,as[156]=1,us[137]=0,ls[137]=1,hs[137]=1,cs[137]=0,ps[137]=1,fs[137]=0,ds[137]=-1,gs[137]=0,ys[137]=0,Is[137]=0,Ls[137]=-1,ws[137]=0,ns[137]=1,is[137]=0,rs[137]=0,os[137]=1,ss[137]=0,as[137]=1,us[139]=0,ls[139]=1,hs[139]=1,cs[139]=0,ps[139]=-1,fs[139]=0,ds[139]=1,gs[139]=0,ys[139]=0,Is[139]=0,Ls[139]=1,ws[139]=0,ns[139]=-1,is[139]=0,rs[139]=0,os[139]=1,ss[139]=0,as[139]=1,us[98]=0,ls[98]=-1,hs[98]=0,cs[98]=0,ps[98]=-1,fs[98]=1,_s[98]=1,ms[98]=0,vs[98]=0,ds[98]=1,gs[98]=0,ys[98]=1,bs[98]=0,xs[98]=1,Es[98]=0,ns[98]=-1,is[98]=0,rs[98]=1,us[99]=0,ls[99]=1,hs[99]=0,cs[99]=0,ps[99]=-1,fs[99]=1,_s[99]=1,ms[99]=0,vs[99]=0,ds[99]=-1,gs[99]=0,ys[99]=1,bs[99]=0,xs[99]=-1,Es[99]=0,ns[99]=1,is[99]=0,rs[99]=1,cs[38]=0,ps[38]=-1,fs[38]=1,_s[38]=1,ms[38]=0,vs[38]=0,Is[38]=0,Ls[38]=1,ws[38]=1,bs[38]=0,xs[38]=1,Es[38]=0,ns[38]=-1,is[38]=0,rs[38]=1,os[38]=-1,ss[38]=0,as[38]=0,cs[39]=0,ps[39]=1,fs[39]=1,_s[39]=-1,ms[39]=0,vs[39]=0,Is[39]=0,Ls[39]=-1,ws[39]=1,bs[39]=0,xs[39]=1,Es[39]=0,ns[39]=-1,is[39]=0,rs[39]=1,os[39]=1,ss[39]=0,as[39]=0;function Ss(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]}function Ms(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]}function Cs(t){return[[t.topright,1],[1,1],[1,t.righttop]]}function Ps(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]}function Ns(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]}function Os(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]}function Ts(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]}function ks(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]}var Rs=[],Ds=[],As=[],Fs=[],Bs=[],Gs=[],Us=[],js=[];Fs[1]=Bs[1]=18,Fs[169]=Bs[169]=18,As[4]=Ds[4]=12,As[166]=Ds[166]=12,Rs[16]=js[16]=4,Rs[154]=js[154]=4,Gs[64]=Us[64]=22,Gs[106]=Us[106]=22,As[2]=Gs[2]=17,Fs[2]=Bs[2]=18,As[168]=Gs[168]=17,Fs[168]=Bs[168]=18,Rs[8]=Fs[8]=9,Ds[8]=As[8]=12,Rs[162]=Fs[162]=9,Ds[162]=As[162]=12,Rs[32]=js[32]=4,Ds[32]=Us[32]=1,Rs[138]=js[138]=4,Ds[138]=Us[138]=1,Bs[128]=js[128]=21,Gs[128]=Us[128]=22,Bs[42]=js[42]=21,Gs[42]=Us[42]=22,Ds[5]=Bs[5]=14,Ds[165]=Bs[165]=14,As[20]=js[20]=6,As[150]=js[150]=6,Rs[80]=Gs[80]=11,Rs[90]=Gs[90]=11,Fs[65]=Us[65]=3,Fs[105]=Us[105]=3,Rs[160]=Gs[160]=11,Ds[160]=Bs[160]=14,Rs[10]=Gs[10]=11,Ds[10]=Bs[10]=14,As[130]=js[130]=6,Fs[130]=Us[130]=3,As[40]=js[40]=6,Fs[40]=Us[40]=3,Ds[101]=Us[101]=1,Ds[69]=Us[69]=1,Bs[149]=js[149]=21,Bs[21]=js[21]=21,As[86]=Gs[86]=17,As[84]=Gs[84]=17,Rs[89]=Fs[89]=9,Rs[81]=Fs[81]=9,Rs[96]=Us[96]=0,Ds[96]=Gs[96]=15,Rs[74]=Us[74]=0,Ds[74]=Gs[74]=15,Rs[24]=As[24]=8,Fs[24]=js[24]=7,Rs[146]=As[146]=8,Fs[146]=js[146]=7,Ds[6]=Gs[6]=15,As[6]=Bs[6]=16,Ds[164]=Gs[164]=15,As[164]=Bs[164]=16,Fs[129]=js[129]=7,Bs[129]=Us[129]=20,Fs[41]=js[41]=7,Bs[41]=Us[41]=20,As[66]=Us[66]=2,Fs[66]=Gs[66]=19,As[104]=Us[104]=2,Fs[104]=Gs[104]=19,Rs[144]=Bs[144]=10,Gs[144]=js[144]=23,Rs[26]=Bs[26]=10,Gs[26]=js[26]=23,Ds[36]=js[36]=5,As[36]=Us[36]=2,Ds[134]=js[134]=5,As[134]=Us[134]=2,Rs[9]=Bs[9]=10,Ds[9]=Fs[9]=13,Rs[161]=Bs[161]=10,Ds[161]=Fs[161]=13,Ds[37]=js[37]=5,Bs[37]=Us[37]=20,Ds[133]=js[133]=5,Bs[133]=Us[133]=20,As[148]=Bs[148]=16,Gs[148]=js[148]=23,As[22]=Bs[22]=16,Gs[22]=js[22]=23,Rs[82]=As[82]=8,Fs[82]=Gs[82]=19,Rs[88]=As[88]=8,Fs[88]=Gs[88]=19,Rs[73]=Us[73]=0,Ds[73]=Fs[73]=13,Rs[97]=Us[97]=0,Ds[97]=Fs[97]=13,Rs[145]=Fs[145]=9,Bs[145]=js[145]=21,Rs[25]=Fs[25]=9,Bs[25]=js[25]=21,Ds[70]=Us[70]=1,As[70]=Gs[70]=17,Ds[100]=Us[100]=1,As[100]=Gs[100]=17,Rs[34]=Fs[34]=9,Ds[34]=As[34]=12,Bs[34]=js[34]=21,Gs[34]=Us[34]=22,Rs[136]=js[136]=4,Ds[136]=Us[136]=1,As[136]=Gs[136]=17,Fs[136]=Bs[136]=18,Rs[35]=js[35]=4,Ds[35]=As[35]=12,Fs[35]=Bs[35]=18,Gs[35]=Us[35]=22,Rs[153]=js[153]=4,Fs[153]=Bs[153]=18,Ds[102]=As[102]=12,Gs[102]=Us[102]=22,Rs[155]=Fs[155]=9,Bs[155]=js[155]=23,Ds[103]=Us[103]=1,As[103]=Gs[103]=17,Rs[152]=js[152]=4,As[152]=Gs[152]=17,Fs[152]=Bs[152]=18,Rs[156]=As[156]=8,Fs[156]=Bs[156]=18,Gs[156]=js[156]=23,Rs[137]=js[137]=4,Ds[137]=Us[137]=1,Fs[137]=Bs[137]=18,Rs[139]=js[139]=4,Ds[139]=Fs[139]=13,Bs[139]=Us[139]=20,Rs[98]=Fs[98]=9,Ds[98]=As[98]=12,Gs[98]=Us[98]=22,Rs[99]=Us[99]=0,Ds[99]=As[99]=12,Fs[99]=Gs[99]=19,Ds[38]=As[38]=12,Bs[38]=js[38]=21,Gs[38]=Us[38]=22,Ds[39]=js[39]=5,As[39]=Bs[39]=16,Gs[39]=Us[39]=22;var qs=[];function zs(t,e,n){return(t-e)/(n-e)}function Vs(t){return-1<t.constructor.toString().indexOf("Array")}function Ys(t,e,n,i,r,o){for(var s=t.cells[n][e],a=s.cval_real,u=e+i,l=n+r,h=[],c=!1;!c;){if(void 0===t.cells[l]||void 0===t.cells[l][u])if(l-=r,u-=i,a=(s=t.cells[l][u]).cval_real,-1===r)if(0===o)if(a&es)h.push([u,l]),i=-1,o=r=0;else{if(!(a&ts)){h.push([u+s.bottomright,l]),o=r=1,c=!(i=0);break}h.push([u+1,l]),i=1,o=r=0}else{if(!(a&es)){if(a&ts){h.push([u+s.bottomright,l]),o=r=1,c=!(i=0);break}h.push([u+s.bottomleft,l]),r=1,c=!(o=i=0);break}h.push([u,l]),i=-1,o=r=0}else if(1===r)if(0===o){if(!(a&$o)){if(a&Qo){h.push([u+s.topleft,l+1]),r=-1,c=!(o=i=0);break}h.push([u+s.topright,l+1]),r=-1,o=1,c=!(i=0);break}h.push([u+1,l+1]),r=0,o=i=1}else o=i=(h.push([u+1,l+1]),r=0,1);else if(-1===i)if(0===o){if(!(a&Qo)){if(a&es){h.push([u,l+s.leftbottom]),i=1,c=!(o=r=0);break}h.push([u,l+s.lefttop]),o=i=1,c=!(r=0);break}h.push([u,l+1]),r=1,o=i=0}else{if(!(a&Qo)){console.log("MarchingSquaresJS-isoBands: wtf");break}h.push([u,l+1]),r=1,o=i=0}else{if(1!==i){console.log("MarchingSquaresJS-isoBands: we came from nowhere!");break}if(0===o){if(!(a&ts)){h.push([u+1,l+s.rightbottom]),i=-1,c=!(o=r=0);break}h.push([u+1,l]),i=0,r=-1,o=1}else{if(!(a&ts)){if(a&$o){h.push([u+1,l+s.righttop]),i=-1,r=0,o=1;break}h.push([u+1,l+s.rightbottom]),i=-1,c=!(o=r=0);break}h.push([u+1,l]),i=0,r=-1,o=1}}else if(a=(s=t.cells[l][u]).cval_real,-1===i)if(0===o)if(void 0!==t.cells[l-1]&&void 0!==t.cells[l-1][u])i=0,r=-1,o=1;else{if(!(a&es)){h.push([u+s.bottomright,l]),o=r=1,c=!(i=0);break}h.push([u,l])}else{if(!(a&Qo)){console.log("MarchingSquaresJS-isoBands: found entry from top at "+u+","+l);break}console.log("MarchingSquaresJS-isoBands: proceeding in x-direction!")}else if(1===i){if(0===o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l+1]&&void 0!==t.cells[l+1][u])r=1,o=i=0;else{if(!(a&$o)){h.push([u+s.topleft,l+1]),r=-1,c=!(o=i=0);break}h.push([u+1,l+1]),r=0,o=i=1}}else if(-1===r){if(1!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][u+1])r=0,o=i=1;else{if(!(a&ts)){h.push([u+1,l+s.righttop]),i=-1,o=1,c=!(r=0);break}h.push([u+1,l]),i=0,r=-1,o=1}}else{if(1!==r){console.log("MarchingSquaresJS-isoBands: where did we came from???");break}if(0!==o){console.log("MarchingSquaresJS-isoBands: wtf");break}if(void 0!==t.cells[l][u-1])i=-1,o=r=0;else{if(!(a&Qo)){h.push([u,l+s.leftbottom]),i=1,c=!(o=r=0);break}h.push([u,l+1]),r=1,o=i=0}}if(l+=r,(u+=i)===e&&l===n)break}return{path:h,i:u,j:l,x:i,y:r,o:o}}function Hs(t){if(0<t.edges.length){var e=t.edges[t.edges.length-1],n=t.cval_real;switch(e){case 0:return n&$o?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 1:return n&ts?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 2:return n&ts?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topleft,1],x:0,y:-1,o:0};case 3:return n&es?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 4:return n&$o?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 5:return n&ts?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 6:return n&ts?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};case 7:return n&es?{p:[t.topright,1],x:0,y:-1,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 8:return n&ts?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.righttop],x:-1,y:0,o:1};case 9:return n&es?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 10:return n&es?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.righttop],x:-1,y:0,o:1};case 11:return n&Qo?{p:[1,t.righttop],x:-1,y:0,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 12:return n&ts?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 13:return n&es?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 14:return n&es?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[1,t.rightbottom],x:-1,y:0,o:0};case 15:return n&Qo?{p:[1,t.rightbottom],x:-1,y:0,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 16:return n&ts?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 17:return n&Qo?{p:[t.bottomright,0],x:0,y:1,o:1}:{p:[0,t.lefttop],x:1,y:0,o:1};case 18:return n&es?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.bottomleft,0],x:0,y:1,o:0};case 19:return n&Qo?{p:[t.bottomleft,0],x:0,y:1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 20:return n&Qo?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.leftbottom],x:1,y:0,o:0};case 21:return n&$o?{p:[0,t.leftbottom],x:1,y:0,o:0}:{p:[t.topright,1],x:0,y:-1,o:1};case 22:return n&Qo?{p:[t.topleft,1],x:0,y:-1,o:0}:{p:[0,t.lefttop],x:1,y:0,o:1};case 23:return n&$o?{p:[0,t.lefttop],x:1,y:0,o:1}:{p:[t.topright,1],x:0,y:-1,o:1};default:console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t)}}return null}function Xs(t,e,n,i){var r,o,s,a,u,l=t.cval;switch(e){case-1:switch(i){case 0:r=Ds[l],s=cs[l],a=ps[l],u=fs[l];break;default:r=Rs[l],s=us[l],a=ls[l],u=hs[l]}break;case 1:switch(i){case 0:r=Bs[l],s=Is[l],a=Ls[l],u=ws[l];break;default:r=Gs[l],s=bs[l],a=xs[l],u=Es[l]}break;default:switch(n){case-1:switch(i){case 0:r=Us[l],s=ns[l],a=is[l],u=rs[l];break;default:r=js[l],s=os[l],a=ss[l],u=as[l]}break;case 1:switch(i){case 0:r=Fs[l],s=ds[l],a=gs[l],u=ys[l];break;default:r=As[l],s=_s[l],a=ms[l],u=vs[l]}}}if(o=t.edges.indexOf(r),void 0===t.edges[o])return null;switch(!function(t,e){delete t.edges[e];for(var n=e+1;n<t.edges.length;n++)t.edges[n-1]=t.edges[n];t.edges.pop()}(t,o),l=t.cval_real,r){case 0:n=l&$o?(e=t.topleft,1):(e=1,t.righttop);break;case 1:n=l&ts?(e=1,t.rightbottom):(e=t.topleft,1);break;case 2:n=l&ts?(e=t.topleft,1):(e=t.bottomright,0);break;case 3:n=l&es?(e=t.bottomleft,0):(e=t.topleft,1);break;case 4:n=l&$o?(e=t.topright,1):(e=1,t.righttop);break;case 5:n=l&ts?(e=1,t.rightbottom):(e=t.topright,1);break;case 6:n=l&ts?(e=t.topright,1):(e=t.bottomright,0);break;case 7:n=l&es?(e=t.bottomleft,0):(e=t.topright,1);break;case 8:n=l&ts?(e=1,t.righttop):(e=t.bottomright,0);break;case 9:n=l&es?(e=t.bottomleft,0):(e=1,t.righttop);break;case 10:n=l&es?(e=1,t.righttop):(e=0,t.leftbottom);break;case 11:n=l&Qo?(e=0,t.lefttop):(e=1,t.righttop);break;case 12:n=l&ts?(e=1,t.rightbottom):(e=t.bottomright,0);break;case 13:n=l&es?(e=t.bottomleft,0):(e=1,t.rightbottom);break;case 14:n=l&es?(e=1,t.rightbottom):(e=0,t.leftbottom);break;case 15:n=l&Qo?(e=0,t.lefttop):(e=1,t.rightbottom);break;case 16:n=l&ts?(e=0,t.leftbottom):(e=t.bottomright,0);break;case 17:n=l&Qo?(e=0,t.lefttop):(e=t.bottomright,0);break;case 18:n=l&es?(e=t.bottomleft,0):(e=0,t.leftbottom);break;case 19:n=l&Qo?(e=0,t.lefttop):(e=t.bottomleft,0);break;case 20:n=l&Qo?(e=0,t.leftbottom):(e=t.topleft,1);break;case 21:n=l&$o?(e=t.topright,1):(e=0,t.leftbottom);break;case 22:n=l&Qo?(e=0,t.lefttop):(e=t.topleft,1);break;case 23:n=l&$o?(e=t.topright,1):(e=0,t.lefttop);break;default:return console.log("MarchingSquaresJS-isoBands: edge index out of range!"),console.log(t),null}return void 0!==e&&void 0!==n&&void 0!==s&&void 0!==a&&void 0!==u||(console.log("MarchingSquaresJS-isoBands: undefined value!"),console.log(t),console.log(e+" "+n+" "+s+" "+a+" "+u)),{p:[e,n],x:s,y:a,o:u}}function Js(t){var n=[],i=[];t.forEach(function(t){var e=qr(kt([t]));i.push(e),n.push({ring:t,area:e})}),i.sort(function(t,e){return e-t});var r=[];return i.forEach(function(t){for(var e=0;e<n.length;e++)if(n[e].area===t){r.push(n[e].ring),n.splice(e,1);break}}),r}function Ws(t){for(var e=t.map(function(t){return{lrCoordinates:t,grouped:!1}}),n=[];!Zs(e);)for(var i=0;i<e.length;i++)if(!e[i].grouped){var r=[];r.push(e[i].lrCoordinates),e[i].grouped=!0;for(var o=kt([e[i].lrCoordinates]),s=i+1;s<e.length;s++){if(!e[s].grouped)Ks(kt([e[s].lrCoordinates]),o)&&(r.push(e[s].lrCoordinates),e[s].grouped=!0)}n.push(r)}return n}function Ks(t,e){for(var n=Ti(t),i=0;i<n.features.length;i++)if(!On(n.features[i],e))return!1;return!0}function Zs(t){for(var e=0;e<t.length;e++)if(!1===t[e].grouped)return!1;return!0}function Qs(t,r,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var o=e.pivot,n=e.mutate;if(!t)throw new Error("geojson is required");if(null==r||isNaN(r))throw new Error("angle is required");return 0===r||(o=o||Oi(t),!1!==n&&void 0!==n||(t=Gn(t)),ne(t,function(t){var e=Cr(o,t)+r,n=Nr(o,t),i=be(jo(o,n,e));t[0]=i[0],t[1]=i[1]})),t}function $s(n,i,t){if(!Qt(t=t||{}))throw new Error("options is invalid");var r=t.origin,e=t.mutate;if(!n)throw new Error("geojson required");if("number"!=typeof i||0===i)throw new Error("invalid factor");var o=Array.isArray(r)||"object"==typeof r;return!0!==e&&(n=Gn(n)),"FeatureCollection"!==n.type||o?ta(n,i,r):(se(n,function(t,e){n.features[e]=ta(t,i,r)}),n)}function ta(t,r,o){var e="Point"===Me(t);return o=function(t,e){null==e&&(e="centroid");if(Array.isArray(e)||"object"==typeof e)return ve(e);var n=t.bbox?t.bbox:me(t),i=n[0],r=n[1],o=n[2],s=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return Ot([i,r]);case"se":case"southeast":case"eastsouth":case"bottomright":return Ot([o,r]);case"nw":case"northwest":case"westnorth":case"topleft":return Ot([i,s]);case"ne":case"northeast":case"eastnorth":case"topright":return Ot([o,s]);case"center":return Ni(t);case void 0:case null:case"centroid":return Oi(t);default:throw new Error("invalid origin")}}(t,o),1===r||e||ne(t,function(t){var e=Nr(o,t),n=Cr(o,t),i=be(jo(o,e*r,n));t[0]=i[0],t[1]=i[1],3===t.length&&(t[2]*=r)}),t}function ea(t){var e=t[0],n=t[1];return[n[0]-e[0],n[1]-e[1]]}function na(t,e){return t[0]*e[1]-e[0]*t[1]}function ia(t,e){return n=e,0!==na(ea(t),ea(n))&&(r=e,c=(i=t)[0],p=ea(i),f=r[0],d=ea(r),g=na(p,d),y=na((s=c,[(o=f)[0]-s[0],o[1]-s[1]]),d),a=c,u=[(l=y/g)*(h=p)[0],l*h[1]],[a[0]+u[0],a[1]+u[1]]);var n,i,r,o,s,a,u,l,h,c,p,f,d,g,y}function ra(t,e,n){var f=[],d=Yt(e,n),g=be(t),y=[];return g.forEach(function(t,e){if(e!==g.length-1){var n=(o=t,s=g[e+1],a=d,u=Math.sqrt((o[0]-s[0])*(o[0]-s[0])+(o[1]-s[1])*(o[1]-s[1])),l=o[0]+a*(s[1]-o[1])/u,h=s[0]+a*(s[1]-o[1])/u,c=o[1]+a*(o[0]-s[0])/u,p=s[1]+a*(o[0]-s[0])/u,[[l,c],[h,p]]);if(f.push(n),0<e){var i=f[e-1],r=ia(n,i);!1!==r&&(i[1]=r,n[0]=r),y.push(i[0]),e===g.length-2&&(y.push(n[0]),y.push(n[1]))}2===g.length&&(y.push(n[0]),y.push(n[1]))}var o,s,a,u,l,h,c,p}),Dt(y,t.properties)}function oa(t,e,n){var i=e[0]-t[0],r=e[1]-t[1],o=n[0]-e[0],s=n[1]-e[1];return Math.sign(i*s-o*r)}function sa(e,t){return t.geometry.coordinates[0].every(function(t){return On(Ot(t),e)})}qs[1]=qs[169]=Ss,qs[4]=qs[166]=Ms,qs[16]=qs[154]=Cs,qs[64]=qs[106]=Ps,qs[168]=qs[2]=Ns,qs[162]=qs[8]=Os,qs[138]=qs[32]=Ts,qs[42]=qs[128]=ks,qs[5]=qs[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},qs[20]=qs[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},qs[80]=qs[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},qs[65]=qs[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},qs[160]=qs[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},qs[130]=qs[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},qs[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},qs[101]=qs[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},qs[149]=qs[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},qs[86]=qs[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},qs[89]=qs[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},qs[96]=qs[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},qs[24]=qs[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},qs[6]=qs[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},qs[129]=qs[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},qs[66]=qs[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},qs[144]=qs[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},qs[36]=qs[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},qs[9]=qs[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},qs[37]=qs[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},qs[148]=qs[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},qs[82]=qs[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},qs[73]=qs[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},qs[145]=qs[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},qs[70]=qs[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},qs[34]=function(t){return[ks(t),Os(t)]},qs[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},qs[136]=function(t){return[Ts(t),Ns(t)]},qs[153]=function(t){return[Cs(t),Ss(t)]},qs[102]=function(t){return[Ms(t),Ps(t)]},qs[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},qs[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},qs[152]=function(t){return[Cs(t),Ns(t)]},qs[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},qs[137]=function(t){return[Ts(t),Ss(t)]},qs[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},qs[98]=function(t){return[Os(t),Ps(t)]},qs[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},qs[38]=function(t){return[Ms(t),ks(t)]},qs[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};function aa(t){this.id=aa.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}aa.buildId=function(t){return t.join(",")},aa.prototype.removeInnerEdge=function(e){this.innerEdges=this.innerEdges.filter(function(t){return t.from.id!==e.from.id})},aa.prototype.removeOuterEdge=function(e){this.outerEdges=this.outerEdges.filter(function(t){return t.to.id!==e.to.id})},aa.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},aa.prototype.sortOuterEdges=function(){var o=this;this.outerEdgesSorted||(this.outerEdges.sort(function(t,e){var n=t.to,i=e.to;if(0<=n.coordinates[0]-o.coordinates[0]&&i.coordinates[0]-o.coordinates[0]<0)return 1;if(n.coordinates[0]-o.coordinates[0]<0&&0<=i.coordinates[0]-o.coordinates[0])return-1;if(n.coordinates[0]-o.coordinates[0]==0&&i.coordinates[0]-o.coordinates[0]==0)return 0<=n.coordinates[1]-o.coordinates[1]||0<=i.coordinates[1]-o.coordinates[1]?n.coordinates[1]-i.coordinates[1]:i.coordinates[1]-n.coordinates[1];var r=oa(o.coordinates,n.coordinates,i.coordinates);return r<0?1:0<r?-1:Math.pow(n.coordinates[0]-o.coordinates[0],2)+Math.pow(n.coordinates[1]-o.coordinates[1],2)-(Math.pow(i.coordinates[0]-o.coordinates[0],2)+Math.pow(i.coordinates[1]-o.coordinates[1],2))}),this.outerEdgesSorted=!0)},aa.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},aa.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},aa.prototype.addInnerEdge=function(t){this.innerEdges.push(t)};function ua(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}ua.prototype.getSymetric=function(){return this.symetric||(this.symetric=new ua(this.to,this.from),this.symetric.symetric=this),this.symetric},ua.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},ua.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},ua.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},ua.prototype.toLineString=function(){return Dt([this.from.coordinates,this.to.coordinates])},ua.prototype.compareTo=function(t){return oa(t.from.coordinates,t.to.coordinates,this.to.coordinates)};function la(){this.edges=[],this.polygon=void 0,this.envelope=void 0}var ha={length:{configurable:!0}};la.prototype.push=function(t){this[this.edges.length]=t,this.edges.push(t),this.polygon=this.envelope=void 0},la.prototype.get=function(t){return this.edges[t]},ha.length.get=function(){return this.edges.length},la.prototype.forEach=function(t){this.edges.forEach(t)},la.prototype.map=function(t){return this.edges.map(t)},la.prototype.some=function(t){return this.edges.some(t)},la.prototype.isValid=function(){return!0},la.prototype.isHole=function(){var i=this,t=this.edges.reduce(function(t,e,n){return e.from.coordinates[1]>i.edges[t].from.coordinates[1]&&(t=n),t},0),e=(0===t?this.length:t)-1,n=(t+1)%this.length,r=oa(this.edges[e].from.coordinates,this.edges[t].from.coordinates,this.edges[n].from.coordinates);return 0===r?this.edges[e].from.coordinates[0]>this.edges[n].from.coordinates[0]:0<r},la.prototype.toMultiPoint=function(){return Gt(this.edges.map(function(t){return t.from.coordinates}))},la.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map(function(t){return t.from.coordinates});return t.push(this.edges[0].from.coordinates),this.polygon=kt([t])},la.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=wi(this.toPolygon())},la.findEdgeRingContaining=function(l,t){var h,c,p=l.getEnvelope();return t.forEach(function(t){var e,n,i,r,o,s,a=t.getEnvelope();if((c&&(h=c.getEnvelope()),n=p,i=(e=a).geometry.coordinates.map(function(t){return t[0]}),r=e.geometry.coordinates.map(function(t){return t[1]}),o=n.geometry.coordinates.map(function(t){return t[0]}),s=n.geometry.coordinates.map(function(t){return t[1]}),Math.max(null,i)!==Math.max(null,o)||Math.max(null,r)!==Math.max(null,s)||Math.min(null,i)!==Math.min(null,o)||Math.min(null,r)!==Math.min(null,s))&&sa(a,p)){var u=l.map(function(t){return t.from.coordinates}).find(function(i){return!t.some(function(t){return e=i,n=t.from.coordinates,e[0]===n[0]&&e[1]===n[1];var e,n})});u&&t.inside(Ot(u))&&(c&&!sa(h,a)||(c=t))}}),c},la.prototype.inside=function(t){return On(t,this.toPolygon())},Object.defineProperties(la.prototype,ha);function ca(){this.edges=[],this.nodes={}}function pa(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(da(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function fa(t,e){return 0<wr(e,Io(t)).features.length}function da(t,e,n){var i=n[0]-t[0],r=n[1]-t[1],o=e[0]-t[0],s=e[1]-t[1];return 0==i*s-r*o&&(Math.abs(o)>=Math.abs(s)?0<o?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:0<s?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1])}function ga(t,e){return!(t[0]>e[0])&&(!(t[2]<e[2])&&(!(t[1]>e[1])&&!(t[3]<e[3])))}function ya(t,e){return t[0]===e[0]&&t[1]===e[1]}function _a(t,e){for(var n=!1,i=!1,r=t.coordinates.length,o=0;o<r&&!n&&!i;){for(var s=0;s<e.coordinates.length-1;s++){var a=!0;0!==s&&s!==e.coordinates.length-2||(a=!1),ba(e.coordinates[s],e.coordinates[s+1],t.coordinates[o],a)?n=!0:i=!0}o++}return n&&i}function ma(t,e){return 0<wr(t,Io(e)).features.length}function va(t,e){for(var n=!1,i=!1,r=t.coordinates[0].length,o=0;o<r&&n&&i;)On(Ot(t.coordinates[0][o]),e)?n=!0:i=!0,o++;return i&&i}function ba(t,e,n,i){var r=n[0]-t[0],o=n[1]-t[1],s=e[0]-t[0],a=e[1]-t[1];return 0==r*a-o*s&&(i?Math.abs(s)>=Math.abs(a)?0<s?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:0<a?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]:Math.abs(s)>=Math.abs(a)?0<s?t[0]<n[0]&&n[0]<e[0]:e[0]<n[0]&&n[0]<t[0]:0<a?t[1]<n[1]&&n[1]<e[1]:e[1]<n[1]&&n[1]<t[1])}ca.fromGeoJson=function(t){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(t);var r=new ca;return ce(t,function(t){Ie(t,"LineString","Graph::fromGeoJson"),ie(t,function(t,e){if(t){var n=r.getNode(t),i=r.getNode(e);r.addEdge(n,i)}return e})}),r},ca.prototype.getNode=function(t){var e=aa.buildId(t),n=this.nodes[e];return n=n||(this.nodes[e]=new aa(t))},ca.prototype.addEdge=function(t,e){var n=new ua(t,e),i=n.getSymetric();this.edges.push(n),this.edges.push(i)},ca.prototype.deleteDangles=function(){var e=this;Object.keys(this.nodes).map(function(t){return e.nodes[t]}).forEach(function(t){return e._removeIfDangle(t)})},ca.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map(function(t){return t.to});this.removeNode(t),n.forEach(function(t){return e._removeIfDangle(t)})}},ca.prototype.deleteCutEdges=function(){var e=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(function(t){t.label===t.symetric.label&&(e.removeEdge(t.symetric),e.removeEdge(t))})},ca.prototype._computeNextCWEdges=function(n){var e=this;void 0===n?Object.keys(this.nodes).forEach(function(t){return e._computeNextCWEdges(e.nodes[t])}):n.getOuterEdges().forEach(function(t,e){n.getOuterEdge((0===e?n.getOuterEdges().length:e)-1).symetric.next=t})},ca.prototype._computeNextCCWEdges=function(t,e){for(var n,i,r=t.getOuterEdges(),o=r.length-1;0<=o;--o){var s=r[o],a=s.symetric,u=void 0,l=void 0;s.label===e&&(u=s),a.label===e&&(l=a),u&&l&&(l&&(i=l),u&&(i&&(i.next=u,i=void 0),n=n||u))}i&&(i.next=n)},ca.prototype._findLabeledEdgeRings=function(){var n=[],i=0;return this.edges.forEach(function(t){if(!(0<=t.label)){n.push(t);for(var e=t;e.label=i,e=e.next,!t.isEqual(e););i++}}),n},ca.prototype.getEdgeRings=function(){var n=this;this._computeNextCWEdges(),this.edges.forEach(function(t){t.label=void 0}),this._findLabeledEdgeRings().forEach(function(e){n._findIntersectionNodes(e).forEach(function(t){n._computeNextCCWEdges(t,e.label)})});var e=[];return this.edges.forEach(function(t){t.ring||e.push(n._findEdgeRing(t))}),e},ca.prototype._findIntersectionNodes=function(n){for(var t=[],i=n,e=function(){var e=0;i.from.getOuterEdges().forEach(function(t){t.label===n.label&&++e}),1<e&&t.push(i.from),i=i.next};e(),!n.isEqual(i););return t},ca.prototype._findEdgeRing=function(t){for(var e=t,n=new la;n.push(e),e.ring=n,e=e.next,!t.isEqual(e););return n},ca.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach(function(t){return e.removeEdge(t)}),t.innerEdges.forEach(function(t){return e.removeEdge(t)}),delete this.nodes[t.id]},ca.prototype.removeEdge=function(e){this.edges=this.edges.filter(function(t){return!t.isEqual(e)}),e.deleteEdge()};function xa(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:Ma}var Ea=tn(function(t,e){function n(t){var e=[];for(var n in t)e.push(n);return e}(t.exports="function"==typeof Object.keys?Object.keys:n).shim=n}),Ia=(Ea.shim,tn(function(t,e){var n="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function i(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function r(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=n?i:r).supported=i,e.unsupported=r})),La=(Ia.supported,Ia.unsupported,tn(function(t){var a=Array.prototype.slice,u=t.exports=function(t,e,n){return n=n||{},t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?n.strict?t===e:t==e:function(t,e,n){var i,r;if(l(t)||l(e))return!1;if(t.prototype!==e.prototype)return!1;if(Ia(t))return!!Ia(e)&&(t=a.call(t),e=a.call(e),u(t,e,n));if(h(t)){if(!h(e))return!1;if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}try{var o=Ea(t),s=Ea(e)}catch(t){return!1}if(o.length!=s.length)return!1;for(o.sort(),s.sort(),i=o.length-1;0<=i;i--)if(o[i]!=s[i])return!1;for(i=o.length-1;0<=i;i--)if(r=o[i],!u(t[r],e[r],n))return!1;return typeof t==typeof e}(t,e,n))};function l(t){return null==t}function h(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(0<t.length&&"number"!=typeof t[0]))}}));function wa(e){return e.coordinates.map(function(t){return{type:e.type.replace("Multi",""),coordinates:t}})}function Sa(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function Ma(t,e){return La(t,e,{strict:!0})}xa.prototype.compare=function(t,e){if(t.type!==e.type||!Sa(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,i=wa(t),r=wa(e);return i.every(function(e){return this.some(function(t){return n.compare(e,t)})},r)}}return!1},xa.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},xa.prototype.compareLine=function(t,e,n,i){if(!Sa(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!i||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var s=this.compareCoord(r[n],o[n]);return this.direction||s?this.comparePath(r,o):!!this.compareCoord(r[n],o[o.length-(1+n)])&&this.comparePath(r.slice().reverse(),o)}},xa.prototype.fixStartIndex=function(t,e){for(var n,i=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){i=r;break}return 0<=i&&(n=[].concat(t.slice(i,t.length),t.slice(1,i+1))),n},xa.prototype.comparePath=function(t,e){var n=this;return t.every(function(t,e){return n.compareCoord(t,this[e])},e)},xa.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),i=e.coordinates.slice(1,e.coordinates.length),r=this;return n.every(function(e){return this.some(function(t){return r.compareLine(e,t,1,!0)})},i)}return!1},xa.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},xa.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},xa.prototype.removePseudo=function(t){return t};var Ca=xa;function Pa(t,n){if(!t)throw new Error("feature1 is required");if(!n)throw new Error("feature2 is required");var e=Me(t);if(e!==Me(n))throw new Error("features must be of the same type");if("Point"===e)throw new Error("Point geometry not supported");if(new Ca({precision:6}).compare(t,n))return!1;var i=0;switch(e){case"MultiPoint":var r=ue(t),o=ue(n);r.forEach(function(e){o.forEach(function(t){e[0]===t[0]&&e[1]===t[1]&&i++})});break;case"LineString":case"MultiLineString":fe(t,function(e){fe(n,function(t){Bo(e,t).features.length&&i++})});break;case"Polygon":case"MultiPolygon":fe(t,function(e){fe(n,function(t){wr(e,t).features.length&&i++})})}return 0<i}var Na=tn(function(t){function e(t,e,n,i){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,i)}e.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var r=0;r<this._datasetLength;r++)if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);if(o.length<this.minPts)this.noise.push(r);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(r,s),this._expandCluster(s,o)}}return this.clusters},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(1!==this._visited[i]){this._visited[i]=1;var r=this._regionQuery(i);r.length>=this.minPts&&(e=this._mergeArrays(e,r))}1!==this._assigned[i]&&this._addToCluster(i,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++){this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n)}return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,i=0;i<n;i++){var r=e[i];t.indexOf(r)<0&&t.push(r)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)}),Oa=tn(function(t){function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,i=0;i<this.k;i++)this.centroids[i]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var o=0;o<this.k;o++){for(var s=new Array(h),a=0,u=0;u<h;u++)s[u]=0;for(var l=0;l<n;l++){var h=this.dataset[l].length;if(o===this.assignments[l]){for(u=0;u<h;u++)s[u]+=this.dataset[l][u];a++}}if(0<a){for(u=0;u<h;u++)s[u]/=a;this.centroids[o]=s}else this.centroids[o]=this.randomCentroid(),r=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){for(var t,e,n=this.dataset.length-1;e=Math.round(Math.random()*n),t=this.dataset[e],0<=this.centroids.indexOf(t););return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,i=0;i<n;i++)(t=this.argmin(this.dataset[i],this.centroids,this.distance))!=this.assignments[i]&&(this.assignments[i]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var i,r=Number.MAX_VALUE,o=0,s=e.length,a=0;a<s;a++)(i=n(t,e[a]))<r&&(r=i,o=a);return o},e.prototype.distance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;){var r=t[i]-e[i];n+=r*r}return Math.sqrt(n)},t.exports&&(t.exports=e)}),Ta=tn(function(t){function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,i=n;i--;){var r=this._priorities[i];"desc"===this._sorting?r<e&&(n=i):e<r&&(n=i)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;){if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var i=0;i<t.length;i++)this.insert(t[i],e[i])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)}),ka=tn(function(t){if(t.exports)var l=Ta;function e(t,e,n,i){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,i)}e.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var r=0,o=this.dataset.length;r<o;r++)if(1!==this._processed[r]){this._processed[r]=1,this.clusters.push([r]);var s=this.clusters.length-1;this._orderedList.push(r);var a=new l(null,null,"asc"),u=this._regionQuery(r);void 0!==this._distanceToCore(r)&&(this._updateQueue(r,u,a),this._expandCluster(s,a))}return this.clusters},e.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var i=this._orderedList[e],r=this._reachability[i];t.push([i,r])}return t},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._updateQueue=function(i,t,r){var o=this;this._coreDistance=this._distanceToCore(i),t.forEach(function(t){if(void 0===o._processed[t]){var e=o.distance(o.dataset[i],o.dataset[t]),n=Math.max(o._coreDistance,e);void 0===o._reachability[t]?(o._reachability[t]=n,r.insert(t,n)):n<o._reachability[t]&&(o._reachability[t]=n,r.remove(t),r.insert(t,n))}})},e.prototype._expandCluster=function(t,e){for(var n=e.getElements(),i=0,r=n.length;i<r;i++){var o=n[i];if(void 0===this._processed[o]){var s=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,s,e),this._expandCluster(t,e))}}},e.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++){if(this._regionQuery(t,n).length>=this.minPts)return n}},e.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],i=0,r=this.dataset.length;i<r;i++)this.distance(this.dataset[t],this.dataset[i])<e&&n.push(i);return n},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)}),Ra=tn(function(t){t.exports&&(t.exports={DBSCAN:Na,KMEANS:Oa,OPTICS:ka,PriorityQueue:Ta})});Ra.DBSCAN,Ra.KMEANS,Ra.OPTICS,Ra.PriorityQueue;function Da(t,e,n){var i=Math.abs(t-e);return n?i:i*i}var Aa=function(t,e,n){for(var i=t.length,r=0,o=0;o<i;o++){var s=(t[o]||0)-(e[o]||0);r+=s*s}return n?Math.sqrt(r):r},Fa=Aa,Ba=Aa,Ga=function(t,e){for(var n={},i=[],r=e<<2,o=t.length,s=0<t[0].length;i.length<e&&0<r--;){var a=t[Math.floor(Math.random()*o)],u=s?a.join("_"):""+a;n[u]||(n[u]=!0,i.push(a))}if(i.length<e)throw new Error("Error initializating clusters");return i},Ua=function(t,e){var n=t[0].length?Fa:Da,i=[],r=t.length,o=0<t[0].length,s=t[Math.floor(Math.random()*r)];o&&s.join("_");for(i.push(s);i.length<e;){for(var a=[],u=i.length,l=0,h=[],c=0;c<r;c++){for(var p=1/0,f=0;f<u;f++){var d=n(t[c],i[f]);d<=p&&(p=d)}a[c]=p}for(var g=0;g<r;g++)l+=a[g];for(var y=0;y<r;y++)h[y]={i:y,v:t[y],pr:a[y]/l,cs:0};h.sort(function(t,e){return t.pr-e.pr}),h[0].cs=h[0].pr;for(var _=1;_<r;_++)h[_].cs=h[_-1].cs+h[_].pr;for(var m=Math.random(),v=0;v<r-1&&h[v++].cs<m;);i.push(h[v-1].v)}return i};function ja(t,e,n){n=n||[];for(var i=0;i<t;i++)n[i]=e;return n}var qa=function(t,e,n,i){var r=[],o=[],s=[],a=[],u=!1,l=i||1e4,h=t.length,c=t[0].length,p=0<c,f=[];if(n)r="kmrand"==n?Ga(t,e):"kmpp"==n?Ua(t,e):n;else for(var d={};r.length<e;){var g=Math.floor(Math.random()*h);d[g]||(d[g]=!0,r.push(t[g]))}do{ja(e,0,f);for(var y=0;y<h;y++){for(var _=1/0,m=0,v=0;v<e;v++){(a=p?Ba(t[y],r[v]):Math.abs(t[y]-r[v]))<=_&&(_=a,m=v)}f[s[y]=m]++}for(var b=[],x=(o=[],0);x<e;x++)b[x]=p?ja(c,0,b[x]):0,o[x]=r[x];if(p){for(var E=0;E<e;E++)r[E]=[];for(var I=0;I<h;I++)for(var L=b[s[I]],w=t[I],S=0;S<c;S++)L[S]+=w[S];u=!0;for(var M=0;M<e;M++){for(var C=r[M],P=b[M],N=o[M],O=f[M],T=0;T<c;T++)C[T]=P[T]/O||0;if(u)for(var k=0;k<c;k++)if(N[k]!=C[k]){u=!1;break}}}else{for(var R=0;R<h;R++){b[s[R]]+=t[R]}for(var D=0;D<e;D++)r[D]=b[D]/f[D]||0;u=!0;for(var A=0;A<e;A++)if(o[A]!=r[A]){u=!1;break}}u=u||--l<=0}while(!u);return{it:1e4-l,k:e,idxs:s,centroids:r}};function za(t,e){if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("Invalid GeoJSON object for "+e)}function Va(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}var Ya={search:function(t,e,n,i){t.cleanDirty();var r=(i=i||{}).heuristic||Ya.heuristics.manhattan,o=i.closest||!1,s=new Ja(function(t){return t.f}),a=e;for(e.h=r(e,n),s.push(e);0<s.size();){var u=s.pop();if(u===n)return Va(u);u.closed=!0;for(var l=t.neighbors(u),h=0,c=l.length;h<c;++h){var p=l[h];if(!p.closed&&!p.isWall()){var f=u.g+p.getCost(u),d=p.visited;(!d||f<p.g)&&(p.visited=!0,p.parent=u,p.h=p.h||r(p,n),p.g=f,p.f=p.g+p.h,t.markDirty(p),o&&(p.h<a.h||p.h===a.h&&p.g<a.g)&&(a=p),d?s.rescoreElement(p):s.push(p))}}}return o?Va(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(i+r)+(n-2)*Math.min(i,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function Ha(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var i=0,r=t[n];i<r.length;i++){var o=new Xa(n,i,r[i]);this.grid[n][i]=o,this.nodes.push(o)}}this.init()}function Xa(t,e,n){this.x=t,this.y=e,this.weight=n}function Ja(t){this.content=[],this.scoreFunction=t}function Wa(t,e){for(var n=0;n<e.features.length;n++)if(On(t,e.features[n]))return!0;return!1}Ha.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)Ya.cleanNode(this.nodes[t])},Ha.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)Ya.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},Ha.prototype.markDirty=function(t){this.dirtyNodes.push(t)},Ha.prototype.neighbors=function(t){var e=[],n=t.x,i=t.y,r=this.grid;return r[n-1]&&r[n-1][i]&&e.push(r[n-1][i]),r[n+1]&&r[n+1][i]&&e.push(r[n+1][i]),r[n]&&r[n][i-1]&&e.push(r[n][i-1]),r[n]&&r[n][i+1]&&e.push(r[n][i+1]),this.diagonal&&(r[n-1]&&r[n-1][i-1]&&e.push(r[n-1][i-1]),r[n+1]&&r[n+1][i-1]&&e.push(r[n+1][i-1]),r[n-1]&&r[n-1][i+1]&&e.push(r[n-1][i+1]),r[n+1]&&r[n+1][i+1]&&e.push(r[n+1][i+1])),e},Ha.prototype.toString=function(){for(var t,e,n,i,r=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],n=0,i=(e=o[s]).length;n<i;n++)t.push(e[n].weight);r.push(t.join(" "))}return r.join("\n")},Xa.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},Xa.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},Xa.prototype.isWall=function(){return 0===this.weight},Ja.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return 0<this.content.length&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];0<t;){var n=(t+1>>1)-1,i=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[n]=e,this.content[t]=i,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],i=this.scoreFunction(n);;){var r,o=t+1<<1,s=o-1,a=null;if(s<e){var u=this.content[s];(r=this.scoreFunction(u))<i&&(a=s)}if(o<e){var l=this.content[o];this.scoreFunction(l)<(null===a?i:r)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}};function Ka(t){return function(){return t}}function Za(t){return t[0]}function Qa(t){return t[1]}function $a(){this._=null}function tu(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function eu(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function nu(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function iu(t){for(;t.L;)t=t.L;return t}function ru(t,e,n,i){var r=[null,null],o=Su.push(r)-1;return r.left=t,r.right=e,n&&su(r,t,e,n),i&&su(r,e,t,i),Lu[t.index].halfedges.push(o),Lu[e.index].halfedges.push(o),r}function ou(t,e,n){var i=[e,n];return i.left=t,i}function su(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function au(t,e,n,i,r){var o,s=t[0],a=t[1],u=s[0],l=s[1],h=0,c=1,p=a[0]-u,f=a[1]-l;if(o=e-u,p||!(0<o)){if(o/=p,p<0){if(o<h)return;o<c&&(c=o)}else if(0<p){if(c<o)return;h<o&&(h=o)}if(o=i-u,p||!(o<0)){if(o/=p,p<0){if(c<o)return;h<o&&(h=o)}else if(0<p){if(o<h)return;o<c&&(c=o)}if(o=n-l,f||!(0<o)){if(o/=f,f<0){if(o<h)return;o<c&&(c=o)}else if(0<f){if(c<o)return;h<o&&(h=o)}if(o=r-l,f||!(o<0)){if(o/=f,f<0){if(c<o)return;h<o&&(h=o)}else if(0<f){if(o<h)return;o<c&&(c=o)}return(0<h||c<1)&&(0<h&&(t[0]=[u+h*p,l+h*f]),c<1&&(t[1]=[u+c*p,l+c*f])),!0}}}}}function uu(t,e,n,i,r){var o=t[1];if(o)return!0;var s,a,u=t[0],l=t.left,h=t.right,c=l[0],p=l[1],f=h[0],d=h[1],g=(c+f)/2,y=(p+d)/2;if(d===p){if(g<e||i<=g)return;if(f<c){if(u){if(u[1]>=r)return}else u=[g,n];o=[g,r]}else{if(u){if(u[1]<n)return}else u=[g,r];o=[g,n]}}else if(a=y-(s=(c-f)/(d-p))*g,s<-1||1<s)if(f<c){if(u){if(u[1]>=r)return}else u=[(n-a)/s,n];o=[(r-a)/s,r]}else{if(u){if(u[1]<n)return}else u=[(r-a)/s,r];o=[(n-a)/s,n]}else if(p<d){if(u){if(u[0]>=i)return}else u=[e,s*e+a];o=[i,s*i+a]}else{if(u){if(u[0]<e)return}else u=[i,s*i+a];o=[e,s*e+a]}return t[0]=u,t[1]=o,!0}function lu(t,e){return e[+(e.left!==t.site)]}$a.prototype={constructor:$a,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else n=this._?(t=iu(this._),e.P=null,(e.N=t).P=t.L=e,t):(e.P=e.N=null,this._=e,null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(eu(this,n),n=(t=n).U),n.C=!1,i.C=!0,nu(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(nu(this,n),n=(t=n).U),n.C=!1,i.C=!0,eu(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,s=t.R;if(n=o?s?iu(s):o:s,r?r.L===t?r.L=n:r.R=n:this._=n,o&&s?(i=n.C,n.C=t.C,((n.L=o).U=n)!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,(n.R=s).U=n):(n.U=r,t=(r=n).R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,eu(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,nu(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,eu(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,nu(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,eu(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,nu(this,r),t=this._;break}e.C=!0,r=(t=r).U}while(!t.C);t&&(t.C=!1)}}};var hu,cu=[];function pu(){tu(this),this.x=this.y=this.arc=this.site=this.cy=null}function fu(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var s=r[0],a=r[1],u=i[0]-s,l=i[1]-a,h=o[0]-s,c=o[1]-a,p=2*(u*c-l*h);if(!(-Cu<=p)){var f=u*u+l*l,d=h*h+c*c,g=(c*f-l*d)/p,y=(u*d-h*f)/p,_=cu.pop()||new pu;_.arc=t,_.site=r,_.x=g+s,_.y=(_.cy=y+a)+Math.sqrt(g*g+y*y),t.circle=_;for(var m=null,v=wu._;v;)if(_.y<v.y||_.y===v.y&&_.x<=v.x){if(!v.L){m=v.P;break}v=v.L}else{if(!v.R){m=v;break}v=v.R}wu.insert(m,_),m||(hu=_)}}}}function du(t){var e=t.circle;e&&(e.P||(hu=e.N),wu.remove(e),cu.push(e),tu(e),t.circle=null)}var gu=[];function yu(){tu(this),this.edge=this.site=this.circle=null}function _u(t){var e=gu.pop()||new yu;return e.site=t,e}function mu(t){du(t),Iu.remove(t),gu.push(t),tu(t)}function vu(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,s=t.N,a=[t];mu(t);for(var u=o;u.circle&&Math.abs(n-u.circle.x)<Mu&&Math.abs(i-u.circle.cy)<Mu;)o=u.P,a.unshift(u),mu(u),u=o;a.unshift(u),du(u);for(var l=s;l.circle&&Math.abs(n-l.circle.x)<Mu&&Math.abs(i-l.circle.cy)<Mu;)s=l.N,a.push(l),mu(l),l=s;a.push(l),du(l);var h,c=a.length;for(h=1;h<c;++h)l=a[h],u=a[h-1],su(l.edge,u.site,l.site,r);u=a[0],(l=a[c-1]).edge=ru(u.site,l.site,null,r),fu(u),fu(l)}function bu(t){for(var e,n,i,r,o,s=t[0],a=t[1],u=Iu._;u;)if(i=xu(u,a)-s,Mu<i)u=u.L;else{if(r=s-Eu(u,a),!(Mu<r)){-Mu<i?(e=u.P,n=u):-Mu<r?n=(e=u).N:e=n=u;break}if(!u.R){e=u;break}u=u.R}Lu[(o=t).index]={site:o,halfedges:[]};var l=_u(t);if(Iu.insert(e,l),e||n){if(e===n)return du(e),n=_u(e.site),Iu.insert(l,n),l.edge=n.edge=ru(e.site,l.site),fu(e),void fu(n);if(n){du(e),du(n);var h=e.site,c=h[0],p=h[1],f=t[0]-c,d=t[1]-p,g=n.site,y=g[0]-c,_=g[1]-p,m=2*(f*_-d*y),v=f*f+d*d,b=y*y+_*_,x=[(_*v-d*b)/m+c,(f*b-y*v)/m+p];su(n.edge,h,g,x),l.edge=ru(h,t,null,x),n.edge=ru(t,g,null,x),fu(e),fu(n)}else l.edge=ru(e.site,l.site)}}function xu(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],u=n[1],l=u-e;if(!l)return a;var h=a-i,c=1/o-1/l,p=h/l;return c?(-p+Math.sqrt(p*p-2*c*(h*h/(-2*l)-u+l/2+r-o/2)))/c+i:(i+a)/2}function Eu(t,e){var n=t.N;if(n)return xu(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var Iu,Lu,wu,Su,Mu=1e-6,Cu=1e-12;function Pu(t,e){return e[1]-t[1]||e[0]-t[0]}function Nu(t,e){var n,i,r,o=t.sort(Pu).pop();for(Su=[],Lu=new Array(t.length),Iu=new $a,wu=new $a;;)if(r=hu,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(bu(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;vu(r.arc)}if(!function(){for(var t,e,n,i,r=0,o=Lu.length;r<o;++r)if((t=Lu[r])&&(i=(e=t.halfedges).length)){var s=new Array(i),a=new Array(i);for(n=0;n<i;++n)s[n]=n,a[n]=(u=t,l=Su[e[n]],p=c=void 0,h=u.site,c=l.left,p=l.right,h===p&&(p=c,c=h),p?Math.atan2(p[1]-c[1],p[0]-c[0]):(p=h===c?(c=l[1],l[0]):(c=l[0],l[1]),Math.atan2(c[0]-p[0],p[1]-c[1])));for(s.sort(function(t,e){return a[e]-a[t]}),n=0;n<i;++n)a[n]=e[s[n]];for(n=0;n<i;++n)e[n]=a[n]}var u,l,h,c,p}(),e){var s=+e[0][0],a=+e[0][1],u=+e[1][0],l=+e[1][1];!function(t,e,n,i){for(var r,o=Su.length;o--;)uu(r=Su[o],t,e,n,i)&&au(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>Mu||Math.abs(r[0][1]-r[1][1])>Mu)||delete Su[o]}(s,a,u,l),function(t,e,n,i){var r,o,s,a,u,l,h,c,p,f,d,g,y,_,m=Lu.length,v=!0;for(r=0;r<m;++r)if(o=Lu[r]){for(s=o.site,a=(u=o.halfedges).length;a--;)Su[u[a]]||u.splice(a,1);for(a=0,l=u.length;a<l;)y=o,d=(f=(_=Su[u[a]])[+(_.left===y.site)])[0],g=f[1],c=(h=lu(o,Su[u[++a%l]]))[0],p=h[1],(Math.abs(d-c)>Mu||Math.abs(g-p)>Mu)&&(u.splice(a,0,Su.push(ou(s,f,Math.abs(d-t)<Mu&&Mu<i-g?[t,Math.abs(c-t)<Mu?p:i]:Math.abs(g-i)<Mu&&Mu<n-d?[Math.abs(p-i)<Mu?c:n,i]:Math.abs(d-n)<Mu&&Mu<g-e?[n,Math.abs(c-n)<Mu?p:e]:Math.abs(g-e)<Mu&&Mu<d-t?[Math.abs(p-e)<Mu?c:t,e]:null))-1),++l);l&&(v=!1)}if(v){var b,x,E,I=1/0;for(r=0,v=null;r<m;++r)(o=Lu[r])&&(E=(b=(s=o.site)[0]-t)*b+(x=s[1]-e)*x)<I&&(I=E,v=o);if(v){var L=[t,e],w=[t,i],S=[n,i],M=[n,e];v.halfedges.push(Su.push(ou(s=v.site,L,w))-1,Su.push(ou(s,w,S))-1,Su.push(ou(s,S,M))-1,Su.push(ou(s,M,L))-1)}}for(r=0;r<m;++r)(o=Lu[r])&&(o.halfedges.length||delete Lu[r])}(s,a,u,l)}this.edges=Su,this.cells=Lu,Iu=wu=Su=Lu=null}Nu.prototype={constructor:Nu,polygons:function(){var n=this.edges;return this.cells.map(function(e){var t=e.halfedges.map(function(t){return lu(e,n[t])});return t.data=e.site.data,t})},triangles:function(){var p=[],f=this.edges;return this.cells.forEach(function(t,e){if(i=(n=t.halfedges).length)for(var n,i,r,o,s,a,u=t.site,l=-1,h=f[n[i-1]],c=h.left===u?h.right:h.left;++l<i;)r=c,c=(h=f[n[l]]).left===u?h.right:h.left,r&&c&&e<r.index&&e<c.index&&(s=r,a=c,((o=u)[0]-a[0])*(s[1]-o[1])-(o[0]-s[0])*(a[1]-o[1])<0)&&p.push([u.data,r.data,c.data])}),p},links:function(){return this.edges.filter(function(t){return t.right}).map(function(t){return{source:t.left.data,target:t.right.data}})},find:function(s,a,t){for(var e,u,l=this,h=l._found||0,n=l.cells.length;!(u=l.cells[h]);)if(++h>=n)return null;for(var i=s-u.site[0],r=a-u.site[1],c=i*i+r*r;u=l.cells[e=h],h=null,u.halfedges.forEach(function(t){var e=l.edges[t],n=e.left;if(n!==u.site&&n||(n=e.right)){var i=s-n[0],r=a-n[1],o=i*i+r*r;o<c&&(c=o,h=n.index)}}),null!==h;);return l._found=e,null==t||c<=t*t?u.site:null}};function Ou(t){return(t=t.slice()).push(t[0]),kt([t])}function Tu(t,e,n,i){var r=(i=i||{}).steps||64,o=i.units||"kilometers",s=i.angle||0,a=i.pivot||t,u=i.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!Qt(i))throw new Error("options must be an object");if(!Zt(r))throw new Error("steps must be a number");if(!Zt(s))throw new Error("angle must be a number");var l=ve(t);if("degrees"===o)var h=Jt(s);else e=jo(t,e,90,{units:o}),n=jo(t,n,0,{units:o}),e=ve(e)[0]-l[0],n=ve(n)[1]-l[1];for(var c=[],p=0;p<r;p+=1){var f=-360*p/r,d=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(ku(f),2)),g=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(ku(f),2));if(f<-90&&-270<=f&&(d=-d),f<-180&&-360<=f&&(g=-g),"degrees"===o){var y=d*Math.cos(h)+g*Math.sin(h),_=g*Math.cos(h)-d*Math.sin(h);d=y,g=_}c.push([d+l[0],g+l[1]])}return c.push(c[0]),"degrees"===o?kt([c],u):Qs(kt([c],u),s,{pivot:a})}function ku(t){var e=t*Math.PI/180;return Math.tan(e)}function Ru(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.properties,r=e.weight;if(!t)throw new Error("geojson is required");var o=0,s=0,a=0;return le(t,function(t,e,n){var i=n[r];if(!Zt(i=null==i?1:i))throw new Error("weight value must be a number for feature index "+e);0<(i=Number(i))&&ne(t,function(t){o+=t[0]*i,s+=t[1]*i,a+=i})}),Ot([o/a,s/a],n)}function Du(t,e){return{x:t[0]-e[0],y:t[1]-e[1]}}function Au(t){if(Qt(t)&&(t=t.bbox),t&&!Array.isArray(t))throw new Error("bbox is invalid");return t?(e=t,[Math.random()*(e[2]-e[0])+e[0],Math.random()*(e[3]-e[1])+e[1]]):[360*ju(),180*ju()];var e}function Fu(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.bbox;null==t&&(t=1);for(var i=[],r=0;r<t;r++)i.push(Ot(Au(n)));return Ft(i)}function Bu(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_radial_length;null==t&&(t=1),Zt(i)||(i=10),Zt(r)||(r=10);for(var o=[],s=0;s<t;s++){var a=[],u=Array.apply(null,new Array(i+1)).map(Math.random);u.forEach(l),u.forEach(h),a[a.length-1]=a[0],a=a.map(Uu(Au(n))),o.push(kt([a]))}function l(t,e,n){n[e]=0<e?t+n[e-1]:t}function h(t){t=2*t*Math.PI/u[u.length-1];var e=Math.random();a.push([e*r*Math.sin(t),e*r*Math.cos(t)])}return Ft(o)}function Gu(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.bbox,i=e.num_vertices,r=e.max_length,o=e.max_rotation;null==t&&(t=1),(!Zt(i)||i<2)&&(i=10),Zt(r)||(r=1e-4),Zt(o)||(o=Math.PI/8);for(var s=[],a=0;a<t;a++){for(var u=[Au(n)],l=0;l<i-1;l++){var h=(0===l?2*Math.random()*Math.PI:Math.tan((u[l][1]-u[l-1][1])/(u[l][0]-u[l-1][0])))+(Math.random()-.5)*o*2,c=Math.random()*r;u.push([u[l][0]+c*Math.cos(h),u[l][1]+c*Math.sin(h)])}s.push(Dt(u))}return Ft(s)}function Uu(e){return function(t){return[t[0]+e[0],t[1]+e[1]]}}function ju(){return Math.random()-.5}var qu=Object.freeze({randomPosition:Au,randomPoint:Fu,randomPolygon:Bu,randomLineString:Gu});function zu(t,e){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("filter is required");var n=[];return se(t,function(t){Xu(t.properties,e)&&n.push(t)}),Ft(n)}function Vu(t,e,n){if(!t)throw new Error("geojson is required");if("FeatureCollection"!==t.type)throw new Error("geojson must be a FeatureCollection");if(null==e)throw new Error("property is required");for(var i=Hu(t,e),r=Object.keys(i),o=0;o<r.length;o++){for(var s=r[o],a=i[s],u=[],l=0;l<a.length;l++)u.push(t.features[a[l]]);n(Ft(u),s,o)}}function Yu(t,e,i,r){var o=r;return Vu(t,e,function(t,e,n){o=0===n&&void 0===r?t:i(o,t,e,n)}),o}function Hu(t,r){var o={};return se(t,function(t,e){var n=t.properties||{};if(n.hasOwnProperty(r)){var i=n[r];o.hasOwnProperty(i)?o[i].push(e):o[i]=[e]}}),o}function Xu(t,e){if(void 0===t)return!1;var n=typeof e;if("number"==n||"string"==n)return t.hasOwnProperty(e);if(Array.isArray(e)){for(var i=0;i<e.length;i++)if(!Xu(t,e[i]))return!1;return!0}return Ju(t,e)}function Ju(t,e){for(var n=Object.keys(e),i=0;i<n.length;i++){var r=n[i];if(t[r]!==e[r])return!1}return!0}function Wu(t,e){if(!e)return{};if(!e.length)return{};for(var n={},i=0;i<e.length;i++){var r=e[i];t.hasOwnProperty(r)&&(n[r]=t[r])}return n}var Ku=Object.freeze({getCluster:zu,clusterEach:Vu,clusterReduce:Yu,createBins:Hu,applyFilter:Xu,propertiesContainsFilter:Ju,filterProperties:Wu});"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t,e,n){if(null==this)throw new TypeError(this+" is not an object");var i=Object(this),r=Math.max(Math.min(i.length,9007199254740991),0)||0,o=1 in arguments&&parseInt(Number(e),10)||0;o=o<0?Math.max(r+o,0):Math.min(o,r);var s=2 in arguments&&void 0!==n?parseInt(Number(n),10)||0:r;for(s=s<0?Math.max(r+n,0):Math.min(s,r);o<s;)i[o]=t,++o;return i},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};function Zu(){}Zu.prototype.interfaces_=function(){return[]},Zu.prototype.getClass=function(){return Zu},Zu.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};function Qu(){}function $u(){}var tl={MAX_VALUE:{configurable:!0}};$u.isNaN=function(t){return Number.isNaN(t)},$u.doubleToLongBits=function(t){return t},$u.longBitsToDouble=function(t){return t},$u.isInfinite=function(t){return!Number.isFinite(t)},tl.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties($u,tl);function el(){}function nl(){}function il(){}function rl(){}function ol(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=ol.NULL_ORDINATE;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.z=t.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=ol.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])}var sl={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};ol.prototype.setOrdinate=function(t,e){switch(t){case ol.X:this.x=e;break;case ol.Y:this.y=e;break;case ol.Z:this.z=e;break;default:throw new Qu("Invalid ordinate index: "+t)}},ol.prototype.equals2D=function(t,e){if(1===arguments.length){return this.x===t.x&&this.y===t.y}if(2===arguments.length){var n=t,i=e;return!!Zu.equalsWithTolerance(this.x,n.x,i)&&!!Zu.equalsWithTolerance(this.y,n.y,i)}},ol.prototype.getOrdinate=function(t){switch(t){case ol.X:return this.x;case ol.Y:return this.y;case ol.Z:return this.z}throw new Qu("Invalid ordinate index: "+t)},ol.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||$u.isNaN(this.z))&&$u.isNaN(t.z)},ol.prototype.equals=function(t){return t instanceof ol&&this.equals2D(t)},ol.prototype.equalInZ=function(t,e){return Zu.equalsWithTolerance(this.z,t.z,e)},ol.prototype.compareTo=function(t){return this.x<t.x?-1:this.x>t.x?1:this.y<t.y?-1:this.y>t.y?1:0},ol.prototype.clone=function(){},ol.prototype.copy=function(){return new ol(this)},ol.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},ol.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},ol.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},ol.prototype.hashCode=function(){var t=17;return t=37*(t=37*t+ol.hashCode(this.x))+ol.hashCode(this.y)},ol.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},ol.prototype.interfaces_=function(){return[el,nl,rl]},ol.prototype.getClass=function(){return ol},ol.hashCode=function(t){if(1===arguments.length){var e=$u.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},sl.DimensionalComparator.get=function(){return al},sl.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},sl.NULL_ORDINATE.get=function(){return $u.NaN},sl.X.get=function(){return 0},sl.Y.get=function(){return 1},sl.Z.get=function(){return 2},Object.defineProperties(ol,sl);var al=function(t){if(this._dimensionsToTest=2,0!==arguments.length&&1===arguments.length){var e=t;if(2!==e&&3!==e)throw new Qu("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};al.prototype.compare=function(t,e){var n=t,i=e,r=al.compare(n.x,i.x);if(0!==r)return r;var o=al.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:al.compare(n.z,i.z)},al.prototype.interfaces_=function(){return[il]},al.prototype.getClass=function(){return al},al.compare=function(t,e){return t<e?-1:e<t?1:$u.isNaN(t)?$u.isNaN(e)?0:-1:$u.isNaN(e)?1:0};function ul(){}ul.prototype.create=function(){},ul.prototype.interfaces_=function(){return[]},ul.prototype.getClass=function(){return ul};function ll(){}var hl={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};ll.prototype.interfaces_=function(){return[]},ll.prototype.getClass=function(){return ll},ll.toLocationSymbol=function(t){switch(t){case ll.EXTERIOR:return"e";case ll.BOUNDARY:return"b";case ll.INTERIOR:return"i";case ll.NONE:return"-"}throw new Qu("Unknown location value: "+t)},hl.INTERIOR.get=function(){return 0},hl.BOUNDARY.get=function(){return 1},hl.EXTERIOR.get=function(){return 2},hl.NONE.get=function(){return-1},Object.defineProperties(ll,hl);function cl(t,e){return t.interfaces_&&-1<t.interfaces_().indexOf(e)}function pl(){}var fl={LOG_10:{configurable:!0}};pl.prototype.interfaces_=function(){return[]},pl.prototype.getClass=function(){return pl},pl.log10=function(t){var e=Math.log(t);return $u.isInfinite(e)?e:$u.isNaN(e)?e:e/pl.LOG_10},pl.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},pl.clamp=function(t,e,n){if("number"==typeof n&&"number"==typeof t&&"number"==typeof e){return t<e?e:n<t?n:t}if(Number.isInteger(n)&&Number.isInteger(t)&&Number.isInteger(e)){return t<e?e:n<t?n:t}},pl.wrap=function(t,e){return t<0?e- -t%e:t%e},pl.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return n<t&&(n=t),n<e&&(n=e),n}if(4===arguments.length){var i=arguments[1],r=arguments[2],o=arguments[3],s=arguments[0];return s<i&&(s=i),s<r&&(s=r),s<o&&(s=o),s}},pl.average=function(t,e){return(t+e)/2},fl.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(pl,fl);function dl(t){this.str=t}dl.prototype.append=function(t){this.str+=t},dl.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},dl.prototype.toString=function(){return this.str};function gl(t){this.value=t}gl.prototype.intValue=function(){return this.value},gl.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},gl.isNaN=function(t){return Number.isNaN(t)};function yl(){}yl.isWhitespace=function(t){return t<=32&&0<=t||127===t},yl.toUpperCase=function(t){return t.toUpperCase()};function _l(){if(this._hi=0,(this._lo=0)===arguments.length)this.init(0);else if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof _l){var e=arguments[0];this.init(e)}else if("string"==typeof arguments[0]){_l.call(this,_l.parse(arguments[0]))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n,i)}}var ml={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};_l.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},_l.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=_l.magnitude(n._hi),r=_l.TEN.pow(i);(n=n.divide(r)).gt(_l.TEN)?(n=n.divide(_l.TEN),i+=1):n.lt(_l.ONE)&&(n=n.multiply(_l.TEN),--i);for(var o=i+1,s=new dl,a=_l.MAX_PRINT_DIGITS-1,u=0;u<=a;u++){t&&u===o&&s.append(".");var l=Math.trunc(n._hi);if(l<0)break;var h=!1,c=0;c=9<l?(h=!0,"9"):"0"+l,s.append(c),n=n.subtract(_l.valueOf(l)).multiply(_l.TEN),h&&n.selfAdd(_l.TEN);var p=!0,f=_l.magnitude(n._hi);if(f<0&&Math.abs(f)>=a-u&&(p=!1),!p)break}return e[0]=i,s.toString()},_l.prototype.sqr=function(){return this.multiply(this)},_l.prototype.doubleValue=function(){return this._hi+this._lo},_l.prototype.subtract=function(t){if(t instanceof _l){var e=t;return this.add(e.negate())}if("number"==typeof t){var n=t;return this.add(-n)}},_l.prototype.equals=function(t){if(1===arguments.length){return this._hi===t._hi&&this._lo===t._lo}},_l.prototype.isZero=function(){return 0===this._hi&&0===this._lo},_l.prototype.selfSubtract=function(t){if(t instanceof _l){var e=t;return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}if("number"==typeof t){var n=t;return this.isNaN()?this:this.selfAdd(-n,0)}},_l.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},_l.prototype.min=function(t){return this.le(t)?this:t},_l.prototype.selfDivide=function(t,e){if(1===arguments.length){if(t instanceof _l){return this.selfDivide(t._hi,t._lo)}if("number"==typeof t){var n=t;return this.selfDivide(n,0)}}else if(2===arguments.length){var i,r,o,s,a=e,u=null,l=null,h=null,c=null;return o=this._hi/t,c=(u=(h=_l.SPLIT*o)-(u=h-o))*(l=(c=_l.SPLIT*t)-(l=c-t))-(s=o*t)+u*(r=t-l)+(i=o-u)*l+i*r,c=o+(h=(this._hi-s-c+this._lo-o*a)/t),this._hi=c,this._lo=o-c+h,this}},_l.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},_l.prototype.divide=function(t){if(t instanceof _l){var e,n,i,r,o=null,s=null,a=null,u=null;return e=(i=this._hi/t._hi)-(o=(a=_l.SPLIT*i)-(o=a-i)),u=o*(s=(u=_l.SPLIT*t._hi)-(s=u-t._hi))-(r=i*t._hi)+o*(n=t._hi-s)+e*s+e*n,a=(this._hi-r-u+this._lo-i*t._lo)/t._hi,new _l(u=i+a,i-u+a)}if("number"==typeof t){var l=t;return $u.isNaN(l)?_l.createNaN():_l.copy(this).selfDivide(l,0)}},_l.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},_l.prototype.pow=function(t){if(0===t)return _l.valueOf(1);var e=new _l(this),n=_l.valueOf(1),i=Math.abs(t);if(1<i)for(;0<i;)i%2==1&&n.selfMultiply(e),0<(i/=2)&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},_l.prototype.ceil=function(){if(this.isNaN())return _l.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new _l(t,e)},_l.prototype.compareTo=function(t){return this._hi<t._hi?-1:this._hi>t._hi?1:this._lo<t._lo?-1:this._lo>t._lo?1:0},_l.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},_l.prototype.setValue=function(t){if(t instanceof _l){var e=t;return this.init(e),this}if("number"==typeof t){var n=t;return this.init(n),this}},_l.prototype.max=function(t){return this.ge(t)?this:t},_l.prototype.sqrt=function(){if(this.isZero())return _l.valueOf(0);if(this.isNegative())return _l.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=_l.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},_l.prototype.selfAdd=function(t,e){if(1===arguments.length){if(t instanceof _l){return this.selfAdd(t._hi,t._lo)}if("number"==typeof t){var n,i,r,o,s,a=null;return a=(r=this._hi+t)-(o=r-this._hi),i=(s=(a=t-o+(this._hi-a))+this._lo)+(r-(n=r+s)),this._hi=n+i,this._lo=i+(n-this._hi),this}}else if(2===arguments.length){var u,l,h,c,p=null,f=null,d=null;h=this._hi+t,l=this._lo+e,f=h-(d=h-this._hi),p=l-(c=l-this._lo);var g=(u=h+(d=(f=t-d+(this._hi-f))+l))+(d=(p=e-c+(this._lo-p))+(d+(h-u))),y=d+(u-g);return this._hi=g,this._lo=y,this}},_l.prototype.selfMultiply=function(t,e){if(1===arguments.length){if(t instanceof _l){return this.selfMultiply(t._hi,t._lo)}if("number"==typeof t){var n=t;return this.selfMultiply(n,0)}}else if(2===arguments.length){var i,r,o=e,s=null,a=null,u=null,l=null;s=(u=_l.SPLIT*this._hi)-this._hi,l=_l.SPLIT*t,s=u-s,i=this._hi-s,a=l-t;var h=(u=this._hi*t)+(l=s*(a=l-a)-u+s*(r=t-a)+i*a+i*r+(this._hi*o+this._lo*t)),c=l+(s=u-h);return this._hi=h,this._lo=c,this}},_l.prototype.selfSqr=function(){return this.selfMultiply(this)},_l.prototype.floor=function(){if(this.isNaN())return _l.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new _l(t,e)},_l.prototype.negate=function(){return this.isNaN()?this:new _l(-this._hi,-this._lo)},_l.prototype.clone=function(){},_l.prototype.multiply=function(t){if(t instanceof _l){var e=t;return e.isNaN()?_l.createNaN():_l.copy(this).selfMultiply(e)}if("number"==typeof t){var n=t;return $u.isNaN(n)?_l.createNaN():_l.copy(this).selfMultiply(n,0)}},_l.prototype.isNaN=function(){return $u.isNaN(this._hi)},_l.prototype.intValue=function(){return Math.trunc(this._hi)},_l.prototype.toString=function(){var t=_l.magnitude(this._hi);return-3<=t&&t<=20?this.toStandardNotation():this.toSciNotation()},_l.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+_l.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+_l.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},_l.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=_l.SPLIT*n)-(r=s-n)),o=(a=_l.SPLIT*this._hi)-this._hi;var u=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new _l(u,n-u+s)},_l.prototype.toSciNotation=function(){if(this.isZero())return _l.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=_l.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";1<n.length&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},_l.prototype.abs=function(){return this.isNaN()?_l.NaN:this.isNegative()?this.negate():new _l(this)},_l.prototype.isPositive=function(){return(0<this._hi||0===this._hi)&&0<this._lo},_l.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},_l.prototype.add=function(t){if(t instanceof _l){var e=t;return _l.copy(this).selfAdd(e)}if("number"==typeof t){var n=t;return _l.copy(this).selfAdd(n)}},_l.prototype.init=function(t,e){if(1===arguments.length){if("number"==typeof t){var n=t;this._hi=n,this._lo=0}else if(t instanceof _l){var i=t;this._hi=i._hi,this._lo=i._lo}}else if(2===arguments.length){var r=t,o=e;this._hi=r,this._lo=o}},_l.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},_l.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},_l.prototype.trunc=function(){return this.isNaN()?_l.NaN:this.isPositive()?this.floor():this.ceil()},_l.prototype.signum=function(){return 0<this._hi?1:this._hi<0?-1:0<this._lo?1:this._lo<0?-1:0},_l.prototype.interfaces_=function(){return[rl,el,nl]},_l.prototype.getClass=function(){return _l},_l.sqr=function(t){return _l.valueOf(t).selfMultiply(t)},_l.valueOf=function(t){return"string"==typeof t?_l.parse(t):"number"==typeof t?new _l(t):void 0},_l.sqrt=function(t){return _l.valueOf(t).sqrt()},_l.parse=function(e){for(var t=0,n=e.length;yl.isWhitespace(e.charAt(t));)t++;var i=!1;if(t<n){var r=e.charAt(t);"-"!==r&&"+"!==r||(t++,"-"===r&&(i=!0))}for(var o=new _l,s=0,a=0,u=0;!(n<=t);){var l=e.charAt(t);if(t++,yl.isDigit(l)){var h=l-"0";o.selfMultiply(_l.TEN),o.selfAdd(h),s++}else{if("."!==l){if("e"!==l&&"E"!==l)throw new Error("Unexpected character '"+l+"' at position "+t+" in string "+e);var c=e.substring(t);try{u=gl.parseInt(c)}catch(t){throw t instanceof Error?new Error("Invalid exponent "+c+" in string "+e):t}break}a=s}}var p=o,f=s-a-u;if(0==f)p=o;else if(0<f){var d=_l.TEN.pow(f);p=o.divide(d)}else if(f<0){var g=_l.TEN.pow(-f);p=o.multiply(g)}return i?p.negate():p},_l.createNaN=function(){return new _l($u.NaN,$u.NaN)},_l.copy=function(t){return new _l(t)},_l.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},_l.stringOfChar=function(t,e){for(var n=new dl,i=0;i<e;i++)n.append(t);return n.toString()},ml.PI.get=function(){return new _l(3.141592653589793,12246467991473532e-32)},ml.TWO_PI.get=function(){return new _l(6.283185307179586,24492935982947064e-32)},ml.PI_2.get=function(){return new _l(1.5707963267948966,6123233995736766e-32)},ml.E.get=function(){return new _l(2.718281828459045,14456468917292502e-32)},ml.NaN.get=function(){return new _l($u.NaN,$u.NaN)},ml.EPS.get=function(){return 123259516440783e-46},ml.SPLIT.get=function(){return 134217729},ml.MAX_PRINT_DIGITS.get=function(){return 32},ml.TEN.get=function(){return _l.valueOf(10)},ml.ONE.get=function(){return _l.valueOf(1)},ml.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},ml.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(_l,ml);function vl(){}var bl={DP_SAFE_EPSILON:{configurable:!0}};vl.prototype.interfaces_=function(){return[]},vl.prototype.getClass=function(){return vl},vl.orientationIndex=function(t,e,n){var i=vl.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=_l.valueOf(e.x).selfAdd(-t.x),o=_l.valueOf(e.y).selfAdd(-t.y),s=_l.valueOf(n.x).selfAdd(-e.x),a=_l.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},vl.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},vl.intersection=function(t,e,n,i){var r=_l.valueOf(i.y).selfSubtract(n.y).selfMultiply(_l.valueOf(e.x).selfSubtract(t.x)),o=_l.valueOf(i.x).selfSubtract(n.x).selfMultiply(_l.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=_l.valueOf(i.x).selfSubtract(n.x).selfMultiply(_l.valueOf(t.y).selfSubtract(n.y)),u=_l.valueOf(i.y).selfSubtract(n.y).selfMultiply(_l.valueOf(t.x).selfSubtract(n.x)),l=a.subtract(u).selfDivide(s).doubleValue(),h=_l.valueOf(t.x).selfAdd(_l.valueOf(e.x).selfSubtract(t.x).selfMultiply(l)).doubleValue(),c=_l.valueOf(e.x).selfSubtract(t.x).selfMultiply(_l.valueOf(t.y).selfSubtract(n.y)),p=_l.valueOf(e.y).selfSubtract(t.y).selfMultiply(_l.valueOf(t.x).selfSubtract(n.x)),f=c.subtract(p).selfDivide(s).doubleValue(),d=_l.valueOf(n.y).selfAdd(_l.valueOf(i.y).selfSubtract(n.y).selfMultiply(f)).doubleValue();return new ol(h,d)},vl.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(0<r){if(o<=0)return vl.signum(s);i=r+o}else{if(!(r<0))return vl.signum(s);if(0<=o)return vl.signum(s);i=-r-o}var a=vl.DP_SAFE_EPSILON*i;return a<=s||a<=-s?vl.signum(s):2},vl.signum=function(t){return 0<t?1:t<0?-1:0},bl.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(vl,bl);function xl(){}var El={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};El.X.get=function(){return 0},El.Y.get=function(){return 1},El.Z.get=function(){return 2},El.M.get=function(){return 3},xl.prototype.setOrdinate=function(){},xl.prototype.size=function(){},xl.prototype.getOrdinate=function(){},xl.prototype.getCoordinate=function(){},xl.prototype.getCoordinateCopy=function(){},xl.prototype.getDimension=function(){},xl.prototype.getX=function(){},xl.prototype.clone=function(){},xl.prototype.expandEnvelope=function(){},xl.prototype.copy=function(){},xl.prototype.getY=function(){},xl.prototype.toCoordinateArray=function(){},xl.prototype.interfaces_=function(){return[nl]},xl.prototype.getClass=function(){return xl},Object.defineProperties(xl,El);function Il(){}var Ll,wl=((Ll=Il)&&(Sl.__proto__=Ll),((Sl.prototype=Object.create(Ll&&Ll.prototype)).constructor=Sl).prototype.interfaces_=function(){return[]},Sl.prototype.getClass=function(){return Sl},Sl);function Sl(){Ll.call(this,"Projective point not representable on the Cartesian plane.")}function Ml(){}Ml.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},Ml.getProperty=function(t){return{"line.separator":"\n"}[t]};function Cl(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof Cl&&arguments[1]instanceof Cl){var i=arguments[0],r=arguments[1];this.x=i.y*r.w-r.y*i.w,this.y=r.x*i.w-i.x*r.w,this.w=i.x*r.y-r.x*i.y}else if(arguments[0]instanceof ol&&arguments[1]instanceof ol){var o=arguments[0],s=arguments[1];this.x=o.y-s.y,this.y=s.x-o.x,this.w=o.x*s.y-s.x*o.y}}else if(3===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2];this.x=a,this.y=u,this.w=l}else if(4===arguments.length){var h=arguments[0],c=arguments[1],p=arguments[2],f=arguments[3],d=h.y-c.y,g=c.x-h.x,y=h.x*c.y-c.x*h.y,_=p.y-f.y,m=f.x-p.x,v=p.x*f.y-f.x*p.y;this.x=g*v-m*y,this.y=_*y-d*v,this.w=d*m-_*g}}Cl.prototype.getY=function(){var t=this.y/this.w;if($u.isNaN(t)||$u.isInfinite(t))throw new wl;return t},Cl.prototype.getX=function(){var t=this.x/this.w;if($u.isNaN(t)||$u.isInfinite(t))throw new wl;return t},Cl.prototype.getCoordinate=function(){var t=new ol;return t.x=this.getX(),t.y=this.getY(),t},Cl.prototype.interfaces_=function(){return[]},Cl.prototype.getClass=function(){return Cl},Cl.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,u=i.x-n.x,l=n.x*i.y-i.x*n.y,h=r*u-a*o,c=(o*l-u*s)/h,p=(a*s-r*l)/h;if($u.isNaN(c)||$u.isInfinite(c)||$u.isNaN(p)||$u.isInfinite(p))throw new wl;return new ol(c,p)};function Pl(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof ol){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Pl){var e=arguments[0];this.init(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.init(r,o,s,a)}}var Nl={serialVersionUID:{configurable:!0}};Pl.prototype.getArea=function(){return this.getWidth()*this.getHeight()},Pl.prototype.equals=function(t){if(!(t instanceof Pl))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},Pl.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Pl;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Pl(e,i,n,r)},Pl.prototype.isNull=function(){return this._maxx<this._minx},Pl.prototype.getMaxX=function(){return this._maxx},Pl.prototype.covers=function(t,e){if(1===arguments.length){if(t instanceof ol){return this.covers(t.x,t.y)}if(t instanceof Pl){var n=t;return!this.isNull()&&!n.isNull()&&(n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy)}}else if(2===arguments.length){var i=t,r=e;return!this.isNull()&&(i>=this._minx&&i<=this._maxx&&r>=this._miny&&r<=this._maxy)}},Pl.prototype.intersects=function(t,e){if(1===arguments.length){if(t instanceof Pl){var n=t;return!this.isNull()&&!n.isNull()&&!(n._minx>this._maxx||n._maxx<this._minx||n._miny>this._maxy||n._maxy<this._miny)}if(t instanceof ol){return this.intersects(t.x,t.y)}}else if(2===arguments.length){var i=t,r=e;return!this.isNull()&&!(i>this._maxx||i<this._minx||r>this._maxy||r<this._miny)}},Pl.prototype.getMinY=function(){return this._miny},Pl.prototype.getMinX=function(){return this._minx},Pl.prototype.expandToInclude=function(t,e){if(1===arguments.length){if(t instanceof ol){this.expandToInclude(t.x,t.y)}else if(t instanceof Pl){var n=t;if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(2===arguments.length){var i=t,r=e;this.isNull()?(this._minx=i,this._maxx=i,this._miny=r,this._maxy=r):(i<this._minx&&(this._minx=i),i>this._maxx&&(this._maxx=i),r<this._miny&&(this._miny=r),r>this._maxy&&(this._maxy=r))}},Pl.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},Pl.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},Pl.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},Pl.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},Pl.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},Pl.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},Pl.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},Pl.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return e<t?t:e},Pl.prototype.expandBy=function(t,e){if(1===arguments.length){this.expandBy(t,t)}else if(2===arguments.length){var n=t,i=e;if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=i,this._maxy+=i,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},Pl.prototype.contains=function(t,e){if(1===arguments.length){if(t instanceof Pl){var n=t;return this.covers(n)}if(t instanceof ol){var i=t;return this.covers(i)}}else if(2===arguments.length){var r=t,o=e;return this.covers(r,o)}},Pl.prototype.centre=function(){return this.isNull()?null:new ol((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},Pl.prototype.init=function(t,e,n,i){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(t instanceof ol){this.init(t.x,t.x,t.y,t.y)}else if(t instanceof Pl){var r=t;this._minx=r._minx,this._maxx=r._maxx,this._miny=r._miny,this._maxy=r._maxy}}else if(2===arguments.length){this.init(t.x,e.x,t.y,e.y)}else if(4===arguments.length){var o=t,s=e,a=n,u=i;o<s?(this._minx=o,this._maxx=s):(this._minx=s,this._maxx=o),a<u?(this._miny=a,this._maxy=u):(this._miny=u,this._maxy=a)}},Pl.prototype.getMaxY=function(){return this._maxy},Pl.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},Pl.prototype.hashCode=function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+ol.hashCode(this._minx))+ol.hashCode(this._maxx))+ol.hashCode(this._miny))+ol.hashCode(this._maxy)},Pl.prototype.interfaces_=function(){return[el,rl]},Pl.prototype.getClass=function(){return Pl},Pl.intersects=function(t,e,n,i){if(3===arguments.length){return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var r=t,o=e,s=n,a=i,u=Math.min(s.x,a.x),l=Math.max(s.x,a.x),h=Math.min(r.x,o.x),c=Math.max(r.x,o.x);return!(l<h)&&(!(c<u)&&(u=Math.min(s.y,a.y),l=Math.max(s.y,a.y),h=Math.min(r.y,o.y),c=Math.max(r.y,o.y),!(l<h)&&!(c<u)))}},Nl.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(Pl,Nl);function Ol(t){this.geometryFactory=t||new Bc}var Tl={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/};Ol.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=Tl.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Tl.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],Dl[n]&&(e=Dl[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Ol.prototype.write=function(t){return this.extractGeometry(t)},Ol.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!Rl[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+Rl[e].apply(this,[t])+")"};function kl(t){this.parser=new Ol(t)}var Rl={coordinate:function(t){return t.x+" "+t.y},point:function(t){return Rl.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Rl.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Rl.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(Rl.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Rl.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+Rl.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+Rl.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+Rl.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},Dl={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Tl.spaces);return this.geometryFactory.createPoint(new ol(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPoint();for(var n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Tl.trimParens,"$1"),i.push(Dl.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Tl.spaces),i.push(new ol(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Tl.spaces),i.push(new ol(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiLineString();for(var n=t.trim().split(Tl.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Tl.trimParens,"$1"),i.push(Dl.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){var e,n,i;if(void 0===t)return this.geometryFactory.createPolygon();for(var r,o=t.trim().split(Tl.parenComma),s=[],a=0,u=o.length;a<u;++a)e=o[a].replace(Tl.trimParens,"$1"),n=Dl.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){var e;if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var n=t.trim().split(Tl.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Tl.trimParens,"$1"),i.push(Dl.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}};kl.prototype.write=function(t){return this.parser.write(t)},kl.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var Al,Fl=((Al=Error)&&(Bl.__proto__=Al),(Bl.prototype=Object.create(Al&&Al.prototype)).constructor=Bl);function Bl(t){Al.call(this,t),this.name="RuntimeException",this.message=t,this.stack=(new Al).stack}var Gl,Ul=((Gl=Fl)&&(jl.__proto__=Gl),((jl.prototype=Object.create(Gl&&Gl.prototype)).constructor=jl).prototype.interfaces_=function(){return[]},jl.prototype.getClass=function(){return jl},jl);function jl(){if(Gl.call(this),0===arguments.length)Gl.call(this);else if(1===arguments.length){var t=arguments[0];Gl.call(this,t)}}function ql(){}ql.prototype.interfaces_=function(){return[]},ql.prototype.getClass=function(){return ql},ql.shouldNeverReachHere=function(t){if(0===arguments.length)ql.shouldNeverReachHere(null);else if(1===arguments.length){throw new Ul("Should never reach here"+(null!==t?": "+t:""))}},ql.isTrue=function(t,e){var n;if(1===arguments.length)ql.isTrue(t,null);else if(2===arguments.length&&(n=e,!t))throw null===n?new Ul:new Ul(n)},ql.equals=function(t,e,n){var i,r,o;if(2===arguments.length)ql.equals(i=t,r=e,null);else if(3===arguments.length&&(i=t,o=n,!(r=e).equals(i)))throw new Ul("Expected "+i+" but encountered "+r+(null!==o?": "+o:""))};function zl(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new ol,this._intPt[1]=new ol,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}var Vl={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};zl.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},zl.prototype.getTopologySummary=function(){var t=new dl;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},zl.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},zl.prototype.getIntersectionNum=function(){return this._result},zl.prototype.computeIntLineIndex=function(t){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var e=t,n=this.getEdgeDistance(e,0);this.getEdgeDistance(e,1)<n?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}},zl.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},zl.prototype.setPrecisionModel=function(t){this._precisionModel=t},zl.prototype.isInteriorIntersection=function(t){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var e=t,n=0;n<this._result;n++)if(!this._intPt[n].equals2D(this._inputLines[e][0])&&!this._intPt[n].equals2D(this._inputLines[e][1]))return!0;return!1}},zl.prototype.getIntersection=function(t){return this._intPt[t]},zl.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},zl.prototype.hasIntersection=function(){return this._result!==zl.NO_INTERSECTION},zl.prototype.getEdgeDistance=function(t,e){return zl.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},zl.prototype.isCollinear=function(){return this._result===zl.COLLINEAR_INTERSECTION},zl.prototype.toString=function(){return kl.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+kl.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},zl.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},zl.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},zl.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},zl.prototype.interfaces_=function(){return[]},zl.prototype.getClass=function(){return zl},zl.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=r<i?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=r<i?s:a)||t.equals(e)||(o=Math.max(s,a))}return ql.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},zl.nonRobustComputeEdgeDistance=function(t,e){var n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);return ql.isTrue(!(0===r&&!t.equals(e)),"Invalid distance calculation"),r},Vl.DONT_INTERSECT.get=function(){return 0},Vl.DO_INTERSECT.get=function(){return 1},Vl.COLLINEAR.get=function(){return 2},Vl.NO_INTERSECTION.get=function(){return 0},Vl.POINT_INTERSECTION.get=function(){return 1},Vl.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(zl,Vl);var Yl,Hl=((Yl=zl)&&(Xl.__proto__=Yl),((Xl.prototype=Object.create(Yl&&Yl.prototype)).constructor=Xl).prototype.isInSegmentEnvelopes=function(t){var e=new Pl(this._inputLines[0][0],this._inputLines[0][1]),n=new Pl(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},Xl.prototype.computeIntersection=function(t,e,n){if(3!==arguments.length)return Yl.prototype.computeIntersection.apply(this,arguments);var i=t,r=e,o=n;if(this._isProper=!1,Pl.intersects(r,o,i)&&0===Kl.orientationIndex(r,o,i)&&0===Kl.orientationIndex(o,r,i))return this._isProper=!0,(i.equals(r)||i.equals(o))&&(this._isProper=!1),this._result=Yl.POINT_INTERSECTION,null;this._result=Yl.NO_INTERSECTION},Xl.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},Xl.prototype.safeHCoordinateIntersection=function(e,n,i,r){var o=null;try{o=Cl.intersection(e,n,i,r)}catch(t){if(!(t instanceof wl))throw t;o=Xl.nearestEndpoint(e,n,i,r)}return o},Xl.prototype.intersection=function(t,e,n,i){var r=this.intersectionWithNormalization(t,e,n,i);return this.isInSegmentEnvelopes(r)||(r=new ol(Xl.nearestEndpoint(t,e,n,i))),null!==this._precisionModel&&this._precisionModel.makePrecise(r),r},Xl.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},Xl.prototype.checkDD=function(t,e,n,i,r){var o=vl.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);Ml.out.println("DD in env = "+s+"  --------------------- "+o),1e-4<r.distance(o)&&Ml.out.println("Distance = "+r.distance(o))},Xl.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new ol(t),o=new ol(e),s=new ol(n),a=new ol(i),u=new ol;this.normalizeToEnvCentre(r,o,s,a,u);var l=this.safeHCoordinateIntersection(r,o,s,a);return l.x+=u.x,l.y+=u.y,l},Xl.prototype.computeCollinearIntersection=function(t,e,n,i){var r=Pl.intersects(t,e,n),o=Pl.intersects(t,e,i),s=Pl.intersects(n,i,t),a=Pl.intersects(n,i,e);return r&&o?(this._intPt[0]=n,this._intPt[1]=i,Yl.COLLINEAR_INTERSECTION):s&&a?(this._intPt[0]=t,this._intPt[1]=e,Yl.COLLINEAR_INTERSECTION):r&&s?(this._intPt[0]=n,this._intPt[1]=t,!n.equals(t)||o||a?Yl.COLLINEAR_INTERSECTION:Yl.POINT_INTERSECTION):r&&a?(this._intPt[0]=n,this._intPt[1]=e,!n.equals(e)||o||s?Yl.COLLINEAR_INTERSECTION:Yl.POINT_INTERSECTION):o&&s?(this._intPt[0]=i,this._intPt[1]=t,!i.equals(t)||r||a?Yl.COLLINEAR_INTERSECTION:Yl.POINT_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||r||s?Yl.COLLINEAR_INTERSECTION:Yl.POINT_INTERSECTION):Yl.NO_INTERSECTION},Xl.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,u=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,h=n.y<i.y?n.y:i.y,c=n.x>i.x?n.x:i.x,p=n.y>i.y?n.y:i.y,f=((l<o?o:l)+(a<c?a:c))/2,d=((h<s?s:h)+(u<p?u:p))/2;r.x=f,r.y=d,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},Xl.prototype.computeIntersect=function(t,e,n,i){if(this._isProper=!1,!Pl.intersects(t,e,n,i))return Yl.NO_INTERSECTION;var r=Kl.orientationIndex(t,e,n),o=Kl.orientationIndex(t,e,i);if(0<r&&0<o||r<0&&o<0)return Yl.NO_INTERSECTION;var s=Kl.orientationIndex(n,i,t),a=Kl.orientationIndex(n,i,e);return 0<s&&0<a||s<0&&a<0?Yl.NO_INTERSECTION:0===r&&0===o&&0===s&&0===a?this.computeCollinearIntersection(t,e,n,i):(0===r||0===o||0===s||0===a?(this._isProper=!1,t.equals2D(n)||t.equals2D(i)?this._intPt[0]=t:e.equals2D(n)||e.equals2D(i)?this._intPt[0]=e:0===r?this._intPt[0]=new ol(n):0===o?this._intPt[0]=new ol(i):0===s?this._intPt[0]=new ol(t):0===a&&(this._intPt[0]=new ol(e))):(this._isProper=!0,this._intPt[0]=this.intersection(t,e,n,i)),Yl.POINT_INTERSECTION)},Xl.prototype.interfaces_=function(){return[]},Xl.prototype.getClass=function(){return Xl},Xl.nearestEndpoint=function(t,e,n,i){var r=t,o=Kl.distancePointLine(t,n,i),s=Kl.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=Kl.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=Kl.distancePointLine(i,t,e))<o&&(o=s,r=i),r},Xl);function Xl(){Yl.apply(this,arguments)}function Jl(){}Jl.prototype.interfaces_=function(){return[]},Jl.prototype.getClass=function(){return Jl},Jl.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return Jl.signOfDet2x2(i,r,o,s)},Jl.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:0<e?0<n?-r:r:0<n?r:-r;if(0===e||0===n)return 0<i?0<t?r:-r:0<t?-r:r;if(0<e?0<i?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):i=e<=-i?(r=-r,n=-n,-i):(o=t,t=-n,n=o,o=e,e=-i,o):0<i?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):i=i<=e?(t=-t,e=-e,n=-n,-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,o),0<t){if(!(0<n))return r;if(!(t<=n))return r}else{if(0<n)return-r;if(!(n<=t))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(e<i)return r;if((n-=s*t)+n<t){if(e<i+i)return r}else{if(i+i<e)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(i<e)return-r;if((t-=s*n)+t<n){if(i<e+e)return-r}else{if(e+e<i)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};function Wl(t){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=t;this._p=e}Wl.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return i<n&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,u=Jl.signOfDet2x2(r,o,s,a);if(0===u)return this._isPointOnSegment=!0,null;a<o&&(u=-u),0<u&&this._crossingCount++}},Wl.prototype.isPointInPolygon=function(){return this.getLocation()!==ll.EXTERIOR},Wl.prototype.getLocation=function(){return this._isPointOnSegment?ll.BOUNDARY:this._crossingCount%2==1?ll.INTERIOR:ll.EXTERIOR},Wl.prototype.isOnSegment=function(){return this._isPointOnSegment},Wl.prototype.interfaces_=function(){return[]},Wl.prototype.getClass=function(){return Wl},Wl.locatePointInRing=function(t,e){if(t instanceof ol&&cl(e,xl)){for(var n=e,i=new Wl(t),r=new ol,o=new ol,s=1;s<n.size();s++)if(n.getCoordinate(s,r),n.getCoordinate(s-1,o),i.countSegment(r,o),i.isOnSegment())return i.getLocation();return i.getLocation()}if(t instanceof ol&&e instanceof Array){for(var a=e,u=new Wl(t),l=1;l<a.length;l++){var h=a[l],c=a[l-1];if(u.countSegment(h,c),u.isOnSegment())return u.getLocation()}return u.getLocation()}};var Kl=function(){},Zl={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Kl.prototype.interfaces_=function(){return[]},Kl.prototype.getClass=function(){return Kl},Kl.orientationIndex=function(t,e,n){return vl.orientationIndex(t,e,n)},Kl.signedArea=function(t){if(t instanceof Array){var e=t;if(e.length<3)return 0;for(var n=0,i=e[0].x,r=1;r<e.length-1;r++){var o=e[r].x-i,s=e[r+1].y;n+=o*(e[r-1].y-s)}return n/2}if(cl(t,xl)){var a=t,u=a.size();if(u<3)return 0;var l=new ol,h=new ol,c=new ol;a.getCoordinate(0,h),a.getCoordinate(1,c);var p=h.x;c.x-=p;for(var f=0,d=1;d<u-1;d++)l.y=h.y,h.x=c.x,h.y=c.y,a.getCoordinate(d+1,c),c.x-=p,f+=h.x*(l.y-c.y);return f/2}},Kl.distanceLineLine=function(t,e,n,i){if(t.equals(e))return Kl.distancePointLine(t,n,i);if(n.equals(i))return Kl.distancePointLine(i,t,e);var r=!1;if(Pl.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0==o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,u=s/o;(u<0||1<u||a<0||1<a)&&(r=!0)}}else r=!0;return r?pl.min(Kl.distancePointLine(t,n,i),Kl.distancePointLine(e,n,i),Kl.distancePointLine(n,t,e),Kl.distancePointLine(i,t,e)):0},Kl.isPointInRing=function(t,e){return Kl.locatePointInRing(t,e)!==ll.EXTERIOR},Kl.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new ol;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,u=i.y,l=a-r,h=u-o;n+=Math.sqrt(l*l+h*h),r=a,o=u}return n},Kl.isCCW=function(t){var e=t.length-1;if(e<3)throw new Qu("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}for(var s=i;--s<0&&(s=e),t[s].equals2D(n)&&s!==i;);for(var a=i;t[a=(a+1)%e].equals2D(n)&&a!==i;);var u=t[s],l=t[a];if(u.equals2D(n)||l.equals2D(n)||u.equals2D(l))return!1;var h=Kl.computeOrientation(u,n,l),c=!1;return c=0===h?u.x>l.x:0<h,c},Kl.locatePointInRing=function(t,e){return Wl.locatePointInRing(t,e)},Kl.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},Kl.computeOrientation=function(t,e,n){return Kl.orientationIndex(t,e,n)},Kl.distancePointLine=function(t,e,n){if(2===arguments.length){var i=t,r=e;if(0===r.length)throw new Qu("Line array must contain at least one vertex");for(var o=i.distance(r[0]),s=0;s<r.length-1;s++){var a=Kl.distancePointLine(i,r[s],r[s+1]);a<o&&(o=a)}return o}if(3===arguments.length){var u=t,l=e,h=n;if(l.x===h.x&&l.y===h.y)return u.distance(l);var c=(h.x-l.x)*(h.x-l.x)+(h.y-l.y)*(h.y-l.y),p=((u.x-l.x)*(h.x-l.x)+(u.y-l.y)*(h.y-l.y))/c;if(p<=0)return u.distance(l);if(1<=p)return u.distance(h);var f=((l.y-u.y)*(h.x-l.x)-(l.x-u.x)*(h.y-l.y))/c;return Math.abs(f)*Math.sqrt(c)}},Kl.isOnLine=function(t,e){for(var n=new Hl,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},Zl.CLOCKWISE.get=function(){return-1},Zl.RIGHT.get=function(){return Kl.CLOCKWISE},Zl.COUNTERCLOCKWISE.get=function(){return 1},Zl.LEFT.get=function(){return Kl.COUNTERCLOCKWISE},Zl.COLLINEAR.get=function(){return 0},Zl.STRAIGHT.get=function(){return Kl.COLLINEAR},Object.defineProperties(Kl,Zl);function Ql(){}Ql.prototype.filter=function(){},Ql.prototype.interfaces_=function(){return[]},Ql.prototype.getClass=function(){return Ql};function $l(t){var e=t;this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()}var th={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};$l.prototype.isGeometryCollection=function(){return this.getSortIndex()===$l.SORTINDEX_GEOMETRYCOLLECTION},$l.prototype.getFactory=function(){return this._factory},$l.prototype.getGeometryN=function(){return this},$l.prototype.getArea=function(){return 0},$l.prototype.isRectangle=function(){return!1},$l.prototype.equals=function(t){if(t instanceof $l){return null!==t&&this.equalsTopo(t)}if(t instanceof Object){if(!(t instanceof $l))return!1;var e=t;return this.equalsExact(e)}},$l.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},$l.prototype.geometryChanged=function(){this.apply($l.geometryChangedFilter)},$l.prototype.geometryChangedAction=function(){this._envelope=null},$l.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},$l.prototype.getLength=function(){return 0},$l.prototype.getNumGeometries=function(){return 1},$l.prototype.compareTo=function(t,e){if(1===arguments.length){var n=t,i=n;return this.getSortIndex()!==i.getSortIndex()?this.getSortIndex()-i.getSortIndex():this.isEmpty()&&i.isEmpty()?0:this.isEmpty()?-1:i.isEmpty()?1:this.compareToSameClass(n)}if(2===arguments.length){var r=t,o=e;return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,o)}},$l.prototype.getUserData=function(){return this._userData},$l.prototype.getSRID=function(){return this._SRID},$l.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},$l.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===$l.SORTINDEX_GEOMETRYCOLLECTION)throw new Qu("This method does not support GeometryCollection arguments")},$l.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},$l.prototype.norm=function(){var t=this.copy();return t.normalize(),t},$l.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},$l.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new Pl(this._envelope)},$l.prototype.setSRID=function(t){this._SRID=t},$l.prototype.setUserData=function(t){this._userData=t},$l.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},$l.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},$l.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===$l.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===$l.SORTINDEX_MULTIPOINT||this.getSortIndex()===$l.SORTINDEX_MULTILINESTRING||this.getSortIndex()===$l.SORTINDEX_MULTIPOLYGON},$l.prototype.interfaces_=function(){return[nl,el,rl]},$l.prototype.getClass=function(){return $l},$l.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},$l.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},th.serialVersionUID.get=function(){return 0x799ea46522854c00},th.SORTINDEX_POINT.get=function(){return 0},th.SORTINDEX_MULTIPOINT.get=function(){return 1},th.SORTINDEX_LINESTRING.get=function(){return 2},th.SORTINDEX_LINEARRING.get=function(){return 3},th.SORTINDEX_MULTILINESTRING.get=function(){return 4},th.SORTINDEX_POLYGON.get=function(){return 5},th.SORTINDEX_MULTIPOLYGON.get=function(){return 6},th.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},th.geometryChangedFilter.get=function(){return eh},Object.defineProperties($l,th);var eh=function(){};eh.interfaces_=function(){return[Ql]},eh.filter=function(t){t.geometryChangedAction()};function nh(){}nh.prototype.filter=function(){},nh.prototype.interfaces_=function(){return[]},nh.prototype.getClass=function(){return nh};function ih(){}var rh={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};ih.prototype.isInBoundary=function(){},ih.prototype.interfaces_=function(){return[]},ih.prototype.getClass=function(){return ih},rh.Mod2BoundaryNodeRule.get=function(){return oh},rh.EndPointBoundaryNodeRule.get=function(){return sh},rh.MultiValentEndPointBoundaryNodeRule.get=function(){return ah},rh.MonoValentEndPointBoundaryNodeRule.get=function(){return uh},rh.MOD2_BOUNDARY_RULE.get=function(){return new oh},rh.ENDPOINT_BOUNDARY_RULE.get=function(){return new sh},rh.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new ah},rh.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new uh},rh.OGC_SFS_BOUNDARY_RULE.get=function(){return ih.MOD2_BOUNDARY_RULE},Object.defineProperties(ih,rh);var oh=function(){};oh.prototype.isInBoundary=function(t){return t%2==1},oh.prototype.interfaces_=function(){return[ih]},oh.prototype.getClass=function(){return oh};var sh=function(){};sh.prototype.isInBoundary=function(t){return 0<t},sh.prototype.interfaces_=function(){return[ih]},sh.prototype.getClass=function(){return sh};var ah=function(){};ah.prototype.isInBoundary=function(t){return 1<t},ah.prototype.interfaces_=function(){return[ih]},ah.prototype.getClass=function(){return ah};var uh=function(){};uh.prototype.isInBoundary=function(t){return 1===t},uh.prototype.interfaces_=function(){return[ih]},uh.prototype.getClass=function(){return uh};function lh(){}lh.prototype.add=function(){},lh.prototype.addAll=function(){},lh.prototype.isEmpty=function(){},lh.prototype.iterator=function(){},lh.prototype.size=function(){},lh.prototype.toArray=function(){},lh.prototype.remove=function(){};function hh(){}var ch=function(e){function t(t){e.call(this),this.message=t||""}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var n={name:{configurable:!0}};return n.name.get=function(){return"IndexOutOfBoundsException"},Object.defineProperties(t,n),t}(Error);hh.prototype.hasNext=function(){},hh.prototype.next=function(){},hh.prototype.remove=function(){};var ph,fh=((ph=lh)&&(dh.__proto__=ph),((dh.prototype=Object.create(ph&&ph.prototype)).constructor=dh).prototype.get=function(){},dh.prototype.set=function(){},dh.prototype.isEmpty=function(){},dh);function dh(){ph.apply(this,arguments)}function gh(t){this.message=t||""}(gh.prototype=new Error).name="NoSuchElementException";var yh,_h=((yh=fh)&&(mh.__proto__=yh),((mh.prototype=Object.create(yh&&yh.prototype)).constructor=mh).prototype.ensureCapacity=function(){},mh.prototype.interfaces_=function(){return[yh,lh]},mh.prototype.add=function(t,e){return 1===arguments.length?this.array_.push(t):this.array_.splice(t,e),!0},mh.prototype.clear=function(){this.array_=[]},mh.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},mh.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},mh.prototype.iterator=function(){return new bh(this)},mh.prototype.get=function(t){if(t<0||t>=this.size())throw new ch;return this.array_[t]},mh.prototype.isEmpty=function(){return 0===this.array_.length},mh.prototype.size=function(){return this.array_.length},mh.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},mh.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},mh);function mh(){yh.call(this),this.array_=[],arguments[0]instanceof lh&&this.addAll(arguments[0])}var vh,bh=((vh=hh)&&(xh.__proto__=vh),((xh.prototype=Object.create(vh&&vh.prototype)).constructor=xh).prototype.next=function(){if(this.position_===this.arrayList_.size())throw new gh;return this.arrayList_.get(this.position_++)},xh.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},xh.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},xh.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},xh);function xh(t){vh.call(this),this.arrayList_=t,this.position_=0}function Eh(){}var Ih=function(E){function t(){if(E.call(this),0!==arguments.length)if(1===arguments.length){var t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.ensureCapacity(e.length),this.add(e,n)}}E&&(t.__proto__=E),(t.prototype=Object.create(E&&E.prototype)).constructor=t;var e={coordArrayType:{configurable:!0}};return e.coordArrayType.get=function(){return new Array(0).fill(null)},t.prototype.getCoordinate=function(t){return this.get(t)},t.prototype.addAll=function(t,e){if(2!==arguments.length)return E.prototype.addAll.apply(this,arguments);for(var n=e,i=!1,r=t.iterator();r.hasNext();)this.add(r.next(),n),i=!0;return i},t.prototype.clone=function(){for(var t=E.prototype.clone.call(this),e=0;e<this.size();e++)t.add(e,this.get(e).copy());return t},t.prototype.toCoordinateArray=function(){return this.toArray(t.coordArrayType)},t.prototype.add=function(t,e,n,i){if(1===arguments.length){var r=t;E.prototype.add.call(this,r)}else if(2===arguments.length){if(t instanceof Array&&"boolean"==typeof e){var o=t,s=e;return this.add(o,s,!0),!0}if(t instanceof ol&&"boolean"==typeof e){var a=t;if(!e)if(1<=this.size())if(this.get(this.size()-1).equals2D(a))return null;E.prototype.add.call(this,a)}else if(t instanceof Object&&"boolean"==typeof e){var u=t,l=e;return this.add(u,l),!0}}else if(3===arguments.length){if("boolean"==typeof n&&t instanceof Array&&"boolean"==typeof e){var h=t,c=e;if(n)for(var p=0;p<h.length;p++)this.add(h[p],c);else for(var f=h.length-1;0<=f;f--)this.add(h[f],c);return!0}if("boolean"==typeof n&&Number.isInteger(t)&&e instanceof ol){var d=t,g=e;if(!n){var y=this.size();if(0<y){if(0<d)if(this.get(d-1).equals2D(g))return null;if(d<y)if(this.get(d).equals2D(g))return null}}E.prototype.add.call(this,d,g)}}else if(4===arguments.length){var _=t,m=e,v=i,b=1;v<n&&(b=-1);for(var x=n;x!==v;x+=b)this.add(_[x],m);return!0}},t.prototype.closeRing=function(){0<this.size()&&this.add(new ol(this.get(0)),!1)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},Object.defineProperties(t,e),t}(_h),Lh={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};Lh.ForwardComparator.get=function(){return wh},Lh.BidirectionalComparator.get=function(){return Sh},Lh.coordArrayType.get=function(){return new Array(0).fill(null)},Eh.prototype.interfaces_=function(){return[]},Eh.prototype.getClass=function(){return Eh},Eh.isRing=function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])},Eh.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Eh.indexOf(i,e)<0)return i}return null},Eh.scroll=function(t,e){var n=Eh.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);Ml.arraycopy(t,n,i,0,t.length-n),Ml.arraycopy(t,0,i,t.length-n,n),Ml.arraycopy(i,0,t,0,t.length)},Eh.equals=function(t,e,n){if(2===arguments.length){var i=t,r=e;if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(!i[o].equals(r[o]))return!1;return!0}if(3===arguments.length){var s=t,a=e,u=n;if(s===a)return!0;if(null===s||null===a)return!1;if(s.length!==a.length)return!1;for(var l=0;l<s.length;l++)if(0!==u.compare(s[l],a[l]))return!1;return!0}},Eh.intersection=function(t,e){for(var n=new Ih,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Eh.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Eh.removeRepeatedPoints=function(t){return Eh.hasRepeatedPoints(t)?new Ih(t,!1).toCoordinateArray():t},Eh.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Eh.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Eh.copyDeep=function(t,e,n,i,r){if(1===arguments.length){for(var o=t,s=new Array(o.length).fill(null),a=0;a<o.length;a++)s[a]=new ol(o[a]);return s}if(5===arguments.length)for(var u=t,l=e,h=n,c=i,p=r,f=0;f<p;f++)h[c+f]=new ol(u[l+f])},Eh.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Eh.envelope=function(t){for(var e=new Pl,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Eh.toCoordinateArray=function(t){return t.toArray(Eh.coordArrayType)},Eh.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Eh.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Eh.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Eh.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Eh.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||0<e.compareTo(t[n]))&&(e=t[n]);return e},Eh.extract=function(t,e,n){e=pl.clamp(e,0,t.length);var i=(n=pl.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(Eh,Lh);var wh=function(){};wh.prototype.compare=function(t,e){return Eh.compare(t,e)},wh.prototype.interfaces_=function(){return[il]},wh.prototype.getClass=function(){return wh};var Sh=function(){};Sh.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Eh.compare(n,i);return Eh.isEqualReversed(n,i)?0:r},Sh.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Eh.increasingDirection(n),o=Eh.increasingDirection(i),s=0<r?0:n.length-1,a=0<o?0:n.length-1,u=0;u<n.length;u++){var l=n[s].compareTo(i[a]);if(0!==l)return l;s+=r,a+=o}return 0},Sh.prototype.interfaces_=function(){return[il]},Sh.prototype.getClass=function(){return Sh};function Mh(){}Mh.prototype.get=function(){},Mh.prototype.put=function(){},Mh.prototype.size=function(){},Mh.prototype.values=function(){},Mh.prototype.entrySet=function(){};var Ch,Ph=((Ch=Mh)&&(Nh.__proto__=Ch),(Nh.prototype=Object.create(Ch&&Ch.prototype)).constructor=Nh);function Nh(){Ch.apply(this,arguments)}function Oh(t){this.message=t||""}function Th(){}(Oh.prototype=new Error).name="OperationNotSupported",(Th.prototype=new lh).contains=function(){};var kh,Rh=((kh=Th)&&(Dh.__proto__=kh),((Dh.prototype=Object.create(kh&&kh.prototype)).constructor=Dh).prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},Dh.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},Dh.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Dh.prototype.remove=function(){throw new Error},Dh.prototype.size=function(){return this.array_.length},Dh.prototype.isEmpty=function(){return 0===this.array_.length},Dh.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Dh.prototype.iterator=function(){return new Fh(this)},Dh);function Dh(){kh.call(this),this.array_=[],arguments[0]instanceof lh&&this.addAll(arguments[0])}var Ah,Fh=((Ah=hh)&&(Bh.__proto__=Ah),((Bh.prototype=Object.create(Ah&&Ah.prototype)).constructor=Bh).prototype.next=function(){if(this.position_===this.hashSet_.size())throw new gh;return this.hashSet_.array_[this.position_++]},Bh.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},Bh.prototype.remove=function(){throw new Oh},Bh);function Bh(t){Ah.call(this),this.hashSet_=t,this.position_=0}var Gh=0;function Uh(t){return null===t?Gh:t.color}function jh(t){return null===t?null:t.parent}function qh(t,e){null!==t&&(t.color=e)}function zh(t){return null===t?null:t.left}function Vh(t){return null===t?null:t.right}function Yh(){this.root_=null,this.size_=0}(Yh.prototype=new Ph).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(0<n))return e.value;e=e.right}}return null},Yh.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Gh,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(0<i)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Gh,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},Yh.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(jh(t)===zh(jh(jh(t)))){var e=Vh(jh(jh(t)));1===Uh(e)?(qh(jh(t),Gh),qh(e,Gh),qh(jh(jh(t)),1),t=jh(jh(t))):(t===Vh(jh(t))&&(t=jh(t),this.rotateLeft(t)),qh(jh(t),Gh),qh(jh(jh(t)),1),this.rotateRight(jh(jh(t))))}else{var n=zh(jh(jh(t)));1===Uh(n)?(qh(jh(t),Gh),qh(n,Gh),qh(jh(jh(t)),1),t=jh(jh(t))):(t===zh(jh(t))&&(t=jh(t),this.rotateRight(t)),qh(jh(t),Gh),qh(jh(jh(t)),1),this.rotateLeft(jh(jh(t))))}this.root_.color=Gh},Yh.prototype.values=function(){var t=new _h,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=Yh.successor(e));)t.add(e.value);return t},Yh.prototype.entrySet=function(){var t=new Rh,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=Yh.successor(e));)t.add(e);return t},Yh.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,(e.left=t).parent=e}},Yh.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,(e.right=t).parent=e}},Yh.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},Yh.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)n=(i=n).parent;return n},Yh.prototype.size=function(){return this.size_};function Hh(){}function Xh(){}function Jh(){this.array_=[],arguments[0]instanceof lh&&this.addAll(arguments[0])}Hh.prototype.interfaces_=function(){return[]},Hh.prototype.getClass=function(){return Hh},Xh.prototype=new Th,(Jh.prototype=new Xh).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++){if(0===this.array_[e].compareTo(t))return!0}return!1},Jh.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++){if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0}return this.array_.push(t),!0},Jh.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},Jh.prototype.remove=function(t){throw new Oh},Jh.prototype.size=function(){return this.array_.length},Jh.prototype.isEmpty=function(){return 0===this.array_.length},Jh.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},Jh.prototype.iterator=function(){return new Wh(this)};var Wh=function(t){this.treeSet_=t,this.position_=0};Wh.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new gh;return this.treeSet_.array_[this.position_++]},Wh.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Wh.prototype.remove=function(){throw new Oh};function Kh(){}Kh.sort=function(t,e,n,i){var r,o,s,a,u=t;if(1===arguments.length)a=function(t,e){return t.compareTo(e)},u.sort(a);else if(2===arguments.length)s=e,a=function(t,e){return s.compare(t,e)},u.sort(a);else if(3===arguments.length){(o=u.slice(e,n)).sort();var l=u.slice(0,e).concat(o,u.slice(n,u.length));for(u.splice(0,u.length),r=0;r<l.length;r++)u.push(l[r])}else if(4===arguments.length)for(o=u.slice(e,n),s=i,a=function(t,e){return s.compare(t,e)},o.sort(a),l=u.slice(0,e).concat(o,u.slice(n,u.length)),u.splice(0,u.length),r=0;r<l.length;r++)u.push(l[r])},Kh.asList=function(t){for(var e=new _h,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};function Zh(){}var Qh={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Qh.P.get=function(){return 0},Qh.L.get=function(){return 1},Qh.A.get=function(){return 2},Qh.FALSE.get=function(){return-1},Qh.TRUE.get=function(){return-2},Qh.DONTCARE.get=function(){return-3},Qh.SYM_FALSE.get=function(){return"F"},Qh.SYM_TRUE.get=function(){return"T"},Qh.SYM_DONTCARE.get=function(){return"*"},Qh.SYM_P.get=function(){return"0"},Qh.SYM_L.get=function(){return"1"},Qh.SYM_A.get=function(){return"2"},Zh.prototype.interfaces_=function(){return[]},Zh.prototype.getClass=function(){return Zh},Zh.toDimensionSymbol=function(t){switch(t){case Zh.FALSE:return Zh.SYM_FALSE;case Zh.TRUE:return Zh.SYM_TRUE;case Zh.DONTCARE:return Zh.SYM_DONTCARE;case Zh.P:return Zh.SYM_P;case Zh.L:return Zh.SYM_L;case Zh.A:return Zh.SYM_A}throw new Qu("Unknown dimension value: "+t)},Zh.toDimensionValue=function(t){switch(yl.toUpperCase(t)){case Zh.SYM_FALSE:return Zh.FALSE;case Zh.SYM_TRUE:return Zh.TRUE;case Zh.SYM_DONTCARE:return Zh.DONTCARE;case Zh.SYM_P:return Zh.P;case Zh.SYM_L:return Zh.L;case Zh.SYM_A:return Zh.A}throw new Qu("Unknown dimension symbol: "+t)},Object.defineProperties(Zh,Qh);function $h(){}$h.prototype.filter=function(){},$h.prototype.interfaces_=function(){return[]},$h.prototype.getClass=function(){return $h};function tc(){}tc.prototype.filter=function(){},tc.prototype.isDone=function(){},tc.prototype.isGeometryChanged=function(){},tc.prototype.interfaces_=function(){return[]},tc.prototype.getClass=function(){return tc};var ec=function(s){function n(t,e){if(s.call(this,e),this._geometries=t||[],s.hasNullElements(this._geometries))throw new Qu("geometries must not contain null elements")}s&&(n.__proto__=s);var t={serialVersionUID:{configurable:!0}};return((n.prototype=Object.create(s&&s.prototype)).constructor=n).prototype.computeEnvelopeInternal=function(){for(var t=new Pl,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},n.prototype.getGeometryN=function(t){return this._geometries[t]},n.prototype.getSortIndex=function(){return s.SORTINDEX_GEOMETRYCOLLECTION},n.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},n.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},n.prototype.equalsExact=function(t,e){if(2!==arguments.length)return s.prototype.equalsExact.apply(this,arguments);var n=t,i=e;if(!this.isEquivalentClass(n))return!1;var r=n;if(this._geometries.length!==r._geometries.length)return!1;for(var o=0;o<this._geometries.length;o++)if(!this._geometries[o].equalsExact(r._geometries[o],i))return!1;return!0},n.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Kh.sort(this._geometries)},n.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},n.prototype.getBoundaryDimension=function(){for(var t=Zh.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},n.prototype.getDimension=function(){for(var t=Zh.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},n.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},n.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},n.prototype.getNumGeometries=function(){return this._geometries.length},n.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},n.prototype.compareToSameClass=function(t,e){if(1===arguments.length){var n=t,i=new Jh(Kh.asList(this._geometries)),r=new Jh(Kh.asList(n._geometries));return this.compare(i,r)}if(2===arguments.length){for(var o=e,s=t,a=this.getNumGeometries(),u=s.getNumGeometries(),l=0;l<a&&l<u;){var h=this.getGeometryN(l),c=s.getGeometryN(l),p=h.compareToSameClass(c,o);if(0!==p)return p;l++}return l<a?1:l<u?-1:0}},n.prototype.apply=function(t){if(cl(t,nh))for(var e=t,n=0;n<this._geometries.length;n++)this._geometries[n].apply(e);else if(cl(t,tc)){var i=t;if(0===this._geometries.length)return null;for(var r=0;r<this._geometries.length&&(this._geometries[r].apply(i),!i.isDone());r++);i.isGeometryChanged()&&this.geometryChanged()}else if(cl(t,$h)){var o=t;o.filter(this);for(var s=0;s<this._geometries.length;s++)this._geometries[s].apply(o)}else if(cl(t,Ql)){var a=t;a.filter(this);for(var u=0;u<this._geometries.length;u++)this._geometries[u].apply(a)}},n.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),ql.shouldNeverReachHere(),null},n.prototype.clone=function(){var t=s.prototype.clone.call(this);t._geometries=new Array(this._geometries.length).fill(null);for(var e=0;e<this._geometries.length;e++)t._geometries[e]=this._geometries[e].clone();return t},n.prototype.getGeometryType=function(){return"GeometryCollection"},n.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)},n.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},n.prototype.interfaces_=function(){return[]},n.prototype.getClass=function(){return n},t.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(n,t),n}($l),nc=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((n.prototype=Object.create(r&&r.prototype)).constructor=n).prototype.getSortIndex=function(){return $l.SORTINDEX_MULTILINESTRING},n.prototype.equalsExact=function(t,e){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var n=t,i=e;return!!this.isEquivalentClass(n)&&r.prototype.equalsExact.call(this,n,i)},n.prototype.getBoundaryDimension=function(){return this.isClosed()?Zh.FALSE:0},n.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},n.prototype.getDimension=function(){return 1},n.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},n.prototype.getBoundary=function(){return new ic(this).getBoundary()},n.prototype.getGeometryType=function(){return"MultiLineString"},n.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)},n.prototype.interfaces_=function(){return[Hh]},n.prototype.getClass=function(){return n},t.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(n,t),n}(ec),ic=function(t,e){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var n=t,i=ih.MOD2_BOUNDARY_RULE;this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}else if(2===arguments.length){var r=t,o=e;this._geom=r,this._geomFact=r.getFactory(),this._bnRule=o}};ic.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},ic.prototype.getBoundary=function(){return this._geom instanceof gc?this.boundaryLineString(this._geom):this._geom instanceof nc?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},ic.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},ic.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},ic.prototype.computeBoundaryCoordinates=function(t){var e=new _h;this._endpointMap=new Yh;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Eh.toCoordinateArray(e)},ic.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new rc,this._endpointMap.put(t,e)),e.count++},ic.prototype.interfaces_=function(){return[]},ic.prototype.getClass=function(){return ic},ic.getBoundary=function(t,e){return 1===arguments.length?new ic(t).getBoundary():2===arguments.length?new ic(t,e).getBoundary():void 0};var rc=function(){this.count=null};function oc(){}function sc(){}rc.prototype.interfaces_=function(){return[]},rc.prototype.getClass=function(){return rc};function ac(){}function uc(){}function lc(){}function hc(){}function cc(){}var pc={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};cc.prototype.interfaces_=function(){return[]},cc.prototype.getClass=function(){return cc},cc.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},cc.getStackTrace=function(t,e){if(1===arguments.length){var n=t,i=new uc,r=new oc(i);return n.printStackTrace(r),i.toString()}if(2===arguments.length){for(var o=e,s="",a=new hc(new sc(cc.getStackTrace(t))),u=0;u<o;u++)try{s+=a.readLine()+cc.NEWLINE}catch(t){if(!(t instanceof lc))throw t;ql.shouldNeverReachHere()}return s}},cc.split=function(t,e){for(var n=e.length,i=new _h,r=""+t,o=r.indexOf(e);0<=o;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}0<r.length&&i.add(r);for(var a=new Array(i.size()).fill(null),u=0;u<a.length;u++)a[u]=i.get(u);return a},cc.toString=function(t){if(1===arguments.length){var e=t;return cc.SIMPLE_ORDINATE_FORMAT.format(e)}},cc.spaces=function(t){return cc.chars(" ",t)},pc.NEWLINE.get=function(){return Ml.getProperty("line.separator")},pc.SIMPLE_ORDINATE_FORMAT.get=function(){return new ac("0.#")},Object.defineProperties(cc,pc);function fc(){}fc.prototype.interfaces_=function(){return[]},fc.prototype.getClass=function(){return fc},fc.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},fc.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&(t.getOrdinate(0,xl.X)===t.getOrdinate(e-1,xl.X)&&t.getOrdinate(0,xl.Y)===t.getOrdinate(e-1,xl.Y))},fc.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(t.getOrdinate(r,o)!==e.getOrdinate(r,o)&&(!$u.isNaN(s)||!$u.isNaN(a)))return!1}return!0},fc.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(fc.copy(e,0,i,0,r),0<r)for(var o=r;o<n;o++)fc.copy(e,r-1,i,o,1);return i},fc.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)fc.swap(t,i,e-i)},fc.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},fc.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)fc.copyCoord(t,e+o,n,i+o)},fc.toString=function(t){if(1===arguments.length){var e=t,n=e.size();if(0===n)return"()";var i=e.getDimension(),r=new dl;r.append("(");for(var o=0;o<n;o++){0<o&&r.append(" ");for(var s=0;s<i;s++)0<s&&r.append(","),r.append(cc.toString(e.getOrdinate(o,s)))}return r.append(")"),r.toString()}},fc.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?fc.createClosedRing(t,e,4):e.getOrdinate(0,xl.X)===e.getOrdinate(n-1,xl.X)&&e.getOrdinate(0,xl.Y)===e.getOrdinate(n-1,xl.Y)?e:fc.createClosedRing(t,e,n+1)},fc.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();fc.copy(e,0,i,0,r);for(var o=r;o<n;o++)fc.copy(e,0,i,o,1);return i};function dc(){}var gc=function(s){function e(t,e){s.call(this,e),this._points=null,this.init(t)}s&&(e.__proto__=s);var t={serialVersionUID:{configurable:!0}};return((e.prototype=Object.create(s&&s.prototype)).constructor=e).prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Pl:this._points.expandEnvelope(new Pl)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return s.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(t,e){if(2!==arguments.length)return s.prototype.equalsExact.apply(this,arguments);var n=t,i=e;if(!this.isEquivalentClass(n))return!1;var r=n;if(this._points.size()!==r._points.size())return!1;for(var o=0;o<this._points.size();o++)if(!this.equal(this._points.getCoordinate(o),r._points.getCoordinate(o),i))return!1;return!0},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return 0<this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))&&fc.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?Zh.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return Kl.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return fc.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(t,e){if(1===arguments.length){for(var n=t,i=0,r=0;i<this._points.size()&&r<n._points.size();){var o=this._points.getCoordinate(i).compareTo(n._points.getCoordinate(r));if(0!==o)return o;i++,r++}return i<this._points.size()?1:r<n._points.size()?-1:0}if(2===arguments.length){var s=t;return e.compare(this._points,s._points)}},e.prototype.apply=function(t){if(cl(t,nh))for(var e=t,n=0;n<this._points.size();n++)e.filter(this._points.getCoordinate(n));else if(cl(t,tc)){var i=t;if(0===this._points.size())return null;for(var r=0;r<this._points.size()&&(i.filter(this._points,r),!i.isDone());r++);i.isGeometryChanged()&&this.geometryChanged()}else if(cl(t,$h)){t.filter(this)}else if(cl(t,Ql)){t.filter(this)}},e.prototype.getBoundary=function(){return new ic(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var t=s.prototype.clone.call(this);return t._points=this._points.clone(),t},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new Qu("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[Hh]},e.prototype.getClass=function(){return e},t.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,t),e}($l);dc.prototype.interfaces_=function(){return[]},dc.prototype.getClass=function(){return dc};function yc(){}var _c=function(r){function t(t,e){r.call(this,e),this._coordinates=t||null,this.init(this._coordinates)}r&&(t.__proto__=r);var e={serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(r&&r.prototype)).constructor=t).prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Pl;var t=new Pl;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},t.prototype.getSortIndex=function(){return r.SORTINDEX_POINT},t.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},t.prototype.equalsExact=function(t,e){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var n=t,i=e;return!!this.isEquivalentClass(n)&&(!(!this.isEmpty()||!n.isEmpty())||this.isEmpty()===n.isEmpty()&&this.equal(n.getCoordinate(),this.getCoordinate(),i))},t.prototype.normalize=function(){},t.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},t.prototype.getBoundaryDimension=function(){return Zh.FALSE},t.prototype.getDimension=function(){return 0},t.prototype.getNumPoints=function(){return this.isEmpty()?0:1},t.prototype.reverse=function(){return this.copy()},t.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},t.prototype.compareToSameClass=function(t,e){if(1===arguments.length){var n=t;return this.getCoordinate().compareTo(n.getCoordinate())}if(2===arguments.length){var i=t;return e.compare(this._coordinates,i._coordinates)}},t.prototype.apply=function(t){if(cl(t,nh)){var e=t;if(this.isEmpty())return null;e.filter(this.getCoordinate())}else if(cl(t,tc)){var n=t;if(this.isEmpty())return null;n.filter(this._coordinates,0),n.isGeometryChanged()&&this.geometryChanged()}else if(cl(t,$h)){t.filter(this)}else if(cl(t,Ql)){t.filter(this)}},t.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},t.prototype.clone=function(){var t=r.prototype.clone.call(this);return t._coordinates=this._coordinates.clone(),t},t.prototype.getGeometryType=function(){return"Point"},t.prototype.copy=function(){return new t(this._coordinates.copy(),this._factory)},t.prototype.getCoordinateSequence=function(){return this._coordinates},t.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},t.prototype.isEmpty=function(){return 0===this._coordinates.size()},t.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),ql.isTrue(t.size()<=1),this._coordinates=t},t.prototype.isSimple=function(){return!0},t.prototype.interfaces_=function(){return[dc]},t.prototype.getClass=function(){return t},e.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(t,e),t}($l);yc.prototype.interfaces_=function(){return[]},yc.prototype.getClass=function(){return yc};function mc(t){this._factory=t||null,this._isUserDataCopied=!1}var vc=function(u){function i(t,e,n){if(u.call(this,n),this._shell=null,(this._holes=null)===t&&(t=this.getFactory().createLinearRing()),null===e&&(e=[]),u.hasNullElements(e))throw new Qu("holes must not contain null elements");if(t.isEmpty()&&u.hasNonEmptyElements(e))throw new Qu("shell is empty but holes are not");this._shell=t,this._holes=e}u&&(i.__proto__=u);var t={serialVersionUID:{configurable:!0}};return((i.prototype=Object.create(u&&u.prototype)).constructor=i).prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},i.prototype.getSortIndex=function(){return u.SORTINDEX_POLYGON},i.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},i.prototype.getArea=function(){var t=0;t+=Math.abs(Kl.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(Kl.signedArea(this._holes[e].getCoordinateSequence()));return t},i.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var u=t.getX(a),l=t.getY(a);if(u!==o==(l!==s))return!1;o=u,s=l}return!0},i.prototype.equalsExact=function(t,e){if(2!==arguments.length)return u.prototype.equalsExact.apply(this,arguments);var n=t,i=e;if(!this.isEquivalentClass(n))return!1;var r=n,o=this._shell,s=r._shell;if(!o.equalsExact(s,i))return!1;if(this._holes.length!==r._holes.length)return!1;for(var a=0;a<this._holes.length;a++)if(!this._holes[a].equalsExact(r._holes[a],i))return!1;return!0},i.prototype.normalize=function(t,e){if(0===arguments.length){this.normalize(this._shell,!0);for(var n=0;n<this._holes.length;n++)this.normalize(this._holes[n],!1);Kh.sort(this._holes)}else if(2===arguments.length){var i=t,r=e;if(i.isEmpty())return null;var o=new Array(i.getCoordinates().length-1).fill(null);Ml.arraycopy(i.getCoordinates(),0,o,0,o.length);var s=Eh.minCoordinate(i.getCoordinates());Eh.scroll(o,s),Ml.arraycopy(o,0,i.getCoordinates(),0,o.length),i.getCoordinates()[o.length]=o[0],Kl.isCCW(i.getCoordinates())===r&&Eh.reverse(i.getCoordinates())}},i.prototype.getCoordinate=function(){return this._shell.getCoordinate()},i.prototype.getNumInteriorRing=function(){return this._holes.length},i.prototype.getBoundaryDimension=function(){return 1},i.prototype.getDimension=function(){return 2},i.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},i.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},i.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},i.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},i.prototype.compareToSameClass=function(t,e){if(1===arguments.length){var n=t,i=this._shell,r=n._shell;return i.compareToSameClass(r)}if(2===arguments.length){var o=e,s=t,a=this._shell,u=s._shell,l=a.compareToSameClass(u,o);if(0!==l)return l;for(var h=this.getNumInteriorRing(),c=s.getNumInteriorRing(),p=0;p<h&&p<c;){var f=this.getInteriorRingN(p),d=s.getInteriorRingN(p),g=f.compareToSameClass(d,o);if(0!==g)return g;p++}return p<h?1:p<c?-1:0}},i.prototype.apply=function(t){if(cl(t,nh)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(cl(t,tc)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(cl(t,$h))t.filter(this);else if(cl(t,Ql)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},i.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},i.prototype.clone=function(){var t=u.prototype.clone.call(this);t._shell=this._shell.clone(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].clone();return t},i.prototype.getGeometryType=function(){return"Polygon"},i.prototype.copy=function(){for(var t=this._shell.copy(),e=new Array(this._holes.length).fill(null),n=0;n<e.length;n++)e[n]=this._holes[n].copy();return new i(t,e,this._factory)},i.prototype.getExteriorRing=function(){return this._shell},i.prototype.isEmpty=function(){return this._shell.isEmpty()},i.prototype.getInteriorRingN=function(t){return this._holes[t]},i.prototype.interfaces_=function(){return[yc]},i.prototype.getClass=function(){return i},t.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(i,t),i}($l),bc=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((n.prototype=Object.create(r&&r.prototype)).constructor=n).prototype.getSortIndex=function(){return $l.SORTINDEX_MULTIPOINT},n.prototype.isValid=function(){return!0},n.prototype.equalsExact=function(t,e){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var n=t,i=e;return!!this.isEquivalentClass(n)&&r.prototype.equalsExact.call(this,n,i)},n.prototype.getCoordinate=function(t){if(1!==arguments.length)return r.prototype.getCoordinate.apply(this,arguments);var e=t;return this._geometries[e].getCoordinate()},n.prototype.getBoundaryDimension=function(){return Zh.FALSE},n.prototype.getDimension=function(){return 0},n.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},n.prototype.getGeometryType=function(){return"MultiPoint"},n.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)},n.prototype.interfaces_=function(){return[dc]},n.prototype.getClass=function(){return n},t.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(n,t),n}(ec),xc=function(n){function t(t,e){t instanceof ol&&e instanceof Bc&&(t=e.getCoordinateSequenceFactory().create(t)),n.call(this,t,e),this.validateConstruction()}n&&(t.__proto__=n);var e={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return((t.prototype=Object.create(n&&n.prototype)).constructor=t).prototype.getSortIndex=function(){return $l.SORTINDEX_LINEARRING},t.prototype.getBoundaryDimension=function(){return Zh.FALSE},t.prototype.isClosed=function(){return!!this.isEmpty()||n.prototype.isClosed.call(this)},t.prototype.reverse=function(){var t=this._points.copy();return fc.reverse(t),this.getFactory().createLinearRing(t)},t.prototype.validateConstruction=function(){if(!this.isEmpty()&&!n.prototype.isClosed.call(this))throw new Qu("Points of LinearRing do not form a closed linestring");if(1<=this.getCoordinateSequence().size()&&this.getCoordinateSequence().size()<t.MINIMUM_VALID_SIZE)throw new Qu("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},t.prototype.getGeometryType=function(){return"LinearRing"},t.prototype.copy=function(){return new t(this._points.copy(),this._factory)},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},e.MINIMUM_VALID_SIZE.get=function(){return 4},e.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(t,e),t}(gc),Ec=function(r){function n(){r.apply(this,arguments)}r&&(n.__proto__=r);var t={serialVersionUID:{configurable:!0}};return((n.prototype=Object.create(r&&r.prototype)).constructor=n).prototype.getSortIndex=function(){return $l.SORTINDEX_MULTIPOLYGON},n.prototype.equalsExact=function(t,e){if(2!==arguments.length)return r.prototype.equalsExact.apply(this,arguments);var n=t,i=e;return!!this.isEquivalentClass(n)&&r.prototype.equalsExact.call(this,n,i)},n.prototype.getBoundaryDimension=function(){return 1},n.prototype.getDimension=function(){return 2},n.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},n.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new _h,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},n.prototype.getGeometryType=function(){return"MultiPolygon"},n.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new n(t,this._factory)},n.prototype.interfaces_=function(){return[yc]},n.prototype.getClass=function(){return n},t.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(n,t),n}(ec),Ic={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};mc.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},mc.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},mc.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof ec?this.editGeometryCollection(t,e):t instanceof vc?this.editPolygon(t,e):t instanceof _c?e.edit(t,this._factory):t instanceof gc?e.edit(t,this._factory):(ql.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},mc.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new _h,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===bc?this._factory.createMultiPoint(i.toArray([])):n.getClass()===nc?this._factory.createMultiLineString(i.toArray([])):n.getClass()===Ec?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},mc.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new _h,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},mc.prototype.interfaces_=function(){return[]},mc.prototype.getClass=function(){return mc},mc.GeometryEditorOperation=function(){},Ic.NoOpGeometryOperation.get=function(){return Lc},Ic.CoordinateOperation.get=function(){return wc},Ic.CoordinateSequenceOperation.get=function(){return Sc},Object.defineProperties(mc,Ic);var Lc=function(){};Lc.prototype.edit=function(t){return t},Lc.prototype.interfaces_=function(){return[mc.GeometryEditorOperation]},Lc.prototype.getClass=function(){return Lc};var wc=function(){};wc.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof xc?e.createLinearRing(n):t instanceof gc?e.createLineString(n):t instanceof _c?0<n.length?e.createPoint(n[0]):e.createPoint():t},wc.prototype.interfaces_=function(){return[mc.GeometryEditorOperation]},wc.prototype.getClass=function(){return wc};var Sc=function(){};Sc.prototype.edit=function(t,e){return t instanceof xc?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof gc?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof _c?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},Sc.prototype.interfaces_=function(){return[mc.GeometryEditorOperation]},Sc.prototype.getClass=function(){return Sc};function Mc(t,e){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(t instanceof Array)this._coordinates=t,this._dimension=3;else if(Number.isInteger(t)){var n=t;this._coordinates=new Array(n).fill(null);for(var i=0;i<n;i++)this._coordinates[i]=new ol}else if(cl(t,xl)){var r=t;if(null===r)return this._coordinates=new Array(0).fill(null),null;this._dimension=r.getDimension(),this._coordinates=new Array(r.size()).fill(null);for(var o=0;o<this._coordinates.length;o++)this._coordinates[o]=r.getCoordinateCopy(o)}}else if(2===arguments.length)if(t instanceof Array&&Number.isInteger(e)){var s=t,a=e;this._coordinates=s,this._dimension=a,null===s&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(t)&&Number.isInteger(e)){var u=t,l=e;this._coordinates=new Array(u).fill(null),this._dimension=l;for(var h=0;h<u;h++)this._coordinates[h]=new ol}}var Cc={serialVersionUID:{configurable:!0}};Mc.prototype.setOrdinate=function(t,e,n){switch(e){case xl.X:this._coordinates[t].x=n;break;case xl.Y:this._coordinates[t].y=n;break;case xl.Z:this._coordinates[t].z=n;break;default:throw new Qu("invalid ordinateIndex")}},Mc.prototype.size=function(){return this._coordinates.length},Mc.prototype.getOrdinate=function(t,e){switch(e){case xl.X:return this._coordinates[t].x;case xl.Y:return this._coordinates[t].y;case xl.Z:return this._coordinates[t].z}return $u.NaN},Mc.prototype.getCoordinate=function(t,e){if(1===arguments.length){var n=t;return this._coordinates[n]}if(2===arguments.length){var i=t,r=e;r.x=this._coordinates[i].x,r.y=this._coordinates[i].y,r.z=this._coordinates[i].z}},Mc.prototype.getCoordinateCopy=function(t){return new ol(this._coordinates[t])},Mc.prototype.getDimension=function(){return this._dimension},Mc.prototype.getX=function(t){return this._coordinates[t].x},Mc.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new Mc(t,this._dimension)},Mc.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},Mc.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new Mc(t,this._dimension)},Mc.prototype.toString=function(){if(0<this._coordinates.length){var t=new dl(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},Mc.prototype.getY=function(t){return this._coordinates[t].y},Mc.prototype.toCoordinateArray=function(){return this._coordinates},Mc.prototype.interfaces_=function(){return[xl,rl]},Mc.prototype.getClass=function(){return Mc},Cc.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(Mc,Cc);function Pc(){}var Nc={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Pc.prototype.readResolve=function(){return Pc.instance()},Pc.prototype.create=function(t,e){if(1===arguments.length){if(t instanceof Array)return new Mc(t);if(cl(t,xl))return new Mc(t)}else if(2===arguments.length){var n=t,i=e;return 3<i&&(i=3),i<2?new Mc(n):new Mc(n,i)}},Pc.prototype.interfaces_=function(){return[ul,rl]},Pc.prototype.getClass=function(){return Pc},Pc.instance=function(){return Pc.instanceObject},Nc.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},Nc.instanceObject.get=function(){return new Pc},Object.defineProperties(Pc,Nc);var Oc,Tc=((Oc=Mh)&&(kc.__proto__=Oc),((kc.prototype=Object.create(Oc&&Oc.prototype)).constructor=kc).prototype.get=function(t){return this.map_.get(t)||null},kc.prototype.put=function(t,e){return this.map_.set(t,e),e},kc.prototype.values=function(){for(var t=new _h,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},kc.prototype.entrySet=function(){var e=new Rh;return this.map_.entries().forEach(function(t){return e.add(t)}),e},kc.prototype.size=function(){return this.map_.size()},kc);function kc(){Oc.call(this),this.map_=new Map}function Rc(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=Rc.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof Ac){var t=arguments[0];(this._modelType=t)===Rc.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var e=arguments[0];this._modelType=Rc.FIXED,this.setScale(e)}else if(arguments[0]instanceof Rc){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}}var Dc={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};Rc.prototype.equals=function(t){if(!(t instanceof Rc))return!1;return this._modelType===t._modelType&&this._scale===t._scale},Rc.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new gl(n).compareTo(new gl(i))},Rc.prototype.getScale=function(){return this._scale},Rc.prototype.isFloating=function(){return this._modelType===Rc.FLOATING||this._modelType===Rc.FLOATING_SINGLE},Rc.prototype.getType=function(){return this._modelType},Rc.prototype.toString=function(){var t="UNKNOWN";return this._modelType===Rc.FLOATING?t="Floating":this._modelType===Rc.FLOATING_SINGLE?t="Floating-Single":this._modelType===Rc.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},Rc.prototype.makePrecise=function(t){if("number"==typeof t){var e=t;return $u.isNaN(e)?e:this._modelType!==Rc.FLOATING_SINGLE&&this._modelType===Rc.FIXED?Math.round(e*this._scale)/this._scale:e}if(t instanceof ol){var n=t;if(this._modelType===Rc.FLOATING)return null;n.x=this.makePrecise(n.x),n.y=this.makePrecise(n.y)}},Rc.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===Rc.FLOATING?t=16:this._modelType===Rc.FLOATING_SINGLE?t=6:this._modelType===Rc.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},Rc.prototype.setScale=function(t){this._scale=Math.abs(t)},Rc.prototype.interfaces_=function(){return[rl,el]},Rc.prototype.getClass=function(){return Rc},Rc.mostPrecise=function(t,e){return 0<=t.compareTo(e)?t:e},Dc.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},Dc.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(Rc,Dc);var Ac=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},Fc={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Ac.prototype.readResolve=function(){return Ac.nameToTypeMap.get(this._name)},Ac.prototype.toString=function(){return this._name},Ac.prototype.interfaces_=function(){return[rl]},Ac.prototype.getClass=function(){return Ac},Fc.serialVersionUID.get=function(){return-552860263173159e4},Fc.nameToTypeMap.get=function(){return new Tc},Object.defineProperties(Ac,Fc),Rc.Type=Ac,Rc.FIXED=new Ac("FIXED"),Rc.FLOATING=new Ac("FLOATING"),Rc.FLOATING_SINGLE=new Ac("FLOATING SINGLE");var Bc=function t(){this._precisionModel=new Rc,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?cl(arguments[0],ul)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof Rc&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},Gc={serialVersionUID:{configurable:!0}};Bc.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new ol(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new ol(t.getMinX(),t.getMinY()),new ol(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new ol(t.getMinX(),t.getMinY()),new ol(t.getMinX(),t.getMaxY()),new ol(t.getMaxX(),t.getMaxY()),new ol(t.getMaxX(),t.getMinY()),new ol(t.getMinX(),t.getMinY())]),null)},Bc.prototype.createLineString=function(t){return t?t instanceof Array?new gc(this.getCoordinateSequenceFactory().create(t),this):cl(t,xl)?new gc(t,this):void 0:new gc(this.getCoordinateSequenceFactory().create([]),this)},Bc.prototype.createMultiLineString=function(t){return 0===arguments.length?new nc(null,this):1===arguments.length?new nc(t,this):void 0},Bc.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(Bc.toGeometryArray(t));var a=t.iterator().next();if(1<t.size()){if(a instanceof vc)return this.createMultiPolygon(Bc.toPolygonArray(t));if(a instanceof gc)return this.createMultiLineString(Bc.toLineStringArray(t));if(a instanceof _c)return this.createMultiPoint(Bc.toPointArray(t));ql.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},Bc.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},Bc.prototype.createPoint=function(t){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(t instanceof ol){var e=t;return this.createPoint(null!==e?this.getCoordinateSequenceFactory().create([e]):null)}if(cl(t,xl))return new _c(t,this)}},Bc.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},Bc.prototype.createPolygon=function(t,e){if(0===arguments.length)return new vc(null,null,this);if(1===arguments.length){if(cl(t,xl)){var n=t;return this.createPolygon(this.createLinearRing(n))}if(t instanceof Array){var i=t;return this.createPolygon(this.createLinearRing(i))}if(t instanceof xc){var r=t;return this.createPolygon(r,null)}}else if(2===arguments.length){return new vc(t,e,this)}},Bc.prototype.getSRID=function(){return this._SRID},Bc.prototype.createGeometryCollection=function(t){return 0===arguments.length?new ec(null,this):1===arguments.length?new ec(t,this):void 0},Bc.prototype.createGeometry=function(t){return new mc(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},Bc.prototype.getPrecisionModel=function(){return this._precisionModel},Bc.prototype.createLinearRing=function(t){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(t instanceof Array){var e=t;return this.createLinearRing(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(cl(t,xl))return new xc(t,this)}},Bc.prototype.createMultiPolygon=function(t){return 0===arguments.length?new Ec(null,this):1===arguments.length?new Ec(t,this):void 0},Bc.prototype.createMultiPoint=function(t){if(0===arguments.length)return new bc(null,this);if(1===arguments.length){if(t instanceof Array)return new bc(t,this);if(t instanceof Array){var e=t;return this.createMultiPoint(null!==e?this.getCoordinateSequenceFactory().create(e):null)}if(cl(t,xl)){var n=t;if(null===n)return this.createMultiPoint(new Array(0).fill(null));for(var i=new Array(n.size()).fill(null),r=0;r<n.size();r++){var o=this.getCoordinateSequenceFactory().create(1,n.getDimension());fc.copy(n,r,o,0,1),i[r]=this.createPoint(o)}return this.createMultiPoint(i)}}},Bc.prototype.interfaces_=function(){return[rl]},Bc.prototype.getClass=function(){return Bc},Bc.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.getDefaultCoordinateSequenceFactory=function(){return Pc.instance()},Bc.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},Bc.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},Gc.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(Bc,Gc);function Uc(t){this.geometryFactory=t||new Bc}var jc=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"];Uc.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!qc[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==jc.indexOf(n)?qc[n].apply(this,[e.coordinates]):"GeometryCollection"===n?qc[n].apply(this,[e.geometries]):qc[n].apply(this,[e])},Uc.prototype.write=function(t){var e=t.getGeometryType();if(!zc[e])throw new Error("Geometry is not supported");return zc[e].apply(this,[t])};var qc={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!qc[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=qc.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new ol(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new ol(t[0],t[1]),new ol(t[2],t[1]),new ol(t[2],t[3]),new ol(t[0],t[3]),new ol(t[0],t[1])])},Point:function(t){var e=new ol(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(qc.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=qc.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(qc.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=qc.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=qc.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(qc.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},zc={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:zc.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=zc.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(zc.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=zc.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=zc.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=zc.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=zc.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(zc[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},Vc=function(t){this.geometryFactory=t||new Bc,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new Uc(this.geometryFactory)};Vc.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===Rc.FIXED&&this.reducePrecision(e),e},Vc.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Yc=function(){this.parser=new Uc(this.geometryFactory)};Yc.prototype.write=function(t){return this.parser.write(t)};function Hc(){}var Xc={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};function Jc(t){this.message=t||""}function Wc(){this.array_=[]}Hc.prototype.interfaces_=function(){return[]},Hc.prototype.getClass=function(){return Hc},Hc.opposite=function(t){return t===Hc.LEFT?Hc.RIGHT:t===Hc.RIGHT?Hc.LEFT:t},Xc.ON.get=function(){return 0},Xc.LEFT.get=function(){return 1},Xc.RIGHT.get=function(){return 2},Object.defineProperties(Hc,Xc),(Jc.prototype=new Error).name="EmptyStackException",(Wc.prototype=new fh).add=function(t){return this.array_.push(t),!0},Wc.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},Wc.prototype.push=function(t){return this.array_.push(t),t},Wc.prototype.pop=function(t){if(0===this.array_.length)throw new Jc;return this.array_.pop()},Wc.prototype.peek=function(){if(0===this.array_.length)throw new Jc;return this.array_[this.array_.length-1]},Wc.prototype.empty=function(){return 0===this.array_.length},Wc.prototype.isEmpty=function(){return this.empty()},Wc.prototype.search=function(t){return this.array_.indexOf(t)},Wc.prototype.size=function(){return this.array_.length},Wc.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};function Kc(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}Kc.prototype.getCoordinate=function(){return this._minCoord},Kc.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Kc.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();ql.isTrue(0<this._minIndex&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=Kl.computeOrientation(this._minCoord,n,e),r=!1;e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===Kl.COUNTERCLOCKWISE?r=!0:e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===Kl.CLOCKWISE&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Kc.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Hc.LEFT;return n[e].y<n[e+1].y&&(i=Hc.RIGHT),i},Kc.prototype.getEdge=function(){return this._orientedDe},Kc.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Kc.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Kc.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}ql.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Hc.LEFT&&(this._orientedDe=this._minDe.getSym())},Kc.prototype.interfaces_=function(){return[]},Kc.prototype.getClass=function(){return Kc};var Zc,Qc=((Zc=Fl)&&($c.__proto__=Zc),(($c.prototype=Object.create(Zc&&Zc.prototype)).constructor=$c).prototype.getCoordinate=function(){return this.pt},$c.prototype.interfaces_=function(){return[]},$c.prototype.getClass=function(){return $c},$c.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},$c);function $c(t,e){Zc.call(this,$c.msgWithCoord(t,e)),this.pt=e?new ol(e):null,this.name="TopologyException"}function tp(){this.array_=[]}tp.prototype.addLast=function(t){this.array_.push(t)},tp.prototype.removeFirst=function(){return this.array_.shift()},tp.prototype.isEmpty=function(){return 0===this.array_.length};function ep(){this._finder=null,this._dirEdgeList=new _h,this._nodes=new _h,this._rightMostCoord=null,this._env=null,this._finder=new Kc}ep.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){t.next().setVisited(!1)}},ep.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},ep.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new Qc("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},ep.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Hc.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},ep.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},ep.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();1<=e.getDepth(Hc.RIGHT)&&e.getDepth(Hc.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},ep.prototype.computeDepths=function(t){var e=new Rh,n=new tp,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},ep.prototype.compareTo=function(t){return this._rightMostCoord.x<t._rightMostCoord.x?-1:this._rightMostCoord.x>t._rightMostCoord.x?1:0},ep.prototype.getEnvelope=function(){if(null===this._env){for(var t=new Pl,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},ep.prototype.addReachable=function(t){var e=new Wc;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},ep.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Hc.LEFT,t.getDepth(Hc.RIGHT)),e.setDepth(Hc.RIGHT,t.getDepth(Hc.LEFT))},ep.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},ep.prototype.getNodes=function(){return this._nodes},ep.prototype.getDirectedEdges=function(){return this._dirEdgeList},ep.prototype.interfaces_=function(){return[el]},ep.prototype.getClass=function(){return ep};function np(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[Hc.ON]=e}else if(arguments[0]instanceof np){var n=arguments[0];if(this.init(n.location.length),null!==n)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.init(3),this.location[Hc.ON]=r,this.location[Hc.LEFT]=o,this.location[Hc.RIGHT]=s}}np.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},np.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==ll.NONE)return!1;return!0},np.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===ll.NONE&&(this.location[e]=t)},np.prototype.isLine=function(){return 1===this.location.length},np.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Hc.ON]=this.location[Hc.ON],e[Hc.LEFT]=ll.NONE,e[Hc.RIGHT]=ll.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===ll.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},np.prototype.getLocations=function(){return this.location},np.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Hc.LEFT];this.location[Hc.LEFT]=this.location[Hc.RIGHT],this.location[Hc.RIGHT]=t},np.prototype.toString=function(){var t=new dl;return 1<this.location.length&&t.append(ll.toLocationSymbol(this.location[Hc.LEFT])),t.append(ll.toLocationSymbol(this.location[Hc.ON])),1<this.location.length&&t.append(ll.toLocationSymbol(this.location[Hc.RIGHT])),t.toString()},np.prototype.setLocations=function(t,e,n){this.location[Hc.ON]=t,this.location[Hc.LEFT]=e,this.location[Hc.RIGHT]=n},np.prototype.get=function(t){return t<this.location.length?this.location[t]:ll.NONE},np.prototype.isArea=function(){return 1<this.location.length},np.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===ll.NONE)return!0;return!1},np.prototype.setLocation=function(t,e){if(1===arguments.length){var n=t;this.setLocation(Hc.ON,n)}else if(2===arguments.length){var i=t,r=e;this.location[i]=r}},np.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(ll.NONE)},np.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},np.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},np.prototype.interfaces_=function(){return[]},np.prototype.getClass=function(){return np};function ip(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new np(t),this.elt[1]=new np(t)}else if(arguments[0]instanceof ip){var e=arguments[0];this.elt[0]=new np(e.elt[0]),this.elt[1]=new np(e.elt[1])}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.elt[0]=new np(ll.NONE),this.elt[1]=new np(ll.NONE),this.elt[n].setLocation(i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this.elt[0]=new np(r,o,s),this.elt[1]=new np(r,o,s)}else if(4===arguments.length){var a=arguments[0],u=arguments[1],l=arguments[2],h=arguments[3];this.elt[0]=new np(ll.NONE,ll.NONE,ll.NONE),this.elt[1]=new np(ll.NONE,ll.NONE,ll.NONE),this.elt[a].setLocations(u,l,h)}}ip.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},ip.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},ip.prototype.isNull=function(t){return this.elt[t].isNull()},ip.prototype.setAllLocationsIfNull=function(t,e){if(1===arguments.length){var n=t;this.setAllLocationsIfNull(0,n),this.setAllLocationsIfNull(1,n)}else if(2===arguments.length){var i=t,r=e;this.elt[i].setAllLocationsIfNull(r)}},ip.prototype.isLine=function(t){return this.elt[t].isLine()},ip.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new np(t.elt[e]):this.elt[e].merge(t.elt[e])},ip.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},ip.prototype.getLocation=function(t,e){if(1===arguments.length){var n=t;return this.elt[n].get(Hc.ON)}if(2===arguments.length){var i=t,r=e;return this.elt[i].get(r)}},ip.prototype.toString=function(){var t=new dl;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},ip.prototype.isArea=function(t){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var e=t;return this.elt[e].isArea()}},ip.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},ip.prototype.setLocation=function(t,e,n){if(2===arguments.length){var i=t,r=e;this.elt[i].setLocation(Hc.ON,r)}else if(3===arguments.length){var o=t,s=e,a=n;this.elt[o].setLocation(s,a)}},ip.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},ip.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},ip.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new np(this.elt[t].location[0]))},ip.prototype.interfaces_=function(){return[]},ip.prototype.getClass=function(){return ip},ip.toLineLabel=function(t){for(var e=new ip(ll.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};function rp(t,e){this._startDe=null,this._maxNodeDegree=-1,this._edges=new _h,this._pts=new _h,this._label=new ip(ll.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new _h,this._geometryFactory=null;var n=t,i=e;this._geometryFactory=i,this.computePoints(n),this.computeRing()}rp.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=Kl.isCCW(this._ring.getCoordinates())},rp.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},rp.prototype.computePoints=function(t){var e=this._startDe=t,n=!0;do{if(null===e)throw new Qc("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Qc("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();ql.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},rp.prototype.getLinearRing=function(){return this._ring},rp.prototype.getCoordinate=function(t){return this._pts.get(t)},rp.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},rp.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;0<=a;a--)this._pts.add(i[a])}},rp.prototype.isHole=function(){return this._isHole},rp.prototype.setInResult=function(){for(var t=this._startDe;t.getEdge().setInResult(!0),(t=t.getNext())!==this._startDe;);},rp.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!Kl.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();){if(n.next().containsPoint(t))return!1}return!0},rp.prototype.addHole=function(t){this._holes.add(t)},rp.prototype.isShell=function(){return null===this._shell},rp.prototype.getLabel=function(){return this._label},rp.prototype.getEdges=function(){return this._edges},rp.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},rp.prototype.getShell=function(){return this._shell},rp.prototype.mergeLabel=function(t,e){if(1===arguments.length){var n=t;this.mergeLabel(n,0),this.mergeLabel(n,1)}else if(2===arguments.length){var i=e,r=t.getLocation(i,Hc.RIGHT);if(r===ll.NONE)return null;if(this._label.getLocation(i)===ll.NONE)return this._label.setLocation(i,r),null}},rp.prototype.setShell=function(t){null!==(this._shell=t)&&t.addHole(this)},rp.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},rp.prototype.interfaces_=function(){return[]},rp.prototype.getClass=function(){return rp};var op,sp=((op=rp)&&(ap.__proto__=op),((ap.prototype=Object.create(op&&op.prototype)).constructor=ap).prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},ap.prototype.getNext=function(t){return t.getNextMin()},ap.prototype.interfaces_=function(){return[]},ap.prototype.getClass=function(){return ap},ap);function ap(){var t=arguments[0],e=arguments[1];op.call(this,t,e)}var up,lp=((up=rp)&&(hp.__proto__=up),((hp.prototype=Object.create(up&&up.prototype)).constructor=hp).prototype.buildMinimalRings=function(){var t=new _h,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new sp(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},hp.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},hp.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){for(var t=this._startDe;t.getNode().getEdges().linkMinimalDirectedEdges(this),(t=t.getNext())!==this._startDe;);},hp.prototype.getNext=function(t){return t.getNext()},hp.prototype.interfaces_=function(){return[]},hp.prototype.getClass=function(){return hp},hp);function hp(){var t=arguments[0],e=arguments[1];up.call(this,t,e)}function cp(t){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0!==arguments.length&&1===arguments.length){var e=t;this._label=e}}cp.prototype.setVisited=function(t){this._isVisited=t},cp.prototype.setInResult=function(t){this._isInResult=t},cp.prototype.isCovered=function(){return this._isCovered},cp.prototype.isCoveredSet=function(){return this._isCoveredSet},cp.prototype.setLabel=function(t){this._label=t},cp.prototype.getLabel=function(){return this._label},cp.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},cp.prototype.updateIM=function(t){ql.isTrue(2<=this._label.getGeometryCount(),"found partial label"),this.computeIM(t)},cp.prototype.isInResult=function(){return this._isInResult},cp.prototype.isVisited=function(){return this._isVisited},cp.prototype.interfaces_=function(){return[]},cp.prototype.getClass=function(){return cp};var pp,fp=((pp=cp)&&(dp.__proto__=pp),((dp.prototype=Object.create(pp&&pp.prototype)).constructor=dp).prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},dp.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},dp.prototype.getCoordinate=function(){return this._coord},dp.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},dp.prototype.computeIM=function(){},dp.prototype.computeMergedLocation=function(t,e){var n=ll.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==ll.BOUNDARY&&(n=i)}return n},dp.prototype.setLabel=function(t,e){if(2!==arguments.length)return pp.prototype.setLabel.apply(this,arguments);var n=t,i=e;null===this._label?this._label=new ip(n,i):this._label.setLocation(n,i)},dp.prototype.getEdges=function(){return this._edges},dp.prototype.mergeLabel=function(t){if(t instanceof dp){var e=t;this.mergeLabel(e._label)}else if(t instanceof ip)for(var n=t,i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===ll.NONE&&this._label.setLocation(i,r)}},dp.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},dp.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=ll.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case ll.BOUNDARY:n=ll.INTERIOR;break;case ll.INTERIOR:default:n=ll.BOUNDARY}this._label.setLocation(t,n)},dp.prototype.interfaces_=function(){return[]},dp.prototype.getClass=function(){return dp},dp);function dp(){pp.call(this),this._coord=null,this._edges=null;var t=arguments[0],e=arguments[1];this._coord=t,this._edges=e,this._label=new ip(0,ll.NONE)}function gp(t){this.nodeMap=new Yh,this.nodeFact=null;var e=t;this.nodeFact=e}gp.prototype.find=function(t){return this.nodeMap.get(t)},gp.prototype.addNode=function(t){if(t instanceof ol){var e=t,n=this.nodeMap.get(e);return null===n&&(n=this.nodeFact.createNode(e),this.nodeMap.put(e,n)),n}if(t instanceof fp){var i=t,r=this.nodeMap.get(i.getCoordinate());return null===r?(this.nodeMap.put(i.getCoordinate(),i),i):(r.mergeLabel(i),r)}},gp.prototype.print=function(t){for(var e=this.iterator();e.hasNext();){e.next().print(t)}},gp.prototype.iterator=function(){return this.nodeMap.values().iterator()},gp.prototype.values=function(){return this.nodeMap.values()},gp.prototype.getBoundaryNodes=function(t){for(var e=new _h,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===ll.BOUNDARY&&e.add(i)}return e},gp.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},gp.prototype.interfaces_=function(){return[]},gp.prototype.getClass=function(){return gp};function yp(){}var _p={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};yp.prototype.interfaces_=function(){return[]},yp.prototype.getClass=function(){return yp},yp.isNorthern=function(t){return t===yp.NE||t===yp.NW},yp.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},yp.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(e<t?t:e)?3:n},yp.isInHalfPlane=function(t,e){return e===yp.SE?t===yp.SE||t===yp.SW:t===e||t===e+1},yp.quadrant=function(t,e){if("number"==typeof t&&"number"==typeof e){var n=t,i=e;if(0===n&&0===i)throw new Qu("Cannot compute the quadrant for point ( "+n+", "+i+" )");return 0<=n?0<=i?yp.NE:yp.SE:0<=i?yp.NW:yp.SW}if(t instanceof ol&&e instanceof ol){var r=t,o=e;if(o.x===r.x&&o.y===r.y)throw new Qu("Cannot compute the quadrant for two identical points "+r);return o.x>=r.x?o.y>=r.y?yp.NE:yp.SE:o.y>=r.y?yp.NW:yp.SW}},_p.NE.get=function(){return 0},_p.NW.get=function(){return 1},_p.SW.get=function(){return 2},_p.SE.get=function(){return 3},Object.defineProperties(yp,_p);function mp(t,e,n,i){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var r=t;this._edge=r}else if(3===arguments.length){var o=t,s=e,a=n;this._edge=o,this.init(s,a),this._label=null}else if(4===arguments.length){var u=t,l=e,h=n,c=i;this._edge=u,this.init(l,h),this._label=c}}mp.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:Kl.computeOrientation(t._p0,t._p1,this._p1)},mp.prototype.getDy=function(){return this._dy},mp.prototype.getCoordinate=function(){return this._p0},mp.prototype.setNode=function(t){this._node=t},mp.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},mp.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},mp.prototype.getDirectedCoordinate=function(){return this._p1},mp.prototype.getDx=function(){return this._dx},mp.prototype.getLabel=function(){return this._label},mp.prototype.getEdge=function(){return this._edge},mp.prototype.getQuadrant=function(){return this._quadrant},mp.prototype.getNode=function(){return this._node},mp.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},mp.prototype.computeLabel=function(){},mp.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=yp.quadrant(this._dx,this._dy),ql.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},mp.prototype.interfaces_=function(){return[el]},mp.prototype.getClass=function(){return mp};var vp,bp=((vp=mp)&&(xp.__proto__=vp),((xp.prototype=Object.create(vp&&vp.prototype)).constructor=xp).prototype.getNextMin=function(){return this._nextMin},xp.prototype.getDepth=function(t){return this._depth[t]},xp.prototype.setVisited=function(t){this._isVisited=t},xp.prototype.computeDirectedLabel=function(){this._label=new ip(this._edge.getLabel()),this._isForward||this._label.flip()},xp.prototype.getNext=function(){return this._next},xp.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Qc("assigned depths do not match",this.getCoordinate());this._depth[t]=e},xp.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Hc.LEFT)===ll.INTERIOR&&this._label.getLocation(e,Hc.RIGHT)===ll.INTERIOR||(t=!1);return t},xp.prototype.setNextMin=function(t){this._nextMin=t},xp.prototype.print=function(t){vp.prototype.print.call(this,t),t.print(" "+this._depth[Hc.LEFT]+"/"+this._depth[Hc.RIGHT]),t.print(" ("+this.getDepthDelta()+")"),this._isInResult&&t.print(" inResult")},xp.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},xp.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,ll.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,ll.EXTERIOR);return t&&e&&n},xp.prototype.setEdgeRing=function(t){this._edgeRing=t},xp.prototype.getMinEdgeRing=function(){return this._minEdgeRing},xp.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},xp.prototype.setInResult=function(t){this._isInResult=t},xp.prototype.getSym=function(){return this._sym},xp.prototype.isForward=function(){return this._isForward},xp.prototype.getEdge=function(){return this._edge},xp.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},xp.prototype.setSym=function(t){this._sym=t},xp.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},xp.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Hc.LEFT&&(i=-1);var r=Hc.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},xp.prototype.getEdgeRing=function(){return this._edgeRing},xp.prototype.isInResult=function(){return this._isInResult},xp.prototype.setNext=function(t){this._next=t},xp.prototype.isVisited=function(){return this._isVisited},xp.prototype.interfaces_=function(){return[]},xp.prototype.getClass=function(){return xp},xp.depthFactor=function(t,e){return t===ll.EXTERIOR&&e===ll.INTERIOR?1:t===ll.INTERIOR&&e===ll.EXTERIOR?-1:0},xp);function xp(){var t=arguments[0],e=arguments[1];if(vp.call(this,t),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=e)this.init(t.getCoordinate(0),t.getCoordinate(1));else{var n=t.getNumPoints()-1;this.init(t.getCoordinate(n),t.getCoordinate(n-1))}this.computeDirectedLabel()}function Ep(){}Ep.prototype.createNode=function(t){return new fp(t,null)},Ep.prototype.interfaces_=function(){return[]},Ep.prototype.getClass=function(){return Ep};function Ip(t){if(this._edges=new _h,this._nodes=null,this._edgeEndList=new _h,0===arguments.length)this._nodes=new gp(new Ep);else if(1===arguments.length){var e=t;this._nodes=new gp(e)}}Ip.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},Ip.prototype.find=function(t){return this._nodes.find(t)},Ip.prototype.addNode=function(t){if(t instanceof fp){var e=t;return this._nodes.addNode(e)}if(t instanceof ol){var n=t;return this._nodes.addNode(n)}},Ip.prototype.getNodeIterator=function(){return this._nodes.iterator()},Ip.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkResultDirectedEdges()}},Ip.prototype.debugPrintln=function(t){Ml.out.println(t)},Ip.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===ll.BOUNDARY},Ip.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();){t.next().getEdges().linkAllDirectedEdges()}},Ip.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&(Kl.computeOrientation(t,e,i)===Kl.COLLINEAR&&yp.quadrant(t,e)===yp.quadrant(n,i))},Ip.prototype.getEdgeEnds=function(){return this._edgeEndList},Ip.prototype.debugPrint=function(t){Ml.out.print(t)},Ip.prototype.getEdgeIterator=function(){return this._edges.iterator()},Ip.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},Ip.prototype.insertEdge=function(t){this._edges.add(t)},Ip.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},Ip.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new bp(n,!0),r=new bp(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},Ip.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},Ip.prototype.getNodes=function(){return this._nodes.values()},Ip.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},Ip.prototype.interfaces_=function(){return[]},Ip.prototype.getClass=function(){return Ip},Ip.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();){e.next().getEdges().linkResultDirectedEdges()}};function Lp(t){this._geometryFactory=null,this._shellList=new _h;var e=t;this._geometryFactory=e}Lp.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},Lp.prototype.computePolygons=function(t){for(var e=new _h,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},Lp.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new Qc("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},Lp.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new _h,r=t.iterator();r.hasNext();){var o=r.next();if(2<o.getMaxNodeDegree()){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},Lp.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();){if(e.next().containsPoint(t))return!0}return!1},Lp.prototype.buildMaximalEdgeRings=function(t){for(var e=new _h,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new lp(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},Lp.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},Lp.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},Lp.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var u=a.next(),l=u.getLinearRing(),h=l.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var c=!1;h.contains(i)&&Kl.isPointInRing(r,l.getCoordinates())&&(c=!0),c&&(null!==o&&!s.contains(h)||(o=u))}return o},Lp.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return ql.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},Lp.prototype.add=function(t,e){if(1===arguments.length){var n=t;this.add(n.getEdgeEnds(),n.getNodes())}else if(2===arguments.length){var i=t;Ip.linkResultDirectedEdges(e);var r=this.buildMaximalEdgeRings(i),o=new _h,s=this.buildMinimalEdgeRings(r,this._shellList,o);this.sortShellsAndHoles(s,this._shellList,o),this.placeFreeHoles(this._shellList,o)}},Lp.prototype.interfaces_=function(){return[]},Lp.prototype.getClass=function(){return Lp};function wp(){}wp.prototype.getBounds=function(){},wp.prototype.interfaces_=function(){return[]},wp.prototype.getClass=function(){return wp};function Sp(t,e){this._bounds=null,this._item=null;var n=t,i=e;this._bounds=n,this._item=i}Sp.prototype.getItem=function(){return this._item},Sp.prototype.getBounds=function(){return this._bounds},Sp.prototype.interfaces_=function(){return[wp,rl]},Sp.prototype.getClass=function(){return Sp};function Mp(){this._size=null,this._items=null,this._size=0,this._items=new _h,this._items.add(null)}Mp.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),--this._size,this.reorder(1),t},Mp.prototype.size=function(){return this._size},Mp.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Mp.prototype.clear=function(){this._size=0,this._items.clear()},Mp.prototype.isEmpty=function(){return 0===this._size},Mp.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Mp.prototype.interfaces_=function(){return[]},Mp.prototype.getClass=function(){return Mp};function Cp(){}Cp.prototype.visitItem=function(){},Cp.prototype.interfaces_=function(){return[]},Cp.prototype.getClass=function(){return Cp};function Pp(){}Pp.prototype.insert=function(){},Pp.prototype.remove=function(){},Pp.prototype.query=function(){},Pp.prototype.interfaces_=function(){return[]},Pp.prototype.getClass=function(){return Pp};function Np(t){if(this._childBoundables=new _h,this._bounds=null,this._level=null,0!==arguments.length&&1===arguments.length){var e=t;this._level=e}}var Op={serialVersionUID:{configurable:!0}};Np.prototype.getLevel=function(){return this._level},Np.prototype.size=function(){return this._childBoundables.size()},Np.prototype.getChildBoundables=function(){return this._childBoundables},Np.prototype.addChildBoundable=function(t){ql.isTrue(null===this._bounds),this._childBoundables.add(t)},Np.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},Np.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},Np.prototype.interfaces_=function(){return[wp,rl]},Np.prototype.getClass=function(){return Np},Op.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties(Np,Op);function Tp(){}Tp.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Tp.min=function(t){return Tp.sort(t),t.get(0)},Tp.sort=function(t,e){var n=t.toArray();e?Kh.sort(n,e):Kh.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},Tp.singletonList=function(t){var e=new _h;return e.add(t),e};function kp(t,e,n){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var i=t,r=e,o=n;this._boundable1=i,this._boundable2=r,this._itemDistance=o,this._distance=this.distance()}kp.prototype.expandToQueue=function(t,e){var n=kp.isComposite(this._boundable1),i=kp.isComposite(this._boundable2);if(n&&i)return kp.area(this._boundable1)>kp.area(this._boundable2)?this.expand(this._boundable1,this._boundable2,t,e):this.expand(this._boundable2,this._boundable1,t,e),null;if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new Qu("neither boundable is composite")},kp.prototype.isLeaves=function(){return!(kp.isComposite(this._boundable1)||kp.isComposite(this._boundable2))},kp.prototype.compareTo=function(t){return this._distance<t._distance?-1:this._distance>t._distance?1:0},kp.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new kp(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},kp.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},kp.prototype.getDistance=function(){return this._distance},kp.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},kp.prototype.interfaces_=function(){return[el]},kp.prototype.getClass=function(){return kp},kp.area=function(t){return t.getBounds().getArea()},kp.isComposite=function(t){return t instanceof Np};function Rp(){if(this._root=null,this._built=!1,this._itemBoundables=new _h,this._nodeCapacity=null,0===arguments.length){var t=Rp.DEFAULT_NODE_CAPACITY;this._nodeCapacity=t}else if(1===arguments.length){var e=arguments[0];ql.isTrue(1<e,"Node capacity must be greater than 1"),this._nodeCapacity=e}}var Dp={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Rp.prototype.getNodeCapacity=function(){return this._nodeCapacity},Rp.prototype.lastNode=function(t){return t.get(t.size()-1)},Rp.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof Np?t+=this.size(n):n instanceof Sp&&(t+=1)}return t}},Rp.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Sp&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},Rp.prototype.itemsTree=function(t){if(0===arguments.length){this.build();var e=this.itemsTree(this._root);return null===e?new _h:e}if(1===arguments.length){for(var n=t,i=new _h,r=n.getChildBoundables().iterator();r.hasNext();){var o=r.next();if(o instanceof Np){var s=this.itemsTree(o);null!==s&&i.add(s)}else o instanceof Sp?i.add(o.getItem()):ql.shouldNeverReachHere()}return i.size()<=0?null:i}},Rp.prototype.insert=function(t,e){ql.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Sp(t,e))},Rp.prototype.boundablesAtLevel=function(t,e,n){if(1===arguments.length){var i=t,r=new _h;return this.boundablesAtLevel(i,this._root,r),r}if(3===arguments.length){var o=t,s=e,a=n;if(ql.isTrue(-2<o),s.getLevel()===o)return a.add(s),null;for(var u=s.getChildBoundables().iterator();u.hasNext();){var l=u.next();l instanceof Np?this.boundablesAtLevel(o,l,a):(ql.isTrue(l instanceof Sp),-1===o&&a.add(l))}return null}},Rp.prototype.query=function(t,e,n){if(1===arguments.length){var i=t;this.build();var r=new _h;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.query(i,this._root,r),r}if(2===arguments.length){var o=t,s=e;if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.query(o,this._root,s)}else if(3===arguments.length)if(cl(n,Cp)&&t instanceof Object&&e instanceof Np)for(var a=t,u=n,l=e.getChildBoundables(),h=0;h<l.size();h++){var c=l.get(h);this.getIntersectsOp().intersects(c.getBounds(),a)&&(c instanceof Np?this.query(a,c,u):c instanceof Sp?u.visitItem(c.getItem()):ql.shouldNeverReachHere())}else if(cl(n,fh)&&t instanceof Object&&e instanceof Np)for(var p=t,f=n,d=e.getChildBoundables(),g=0;g<d.size();g++){var y=d.get(g);this.getIntersectsOp().intersects(y.getBounds(),p)&&(y instanceof Np?this.query(p,y,f):y instanceof Sp?f.add(y.getItem()):ql.shouldNeverReachHere())}},Rp.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},Rp.prototype.getRoot=function(){return this.build(),this._root},Rp.prototype.remove=function(t,e,n){if(2===arguments.length){var i=t,r=e;return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.remove(i,this._root,r)}if(3===arguments.length){var o=t,s=e,a=n,u=this.removeItem(s,a);if(u)return!0;for(var l=null,h=s.getChildBoundables().iterator();h.hasNext();){var c=h.next();if(this.getIntersectsOp().intersects(c.getBounds(),o)&&(c instanceof Np&&(u=this.remove(o,c,a)))){l=c;break}}return null!==l&&l.getChildBoundables().isEmpty()&&s.getChildBoundables().remove(l),u}},Rp.prototype.createHigherLevels=function(t,e){ql.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},Rp.prototype.depth=function(t){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var e=0,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();if(i instanceof Np){var r=this.depth(i);e<r&&(e=r)}}return e+1}},Rp.prototype.createParentBoundables=function(t,e){ql.isTrue(!t.isEmpty());var n=new _h;n.add(this.createNode(e));var i=new _h(t);Tp.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},Rp.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},Rp.prototype.interfaces_=function(){return[rl]},Rp.prototype.getClass=function(){return Rp},Rp.compareDoubles=function(t,e){return e<t?1:t<e?-1:0},Dp.IntersectsOp.get=function(){return Fp},Dp.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},Dp.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(Rp,Dp);function Ap(){}var Fp=function(){};Ap.prototype.distance=function(){},Ap.prototype.interfaces_=function(){return[]},Ap.prototype.getClass=function(){return Ap};var Bp,Gp=function(p){function m(t){t=t||m.DEFAULT_NODE_CAPACITY,p.call(this,t)}p&&(m.__proto__=p);var t={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return((m.prototype=Object.create(p&&p.prototype)).constructor=m).prototype.createParentBoundablesFromVerticalSlices=function(t,e){ql.isTrue(0<t.length);for(var n=new _h,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},m.prototype.createNode=function(t){return new Up(t)},m.prototype.size=function(){return 0===arguments.length?p.prototype.size.call(this):p.prototype.size.apply(this,arguments)},m.prototype.insert=function(t,e){if(2!==arguments.length)return p.prototype.insert.apply(this,arguments);var n=t,i=e;if(n.isNull())return null;p.prototype.insert.call(this,n,i)},m.prototype.getIntersectsOp=function(){return m.intersectsOp},m.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new _h;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},m.prototype.query=function(t,e,n){if(1===arguments.length){var i=t;return p.prototype.query.call(this,i)}if(2===arguments.length){var r=t,o=e;p.prototype.query.call(this,r,o)}else if(3===arguments.length)if(cl(n,Cp)&&t instanceof Object&&e instanceof Np){var s=t,a=e,u=n;p.prototype.query.call(this,s,a,u)}else if(cl(n,fh)&&t instanceof Object&&e instanceof Np){var l=t,h=e,c=n;p.prototype.query.call(this,l,h,c)}},m.prototype.getComparator=function(){return m.yComparator},m.prototype.createParentBoundablesFromVerticalSlice=function(t,e){return p.prototype.createParentBoundables.call(this,t,e)},m.prototype.remove=function(t,e){if(2!==arguments.length)return p.prototype.remove.apply(this,arguments);var n=t,i=e;return p.prototype.remove.call(this,n,i)},m.prototype.depth=function(){return 0===arguments.length?p.prototype.depth.call(this):p.prototype.depth.apply(this,arguments)},m.prototype.createParentBoundables=function(t,e){ql.isTrue(!t.isEmpty());var n=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),i=new _h(t);Tp.sort(i,m.xComparator);var r=this.verticalSlices(i,Math.trunc(Math.ceil(Math.sqrt(n))));return this.createParentBoundablesFromVerticalSlices(r,e)},m.prototype.nearestNeighbour=function(t,e,n){if(1===arguments.length){if(cl(t,Ap)){var i=t,r=new kp(this.getRoot(),this.getRoot(),i);return this.nearestNeighbour(r)}if(t instanceof kp){var o=t;return this.nearestNeighbour(o,$u.POSITIVE_INFINITY)}}else if(2===arguments.length){if(t instanceof m&&cl(e,Ap)){var s=t,a=e,u=new kp(this.getRoot(),s.getRoot(),a);return this.nearestNeighbour(u)}if(t instanceof kp&&"number"==typeof e){var l=t,h=e,c=null,p=new Mp;for(p.add(l);!p.isEmpty()&&0<h;){var f=p.poll(),d=f.getDistance();if(h<=d)break;f.isLeaves()?(h=d,c=f):f.expandToQueue(p,h)}return[c.getBoundable(0).getItem(),c.getBoundable(1).getItem()]}}else if(3===arguments.length){var g=n,y=new Sp(t,e),_=new kp(this.getRoot(),y,g);return this.nearestNeighbour(_)[0]}},m.prototype.interfaces_=function(){return[Pp,rl]},m.prototype.getClass=function(){return m},m.centreX=function(t){return m.avg(t.getMinX(),t.getMaxX())},m.avg=function(t,e){return(t+e)/2},m.centreY=function(t){return m.avg(t.getMinY(),t.getMaxY())},t.STRtreeNode.get=function(){return Up},t.serialVersionUID.get=function(){return 0x39920f7d5f261e0},t.xComparator.get=function(){return{interfaces_:function(){return[il]},compare:function(t,e){return p.compareDoubles(m.centreX(t.getBounds()),m.centreX(e.getBounds()))}}},t.yComparator.get=function(){return{interfaces_:function(){return[il]},compare:function(t,e){return p.compareDoubles(m.centreY(t.getBounds()),m.centreY(e.getBounds()))}}},t.intersectsOp.get=function(){return{interfaces_:function(){return[p.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},t.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(m,t),m}(Rp),Up=((Bp=Np)&&(jp.__proto__=Bp),((jp.prototype=Object.create(Bp&&Bp.prototype)).constructor=jp).prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new Pl(n.getBounds()):t.expandToInclude(n.getBounds())}return t},jp.prototype.interfaces_=function(){return[]},jp.prototype.getClass=function(){return jp},jp);function jp(){var t=arguments[0];Bp.call(this,t)}function qp(){}qp.prototype.interfaces_=function(){return[]},qp.prototype.getClass=function(){return qp},qp.relativeSign=function(t,e){return t<e?-1:e<t?1:0},qp.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=qp.relativeSign(e.x,n.x),r=qp.relativeSign(e.y,n.y);switch(t){case 0:return qp.compareValue(i,r);case 1:return qp.compareValue(r,i);case 2:return qp.compareValue(r,-i);case 3:return qp.compareValue(-i,r);case 4:return qp.compareValue(-i,-r);case 5:return qp.compareValue(-r,-i);case 6:return qp.compareValue(-r,i);case 7:return qp.compareValue(i,-r)}return ql.shouldNeverReachHere("invalid octant value"),0},qp.compareValue=function(t,e){return t<0?-1:0<t?1:e<0?-1:0<e?1:0};function zp(t,e,n,i){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var r=t,o=e,s=n,a=i;this._segString=r,this.coord=new ol(o),this.segmentIndex=s,this._segmentOctant=a,this._isInterior=!o.equals2D(r.getCoordinate(s))}zp.prototype.getCoordinate=function(){return this.coord},zp.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},zp.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:qp.compare(this._segmentOctant,this.coord,e.coord)},zp.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},zp.prototype.isInterior=function(){return this._isInterior},zp.prototype.interfaces_=function(){return[el]},zp.prototype.getClass=function(){return zp};function Vp(t){this._nodeMap=new Yh,this._edge=null;var e=t;this._edge=e}Vp.prototype.getSplitCoordinates=function(){var t=new Ih;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},Vp.prototype.addCollapsedNodes=function(){var t=new _h;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},Vp.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},Vp.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new gl(e+1))}},Vp.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new ol(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new ol(e.coord))},Vp.prototype.iterator=function(){return this._nodeMap.values().iterator()},Vp.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Vp.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},Vp.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new gl(e[0])),i=r}},Vp.prototype.getEdge=function(){return this._edge},Vp.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},Vp.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new ol(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new ol(e.coord)),new Jp(o,this._edge.getData())},Vp.prototype.add=function(t,e){var n=new zp(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(ql.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},Vp.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new Fl("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new Fl("bad split edge end point at "+r)},Vp.prototype.interfaces_=function(){return[]},Vp.prototype.getClass=function(){return Vp};function Yp(){}Yp.prototype.interfaces_=function(){return[]},Yp.prototype.getClass=function(){return Yp},Yp.octant=function(t,e){if("number"==typeof t&&"number"==typeof e){var n=t,i=e;if(0===n&&0===i)throw new Qu("Cannot compute the octant for point ( "+n+", "+i+" )");var r=Math.abs(n),o=Math.abs(i);return 0<=n?0<=i?o<=r?0:1:o<=r?7:6:0<=i?o<=r?3:2:o<=r?4:5}if(t instanceof ol&&e instanceof ol){var s=e.x-t.x,a=e.y-t.y;if(0==s&&0==a)throw new Qu("Cannot compute the octant for two identical points "+t);return Yp.octant(s,a)}};function Hp(){}Hp.prototype.getCoordinates=function(){},Hp.prototype.size=function(){},Hp.prototype.getCoordinate=function(){},Hp.prototype.isClosed=function(){},Hp.prototype.setData=function(){},Hp.prototype.getData=function(){},Hp.prototype.interfaces_=function(){return[]},Hp.prototype.getClass=function(){return Hp};function Xp(){}Xp.prototype.addIntersection=function(){},Xp.prototype.interfaces_=function(){return[Hp]},Xp.prototype.getClass=function(){return Xp};var Jp=function(t,e){this._nodeList=new Vp(this),this._pts=null,this._data=null;var n=t,i=e;this._pts=n,this._data=i};Jp.prototype.getCoordinates=function(){return this._pts},Jp.prototype.size=function(){return this._pts.length},Jp.prototype.getCoordinate=function(t){return this._pts[t]},Jp.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Jp.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},Jp.prototype.setData=function(t){this._data=t},Jp.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:Yp.octant(t,e)},Jp.prototype.getData=function(){return this._data},Jp.prototype.addIntersection=function(t,e,n,i){if(2===arguments.length){var r=t,o=e;this.addIntersectionNode(r,o)}else if(4===arguments.length){var s=e,a=i,u=new ol(t.getIntersection(a));this.addIntersection(u,s)}},Jp.prototype.toString=function(){return kl.toLineString(new Mc(this._pts))},Jp.prototype.getNodeList=function(){return this._nodeList},Jp.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},Jp.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},Jp.prototype.interfaces_=function(){return[Xp]},Jp.prototype.getClass=function(){return Jp},Jp.getNodedSubstrings=function(t,e){if(1===arguments.length){var n=t,i=new _h;return Jp.getNodedSubstrings(n,i),i}if(2===arguments.length)for(var r=e,o=t.iterator();o.hasNext();){o.next().getNodeList().addSplitEdges(r)}};function Wp(t,e,n,i){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new ol,this.p1=new ol;else if(1===arguments.length){var r=t;this.p0=new ol(r.p0),this.p1=new ol(r.p1)}else if(2===arguments.length)this.p0=t,this.p1=e;else if(4===arguments.length){var o=t,s=e,a=n,u=i;this.p0=new ol(o,s),this.p1=new ol(a,u)}}var Kp={serialVersionUID:{configurable:!0}};Wp.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},Wp.prototype.orientationIndex=function(t){if(t instanceof Wp){var e=t,n=Kl.orientationIndex(this.p0,this.p1,e.p0),i=Kl.orientationIndex(this.p0,this.p1,e.p1);return 0<=n&&0<=i?Math.max(n,i):n<=0&&i<=0?Math.max(n,i):0}if(t instanceof ol){var r=t;return Kl.orientationIndex(this.p0,this.p1,r)}},Wp.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},Wp.prototype.isVertical=function(){return this.p0.x===this.p1.x},Wp.prototype.equals=function(t){if(!(t instanceof Wp))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},Wp.prototype.intersection=function(t){var e=new Hl;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},Wp.prototype.project=function(t){if(t instanceof ol){var e=t;if(e.equals(this.p0)||e.equals(this.p1))return new ol(e);var n=this.projectionFactor(e),i=new ol;return i.x=this.p0.x+n*(this.p1.x-this.p0.x),i.y=this.p0.y+n*(this.p1.y-this.p0.y),i}if(t instanceof Wp){var r=t,o=this.projectionFactor(r.p0),s=this.projectionFactor(r.p1);if(1<=o&&1<=s)return null;if(o<=0&&s<=0)return null;var a=this.project(r.p0);o<0&&(a=this.p0),1<o&&(a=this.p1);var u=this.project(r.p1);return s<0&&(u=this.p0),1<s&&(u=this.p1),new Wp(a,u)}},Wp.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},Wp.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},Wp.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},Wp.prototype.distancePerpendicular=function(t){return Kl.distancePointLinePerpendicular(t,this.p0,this.p1)},Wp.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},Wp.prototype.midPoint=function(){return Wp.midPoint(this.p0,this.p1)},Wp.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?$u.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},Wp.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=$u.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var u=t.closestPoint(this.p1);return(r=u.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=u),n},Wp.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return 0<e&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},Wp.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},Wp.prototype.getLength=function(){return this.p0.distance(this.p1)},Wp.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},Wp.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},Wp.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},Wp.prototype.lineIntersection=function(t){try{return Cl.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof wl))throw t}return null},Wp.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},Wp.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,u=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,u=e*o/s}return new ol(n-u,i+a)},Wp.prototype.setCoordinates=function(t,e){if(1===arguments.length){this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var n=t,i=e;this.p0.x=n.x,this.p0.y=n.y,this.p1.x=i.x,this.p1.y=i.y}},Wp.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(1<e||$u.isNaN(e))&&(e=1),e},Wp.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},Wp.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},Wp.prototype.distance=function(t){if(t instanceof Wp){return Kl.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(t instanceof ol){var e=t;return Kl.distancePointLine(e,this.p0,this.p1)}},Wp.prototype.pointAlong=function(t){var e=new ol;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},Wp.prototype.hashCode=function(){var t=$u.doubleToLongBits(this.p0.x);t^=31*$u.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=$u.doubleToLongBits(this.p1.x);return n^=31*$u.doubleToLongBits(this.p1.y),e^(Math.trunc(n)^Math.trunc(n>>32))},Wp.prototype.interfaces_=function(){return[el,rl]},Wp.prototype.getClass=function(){return Wp},Wp.midPoint=function(t,e){return new ol((t.x+e.x)/2,(t.y+e.y)/2)},Kp.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(Wp,Kp);function Zp(){this.tempEnv1=new Pl,this.tempEnv2=new Pl,this._overlapSeg1=new Wp,this._overlapSeg2=new Wp}Zp.prototype.overlap=function(t,e,n,i){if(2!==arguments.length&&4===arguments.length){var r=e,o=n,s=i;t.getLineSegment(r,this._overlapSeg1),o.getLineSegment(s,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},Zp.prototype.interfaces_=function(){return[]},Zp.prototype.getClass=function(){return Zp};function Qp(t,e,n,i){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var r=t,o=e,s=n,a=i;this._pts=r,this._start=o,this._end=s,this._context=a}Qp.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},Qp.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},Qp.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},Qp.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},Qp.prototype.setId=function(t){this._id=t},Qp.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},Qp.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new Pl(t,e)}return this._env},Qp.prototype.getEndIndex=function(){return this._end},Qp.prototype.getStartIndex=function(){return this._start},Qp.prototype.getContext=function(){return this._context},Qp.prototype.getId=function(){return this._id},Qp.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],u=n._pts[i],l=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(u,l),!o.tempEnv1.intersects(o.tempEnv2))return null;var h=Math.trunc((t+e)/2),c=Math.trunc((i+r)/2);t<h&&(i<c&&this.computeOverlapsInternal(t,h,n,i,c,o),c<r&&this.computeOverlapsInternal(t,h,n,c,r,o)),h<e&&(i<c&&this.computeOverlapsInternal(h,e,n,i,c,o),c<r&&this.computeOverlapsInternal(h,e,n,c,r,o))},Qp.prototype.interfaces_=function(){return[]},Qp.prototype.getClass=function(){return Qp};function $p(){}$p.prototype.interfaces_=function(){return[]},$p.prototype.getClass=function(){return $p},$p.getChainStartIndices=function(t){var e=0,n=new _h;n.add(new gl(e));do{var i=$p.findChainEnd(t,e);n.add(new gl(i)),e=i}while(e<t.length-1);return $p.toIntArray(n)},$p.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=yp.quadrant(t[n],t[n+1]),r=e+1;r<t.length;){if(!t[r-1].equals2D(t[r]))if(yp.quadrant(t[r-1],t[r])!==i)break;r++}return r-1},$p.getChains=function(t,e){if(1===arguments.length)return $p.getChains(t,null);if(2===arguments.length){for(var n=t,i=e,r=new _h,o=$p.getChainStartIndices(n),s=0;s<o.length-1;s++){var a=new Qp(n,o[s],o[s+1],i);r.add(a)}return r}},$p.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};function tf(){}tf.prototype.computeNodes=function(){},tf.prototype.getNodedSubstrings=function(){},tf.prototype.interfaces_=function(){return[]},tf.prototype.getClass=function(){return tf};function ef(t){if(this._segInt=null,0!==arguments.length&&1===arguments.length){var e=t;this.setSegmentIntersector(e)}}ef.prototype.setSegmentIntersector=function(t){this._segInt=t},ef.prototype.interfaces_=function(){return[tf]},ef.prototype.getClass=function(){return ef};var nf,rf=function(e){function t(t){t?e.call(this,t):e.call(this),this._monoChains=new _h,this._index=new Gp,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}e&&(t.__proto__=e);var n={SegmentOverlapAction:{configurable:!0}};return((t.prototype=Object.create(e&&e.prototype)).constructor=t).prototype.getMonotoneChains=function(){return this._monoChains},t.prototype.getNodedSubstrings=function(){return Jp.getNodedSubstrings(this._nodedSegStrings)},t.prototype.getIndex=function(){return this._index},t.prototype.add=function(t){for(var e=$p.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},t.prototype.computeNodes=function(t){for(var e=(this._nodedSegStrings=t).iterator();e.hasNext();)this.add(e.next());this.intersectChains()},t.prototype.intersectChains=function(){for(var t=new of(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},t.prototype.interfaces_=function(){return[]},t.prototype.getClass=function(){return t},n.SegmentOverlapAction.get=function(){return of},Object.defineProperties(t,n),t}(ef),of=((nf=Zp)&&(sf.__proto__=nf),((sf.prototype=Object.create(nf&&nf.prototype)).constructor=sf).prototype.overlap=function(t,e,n,i){if(4!==arguments.length)return nf.prototype.overlap.apply(this,arguments);var r=e,o=n,s=i,a=t.getContext(),u=o.getContext();this._si.processIntersections(a,r,u,s)},sf.prototype.interfaces_=function(){return[]},sf.prototype.getClass=function(){return sf},sf);function sf(){nf.call(this),this._si=null;var t=arguments[0];this._si=t}function af(){if(this._quadrantSegments=af.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=af.CAP_ROUND,this._joinStyle=af.JOIN_ROUND,this._mitreLimit=af.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=af.DEFAULT_SIMPLIFY_FACTOR,0!==arguments.length)if(1===arguments.length){var t=arguments[0];this.setQuadrantSegments(t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(r),this.setJoinStyle(o),this.setMitreLimit(s)}}var uf={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};af.prototype.getEndCapStyle=function(){return this._endCapStyle},af.prototype.isSingleSided=function(){return this._isSingleSided},af.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=af.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=af.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==af.JOIN_ROUND&&(this._quadrantSegments=af.DEFAULT_QUADRANT_SEGMENTS)},af.prototype.getJoinStyle=function(){return this._joinStyle},af.prototype.setJoinStyle=function(t){this._joinStyle=t},af.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},af.prototype.getSimplifyFactor=function(){return this._simplifyFactor},af.prototype.getQuadrantSegments=function(){return this._quadrantSegments},af.prototype.setEndCapStyle=function(t){this._endCapStyle=t},af.prototype.getMitreLimit=function(){return this._mitreLimit},af.prototype.setMitreLimit=function(t){this._mitreLimit=t},af.prototype.setSingleSided=function(t){this._isSingleSided=t},af.prototype.interfaces_=function(){return[]},af.prototype.getClass=function(){return af},af.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},uf.CAP_ROUND.get=function(){return 1},uf.CAP_FLAT.get=function(){return 2},uf.CAP_SQUARE.get=function(){return 3},uf.JOIN_ROUND.get=function(){return 1},uf.JOIN_MITRE.get=function(){return 2},uf.JOIN_BEVEL.get=function(){return 3},uf.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},uf.DEFAULT_MITRE_LIMIT.get=function(){return 5},uf.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(af,uf);function lf(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Kl.COUNTERCLOCKWISE,this._inputLine=t||null}var hf={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};lf.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&(!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i))},lf.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=lf.DELETE,i=r=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},lf.prototype.isShallowConcavity=function(t,e,n,i){return Kl.computeOrientation(t,e,n)===this._angleOrientation&&Kl.distancePointLine(e,t,n)<i},lf.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/lf.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},lf.prototype.isConcave=function(t,e,n){var i=Kl.computeOrientation(t,e,n)===this._angleOrientation;return i},lf.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=Kl.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);for(;this.deleteShallowConcavities(););return this.collapseLine()},lf.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===lf.DELETE;)e++;return e},lf.prototype.isShallow=function(t,e,n,i){return Kl.distancePointLine(e,t,n)<i},lf.prototype.collapseLine=function(){for(var t=new Ih,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==lf.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},lf.prototype.interfaces_=function(){return[]},lf.prototype.getClass=function(){return lf},lf.simplify=function(t,e){return new lf(t).simplify(e)},hf.INIT.get=function(){return 0},hf.DELETE.get=function(){return 1},hf.KEEP.get=function(){return 1},hf.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(lf,hf);function cf(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new _h}var pf={COORDINATE_ARRAY_TYPE:{configurable:!0}};cf.prototype.getCoordinates=function(){return this._ptList.toArray(cf.COORDINATE_ARRAY_TYPE)},cf.prototype.setPrecisionModel=function(t){this._precisionModel=t},cf.prototype.addPt=function(t){var e=new ol(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},cf.prototype.revere=function(){},cf.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;0<=i;i--)this.addPt(t[i])},cf.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},cf.prototype.toString=function(){return(new Bc).createLineString(this.getCoordinates()).toString()},cf.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new ol(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},cf.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},cf.prototype.interfaces_=function(){return[]},cf.prototype.getClass=function(){return cf},pf.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(cf,pf);function ff(){}var df={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};ff.prototype.interfaces_=function(){return[]},ff.prototype.getClass=function(){return ff},ff.toDegrees=function(t){return 180*t/Math.PI},ff.normalize=function(t){for(;t>Math.PI;)t-=ff.PI_TIMES_2;for(;t<=-Math.PI;)t+=ff.PI_TIMES_2;return t},ff.angle=function(t,e){if(1===arguments.length){return Math.atan2(t.y,t.x)}if(2===arguments.length){var n=e.x-t.x,i=e.y-t.y;return Math.atan2(i,n)}},ff.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return 0<i*(n.x-e.x)+r*(n.y-e.y)},ff.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},ff.interiorAngle=function(t,e,n){var i=ff.angle(e,t),r=ff.angle(e,n);return Math.abs(r-i)},ff.normalizePositive=function(t){if(t<0){for(;t<0;)t+=ff.PI_TIMES_2;ff.PI_TIMES_2<=t&&(t=0)}else{for(;ff.PI_TIMES_2<=t;)t-=ff.PI_TIMES_2;t<0&&(t=0)}return t},ff.angleBetween=function(t,e,n){var i=ff.angle(e,t),r=ff.angle(e,n);return ff.diff(i,r)},ff.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},ff.toRadians=function(t){return t*Math.PI/180},ff.getTurn=function(t,e){var n=Math.sin(e-t);return 0<n?ff.COUNTERCLOCKWISE:n<0?ff.CLOCKWISE:ff.NONE},ff.angleBetweenOriented=function(t,e,n){var i=ff.angle(e,t),r=ff.angle(e,n)-i;return r<=-Math.PI?r+ff.PI_TIMES_2:r>Math.PI?r-ff.PI_TIMES_2:r},df.PI_TIMES_2.get=function(){return 2*Math.PI},df.PI_OVER_2.get=function(){return Math.PI/2},df.PI_OVER_4.get=function(){return Math.PI/4},df.COUNTERCLOCKWISE.get=function(){return Kl.COUNTERCLOCKWISE},df.CLOCKWISE.get=function(){return Kl.CLOCKWISE},df.NONE.get=function(){return Kl.COLLINEAR},Object.defineProperties(ff,df);function gf(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Wp,this._seg1=new Wp,this._offset0=new Wp,this._offset1=new Wp,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new Hl,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),8<=e.getQuadrantSegments()&&e.getJoinStyle()===af.JOIN_ROUND&&(this._closingSegLengthFactor=gf.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}var yf={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};gf.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=Kl.computeOrientation(this._s0,this._s1,this._s2),i=n===Kl.CLOCKWISE&&this._side===Hc.LEFT||n===Kl.COUNTERCLOCKWISE&&this._side===Hc.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},gf.prototype.addLineEndCap=function(t,e){var n=new Wp(t,e),i=new Wp;this.computeOffsetSegment(n,Hc.LEFT,this._distance,i);var r=new Wp;this.computeOffsetSegment(n,Hc.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case af.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,Kl.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case af.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case af.CAP_SQUARE:var u=new ol;u.x=Math.abs(this._distance)*Math.cos(a),u.y=Math.abs(this._distance)*Math.sin(a);var l=new ol(i.p1.x+u.x,i.p1.y+u.y),h=new ol(r.p1.x+u.x,r.p1.y+u.y);this._segList.addPt(l),this._segList.addPt(h)}},gf.prototype.getCoordinates=function(){return this._segList.getCoordinates()},gf.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=Cl.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof wl))throw t;o=new ol(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},gf.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),u=n.x-t.x,l=n.y-t.y,h=Math.atan2(l,u);i===Kl.CLOCKWISE?a<=h&&(a+=2*Math.PI):h<=a&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,h,i,r),this._segList.addPt(n)},gf.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*gf.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===af.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===af.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},gf.prototype.createSquare=function(t){this._segList.addPt(new ol(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new ol(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new ol(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new ol(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},gf.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},gf.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},gf.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},gf.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},gf.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=ff.angle(r,this._seg0.p0),s=ff.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=ff.normalize(o+s),u=ff.normalize(a+Math.PI),l=i*n,h=n-l*Math.abs(Math.sin(s)),c=r.x+l*Math.cos(u),p=r.y+l*Math.sin(u),f=new ol(c,p),d=new Wp(r,f),g=d.pointAlongOffset(1,h),y=d.pointAlongOffset(1,-h);this._side===Hc.LEFT?(this._segList.addPt(g),this._segList.addPt(y)):(this._segList.addPt(y),this._segList.addPt(g))},gf.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===Hc.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),u=r*n*o/a,l=r*n*s/a;i.p0.x=t.p0.x-l,i.p0.y=t.p0.y+u,i.p1.x=t.p1.x-l,i.p1.y=t.p1.y+u},gf.prototype.addFilletArc=function(t,e,n,i,r){var o=i===Kl.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var u=s/a,l=0,h=new ol;l<s;){var c=e+o*l;h.x=t.x+r*Math.cos(c),h.y=t.y+r*Math.sin(c),this._segList.addPt(h),l+=u}},gf.prototype.addInsideTurn=function(){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*gf.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),0<this._closingSegLengthFactor){var t=new ol((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(t);var e=new ol((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(e)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},gf.prototype.createCircle=function(t){var e=new ol(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},gf.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},gf.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new cf,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*gf.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},gf.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),2<=this._li.getIntersectionNum()&&(this._bufParams.getJoinStyle()===af.JOIN_BEVEL||this._bufParams.getJoinStyle()===af.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Kl.CLOCKWISE,this._distance))},gf.prototype.closeRing=function(){this._segList.closeRing()},gf.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},gf.prototype.interfaces_=function(){return[]},gf.prototype.getClass=function(){return gf},yf.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},yf.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},yf.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},yf.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(gf,yf);function _f(t,e){this._distance=0,this._precisionModel=null,this._bufParams=null;var n=t,i=e;this._precisionModel=n,this._bufParams=i}_f.prototype.getOffsetCurve=function(t,e){if(0===(this._distance=e))return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Eh.reverse(o),o},_f.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=lf.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Hc.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=lf.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],Hc.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment(),n.closeRing()},_f.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===Hc.RIGHT&&(i=-i);var r=lf.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},_f.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=lf.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Hc.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=lf.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Hc.LEFT);for(var u=a-2;0<=u;u--)e.addNextSegment(s[u],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},_f.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case af.CAP_ROUND:e.createCircle(t);break;case af.CAP_SQUARE:e.createSquare(t)}},_f.prototype.getLineCurve=function(t,e){if((this._distance=e)<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},_f.prototype.getBufferParameters=function(){return this._bufParams},_f.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},_f.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return _f.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},_f.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=lf.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Hc.LEFT),n.addFirstSegment();for(var s=o-2;0<=s;s--)n.addNextSegment(r[s],!0)}else{var a=lf.simplify(t,i),u=a.length-1;n.initSideSegments(a[0],a[1],Hc.LEFT),n.addFirstSegment();for(var l=2;l<=u;l++)n.addNextSegment(a[l],!0)}n.addLastSegment()},_f.prototype.getSegGen=function(t){return new gf(this._precisionModel,this._bufParams,t)},_f.prototype.interfaces_=function(){return[]},_f.prototype.getClass=function(){return _f},_f.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new ol(t[n]);return e};function mf(t){this._subgraphs=null,this._seg=new Wp,this._cga=new Kl;var e=t;this._subgraphs=e}var vf={DepthSegment:{configurable:!0}};mf.prototype.findStabbedSegments=function(t,e,n){var i=this;if(1===arguments.length){for(var r=t,o=new _h,s=this._subgraphs.iterator();s.hasNext();){var a=s.next(),u=a.getEnvelope();r.y<u.getMinY()||r.y>u.getMaxY()||i.findStabbedSegments(r,a.getDirectedEdges(),o)}return o}if(3===arguments.length)if(cl(n,fh)&&t instanceof ol&&e instanceof bp)for(var l=t,h=e,c=n,p=h.getEdge().getCoordinates(),f=0;f<p.length-1;f++){if(i._seg.p0=p[f],i._seg.p1=p[f+1],i._seg.p0.y>i._seg.p1.y&&i._seg.reverse(),!(Math.max(i._seg.p0.x,i._seg.p1.x)<l.x)&&!(i._seg.isHorizontal()||l.y<i._seg.p0.y||l.y>i._seg.p1.y||Kl.computeOrientation(i._seg.p0,i._seg.p1,l)===Kl.RIGHT)){var d=h.getDepth(Hc.LEFT);i._seg.p0.equals(p[f])||(d=h.getDepth(Hc.RIGHT));var g=new bf(i._seg,d);c.add(g)}}else if(cl(n,fh)&&t instanceof ol&&cl(e,fh))for(var y=t,_=n,m=e.iterator();m.hasNext();){var v=m.next();v.isForward()&&i.findStabbedSegments(y,v,_)}},mf.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Tp.min(e)._leftDepth},mf.prototype.interfaces_=function(){return[]},mf.prototype.getClass=function(){return mf},vf.DepthSegment.get=function(){return bf},Object.defineProperties(mf,vf);var bf=function(t,e){this._upwardSeg=null,this._leftDepth=null;var n=t,i=e;this._upwardSeg=new Wp(n),this._leftDepth=i};bf.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n?n:0!==(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},bf.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},bf.prototype.toString=function(){return this._upwardSeg.toString()},bf.prototype.interfaces_=function(){return[el]},bf.prototype.getClass=function(){return bf};function xf(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null}xf.prototype.area=function(){return xf.area(this.p0,this.p1,this.p2)},xf.prototype.signedArea=function(){return xf.signedArea(this.p0,this.p1,this.p2)},xf.prototype.interpolateZ=function(t){if(null===t)throw new Qu("Supplied point is null.");return xf.interpolateZ(t,this.p0,this.p1,this.p2)},xf.prototype.longestSideLength=function(){return xf.longestSideLength(this.p0,this.p1,this.p2)},xf.prototype.isAcute=function(){return xf.isAcute(this.p0,this.p1,this.p2)},xf.prototype.circumcentre=function(){return xf.circumcentre(this.p0,this.p1,this.p2)},xf.prototype.area3D=function(){return xf.area3D(this.p0,this.p1,this.p2)},xf.prototype.centroid=function(){return xf.centroid(this.p0,this.p1,this.p2)},xf.prototype.inCentre=function(){return xf.inCentre(this.p0,this.p1,this.p2)},xf.prototype.interfaces_=function(){return[]},xf.prototype.getClass=function(){return xf},xf.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},xf.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},xf.det=function(t,e,n,i){return t*i-e*n},xf.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,u=n.y-o,l=i.y-o,h=s*l-a*u,c=t.x-r,p=t.y-o,f=(l*c-a*p)/h,d=(-u*c+s*p)/h;return e.z+f*(n.z-e.z)+d*(i.z-e.z)},xf.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return s<r&&(s=r),s<o&&(s=o),s},xf.isAcute=function(t,e,n){return!!ff.isAcute(t,e,n)&&(!!ff.isAcute(e,n,t)&&!!ff.isAcute(n,t,e))},xf.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,u=e.y-r,l=2*xf.det(o,s,a,u),h=xf.det(s,o*o+s*s,u,a*a+u*u),c=xf.det(o,o*o+s*s,a,a*a+u*u);return new ol(i-h/l,r+c/l)},xf.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new Cl(t.x+n/2,t.y+i/2,1),o=new Cl(t.x-i+n/2,t.y+n+i/2,1);return new Cl(r,o)},xf.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new ol(t.x+r*o,t.y+r*s)},xf.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,u=n.z-t.z,l=r*u-o*a,h=o*s-i*u,c=i*a-r*s,p=l*l+h*h+c*c,f=Math.sqrt(p)/2;return f},xf.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new ol(i,r)},xf.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,u=(i*t.y+r*e.y+o*n.y)/s;return new ol(a,u)};function Ef(t,e,n){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new _h;var i=t,r=e,o=n;this._inputGeom=i,this._distance=r,this._curveBuilder=o}Ef.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,ll.EXTERIOR,ll.INTERIOR)},Ef.prototype.addPolygon=function(t){var e=this._distance,n=Hc.LEFT;this._distance<0&&(e=-this._distance,n=Hc.RIGHT);var i=t.getExteriorRing(),r=Eh.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,ll.EXTERIOR,ll.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Eh.removeRepeatedPoints(s.getCoordinates());0<this._distance&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Hc.opposite(n),ll.INTERIOR,ll.EXTERIOR)}},Ef.prototype.isTriangleErodedCompletely=function(t,e){var n=new xf(t[0],t[1],t[2]),i=n.inCentre();return Kl.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},Ef.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Eh.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,ll.EXTERIOR,ll.INTERIOR)},Ef.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new Jp(t,new ip(0,ll.BOUNDARY,e,n));this._curveList.add(i)},Ef.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Ef.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<xc.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=xc.MINIMUM_VALID_SIZE&&Kl.isCCW(t)&&(o=r,s=i,n=Hc.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},Ef.prototype.add=function(t){if(t.isEmpty())return null;t instanceof vc?this.addPolygon(t):t instanceof gc?this.addLineString(t):t instanceof _c?this.addPoint(t):t instanceof bc?this.addCollection(t):t instanceof nc?this.addCollection(t):t instanceof Ec?this.addCollection(t):t instanceof ec&&this.addCollection(t)},Ef.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},Ef.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Ef.prototype.interfaces_=function(){return[]},Ef.prototype.getClass=function(){return Ef};function If(){}If.prototype.locate=function(){},If.prototype.interfaces_=function(){return[]},If.prototype.getClass=function(){return If};function Lf(t){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=t;this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()}Lf.prototype.next=function(){if(this._atStart)return this._atStart=!1,Lf.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new gh;var t=this._parent.getGeometryN(this._index++);return t instanceof ec?(this._subcollectionIterator=new Lf(t),this._subcollectionIterator.next()):t},Lf.prototype.remove=function(){throw new Error(this.getClass().getName())},Lf.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Lf.prototype.interfaces_=function(){return[hh]},Lf.prototype.getClass=function(){return Lf},Lf.isAtomic=function(t){return!(t instanceof ec)};function wf(t){this._geom=null;var e=t;this._geom=e}wf.prototype.locate=function(t){return wf.locate(t,this._geom)},wf.prototype.interfaces_=function(){return[If]},wf.prototype.getClass=function(){return wf},wf.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&Kl.isPointInRing(t,e.getCoordinates())},wf.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!wf.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(wf.isPointInRing(t,r))return!1}return!0},wf.containsPoint=function(t,e){if(e instanceof vc)return wf.containsPointInPolygon(t,e);if(e instanceof ec)for(var n=new Lf(e);n.hasNext();){var i=n.next();if(i!==e&&wf.containsPoint(t,i))return!0}return!1},wf.locate=function(t,e){return e.isEmpty()?ll.EXTERIOR:wf.containsPoint(t,e)?ll.INTERIOR:ll.EXTERIOR};function Sf(){this._edgeMap=new Yh,this._edgeList=null,this._ptInAreaLocation=[ll.NONE,ll.NONE]}Sf.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Sf.prototype.propagateSideLabels=function(t){for(var e=ll.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Hc.LEFT)!==ll.NONE&&(e=i.getLocation(t,Hc.LEFT))}if(e===ll.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Hc.ON)===ll.NONE&&a.setLocation(t,Hc.ON,r),a.isArea(t)){var u=a.getLocation(t,Hc.LEFT),l=a.getLocation(t,Hc.RIGHT);if(l!==ll.NONE){if(l!==r)throw new Qc("side location conflict",s.getCoordinate());u===ll.NONE&&ql.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=u}else ql.isTrue(a.getLocation(t,Hc.LEFT)===ll.NONE,"found single null side"),a.setLocation(t,Hc.RIGHT,r),a.setLocation(t,Hc.LEFT,r)}}},Sf.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Sf.prototype.print=function(t){Ml.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){e.next().print(t)}},Sf.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Sf.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Hc.LEFT);ql.isTrue(i!==ll.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();ql.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Hc.LEFT),u=s.getLocation(t,Hc.RIGHT);if(a===u)return!1;if(u!==r)return!1;r=a}return!0},Sf.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++){if(this._edgeList.get(e)===t)return e}return-1},Sf.prototype.iterator=function(){return this.getEdges().iterator()},Sf.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new _h(this._edgeMap.values())),this._edgeList},Sf.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===ll.NONE&&(this._ptInAreaLocation[t]=wf.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Sf.prototype.toString=function(){var t=new dl;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Sf.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();){e.next().computeLabel(t)}},Sf.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===ll.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),u=0;u<2;u++)if(a.isAnyNull(u)){var l=ll.NONE;if(e[u])l=ll.EXTERIOR;else{var h=s.getCoordinate();l=this.getLocation(u,h,t)}a.setAllLocationsIfNull(u,l)}},Sf.prototype.getDegree=function(){return this._edgeMap.size()},Sf.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Sf.prototype.interfaces_=function(){return[]},Sf.prototype.getClass=function(){return Sf};var Mf,Cf=((Mf=Sf)&&(Pf.__proto__=Mf),((Pf.prototype=Object.create(Mf&&Mf.prototype)).constructor=Pf).prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Qc("no outgoing dirEdge found",this.getCoordinate());ql.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},Pf.prototype.insert=function(t){this.insertEdgeEnd(t,t)},Pf.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return yp.isNorthern(r)&&yp.isNorthern(o)?n:yp.isNorthern(r)||yp.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(ql.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},Pf.prototype.print=function(t){Ml.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},Pf.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new _h;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},Pf.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},Pf.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;0<=n;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},Pf.prototype.computeDepths=function(t,e,n){if(1===arguments.length){var i=t,r=this.findIndex(i),o=i.getDepth(Hc.LEFT),s=i.getDepth(Hc.RIGHT),a=this.computeDepths(r+1,this._edgeList.size(),o);if(this.computeDepths(0,r,a)!==s)throw new Qc("depth mismatch at "+i.getCoordinate())}else if(3===arguments.length){for(var u=e,l=n,h=t;h<u;h++){var c=this._edgeList.get(h);c.setEdgeDepths(Hc.RIGHT,l),l=c.getDepth(Hc.LEFT)}return l}},Pf.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},Pf.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;0<=r;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(ql.isTrue(null!==e,"found null for first outgoing dirEdge"),ql.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},Pf.prototype.getOutgoingDegree=function(t){if(0===arguments.length){for(var e=0,n=this.iterator();n.hasNext();)n.next().isInResult()&&e++;return e}if(1===arguments.length){for(var i=t,r=0,o=this.iterator();o.hasNext();)o.next().getEdgeRing()===i&&r++;return r}},Pf.prototype.getLabel=function(){return this._label},Pf.prototype.findCoveredLineEdges=function(){for(var t=ll.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=ll.INTERIOR;break}if(i.isInResult()){t=ll.EXTERIOR;break}}}if(t===ll.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===ll.INTERIOR):(s.isInResult()&&(r=ll.EXTERIOR),a.isInResult()&&(r=ll.INTERIOR))}},Pf.prototype.computeLabelling=function(t){Mf.prototype.computeLabelling.call(this,t),this._label=new ip(ll.NONE);for(var e=this.iterator();e.hasNext();)for(var n=e.next().getEdge().getLabel(),i=0;i<2;i++){var r=n.getLocation(i);r!==ll.INTERIOR&&r!==ll.BOUNDARY||this._label.setLocation(i,ll.INTERIOR)}},Pf.prototype.interfaces_=function(){return[]},Pf.prototype.getClass=function(){return Pf},Pf);function Pf(){Mf.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}var Nf,Of=((Nf=Ep)&&(Tf.__proto__=Nf),((Tf.prototype=Object.create(Nf&&Nf.prototype)).constructor=Tf).prototype.createNode=function(t){return new fp(t,new Cf)},Tf.prototype.interfaces_=function(){return[]},Tf.prototype.getClass=function(){return Tf},Tf);function Tf(){Nf.apply(this,arguments)}function kf(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=kf.orientation(t)}kf.prototype.compareTo=function(t){return kf.compareOriented(this._pts,this._orientation,t._pts,t._orientation)},kf.prototype.interfaces_=function(){return[el]},kf.prototype.getClass=function(){return kf},kf.orientation=function(t){return 1===Eh.increasingDirection(t)},kf.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,u=e?0:t.length-1,l=i?0:n.length-1;;){var h=t[u].compareTo(n[l]);if(0!==h)return h;var c=(u+=r)===s,p=(l+=o)===a;if(c&&!p)return-1;if(!c&&p)return 1;if(c&&p)return 0}};function Rf(){this._edges=new _h,this._ocaMap=new Yh}Rf.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);0<e&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)0<r&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Rf.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Rf.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Rf.prototype.iterator=function(){return this._edges.iterator()},Rf.prototype.getEdges=function(){return this._edges},Rf.prototype.get=function(t){return this._edges.get(t)},Rf.prototype.findEqualEdge=function(t){var e=new kf(t.getCoordinates());return this._ocaMap.get(e)},Rf.prototype.add=function(t){this._edges.add(t);var e=new kf(t.getCoordinates());this._ocaMap.put(e,t)},Rf.prototype.interfaces_=function(){return[]},Rf.prototype.getClass=function(){return Rf};function Df(){}Df.prototype.processIntersections=function(){},Df.prototype.isDone=function(){},Df.prototype.interfaces_=function(){return[]},Df.prototype.getClass=function(){return Df};function Af(t){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=t;this._li=e}Af.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Af.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Af.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Af.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Af.prototype.getLineIntersector=function(){return this._li},Af.prototype.hasProperIntersection=function(){return this._hasProper},Af.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Af.prototype.hasIntersection=function(){return this._hasIntersection},Af.prototype.isDone=function(){return!1},Af.prototype.hasInteriorIntersection=function(){return this._hasInterior},Af.prototype.interfaces_=function(){return[Df]},Af.prototype.getClass=function(){return Af},Af.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};function Ff(t,e,n){this.coord=null,this.segmentIndex=null,this.dist=null;var i=t,r=e,o=n;this.coord=new ol(i),this.segmentIndex=r,this.dist=o}Ff.prototype.getSegmentIndex=function(){return this.segmentIndex},Ff.prototype.getCoordinate=function(){return this.coord},Ff.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Ff.prototype.compareTo=function(t){return this.compare(t.segmentIndex,t.dist)},Ff.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Ff.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Ff.prototype.getDistance=function(){return this.dist},Ff.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Ff.prototype.interfaces_=function(){return[el]},Ff.prototype.getClass=function(){return Ff};function Bf(t){this._nodeMap=new Yh,this.edge=null;var e=t;this.edge=e}Bf.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();){e.next().print(t)}},Bf.prototype.iterator=function(){return this._nodeMap.values().iterator()},Bf.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},Bf.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},Bf.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=0<e.dist||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new ol(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new Vf(o,new ip(this.edge._label))},Bf.prototype.add=function(t,e,n){var i=new Ff(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},Bf.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();){if(e.next().coord.equals(t))return!0}return!1},Bf.prototype.interfaces_=function(){return[]},Bf.prototype.getClass=function(){return Bf};function Gf(){}Gf.prototype.getChainStartIndices=function(t){var e=0,n=new _h;n.add(new gl(e));do{var i=this.findChainEnd(t,e);n.add(new gl(i)),e=i}while(e<t.length-1);return Gf.toIntArray(n)},Gf.prototype.findChainEnd=function(t,e){for(var n=yp.quadrant(t[e],t[e+1]),i=e+1;i<t.length;){if(yp.quadrant(t[i-1],t[i])!==n)break;i++}return i-1},Gf.prototype.interfaces_=function(){return[]},Gf.prototype.getClass=function(){return Gf},Gf.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};function Uf(t){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Pl,this.env2=new Pl;var e=t;this.e=e,this.pts=e.getCoordinates();var n=new Gf;this.startIndex=n.getChainStartIndices(this.pts)}Uf.prototype.getCoordinates=function(){return this.pts},Uf.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return n<e?e:n},Uf.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Uf.prototype.computeIntersectsForChain=function(t,e,n,i,r,o){if(4===arguments.length){var s=i;this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],s)}else if(6===arguments.length){var a=t,u=e,l=n,h=i,c=r,p=o,f=this.pts[a],d=this.pts[u],g=l.pts[h],y=l.pts[c];if(u-a==1&&c-h==1)return p.addIntersections(this.e,a,l.e,h),null;if(this.env1.init(f,d),this.env2.init(g,y),!this.env1.intersects(this.env2))return null;var _=Math.trunc((a+u)/2),m=Math.trunc((h+c)/2);a<_&&(h<m&&this.computeIntersectsForChain(a,_,l,h,m,p),m<c&&this.computeIntersectsForChain(a,_,l,m,c,p)),_<u&&(h<m&&this.computeIntersectsForChain(_,u,l,h,m,p),m<c&&this.computeIntersectsForChain(_,u,l,m,c,p))}},Uf.prototype.getStartIndexes=function(){return this.startIndex},Uf.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},Uf.prototype.interfaces_=function(){return[]},Uf.prototype.getClass=function(){return Uf};function jf(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=jf.NULL_VALUE}var qf={NULL_VALUE:{configurable:!0}};jf.prototype.getDepth=function(t,e){return this._depth[t][e]},jf.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},jf.prototype.isNull=function(t,e){if(0===arguments.length){for(var n=0;n<2;n++)for(var i=0;i<3;i++)if(this._depth[n][i]!==jf.NULL_VALUE)return!1;return!0}if(1===arguments.length){var r=t;return this._depth[r][1]===jf.NULL_VALUE}if(2===arguments.length){var o=t,s=e;return this._depth[o][s]===jf.NULL_VALUE}},jf.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},jf.prototype.getDelta=function(t){return this._depth[t][Hc.RIGHT]-this._depth[t][Hc.LEFT]},jf.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?ll.EXTERIOR:ll.INTERIOR},jf.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},jf.prototype.add=function(t,e,n){if(1===arguments.length)for(var i=t,r=0;r<2;r++)for(var o=1;o<3;o++){var s=i.getLocation(r,o);s!==ll.EXTERIOR&&s!==ll.INTERIOR||(this.isNull(r,o)?this._depth[r][o]=jf.depthAtLocation(s):this._depth[r][o]+=jf.depthAtLocation(s))}else if(3===arguments.length){var a=t,u=e;n===ll.INTERIOR&&this._depth[a][u]++}},jf.prototype.interfaces_=function(){return[]},jf.prototype.getClass=function(){return jf},jf.depthAtLocation=function(t){return t===ll.EXTERIOR?0:t===ll.INTERIOR?1:jf.NULL_VALUE},qf.NULL_VALUE.get=function(){return-1},Object.defineProperties(jf,qf);var zf,Vf=((zf=cp)&&(Yf.__proto__=zf),((Yf.prototype=Object.create(zf&&zf.prototype)).constructor=Yf).prototype.getDepth=function(){return this._depth},Yf.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new Yf(t,ip.toLineLabel(this._label))},Yf.prototype.isIsolated=function(){return this._isIsolated},Yf.prototype.getCoordinates=function(){return this.pts},Yf.prototype.setIsolated=function(t){this._isIsolated=t},Yf.prototype.setName=function(t){this._name=t},Yf.prototype.equals=function(t){if(!(t instanceof Yf))return!1;var e=t;if(this.pts.length!==e.pts.length)return!1;for(var n=!0,i=!0,r=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(e.pts[o])||(n=!1),this.pts[o].equals2D(e.pts[--r])||(i=!1),!n&&!i)return!1;return!0},Yf.prototype.getCoordinate=function(t){if(0===arguments.length)return 0<this.pts.length?this.pts[0]:null;if(1===arguments.length){var e=t;return this.pts[e]}},Yf.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},Yf.prototype.computeIM=function(t){Yf.updateIM(this._label,t)},Yf.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},Yf.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},Yf.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},Yf.prototype.getDepthDelta=function(){return this._depthDelta},Yf.prototype.getNumPoints=function(){return this.pts.length},Yf.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;0<=e;e--)t.print(this.pts[e]+" ");t.println("")},Yf.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Uf(this)),this._mce},Yf.prototype.getEnvelope=function(){if(null===this._env){this._env=new Pl;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},Yf.prototype.addIntersection=function(t,e,n,i){var r=new ol(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var u=this.pts[a];r.equals2D(u)&&(o=a,s=0)}this.eiList.add(r,o,s)},Yf.prototype.toString=function(){var t=new dl;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)0<e&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},Yf.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},Yf.prototype.setDepthDelta=function(t){this._depthDelta=t},Yf.prototype.getEdgeIntersectionList=function(){return this.eiList},Yf.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},Yf.prototype.interfaces_=function(){return[]},Yf.prototype.getClass=function(){return Yf},Yf.updateIM=function(t,e){if(2!==arguments.length)return zf.prototype.updateIM.apply(this,arguments);var n=t,i=e;i.setAtLeastIfValid(n.getLocation(0,Hc.ON),n.getLocation(1,Hc.ON),1),n.isArea()&&(i.setAtLeastIfValid(n.getLocation(0,Hc.LEFT),n.getLocation(1,Hc.LEFT),2),i.setAtLeastIfValid(n.getLocation(0,Hc.RIGHT),n.getLocation(1,Hc.RIGHT),2))},Yf);function Yf(){if(zf.call(this),this.pts=null,this._env=null,this.eiList=new Bf(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new jf,this._depthDelta=0,1===arguments.length)Yf.call(this,arguments[0],null);else if(2===arguments.length){var t=arguments[0],e=arguments[1];this.pts=t,this._label=e}}function Hf(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Rf,this._bufParams=t||null}Hf.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},Hf.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new ip(t.getLabel())).flip(),n.merge(i);var r=Hf.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(Hf.depthDelta(t.getLabel()))},Hf.prototype.buildSubgraphs=function(t,e){for(var n=new _h,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new mf(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},Hf.prototype.createSubgraphs=function(t){for(var e=new _h,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new ep;r.create(i),e.add(r)}}return Tp.sort(e,Tp.reverseOrder()),e},Hf.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},Hf.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new rf,n=new Hl;return n.setPrecisionModel(t),e.setSegmentIntersector(new Af(n)),e},Hf.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new _f(n,this._bufParams),r=new Ef(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new Ip(new Of),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new Lp(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},Hf.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new Vf(r.getCoordinates(),new ip(s));this.insertUniqueEdge(a)}}},Hf.prototype.setNoder=function(t){this._workingNoder=t},Hf.prototype.interfaces_=function(){return[]},Hf.prototype.getClass=function(){return Hf},Hf.depthDelta=function(t){var e=t.getLocation(0,Hc.LEFT),n=t.getLocation(0,Hc.RIGHT);return e===ll.INTERIOR&&n===ll.EXTERIOR?1:e===ll.EXTERIOR&&n===ll.INTERIOR?-1:0},Hf.convertSegStrings=function(t){for(var e=new Bc,n=new _h;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};function Xf(t,e,n,i){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var r=t,o=e;this._noder=r,this._scaleFactor=o,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var s=t,a=e,u=n,l=i;this._noder=s,this._scaleFactor=a,this._offsetX=u,this._offsetY=l,this._isScaled=!this.isIntegerPrecision()}}Xf.prototype.rescale=function(t){if(cl(t,lh))for(var e=t.iterator();e.hasNext();){var n=e.next();this.rescale(n.getCoordinates())}else if(t instanceof Array){for(var i=t,r=0;r<i.length;r++)i[r].x=i[r].x/this._scaleFactor+this._offsetX,i[r].y=i[r].y/this._scaleFactor+this._offsetY;2===i.length&&i[0].equals2D(i[1])&&Ml.out.println(i)}},Xf.prototype.scale=function(t){if(cl(t,lh)){for(var e=t,n=new _h,i=e.iterator();i.hasNext();){var r=i.next();n.add(new Jp(this.scale(r.getCoordinates()),r.getData()))}return n}if(t instanceof Array){for(var o=t,s=new Array(o.length).fill(null),a=0;a<o.length;a++)s[a]=new ol(Math.round((o[a].x-this._offsetX)*this._scaleFactor),Math.round((o[a].y-this._offsetY)*this._scaleFactor),o[a].z);return Eh.removeRepeatedPoints(s)}},Xf.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},Xf.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},Xf.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},Xf.prototype.interfaces_=function(){return[tf]},Xf.prototype.getClass=function(){return Xf};function Jf(t){this._li=new Hl,this._segStrings=null;var e=t;this._segStrings=e}var Wf={fact:{configurable:!0}};Jf.prototype.checkEndPtVertexIntersections=function(t,e){if(0===arguments.length)for(var n=this._segStrings.iterator();n.hasNext();){var i=n.next().getCoordinates();this.checkEndPtVertexIntersections(i[0],this._segStrings),this.checkEndPtVertexIntersections(i[i.length-1],this._segStrings)}else if(2===arguments.length)for(var r=t,o=e.iterator();o.hasNext();)for(var s=o.next().getCoordinates(),a=1;a<s.length-1;a++)if(s[a].equals(r))throw new Fl("found endpt/interior pt intersection at index "+a+" :pt "+r)},Jf.prototype.checkInteriorIntersections=function(t,e,n,i){if(0===arguments.length)for(var r=this._segStrings.iterator();r.hasNext();)for(var o=r.next(),s=this._segStrings.iterator();s.hasNext();){var a=s.next();this.checkInteriorIntersections(o,a)}else if(2===arguments.length)for(var u=t,l=e,h=u.getCoordinates(),c=l.getCoordinates(),p=0;p<h.length-1;p++)for(var f=0;f<c.length-1;f++)this.checkInteriorIntersections(u,p,l,f);else if(4===arguments.length){var d=t,g=e,y=n,_=i;if(d===y&&g===_)return null;var m=d.getCoordinates()[g],v=d.getCoordinates()[g+1],b=y.getCoordinates()[_],x=y.getCoordinates()[_+1];if(this._li.computeIntersection(m,v,b,x),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,m,v)||this.hasInteriorIntersection(this._li,b,x)))throw new Fl("found non-noded intersection at "+m+"-"+v+" and "+b+"-"+x)}},Jf.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},Jf.prototype.checkCollapses=function(t){if(0===arguments.length)for(var e=this._segStrings.iterator();e.hasNext();){var n=e.next();this.checkCollapses(n)}else if(1===arguments.length)for(var i=t.getCoordinates(),r=0;r<i.length-2;r++)this.checkCollapse(i[r],i[r+1],i[r+2])},Jf.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},Jf.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new Fl("found non-noded collapse at "+Jf.fact.createLineString([t,e,n]))},Jf.prototype.interfaces_=function(){return[]},Jf.prototype.getClass=function(){return Jf},Wf.fact.get=function(){return new Bc},Object.defineProperties(Jf,Wf);function Kf(t,e,n){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var i=t,r=e,o=n;if(this._originalPt=i,this._pt=i,this._scaleFactor=r,this._li=o,r<=0)throw new Qu("Scale factor must be non-zero");1!==r&&(this._pt=new ol(this.scale(i.x),this.scale(i.y)),this._p0Scaled=new ol,this._p1Scaled=new ol),this.initCorners(this._pt)}var Zf={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};Kf.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return ql.isTrue(!(s&&a),"Found bad envelope test"),a},Kf.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new ol(this._maxx,this._maxy),this._corner[1]=new ol(this._minx,this._maxy),this._corner[2]=new ol(this._minx,this._miny),this._corner[3]=new ol(this._maxx,this._miny)},Kf.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},Kf.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},Kf.prototype.getCoordinate=function(){return this._originalPt},Kf.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},Kf.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=Kf.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Pl(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},Kf.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))},Kf.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||(!(!n||!i)||(!!t.equals(this._pt)||!!e.equals(this._pt))))))},Kf.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},Kf.prototype.interfaces_=function(){return[]},Kf.prototype.getClass=function(){return Kf},Zf.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(Kf,Zf);function Qf(){this.tempEnv1=new Pl,this.selectedSegment=new Wp}Qf.prototype.select=function(t,e){if(1!==arguments.length&&2===arguments.length){var n=e;t.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}},Qf.prototype.interfaces_=function(){return[]},Qf.prototype.getClass=function(){return Qf};function $f(t){this._index=null;var e=t;this._index=e}var td={HotPixelSnapAction:{configurable:!0}};$f.prototype.snap=function(t,e,n){if(1===arguments.length){var i=t;return this.snap(i,null,-1)}if(3===arguments.length){var r=t,o=e,s=n,a=r.getSafeEnvelope(),u=new nd(r,o,s);return this._index.query(a,{interfaces_:function(){return[Cp]},visitItem:function(t){t.select(a,u)}}),u.isNodeAdded()}},$f.prototype.interfaces_=function(){return[]},$f.prototype.getClass=function(){return $f},td.HotPixelSnapAction.get=function(){return nd},Object.defineProperties($f,td);var ed,nd=((ed=Qf)&&(id.__proto__=ed),((id.prototype=Object.create(ed&&ed.prototype)).constructor=id).prototype.isNodeAdded=function(){return this._isNodeAdded},id.prototype.select=function(t,e){if(2!==arguments.length)return ed.prototype.select.apply(this,arguments);var n=e,i=t.getContext();if(null!==this._parentEdge&&i===this._parentEdge&&n===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(i,n)},id.prototype.interfaces_=function(){return[]},id.prototype.getClass=function(){return id},id);function id(){ed.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._hotPixel=t,this._parentEdge=e,this._hotPixelVertexIndex=n}function rd(t){this._li=null,this._interiorIntersections=null;var e=t;this._li=e,this._interiorIntersections=new _h}rd.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var u=0;u<this._li.getIntersectionNum();u++)this._interiorIntersections.add(this._li.getIntersection(u));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},rd.prototype.isDone=function(){return!1},rd.prototype.getInteriorIntersections=function(){return this._interiorIntersections},rd.prototype.interfaces_=function(){return[Df]},rd.prototype.getClass=function(){return rd};function od(t){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=t;this._pm=e,this._li=new Hl,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()}od.prototype.checkCorrectness=function(t){var e=Jp.getNodedSubstrings(t),n=new Jf(e);try{n.checkValid()}catch(t){if(!(t instanceof Il))throw t;t.printStackTrace()}},od.prototype.getNodedSubstrings=function(){return Jp.getNodedSubstrings(this._nodedSegStrings)},od.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},od.prototype.findInteriorIntersections=function(t,e){var n=new rd(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},od.prototype.computeVertexSnaps=function(t){if(cl(t,lh))for(var e=t.iterator();e.hasNext();){var n=e.next();this.computeVertexSnaps(n)}else if(t instanceof Jp)for(var i=t,r=i.getCoordinates(),o=0;o<r.length;o++){var s=new Kf(r[o],this._scaleFactor,this._li);this._pointSnapper.snap(s,i,o)&&i.addIntersection(r[o],o)}},od.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new rf,this._pointSnapper=new $f(this._noder.getIndex()),this.snapRound(t,this._li)},od.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new Kf(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},od.prototype.interfaces_=function(){return[tf]},od.prototype.getClass=function(){return od};var sd=function(t,e){if(this._argGeom=null,this._distance=null,this._bufParams=new af,this._resultGeometry=null,this._saveException=null,1===arguments.length){var n=t;this._argGeom=n}else if(2===arguments.length){var i=t,r=e;this._argGeom=i,this._bufParams=r}},ad={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};sd.prototype.bufferFixedPrecision=function(t){var e=new Xf(new od(new Rc(1)),t.getScale()),n=new Hf(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},sd.prototype.bufferReducedPrecision=function(t){if(0===arguments.length){for(var e=sd.MAX_PRECISION_DIGITS;0<=e;e--){try{this.bufferReducedPrecision(e)}catch(t){if(!(t instanceof Qc))throw t;this._saveException=t}if(null!==this._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=t,i=sd.precisionScaleFactor(this._argGeom,this._distance,n),r=new Rc(i);this.bufferFixedPrecision(r)}},sd.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===Rc.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},sd.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},sd.prototype.bufferOriginalPrecision=function(){try{var t=new Hf(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof Fl))throw t;this._saveException=t}},sd.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},sd.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},sd.prototype.interfaces_=function(){return[]},sd.prototype.getClass=function(){return sd},sd.bufferOp=function(t,e,n,i){if(2===arguments.length){var r=e;return new sd(t).getResultGeometry(r)}if(3===arguments.length){if(Number.isInteger(n)&&t instanceof $l&&"number"==typeof e){var o=e,s=n,a=new sd(t);return a.setQuadrantSegments(s),a.getResultGeometry(o)}if(n instanceof af&&t instanceof $l&&"number"==typeof e){var u=e;return new sd(t,n).getResultGeometry(u)}}else if(4===arguments.length){var l=e,h=n,c=i,p=new sd(t);return p.setQuadrantSegments(h),p.setEndCapStyle(c),p.getResultGeometry(l)}},sd.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=pl.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(0<e?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},ad.CAP_ROUND.get=function(){return af.CAP_ROUND},ad.CAP_BUTT.get=function(){return af.CAP_FLAT},ad.CAP_FLAT.get=function(){return af.CAP_FLAT},ad.CAP_SQUARE.get=function(){return af.CAP_SQUARE},ad.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(sd,ad);function ud(){this._pt=[new ol,new ol],this._distance=$u.NaN,this._isNull=!0}ud.prototype.getCoordinates=function(){return this._pt},ud.prototype.getCoordinate=function(t){return this._pt[t]},ud.prototype.setMinimum=function(t,e){if(1===arguments.length){this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var n=t,i=e;if(this._isNull)return this.initialize(n,i),null;var r=n.distance(i);r<this._distance&&this.initialize(n,i,r)}},ud.prototype.initialize=function(t,e,n){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var i=t,r=e;this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=i.distance(r),this._isNull=!1}else if(3===arguments.length){var o=t,s=e,a=n;this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(s),this._distance=a,this._isNull=!1}},ud.prototype.getDistance=function(){return this._distance},ud.prototype.setMaximum=function(t,e){if(1===arguments.length){this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var n=t,i=e;if(this._isNull)return this.initialize(n,i),null;var r=n.distance(i);r>this._distance&&this.initialize(n,i,r)}},ud.prototype.interfaces_=function(){return[]},ud.prototype.getClass=function(){return ud};function ld(){}ld.prototype.interfaces_=function(){return[]},ld.prototype.getClass=function(){return ld},ld.computeDistance=function(t,e,n){if(n instanceof ud&&t instanceof gc&&e instanceof ol)for(var i=e,r=n,o=t.getCoordinates(),s=new Wp,a=0;a<o.length-1;a++){s.setCoordinates(o[a],o[a+1]);var u=s.closestPoint(i);r.setMinimum(u,i)}else if(n instanceof ud&&t instanceof vc&&e instanceof ol){var l=t,h=e,c=n;ld.computeDistance(l.getExteriorRing(),h,c);for(var p=0;p<l.getNumInteriorRing();p++)ld.computeDistance(l.getInteriorRingN(p),h,c)}else if(n instanceof ud&&t instanceof $l&&e instanceof ol){var f=t,d=e,g=n;if(f instanceof gc)ld.computeDistance(f,d,g);else if(f instanceof vc)ld.computeDistance(f,d,g);else if(f instanceof ec)for(var y=f,_=0;_<y.getNumGeometries();_++){var m=y.getGeometryN(_);ld.computeDistance(m,d,g)}else g.setMinimum(f.getCoordinate(),d)}else if(n instanceof ud&&t instanceof Wp&&e instanceof ol){var v=e,b=n,x=t.closestPoint(v);b.setMinimum(x,v)}};function hd(t){this._maxPtDist=new ud,this._inputGeom=t||null}var cd={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};hd.prototype.computeMaxMidpointDistance=function(t){var e=new fd(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},hd.prototype.computeMaxVertexDistance=function(t){var e=new pd(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},hd.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},hd.prototype.getDistancePoints=function(){return this._maxPtDist},hd.prototype.interfaces_=function(){return[]},hd.prototype.getClass=function(){return hd},cd.MaxPointDistanceFilter.get=function(){return pd},cd.MaxMidpointDistanceFilter.get=function(){return fd},Object.defineProperties(hd,cd);var pd=function(t){this._maxPtDist=new ud,this._minPtDist=new ud,this._geom=t||null};pd.prototype.filter=function(t){this._minPtDist.initialize(),ld.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},pd.prototype.getMaxPointDistance=function(){return this._maxPtDist},pd.prototype.interfaces_=function(){return[nh]},pd.prototype.getClass=function(){return pd};var fd=function(t){this._maxPtDist=new ud,this._minPtDist=new ud,this._geom=t||null};fd.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new ol((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),ld.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},fd.prototype.isDone=function(){return!1},fd.prototype.isGeometryChanged=function(){return!1},fd.prototype.getMaxPointDistance=function(){return this._maxPtDist},fd.prototype.interfaces_=function(){return[tc]},fd.prototype.getClass=function(){return fd};function dd(t){this._comps=t||null}dd.prototype.filter=function(t){t instanceof vc&&this._comps.add(t)},dd.prototype.interfaces_=function(){return[$h]},dd.prototype.getClass=function(){return dd},dd.getPolygons=function(t,e){if(1===arguments.length)return dd.getPolygons(t,new _h);if(2===arguments.length){var n=t,i=e;return n instanceof vc?i.add(n):n instanceof ec&&n.apply(new dd(i)),i}};function gd(t,e){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var n=t;this._lines=n}else if(2===arguments.length){var i=t,r=e;this._lines=i,this._isForcedToLineString=r}}gd.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof xc){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof gc&&this._lines.add(t)},gd.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},gd.prototype.interfaces_=function(){return[Ql]},gd.prototype.getClass=function(){return gd},gd.getGeometry=function(t,e){if(1===arguments.length){var n=t;return n.getFactory().buildGeometry(gd.getLines(n))}if(2===arguments.length){var i=t,r=e;return i.getFactory().buildGeometry(gd.getLines(i,r))}},gd.getLines=function(t,e,n){if(1===arguments.length)return gd.getLines(t,!1);if(2===arguments.length){if(cl(t,lh)&&cl(e,lh)){for(var i=e,r=t.iterator();r.hasNext();){var o=r.next();gd.getLines(o,i)}return i}if(t instanceof $l&&"boolean"==typeof e){var s=t,a=e,u=new _h;return s.apply(new gd(u,a)),u}if(t instanceof $l&&cl(e,lh)){var l=t,h=e;return l instanceof gc?h.add(l):l.apply(new gd(h)),h}}else if(3===arguments.length){if("boolean"==typeof n&&cl(t,lh)&&cl(e,lh)){for(var c=e,p=n,f=t.iterator();f.hasNext();){var d=f.next();gd.getLines(d,c,p)}return c}if("boolean"==typeof n&&t instanceof $l&&cl(e,lh)){var g=e,y=n;return t.apply(new gd(g,y)),g}}};function yd(t){if(this._boundaryRule=ih.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0!==arguments.length&&1===arguments.length){var e=t;if(null===e)throw new Qu("Rule must be non-null");this._boundaryRule=e}}yd.prototype.locateInternal=function(t,e){if(t instanceof ol&&e instanceof vc){var n=t,i=e;if(i.isEmpty())return ll.EXTERIOR;var r=i.getExteriorRing(),o=this.locateInPolygonRing(n,r);if(o===ll.EXTERIOR)return ll.EXTERIOR;if(o===ll.BOUNDARY)return ll.BOUNDARY;for(var s=0;s<i.getNumInteriorRing();s++){var a=i.getInteriorRingN(s),u=this.locateInPolygonRing(n,a);if(u===ll.INTERIOR)return ll.EXTERIOR;if(u===ll.BOUNDARY)return ll.BOUNDARY}return ll.INTERIOR}if(t instanceof ol&&e instanceof gc){var l=t,h=e;if(!h.getEnvelopeInternal().intersects(l))return ll.EXTERIOR;var c=h.getCoordinates();return h.isClosed()||!l.equals(c[0])&&!l.equals(c[c.length-1])?Kl.isOnLine(l,c)?ll.INTERIOR:ll.EXTERIOR:ll.BOUNDARY}if(t instanceof ol&&e instanceof _c){var p=t;return e.getCoordinate().equals2D(p)?ll.INTERIOR:ll.EXTERIOR}},yd.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?Kl.locatePointInRing(t,e.getCoordinates()):ll.EXTERIOR},yd.prototype.intersects=function(t,e){return this.locate(t,e)!==ll.EXTERIOR},yd.prototype.updateLocationInfo=function(t){t===ll.INTERIOR&&(this._isIn=!0),t===ll.BOUNDARY&&this._numBoundaries++},yd.prototype.computeLocation=function(t,e){if(e instanceof _c&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof gc)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof vc)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof nc)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof Ec)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof ec)for(var u=new Lf(e);u.hasNext();){var l=u.next();l!==e&&this.computeLocation(t,l)}},yd.prototype.locate=function(t,e){return e.isEmpty()?ll.EXTERIOR:e instanceof gc?this.locateInternal(t,e):e instanceof vc?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?ll.BOUNDARY:0<this._numBoundaries||this._isIn?ll.INTERIOR:ll.EXTERIOR)},yd.prototype.interfaces_=function(){return[]},yd.prototype.getClass=function(){return yd};function _d(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)_d.call(this,arguments[0],_d.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];this._component=t,this._segIndex=e,this._pt=n}}var md={INSIDE_AREA:{configurable:!0}};_d.prototype.isInsideArea=function(){return this._segIndex===_d.INSIDE_AREA},_d.prototype.getCoordinate=function(){return this._pt},_d.prototype.getGeometryComponent=function(){return this._component},_d.prototype.getSegmentIndex=function(){return this._segIndex},_d.prototype.interfaces_=function(){return[]},_d.prototype.getClass=function(){return _d},md.INSIDE_AREA.get=function(){return-1},Object.defineProperties(_d,md);function vd(t){this._pts=t||null}vd.prototype.filter=function(t){t instanceof _c&&this._pts.add(t)},vd.prototype.interfaces_=function(){return[$h]},vd.prototype.getClass=function(){return vd},vd.getPoints=function(t,e){if(1===arguments.length){var n=t;return n instanceof _c?Tp.singletonList(n):vd.getPoints(n,new _h)}if(2===arguments.length){var i=t,r=e;return i instanceof _c?r.add(i):i instanceof ec&&i.apply(new vd(r)),r}};function bd(t){this._locations=null;var e=t;this._locations=e}bd.prototype.filter=function(t){(t instanceof _c||t instanceof gc||t instanceof vc)&&this._locations.add(new _d(t,0,t.getCoordinate()))},bd.prototype.interfaces_=function(){return[$h]},bd.prototype.getClass=function(){return bd},bd.getLocations=function(t){var e=new _h;return t.apply(new bd(e)),e};function xd(t,e,n){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new yd,this._minDistanceLocation=null,this._minDistance=$u.MAX_VALUE,2===arguments.length){var i=t,r=e;this._geom=[i,r],this._terminateDistance=0}else if(3===arguments.length){var o=t,s=e,a=n;this._geom=new Array(2).fill(null),this._geom[0]=o,this._geom[1]=s,this._terminateDistance=a}}xd.prototype.computeContainmentDistance=function(t,e,n){if(0===arguments.length){var i=new Array(2).fill(null);if(this.computeContainmentDistance(0,i),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,i)}else if(2===arguments.length){var r=t,o=e,s=1-r,a=dd.getPolygons(this._geom[r]);if(0<a.size()){var u=bd.getLocations(this._geom[s]);if(this.computeContainmentDistance(u,a,o),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[s]=o[0],this._minDistanceLocation[r]=o[1],null}}else if(3===arguments.length)if(n instanceof Array&&cl(t,fh)&&cl(e,fh)){for(var l=t,h=e,c=n,p=0;p<l.size();p++)for(var f=l.get(p),d=0;d<h.size();d++)if(this.computeContainmentDistance(f,h.get(d),c),this._minDistance<=this._terminateDistance)return null}else if(n instanceof Array&&t instanceof _d&&e instanceof vc){var g=t,y=e,_=n,m=g.getCoordinate();if(ll.EXTERIOR!==this._ptLocator.locate(m,y))return _[this._minDistance=0]=g,_[1]=new _d(y,m),null}},xd.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},xd.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=gd.getLines(this._geom[0]),n=gd.getLines(this._geom[1]),i=vd.getPoints(this._geom[0]),r=vd.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},xd.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},xd.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},xd.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},xd.prototype.computeMinDistance=function(t,e,n){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(n instanceof Array&&t instanceof gc&&e instanceof _c){var i=t,r=e,o=n;if(i.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var s=i.getCoordinates(),a=r.getCoordinate(),u=0;u<s.length-1;u++){var l=Kl.distancePointLine(a,s[u],s[u+1]);if(l<this._minDistance){this._minDistance=l;var h=new Wp(s[u],s[u+1]).closestPoint(a);o[0]=new _d(i,u,h),o[1]=new _d(r,0,a)}if(this._minDistance<=this._terminateDistance)return null}}else if(n instanceof Array&&t instanceof gc&&e instanceof gc){var c=t,p=e,f=n;if(c.getEnvelopeInternal().distance(p.getEnvelopeInternal())>this._minDistance)return null;for(var d=c.getCoordinates(),g=p.getCoordinates(),y=0;y<d.length-1;y++)for(var _=0;_<g.length-1;_++){var m=Kl.distanceLineLine(d[y],d[y+1],g[_],g[_+1]);if(m<this._minDistance){this._minDistance=m;var v=new Wp(d[y],d[y+1]),b=new Wp(g[_],g[_+1]),x=v.closestPoints(b);f[0]=new _d(c,y,x[0]),f[1]=new _d(p,_,x[1])}if(this._minDistance<=this._terminateDistance)return null}}},xd.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new _d(r,0,r.getCoordinate()),n[1]=new _d(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},xd.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new Qu("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},xd.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},xd.prototype.interfaces_=function(){return[]},xd.prototype.getClass=function(){return xd},xd.distance=function(t,e){return new xd(t,e).distance()},xd.isWithinDistance=function(t,e,n){return new xd(t,e,n).distance()<=n},xd.nearestPoints=function(t,e){return new xd(t,e).nearestPoints()};function Ed(){this._pt=[new ol,new ol],this._distance=$u.NaN,this._isNull=!0}Ed.prototype.getCoordinates=function(){return this._pt},Ed.prototype.getCoordinate=function(t){return this._pt[t]},Ed.prototype.setMinimum=function(t,e){if(1===arguments.length){this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var n=t,i=e;if(this._isNull)return this.initialize(n,i),null;var r=n.distance(i);r<this._distance&&this.initialize(n,i,r)}},Ed.prototype.initialize=function(t,e,n){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var i=t,r=e;this._pt[0].setCoordinate(i),this._pt[1].setCoordinate(r),this._distance=i.distance(r),this._isNull=!1}else if(3===arguments.length){var o=t,s=e,a=n;this._pt[0].setCoordinate(o),this._pt[1].setCoordinate(s),this._distance=a,this._isNull=!1}},Ed.prototype.toString=function(){return kl.toLineString(this._pt[0],this._pt[1])},Ed.prototype.getDistance=function(){return this._distance},Ed.prototype.setMaximum=function(t,e){if(1===arguments.length){this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var n=t,i=e;if(this._isNull)return this.initialize(n,i),null;var r=n.distance(i);r>this._distance&&this.initialize(n,i,r)}},Ed.prototype.interfaces_=function(){return[]},Ed.prototype.getClass=function(){return Ed};function Id(){}Id.prototype.interfaces_=function(){return[]},Id.prototype.getClass=function(){return Id},Id.computeDistance=function(t,e,n){if(n instanceof Ed&&t instanceof gc&&e instanceof ol)for(var i=t,r=e,o=n,s=new Wp,a=i.getCoordinates(),u=0;u<a.length-1;u++){s.setCoordinates(a[u],a[u+1]);var l=s.closestPoint(r);o.setMinimum(l,r)}else if(n instanceof Ed&&t instanceof vc&&e instanceof ol){var h=t,c=e,p=n;Id.computeDistance(h.getExteriorRing(),c,p);for(var f=0;f<h.getNumInteriorRing();f++)Id.computeDistance(h.getInteriorRingN(f),c,p)}else if(n instanceof Ed&&t instanceof $l&&e instanceof ol){var d=t,g=e,y=n;if(d instanceof gc)Id.computeDistance(d,g,y);else if(d instanceof vc)Id.computeDistance(d,g,y);else if(d instanceof ec)for(var _=d,m=0;m<_.getNumGeometries();m++){var v=_.getGeometryN(m);Id.computeDistance(v,g,y)}else y.setMinimum(d.getCoordinate(),g)}else if(n instanceof Ed&&t instanceof Wp&&e instanceof ol){var b=e,x=n,E=t.closestPoint(b);x.setMinimum(E,b)}};function Ld(t,e){this._g0=null,this._g1=null,this._ptDist=new Ed,this._densifyFrac=0;var n=t,i=e;this._g0=n,this._g1=i}var wd={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ld.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ld.prototype.setDensifyFraction=function(t){if(1<t||t<=0)throw new Qu("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Ld.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Ld.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ld.prototype.computeOrientedDistance=function(t,e,n){var i=new Sd(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),0<this._densifyFrac){var r=new Md(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Ld.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ld.prototype.interfaces_=function(){return[]},Ld.prototype.getClass=function(){return Ld},Ld.distance=function(t,e,n){if(2===arguments.length)return new Ld(t,e).distance();if(3===arguments.length){var i=n,r=new Ld(t,e);return r.setDensifyFraction(i),r.distance()}},wd.MaxPointDistanceFilter.get=function(){return Sd},wd.MaxDensifiedByFractionDistanceFilter.get=function(){return Md},Object.defineProperties(Ld,wd);var Sd=function(t){this._maxPtDist=new Ed,this._minPtDist=new Ed,this._euclideanDist=new Id,this._geom=null;var e=t;this._geom=e};Sd.prototype.filter=function(t){this._minPtDist.initialize(),Id.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},Sd.prototype.getMaxPointDistance=function(){return this._maxPtDist},Sd.prototype.interfaces_=function(){return[nh]},Sd.prototype.getClass=function(){return Sd};var Md=function(t,e){this._maxPtDist=new Ed,this._minPtDist=new Ed,this._geom=null,this._numSubSegs=0;var n=t,i=e;this._geom=n,this._numSubSegs=Math.trunc(Math.round(1/i))};Md.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,u=n.y+s*o,l=new ol(a,u);this._minPtDist.initialize(),Id.computeDistance(this._geom,l,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Md.prototype.isDone=function(){return!1},Md.prototype.isGeometryChanged=function(){return!1},Md.prototype.getMaxPointDistance=function(){return this._maxPtDist},Md.prototype.interfaces_=function(){return[tc]},Md.prototype.getClass=function(){return Md};function Cd(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null}var Pd={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Cd.prototype.checkMaximumDistance=function(t,e,n){var i=new Ld(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+kl.toLineString(r[0],r[1])+")"}},Cd.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Cd.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(0<this._bufDistance?this.checkPositiveValid():this.checkNegativeValid(),Cd.VERBOSE&&Ml.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Cd.prototype.checkNegativeValid=function(){if(!(this._input instanceof vc||this._input instanceof Ec||this._input instanceof ec))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Cd.prototype.getErrorIndicator=function(){return this._errorIndicator},Cd.prototype.checkMinimumDistance=function(t,e,n){var i=new xd(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+kl.toLineString(r[0],r[1])+" )"}},Cd.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Cd.prototype.getErrorLocation=function(){return this._errorLocation},Cd.prototype.getPolygonLines=function(t){for(var e=new _h,n=new gd(e),i=dd.getPolygons(t).iterator();i.hasNext();){i.next().apply(n)}return t.getFactory().buildGeometry(e)},Cd.prototype.getErrorMessage=function(){return this._errMsg},Cd.prototype.interfaces_=function(){return[]},Cd.prototype.getClass=function(){return Cd},Pd.VERBOSE.get=function(){return!1},Pd.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Cd,Pd);function Nd(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null}var Od={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Nd.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid&&this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid},Nd.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Nd.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new Pl(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new Pl(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Nd.prototype.checkDistance=function(){var t=new Cd(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Nd.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();0<this._distance&&e<t&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Nd.prototype.checkPolygonal=function(){this._result instanceof vc||this._result instanceof Ec||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Nd.prototype.getErrorIndicator=function(){return this._errorIndicator},Nd.prototype.getErrorLocation=function(){return this._errorLocation},Nd.prototype.checkExpectedEmpty=function(){return 2<=this._input.getDimension()?null:0<this._distance?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Nd.prototype.report=function(t){if(!Nd.VERBOSE)return null;Ml.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Nd.prototype.getErrorMessage=function(){return this._errorMsg},Nd.prototype.interfaces_=function(){return[]},Nd.prototype.getClass=function(){return Nd},Nd.isValidMsg=function(t,e,n){var i=new Nd(t,e,n);return i.isValid()?null:i.getErrorMessage()},Nd.isValid=function(t,e,n){return!!new Nd(t,e,n).isValid()},Od.VERBOSE.get=function(){return!1},Od.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Nd,Od);function Td(t,e){this._pts=null,this._data=null;var n=t,i=e;this._pts=n,this._data=i}Td.prototype.getCoordinates=function(){return this._pts},Td.prototype.size=function(){return this._pts.length},Td.prototype.getCoordinate=function(t){return this._pts[t]},Td.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Td.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:Yp.octant(this.getCoordinate(t),this.getCoordinate(t+1))},Td.prototype.setData=function(t){this._data=t},Td.prototype.getData=function(){return this._data},Td.prototype.toString=function(){return kl.toLineString(new Mc(this._pts))},Td.prototype.interfaces_=function(){return[Hp]},Td.prototype.getClass=function(){return Td};function kd(t){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new _h,this._intersectionCount=0,this._keepIntersections=!0;var e=t;this._li=e,this._interiorIntersection=null}kd.prototype.getInteriorIntersection=function(){return this._interiorIntersection},kd.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},kd.prototype.getIntersectionSegments=function(){return this._intSegments},kd.prototype.count=function(){return this._intersectionCount},kd.prototype.getIntersections=function(){return this._intersections},kd.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},kd.prototype.setKeepIntersections=function(t){this._keepIntersections=t},kd.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!(this.isEndSegment(t,e)||this.isEndSegment(n,i)))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},kd.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},kd.prototype.hasIntersection=function(){return null!==this._interiorIntersection},kd.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},kd.prototype.interfaces_=function(){return[Df]},kd.prototype.getClass=function(){return kd},kd.createAllIntersectionsFinder=function(t){var e=new kd(t);return e.setFindAllIntersections(!0),e},kd.createAnyIntersectionFinder=function(t){return new kd(t)},kd.createIntersectionCounter=function(t){var e=new kd(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};function Rd(t){this._li=new Hl,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var e=t;this._segStrings=e}Rd.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Rd.prototype.getIntersections=function(){return this._segInt.getIntersections()},Rd.prototype.isValid=function(){return this.execute(),this._isValid},Rd.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Rd.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new kd(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new rf;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Rd.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Qc(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Rd.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+kl.toLineString(t[0],t[1])+" and "+kl.toLineString(t[2],t[3])},Rd.prototype.interfaces_=function(){return[]},Rd.prototype.getClass=function(){return Rd},Rd.computeIntersections=function(t){var e=new Rd(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};function Dd(){this._nv=null;var t=arguments[0];this._nv=new Rd(Dd.toSegmentStrings(t))}Dd.prototype.checkValid=function(){this._nv.checkValid()},Dd.prototype.interfaces_=function(){return[]},Dd.prototype.getClass=function(){return Dd},Dd.toSegmentStrings=function(t){for(var e=new _h,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Td(i.getCoordinates(),i))}return e},Dd.checkValid=function(t){new Dd(t).checkValid()};function Ad(t){this._mapOp=t}Ad.prototype.map=function(t){for(var e=new _h,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(Bc.toGeometryArray(e))},Ad.prototype.interfaces_=function(){return[]},Ad.prototype.getClass=function(){return Ad},Ad.map=function(t,e){return new Ad(e).map(t)};function Fd(t,e,n){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new _h,this._resultLineList=new _h;var i=t,r=e,o=n;this._op=i,this._geometryFactory=r,this._ptLocator=o}Fd.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Fd.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Fd.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Fd.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Cg.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Fd.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();){t.next().getEdges().findCoveredLineEdges()}for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Fd.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Fd.prototype.buildLines=function(){for(var t=this._lineEdgesList.iterator();t.hasNext();){var e=t.next(),n=this._geometryFactory.createLineString(e.getCoordinates());this._resultLineList.add(n),e.setInResult(!0)}},Fd.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()?null:t.isVisited()?null:t.isInteriorAreaEdge()?null:t.getEdge().isInResult()?null:(ql.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Cg.isResultOfOp(i,e)&&e===Cg.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Fd.prototype.interfaces_=function(){return[]},Fd.prototype.getClass=function(){return Fd};function Bd(t,e){this._op=null,this._geometryFactory=null,this._resultPointList=new _h;var n=t,i=e;this._op=n,this._geometryFactory=i}Bd.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Bd.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!n.isInResult()&&(!n.isIncidentEdgeInResult()&&(0===n.getEdges().getDegree()||t===Cg.INTERSECTION))){var i=n.getLabel();Cg.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Bd.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Bd.prototype.interfaces_=function(){return[]},Bd.prototype.getClass=function(){return Bd};function Gd(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1}Gd.prototype.transformPoint=function(t){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Gd.prototype.transformPolygon=function(t){var e=!0,n=this.transformLinearRing(t.getExteriorRing(),t);null!==n&&n instanceof xc&&!n.isEmpty()||(e=!1);for(var i=new _h,r=0;r<t.getNumInteriorRing();r++){var o=this.transformLinearRing(t.getInteriorRingN(r),t);null===o||o.isEmpty()||(o instanceof xc||(e=!1),i.add(o))}if(e)return this._factory.createPolygon(n,i.toArray([]));var s=new _h;return null!==n&&s.add(n),s.addAll(i),this._factory.buildGeometry(s)},Gd.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Gd.prototype.getInputGeometry=function(){return this._inputGeom},Gd.prototype.transformMultiLineString=function(t){for(var e=new _h,n=0;n<t.getNumGeometries();n++){var i=this.transformLineString(t.getGeometryN(n),t);null!==i&&(i.isEmpty()||e.add(i))}return this._factory.buildGeometry(e)},Gd.prototype.transformCoordinates=function(t){return this.copy(t)},Gd.prototype.transformLineString=function(t){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Gd.prototype.transformMultiPoint=function(t){for(var e=new _h,n=0;n<t.getNumGeometries();n++){var i=this.transformPoint(t.getGeometryN(n),t);null!==i&&(i.isEmpty()||e.add(i))}return this._factory.buildGeometry(e)},Gd.prototype.transformMultiPolygon=function(t){for(var e=new _h,n=0;n<t.getNumGeometries();n++){var i=this.transformPolygon(t.getGeometryN(n),t);null!==i&&(i.isEmpty()||e.add(i))}return this._factory.buildGeometry(e)},Gd.prototype.copy=function(t){return t.copy()},Gd.prototype.transformGeometryCollection=function(t){for(var e=new _h,n=0;n<t.getNumGeometries();n++){var i=this.transform(t.getGeometryN(n));null!==i&&(this._pruneEmptyGeometry&&i.isEmpty()||e.add(i))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(Bc.toGeometryArray(e)):this._factory.buildGeometry(e)},Gd.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof _c)return this.transformPoint(t,null);if(t instanceof bc)return this.transformMultiPoint(t,null);if(t instanceof xc)return this.transformLinearRing(t,null);if(t instanceof gc)return this.transformLineString(t,null);if(t instanceof nc)return this.transformMultiLineString(t,null);if(t instanceof vc)return this.transformPolygon(t,null);if(t instanceof Ec)return this.transformMultiPolygon(t,null);if(t instanceof ec)return this.transformGeometryCollection(t,null);throw new Qu("Unknown Geometry subtype: "+t.getClass().getName())},Gd.prototype.transformLinearRing=function(t){var e=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===e)return this._factory.createLinearRing(null);var n=e.size();return 0<n&&n<4&&!this._preserveType?this._factory.createLineString(e):this._factory.createLinearRing(e)},Gd.prototype.interfaces_=function(){return[]},Gd.prototype.getClass=function(){return Gd};function Ud(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Wp,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof gc&&"number"==typeof arguments[1]){var t=arguments[1];Ud.call(this,arguments[0].getCoordinates(),t)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var e=arguments[0],n=arguments[1];this._srcPts=e,this._isClosed=Ud.isClosed(e),this._snapTolerance=n}}Ud.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new ol(o)),0===i&&this._isClosed&&t.set(t.size()-1,new ol(o)))}},Ud.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Ud.prototype.snapTo=function(t){var e=new Ih(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Ud.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);0<=o&&t.add(o+1,new ol(r),!1)}},Ud.prototype.findSegmentIndexToSnap=function(t,e){for(var n=$u.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Ud.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Ud.prototype.interfaces_=function(){return[]},Ud.prototype.getClass=function(){return Ud},Ud.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};function jd(t){this._srcGeom=t||null}var qd={SNAP_PRECISION_FACTOR:{configurable:!0}};jd.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Vd(e,n).transform(this._srcGeom)},jd.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new Vd(t,n,!0).transform(this._srcGeom),r=i;return e&&cl(r,yc)&&(r=i.buffer(0)),r},jd.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},jd.prototype.extractTargetCoordinates=function(t){for(var e=new Jh,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},jd.prototype.computeMinimumSegmentLength=function(t){for(var e=$u.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},jd.prototype.interfaces_=function(){return[]},jd.prototype.getClass=function(){return jd},jd.snap=function(t,e,n){var i=new Array(2).fill(null),r=new jd(t);i[0]=r.snapTo(e,n);var o=new jd(e);return i[1]=o.snapTo(i[0],n),i},jd.computeOverlaySnapTolerance=function(t,e){if(1===arguments.length){var n=t,i=jd.computeSizeBasedSnapTolerance(n),r=n.getPrecisionModel();if(r.getType()===Rc.FIXED){var o=1/r.getScale()*2/1.415;i<o&&(i=o)}return i}if(2===arguments.length){var s=t,a=e;return Math.min(jd.computeOverlaySnapTolerance(s),jd.computeOverlaySnapTolerance(a))}},jd.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*jd.SNAP_PRECISION_FACTOR},jd.snapToSelf=function(t,e,n){return new jd(t).snapToSelf(e,n)},qd.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(jd,qd);var zd,Vd=((zd=Gd)&&(Yd.__proto__=zd),((Yd.prototype=Object.create(zd&&zd.prototype)).constructor=Yd).prototype.snapLine=function(t,e){var n=new Ud(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},Yd.prototype.transformCoordinates=function(t){var e=t.toCoordinateArray(),n=this.snapLine(e,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(n)},Yd.prototype.interfaces_=function(){return[]},Yd.prototype.getClass=function(){return Yd},Yd);function Yd(t,e,n){zd.call(this),this._snapTolerance=t||null,this._snapPts=e||null,this._isSelfSnap=void 0!==n&&n}function Hd(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null}Hd.prototype.getCommon=function(){return $u.longBitsToDouble(this._commonBits)},Hd.prototype.add=function(t){var e=$u.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Hd.signExpBits(this._commonBits),this._isFirst=!1,null):Hd.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Hd.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Hd.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Hd.prototype.toString=function(t){if(1===arguments.length){var e=t,n=$u.longBitsToDouble(e),i="0000000000000000000000000000000000000000000000000000000000000000"+$u.toBinaryString(e),r=i.substring(i.length-64);return r.substring(0,1)+"  "+r.substring(1,12)+"(exp) "+r.substring(12)+" [ "+n+" ]"}},Hd.prototype.interfaces_=function(){return[]},Hd.prototype.getClass=function(){return Hd},Hd.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Hd.signExpBits=function(t){return t>>52},Hd.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Hd.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;0<=i;i--){if(Hd.getBit(t,i)!==Hd.getBit(e,i))return n;n++}return 52};function Xd(){this._commonCoord=null,this._ccFilter=new Wd}var Jd={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Xd.prototype.addCommonBits=function(t){var e=new Kd(this._commonCoord);t.apply(e),t.geometryChanged()},Xd.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new ol(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new Kd(e);return t.apply(n),t.geometryChanged(),t},Xd.prototype.getCommonCoordinate=function(){return this._commonCoord},Xd.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},Xd.prototype.interfaces_=function(){return[]},Xd.prototype.getClass=function(){return Xd},Jd.CommonCoordinateFilter.get=function(){return Wd},Jd.Translater.get=function(){return Kd},Object.defineProperties(Xd,Jd);var Wd=function(){this._commonBitsX=new Hd,this._commonBitsY=new Hd};Wd.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},Wd.prototype.getCommonCoordinate=function(){return new ol(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},Wd.prototype.interfaces_=function(){return[nh]},Wd.prototype.getClass=function(){return Wd};var Kd=function(t){this.trans=null;var e=t;this.trans=e};Kd.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},Kd.prototype.isDone=function(){return!1},Kd.prototype.isGeometryChanged=function(){return!0},Kd.prototype.interfaces_=function(){return[tc]},Kd.prototype.getClass=function(){return Kd};function Zd(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()}Zd.prototype.selfSnap=function(t){return new jd(t).snapTo(t,this._snapTolerance)},Zd.prototype.removeCommonBits=function(t){this._cbr=new Xd,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},Zd.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},Zd.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Cg.overlayOp(e[0],e[1],t);return this.prepareResult(n)},Zd.prototype.checkValid=function(t){t.isValid()||Ml.out.println("Snapped geometry is invalid")},Zd.prototype.computeSnapTolerance=function(){this._snapTolerance=jd.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},Zd.prototype.snap=function(t){var e=this.removeCommonBits(t);return jd.snap(e[0],e[1],this._snapTolerance)},Zd.prototype.interfaces_=function(){return[]},Zd.prototype.getClass=function(){return Zd},Zd.overlayOp=function(t,e,n){return new Zd(t,e).getResultGeometry(n)},Zd.union=function(t,e){return Zd.overlayOp(t,e,Cg.UNION)},Zd.intersection=function(t,e){return Zd.overlayOp(t,e,Cg.INTERSECTION)},Zd.symDifference=function(t,e){return Zd.overlayOp(t,e,Cg.SYMDIFFERENCE)},Zd.difference=function(t,e){return Zd.overlayOp(t,e,Cg.DIFFERENCE)};function Qd(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e}Qd.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=Cg.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof Fl))throw t;i=t}if(!n)try{e=Zd.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof Fl?i:t}return e},Qd.prototype.interfaces_=function(){return[]},Qd.prototype.getClass=function(){return Qd},Qd.overlayOp=function(t,e,n){return new Qd(t,e).getResultGeometry(n)},Qd.union=function(t,e){return Qd.overlayOp(t,e,Cg.UNION)},Qd.intersection=function(t,e){return Qd.overlayOp(t,e,Cg.INTERSECTION)},Qd.symDifference=function(t,e){return Qd.overlayOp(t,e,Cg.SYMDIFFERENCE)},Qd.difference=function(t,e){return Qd.overlayOp(t,e,Cg.DIFFERENCE)};function $d(t,e){this.mce=null,this.chainIndex=null;var n=t,i=e;this.mce=n,this.chainIndex=i}$d.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},$d.prototype.interfaces_=function(){return[]},$d.prototype.getClass=function(){return $d};function tg(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var t=arguments[0],e=arguments[1];this._eventType=tg.DELETE,this._xValue=t,this._insertEvent=e}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._eventType=tg.INSERT,this._label=n,this._xValue=i,this._obj=r}}var eg={INSERT:{configurable:!0},DELETE:{configurable:!0}};tg.prototype.isDelete=function(){return this._eventType===tg.DELETE},tg.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},tg.prototype.getObject=function(){return this._obj},tg.prototype.compareTo=function(t){return this._xValue<t._xValue?-1:this._xValue>t._xValue?1:this._eventType<t._eventType?-1:this._eventType>t._eventType?1:0},tg.prototype.getInsertEvent=function(){return this._insertEvent},tg.prototype.isInsert=function(){return this._eventType===tg.INSERT},tg.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},tg.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},tg.prototype.interfaces_=function(){return[el]},tg.prototype.getClass=function(){return tg},eg.INSERT.get=function(){return 1},eg.DELETE.get=function(){return 2},Object.defineProperties(tg,eg);function ng(){}ng.prototype.interfaces_=function(){return[]},ng.prototype.getClass=function(){return ng};function ig(t,e,n){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var i=t,r=e,o=n;this._li=i,this._includeProper=r,this._recordIsolated=o}ig.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(ig.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},ig.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},ig.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},ig.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},ig.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},ig.prototype.hasProperIntersection=function(){return this._hasProper},ig.prototype.hasIntersection=function(){return this._hasIntersection},ig.prototype.isDone=function(){return this._isDone},ig.prototype.isBoundaryPoint=function(t,e){return null!==e&&(!!this.isBoundaryPointInternal(t,e[0])||!!this.isBoundaryPointInternal(t,e[1]))},ig.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},ig.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},ig.prototype.interfaces_=function(){return[]},ig.prototype.getClass=function(){return ig},ig.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var rg,og=((rg=ng)&&(sg.__proto__=rg),((sg.prototype=Object.create(rg&&rg.prototype)).constructor=sg).prototype.prepareEvents=function(){Tp.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},sg.prototype.computeIntersections=function(t,e,n){if(1===arguments.length){var i=t;this.nOverlaps=0,this.prepareEvents();for(var r=0;r<this.events.size();r++){var o=this.events.get(r);if(o.isInsert()&&this.processOverlaps(r,o.getDeleteEventIndex(),o,i),i.isDone())break}}else if(3===arguments.length)if(n instanceof ig&&cl(t,fh)&&cl(e,fh)){var s=e,a=n;this.addEdges(t,t),this.addEdges(s,s),this.computeIntersections(a)}else if("boolean"==typeof n&&cl(t,fh)&&e instanceof ig){var u=t,l=e;n?this.addEdges(u,null):this.addEdges(u),this.computeIntersections(l)}},sg.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new $d(n,r),s=new tg(e,n.getMinX(r),o);this.events.add(s),this.events.add(new tg(n.getMaxX(r),s))}},sg.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},sg.prototype.addEdges=function(t,e){if(1===arguments.length)for(var n=t.iterator();n.hasNext();){var i=n.next();this.addEdge(i,i)}else if(2===arguments.length)for(var r=e,o=t.iterator();o.hasNext();){var s=o.next();this.addEdge(s,r)}},sg.prototype.interfaces_=function(){return[]},sg.prototype.getClass=function(){return sg},sg);function sg(){rg.call(this),this.events=new _h,this.nOverlaps=null}function ag(){this._min=$u.POSITIVE_INFINITY,this._max=$u.NEGATIVE_INFINITY}var ug={NodeComparator:{configurable:!0}};ag.prototype.getMin=function(){return this._min},ag.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},ag.prototype.getMax=function(){return this._max},ag.prototype.toString=function(){return kl.toLineString(new ol(this._min,0),new ol(this._max,0))},ag.prototype.interfaces_=function(){return[]},ag.prototype.getClass=function(){return ag},ug.NodeComparator.get=function(){return lg},Object.defineProperties(ag,ug);var lg=function(){};lg.prototype.compare=function(t,e){var n=(t._min+t._max)/2,i=(e._min+e._max)/2;return n<i?-1:i<n?1:0},lg.prototype.interfaces_=function(){return[il]},lg.prototype.getClass=function(){return lg};var hg,cg=((hg=ag)&&(pg.__proto__=hg),((pg.prototype=Object.create(hg&&hg.prototype)).constructor=pg).prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},pg.prototype.interfaces_=function(){return[]},pg.prototype.getClass=function(){return pg},pg);function pg(){hg.call(this),this._item=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._min=t,this._max=e,this._item=n}var fg,dg=((fg=ag)&&(gg.__proto__=fg),((gg.prototype=Object.create(fg&&fg.prototype)).constructor=gg).prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},gg.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},gg.prototype.interfaces_=function(){return[]},gg.prototype.getClass=function(){return gg},gg);function gg(){fg.call(this),this._node1=null,this._node2=null;var t=arguments[0],e=arguments[1];this._node1=t,this._node2=e,this.buildExtent(this._node1,this._node2)}function yg(){this._leaves=new _h,this._root=null,this._level=0}yg.prototype.buildTree=function(){Tp.sort(this._leaves,new ag.NodeComparator);for(var t=this._leaves,e=null,n=new _h;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},yg.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new cg(t,e,n))},yg.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},yg.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},yg.prototype.printNode=function(t){Ml.out.println(kl.toLineString(new ol(t._min,this._level),new ol(t._max,this._level)))},yg.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},yg.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new dg(t.get(n),t.get(n+1));e.add(r)}}},yg.prototype.interfaces_=function(){return[]},yg.prototype.getClass=function(){return yg};function _g(){this._items=new _h}_g.prototype.visitItem=function(t){this._items.add(t)},_g.prototype.getItems=function(){return this._items},_g.prototype.interfaces_=function(){return[Cp]},_g.prototype.getClass=function(){return _g};function mg(t){this._index=null;var e=t;if(!cl(e,yc))throw new Qu("Argument must be Polygonal");this._index=new xg(e)}var vg={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};mg.prototype.locate=function(t){var e=new Wl(t),n=new bg(e);return this._index.query(t.y,t.y,n),e.getLocation()},mg.prototype.interfaces_=function(){return[If]},mg.prototype.getClass=function(){return mg},vg.SegmentVisitor.get=function(){return bg},vg.IntervalIndexedGeometry.get=function(){return xg},Object.defineProperties(mg,vg);var bg=function(t){this._counter=null;var e=t;this._counter=e};bg.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},bg.prototype.interfaces_=function(){return[Cp]},bg.prototype.getClass=function(){return bg};var xg=function(t){this._index=new yg;var e=t;this.init(e)};xg.prototype.init=function(t){for(var e=gd.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},xg.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new Wp(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},xg.prototype.query=function(t,e,n){if(2===arguments.length){var i=t,r=e,o=new _g;return this._index.query(i,r,o),o.getItems()}if(3===arguments.length){var s=t,a=e,u=n;this._index.query(s,a,u)}},xg.prototype.interfaces_=function(){return[]},xg.prototype.getClass=function(){return xg};var Eg,Ig=((Eg=Ip)&&(Lg.__proto__=Eg),((Lg.prototype=Object.create(Eg&&Eg.prototype)).constructor=Lg).prototype.insertBoundaryPoint=function(t,e){var n=this._nodes.addNode(e).getLabel(),i=1;n.getLocation(t,Hc.ON)===ll.BOUNDARY&&i++;var r=Lg.determineBoundary(this._boundaryNodeRule,i);n.setLocation(t,r)},Lg.prototype.computeSelfNodes=function(t,e,n){if(2===arguments.length){var i=t,r=e;return this.computeSelfNodes(i,r,!1)}if(3===arguments.length){var o=e,s=n,a=new ig(t,!0,!1);a.setIsDoneIfProperInt(s);var u=this.createEdgeSetIntersector(),l=this._parentGeom instanceof xc||this._parentGeom instanceof vc||this._parentGeom instanceof Ec,h=o||!l;return u.computeIntersections(this._edges,a,h),this.addSelfIntersectionNodes(this._argIndex),a}},Lg.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},Lg.prototype.computeEdgeIntersections=function(t,e,n){var i=new ig(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},Lg.prototype.getGeometry=function(){return this._parentGeom},Lg.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},Lg.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},Lg.prototype.addPoint=function(t){if(t instanceof _c){var e=t.getCoordinate();this.insertPoint(this._argIndex,e,ll.INTERIOR)}else if(t instanceof ol){var n=t;this.insertPoint(this._argIndex,n,ll.INTERIOR)}},Lg.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),ll.EXTERIOR,ll.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,ll.INTERIOR,ll.EXTERIOR)}},Lg.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],ll.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],ll.BOUNDARY)},Lg.prototype.addLineString=function(t){var e=Eh.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new Vf(e,new ip(this._argIndex,ll.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),ql.isTrue(2<=e.length,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},Lg.prototype.getInvalidPoint=function(){return this._invalidPoint},Lg.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},Lg.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},Lg.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===ll.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},Lg.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Eh.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;Kl.isCCW(i)&&(r=n,o=e);var s=new Vf(i,new ip(this._argIndex,ll.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],ll.BOUNDARY)},Lg.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new ip(t,n):r.setLocation(t,n)},Lg.prototype.createEdgeSetIntersector=function(){return new og},Lg.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},Lg.prototype.add=function(t){if(1!==arguments.length)return Eg.prototype.add.apply(this,arguments);var e=t;if(e.isEmpty())return null;if(e instanceof Ec&&(this._useBoundaryDeterminationRule=!1),e instanceof vc)this.addPolygon(e);else if(e instanceof gc)this.addLineString(e);else if(e instanceof _c)this.addPoint(e);else if(e instanceof bc)this.addCollection(e);else if(e instanceof nc)this.addCollection(e);else if(e instanceof Ec)this.addCollection(e);else{if(!(e instanceof ec))throw new Error(e.getClass().getName());this.addCollection(e)}},Lg.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Lg.prototype.locate=function(t){return cl(this._parentGeom,yc)&&50<this._parentGeom.getNumGeometries()?(null===this._areaPtLocator&&(this._areaPtLocator=new mg(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},Lg.prototype.findEdge=function(t){if(1!==arguments.length)return Eg.prototype.findEdge.apply(this,arguments);var e=t;return this._lineEdgeMap.get(e)},Lg.prototype.interfaces_=function(){return[]},Lg.prototype.getClass=function(){return Lg},Lg.determineBoundary=function(t,e){return t.isInBoundary(e)?ll.BOUNDARY:ll.INTERIOR},Lg);function Lg(){if(Eg.call(this),this._parentGeom=null,this._lineEdgeMap=new Tc,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new yd,2===arguments.length){var t=arguments[0],e=arguments[1],n=ih.OGC_SFS_BOUNDARY_RULE;this._argIndex=t,this._parentGeom=e,this._boundaryNodeRule=n,null!==e&&this.add(e)}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._argIndex=i,this._parentGeom=r,this._boundaryNodeRule=o,null!==r&&this.add(r)}}function wg(t,e,n){if(this._li=new Hl,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var i=t;this.setComputationPrecision(i.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Ig(0,i)}else if(2===arguments.length){var r=t,o=e,s=ih.OGC_SFS_BOUNDARY_RULE;0<=r.getPrecisionModel().compareTo(o.getPrecisionModel())?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ig(0,r,s),this._arg[1]=new Ig(1,o,s)}else if(3===arguments.length){var a=t,u=e,l=n;0<=a.getPrecisionModel().compareTo(u.getPrecisionModel())?this.setComputationPrecision(a.getPrecisionModel()):this.setComputationPrecision(u.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Ig(0,a,l),this._arg[1]=new Ig(1,u,l)}}wg.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},wg.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},wg.prototype.interfaces_=function(){return[]},wg.prototype.getClass=function(){return wg};function Sg(){}Sg.prototype.interfaces_=function(){return[]},Sg.prototype.getClass=function(){return Sg},Sg.map=function(t,e){if(t instanceof $l&&cl(e,Sg.MapOp)){for(var n=t,i=e,r=new _h,o=0;o<n.getNumGeometries();o++){var s=i.map(n.getGeometryN(o));null!==s&&r.add(s)}return n.getFactory().buildGeometry(r)}if(cl(t,lh)&&cl(e,Sg.MapOp)){for(var a=t,u=e,l=new _h,h=a.iterator();h.hasNext();){var c=h.next(),p=u.map(c);null!==p&&l.add(p)}return l}},Sg.MapOp=function(){};var Mg,Cg=((Mg=wg)&&(Pg.__proto__=Mg),((Pg.prototype=Object.create(Mg&&Mg.prototype)).constructor=Pg).prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new ip(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},Pg.prototype.getGraph=function(){return this._graph},Pg.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},Pg.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},Pg.prototype.computeGeometry=function(t,e,n,i){var r=new _h;return r.addAll(t),r.addAll(e),r.addAll(n),r.isEmpty()?Pg.createEmptyResult(i,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(r)},Pg.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},Pg.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==ll.EXTERIOR)return!0}return!1},Pg.prototype.replaceCollapsedEdges=function(){for(var t=new _h,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},Pg.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},Pg.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},Pg.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},Pg.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new _h;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),Dd.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new Lp(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Fd(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Bd(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},Pg.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},Pg.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},Pg.prototype.findResultAreaEdges=function(t){for(var e=this._graph.getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getLabel();i.isArea()&&!n.isInteriorAreaEdge()&&Pg.isResultOfOp(i.getLocation(0,Hc.RIGHT),i.getLocation(1,Hc.RIGHT),t)&&n.setInResult(!0)}},Pg.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(ql.isTrue(!i.isNull(r,Hc.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Hc.LEFT,i.getLocation(r,Hc.LEFT)),ql.isTrue(!i.isNull(r,Hc.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Hc.RIGHT,i.getLocation(r,Hc.RIGHT))))}}},Pg.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},Pg.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},Pg.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},Pg.prototype.interfaces_=function(){return[]},Pg.prototype.getClass=function(){return Pg},Pg);function Pg(){var t=arguments[0],e=arguments[1];Mg.call(this,t,e),this._ptLocator=new yd,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Rf,this._resultPolyList=new _h,this._resultLineList=new _h,this._resultPointList=new _h,this._graph=new Ip(new Of),this._geomFact=t.getFactory()}Cg.overlayOp=function(t,e,n){return new Cg(t,e).getResultGeometry(n)},Cg.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Cg.createEmptyResult(Cg.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Ad.map(t,{interfaces_:function(){return[Sg.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Qd.overlayOp(t,e,Cg.INTERSECTION)},Cg.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Cg.createEmptyResult(Cg.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Qd.overlayOp(t,e,Cg.SYMDIFFERENCE)},Cg.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case Cg.INTERSECTION:o=Math.min(i,r);break;case Cg.UNION:o=Math.max(i,r);break;case Cg.DIFFERENCE:o=i;break;case Cg.SYMDIFFERENCE:o=Math.max(i,r)}return o},Cg.createEmptyResult=function(t,e,n,i){var r=null;switch(Cg.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Cg.difference=function(t,e){return t.isEmpty()?Cg.createEmptyResult(Cg.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Qd.overlayOp(t,e,Cg.DIFFERENCE))},Cg.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Cg.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1];switch(r===ll.BOUNDARY&&(r=ll.INTERIOR),o===ll.BOUNDARY&&(o=ll.INTERIOR),arguments[2]){case Cg.INTERSECTION:return r===ll.INTERIOR&&o===ll.INTERIOR;case Cg.UNION:return r===ll.INTERIOR||o===ll.INTERIOR;case Cg.DIFFERENCE:return r===ll.INTERIOR&&o!==ll.INTERIOR;case Cg.SYMDIFFERENCE:return r===ll.INTERIOR&&o!==ll.INTERIOR||r!==ll.INTERIOR&&o===ll.INTERIOR}return!1}},Cg.INTERSECTION=1,Cg.UNION=2,Cg.DIFFERENCE=3,Cg.SYMDIFFERENCE=4;function Ng(t,e){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new yd,this._seg=new Wp;var n=t,i=e;this._g=n,this._boundaryDistanceTolerance=i,this._linework=this.extractLinework(n)}Ng.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++){if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0}return!1},Ng.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?ll.BOUNDARY:this._ptLocator.locate(t,this._g)},Ng.prototype.extractLinework=function(t){var e=new Og;t.apply(e);var n=e.getLinework(),i=Bc.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},Ng.prototype.interfaces_=function(){return[]},Ng.prototype.getClass=function(){return Ng};var Og=function(){this._linework=null,this._linework=new _h};Og.prototype.getLinework=function(){return this._linework},Og.prototype.filter=function(t){if(t instanceof vc){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Og.prototype.interfaces_=function(){return[$h]},Og.prototype.getClass=function(){return Og};function Tg(t){this._g=null,this._doLeft=!0,this._doRight=!0;var e=t;this._g=e}Tg.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Tg.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Tg.prototype.getPoints=function(t){for(var e=new _h,n=gd.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Tg.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,u=n*o/s,l=(e.x+t.x)/2,h=(e.y+t.y)/2;if(this._doLeft){var c=new ol(l-u,h+a);i.add(c)}if(this._doRight){var p=new ol(l+u,h-a);i.add(p)}},Tg.prototype.interfaces_=function(){return[]},Tg.prototype.getClass=function(){return Tg};function kg(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=kg.TOLERANCE,this._testCoords=new _h;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundaryDistanceTolerance=kg.computeBoundaryDistanceTolerance(t,e),this._geom=[t,e,n],this._locFinder=[new Ng(this._geom[0],this._boundaryDistanceTolerance),new Ng(this._geom[1],this._boundaryDistanceTolerance),new Ng(this._geom[2],this._boundaryDistanceTolerance)]}var Rg={TOLERANCE:{configurable:!0}};kg.prototype.reportResult=function(t,e,n){Ml.out.println("Overlay result invalid - A:"+ll.toLocationSymbol(e[0])+" B:"+ll.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+ll.toLocationSymbol(e[2]))},kg.prototype.isValid=function(t){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var e=this.checkValid(t);return e},kg.prototype.checkValid=function(t,e){if(1===arguments.length){for(var n=t,i=0;i<this._testCoords.size();i++){var r=this._testCoords.get(i);if(!this.checkValid(n,r))return this._invalidLocation=r,!1}return!0}if(2===arguments.length){var o=t,s=e;return this._location[0]=this._locFinder[0].getLocation(s),this._location[1]=this._locFinder[1].getLocation(s),this._location[2]=this._locFinder[2].getLocation(s),!!kg.hasLocation(this._location,ll.BOUNDARY)||this.isValidResult(o,this._location)}},kg.prototype.addTestPts=function(t){var e=new Tg(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},kg.prototype.isValidResult=function(t,e){var n=Cg.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===ll.INTERIOR);return i||this.reportResult(t,e,n),i},kg.prototype.getInvalidLocation=function(){return this._invalidLocation},kg.prototype.interfaces_=function(){return[]},kg.prototype.getClass=function(){return kg},kg.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},kg.computeBoundaryDistanceTolerance=function(t,e){return Math.min(jd.computeSizeBasedSnapTolerance(t),jd.computeSizeBasedSnapTolerance(e))},kg.isValid=function(t,e,n,i){return new kg(t,e,i).isValid(n)},Rg.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(kg,Rg);function Dg(t){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=Dg.extractFactory(t),this._inputGeoms=t}Dg.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},Dg.prototype.combine=function(){for(var t=new _h,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Dg.prototype.interfaces_=function(){return[]},Dg.prototype.getClass=function(){return Dg},Dg.combine=function(t,e,n){return 1===arguments.length?new Dg(t).combine():2===arguments.length?new Dg(Dg.createList(t,e)).combine():3===arguments.length?new Dg(Dg.createList(t,e,n)).combine():void 0},Dg.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Dg.createList=function(t,e,n){if(2===arguments.length){var i=t,r=e,o=new _h;return o.add(i),o.add(r),o}if(3===arguments.length){var s=t,a=e,u=n,l=new _h;return l.add(s),l.add(a),l.add(u),l}};function Ag(t){this._inputPolys=null,this._geomFactory=null;var e=t;this._inputPolys=e,null===this._inputPolys&&(this._inputPolys=new _h)}var Fg={STRTREE_NODE_CAPACITY:{configurable:!0}};Ag.prototype.reduceToGeometries=function(t){for(var e=new _h,n=t.iterator();n.hasNext();){var i=n.next(),r=null;cl(i,fh)?r=this.unionTree(i):i instanceof $l&&(r=i),e.add(r)}return e},Ag.prototype.extractByEnvelope=function(t,e,n){for(var i=new _h,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Ag.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Dg.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Ag.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new Gp(Ag.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Ag.prototype.binaryUnion=function(t,e,n){if(1===arguments.length){return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var i=t,r=e,o=n;if(o-r<=1){var s=Ag.getGeometry(i,r);return this.unionSafe(s,null)}if(o-r==2)return this.unionSafe(Ag.getGeometry(i,r),Ag.getGeometry(i,r+1));var a=Math.trunc((o+r)/2),u=this.binaryUnion(i,r,a),l=this.binaryUnion(i,a,o);return this.unionSafe(u,l)}},Ag.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Ag.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Ag.prototype.unionActual=function(t,e){return Ag.restrictToPolygons(t.union(e))},Ag.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Ag.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new _h,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Dg.combine(i)},Ag.prototype.bufferUnion=function(t,e){if(1===arguments.length){var n=t;return n.get(0).getFactory().buildGeometry(n).buffer(0)}if(2===arguments.length){var i=t,r=e;return i.getFactory().createGeometryCollection([i,r]).buffer(0)}},Ag.prototype.interfaces_=function(){return[]},Ag.prototype.getClass=function(){return Ag},Ag.restrictToPolygons=function(t){if(cl(t,yc))return t;var e=dd.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(Bc.toPolygonArray(e))},Ag.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Ag.union=function(t){return new Ag(t).union()},Fg.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Ag,Fg);var Bg=function(){};function Gg(t){switch(t.type){case"Polygon":return 1<qr(t)?t:null;case"MultiPolygon":var e=[];if(ce(t,function(t){1<qr(t)&&e.push(t.geometry.coordinates)}),e.length)return{type:"MultiPolygon",coordinates:e}}}Bg.prototype.interfaces_=function(){return[]},Bg.prototype.getClass=function(){return Bg},Bg.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Cg.createEmptyResult(Cg.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Qd.overlayOp(t,e,Cg.UNION)};function Ug(){return new jg}function jg(){this.reset()}jg.prototype={constructor:jg,reset:function(){this.s=this.t=0},add:function(t){zg(qg,t,this.t),zg(this,qg.s,this.s),this.s?this.t+=qg.t:this.s=qg.t},valueOf:function(){return this.s}};var qg=new jg;function zg(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}var Vg=1e-6,Yg=Math.PI,Hg=Yg/2,Xg=Yg/4,Jg=2*Yg,Wg=180/Yg,Kg=Yg/180,Zg=Math.abs,Qg=Math.atan,$g=Math.atan2,ty=Math.cos,ey=Math.exp,ny=Math.log,iy=Math.sin,ry=Math.sqrt,oy=Math.tan;function sy(t){return 1<t?Hg:t<-1?-Hg:Math.asin(t)}function ay(){}function uy(t,e){t&&hy.hasOwnProperty(t.type)&&hy[t.type](t,e)}var ly={Feature:function(t,e){uy(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)uy(n[i].geometry,e)}},hy={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){cy(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)cy(n[i],e,0)},Polygon:function(t,e){py(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)py(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)uy(n[i],e)}};function cy(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function py(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)cy(t[n],e,1);e.polygonEnd()}var fy=function(t,e){t&&ly.hasOwnProperty(t.type)?ly[t.type](t,e):uy(t,e)};Ug(),Ug();function dy(t){return[$g(t[1],t[0]),sy(t[2])]}function gy(t){var e=t[0],n=t[1],i=ty(n);return[i*ty(e),i*iy(e),iy(n)]}function yy(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function _y(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function my(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function vy(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function by(t){var e=ry(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}Ug();var xy=function(n,i){function t(t,e){return t=n(t,e),i(t[0],t[1])}return n.invert&&i.invert&&(t.invert=function(t,e){return(t=i.invert(t,e))&&n.invert(t[0],t[1])}),t};function Ey(t,e){return[Yg<t?t-Jg:t<-Yg?t+Jg:t,e]}function Iy(t,e,n){return(t%=Jg)?e||n?xy(wy(t),Sy(e,n)):wy(t):e||n?Sy(e,n):Ey}function Ly(n){return function(t,e){return[Yg<(t+=n)?t-Jg:t<-Yg?t+Jg:t,e]}}function wy(t){var e=Ly(t);return e.invert=Ly(-t),e}function Sy(t,e){var a=ty(t),u=iy(t),l=ty(e),h=iy(e);function n(t,e){var n=ty(e),i=ty(t)*n,r=iy(t)*n,o=iy(e),s=o*a+i*u;return[$g(r*l-s*h,i*a-o*u),sy(s*l+r*h)]}return n.invert=function(t,e){var n=ty(e),i=ty(t)*n,r=iy(t)*n,o=iy(e),s=o*l-r*h;return[$g(r*l+o*h,i*a+s*u),sy(s*a-i*u)]},n}Ey.invert=Ey;function My(t,e){(e=gy(e))[0]-=t,by(e);var n,i=1<(n=-e[1])?0:n<-1?Yg:Math.acos(n);return((-e[2]<0?-i:i)+Jg-Vg)%Jg}function Cy(t,e){return Zg(t[0]-e[0])<Vg&&Zg(t[1]-e[1])<Vg}var Py=function(){var n,e=[];return{point:function(t,e){n.push([t,e])},lineStart:function(){e.push(n=[])},lineEnd:ay,rejoin:function(){1<e.length&&e.push(e.pop().concat(e.shift()))},result:function(){var t=e;return e=[],n=null,t}}},Ny=function(t,e,n,i,r,o){var s,a=t[0],u=t[1],l=0,h=1,c=e[0]-a,p=e[1]-u;if(s=n-a,c||!(0<s)){if(s/=c,c<0){if(s<l)return;s<h&&(h=s)}else if(0<c){if(h<s)return;l<s&&(l=s)}if(s=r-a,c||!(s<0)){if(s/=c,c<0){if(h<s)return;l<s&&(l=s)}else if(0<c){if(s<l)return;s<h&&(h=s)}if(s=i-u,p||!(0<s)){if(s/=p,p<0){if(s<l)return;s<h&&(h=s)}else if(0<p){if(h<s)return;l<s&&(l=s)}if(s=o-u,p||!(s<0)){if(s/=p,p<0){if(h<s)return;l<s&&(l=s)}else if(0<p){if(s<l)return;s<h&&(h=s)}return 0<l&&(t[0]=a+l*c,t[1]=u+l*p),h<1&&(e[0]=a+h*c,e[1]=u+h*p),!0}}}}};function Oy(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}var Ty=function(t,e,n,i,o){var s,r,a=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],r=t[e];if(Cy(i,r)){for(o.lineStart(),s=0;s<e;++s)o.point((i=t[s])[0],i[1]);o.lineEnd()}else a.push(n=new Oy(i,t,null,!0)),u.push(n.o=new Oy(i,null,n,!1)),a.push(n=new Oy(r,t,null,!1)),u.push(n.o=new Oy(r,null,n,!0))}}),a.length){for(u.sort(e),ky(a),ky(u),s=0,r=u.length;s<r;++s)u[s].e=n=!n;for(var l,h,c=a[0];;){for(var p=c,f=!0;p.v;)if((p=p.n)===c)return;l=p.z,o.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(s=0,r=l.length;s<r;++s)o.point((h=l[s])[0],h[1]);else i(p.x,p.n.x,1,o);p=p.n}else{if(f)for(l=p.p.z,s=l.length-1;0<=s;--s)o.point((h=l[s])[0],h[1]);else i(p.x,p.p.x,-1,o);p=p.p}l=(p=p.o).z,f=!f}while(!p.v);o.lineEnd()}}};function ky(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Ry(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}1===(Dy=Ry).length&&(Ay=Dy,Dy=function(t,e){return Ry(Ay(t),e)});var Dy,Ay,Fy=function(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);0<=--r;)for(e=(i=t[r]).length;0<=--e;)n[--s]=i[e];return n},By=1e9,Gy=-By;function Uy(_,m,v,b){function x(t,e){return _<=t&&t<=v&&m<=e&&e<=b}function E(t,e,n,i){var r=0,o=0;if(null==t||(r=s(t,n))!==(o=s(e,n))||a(t,e)<0^0<n)for(;i.point(0===r||3===r?_:v,1<r?b:m),(r=(r+n+4)%4)!==o;);else i.point(e[0],e[1])}function s(t,e){return Zg(t[0]-_)<Vg?0<e?0:3:Zg(t[0]-v)<Vg?0<e?2:1:Zg(t[1]-m)<Vg?0<e?1:0:0<e?3:2}function I(t,e){return a(t.x,e.x)}function a(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(i){var r,c,o,s,a,u,l,h,p,f,d,g=i,t=Py(),e={point:n,lineStart:function(){e.point=y,c&&c.push(o=[]);f=!0,p=!1,l=h=NaN},lineEnd:function(){r&&(y(s,a),u&&p&&t.rejoin(),r.push(t.result()));e.point=n,p&&g.lineEnd()},polygonStart:function(){g=t,r=[],c=[],d=!0},polygonEnd:function(){var t=function(){for(var t=0,e=0,n=c.length;e<n;++e)for(var i,r,o=c[e],s=1,a=o.length,u=o[0],l=u[0],h=u[1];s<a;++s)i=l,r=h,u=o[s],l=u[0],h=u[1],r<=b?b<h&&(h-r)*(_-i)<(l-i)*(b-r)&&++t:h<=b&&(l-i)*(b-r)<(h-r)*(_-i)&&--t;return t}(),e=d&&t,n=(r=Fy(r)).length;(e||n)&&(i.polygonStart(),e&&(i.lineStart(),E(null,null,1,i),i.lineEnd()),n&&Ty(r,I,t,E,i),i.polygonEnd());g=i,r=c=o=null}};function n(t,e){x(t,e)&&g.point(t,e)}function y(t,e){var n=x(t,e);if(c&&o.push([t,e]),f)s=t,a=e,f=!1,(u=n)&&(g.lineStart(),g.point(t,e));else if(n&&p)g.point(t,e);else{var i=[l=Math.max(Gy,Math.min(By,l)),h=Math.max(Gy,Math.min(By,h))],r=[t=Math.max(Gy,Math.min(By,t)),e=Math.max(Gy,Math.min(By,e))];Ny(i,r,_,m,v,b)?(p||(g.lineStart(),g.point(i[0],i[1])),g.point(r[0],r[1]),n||g.lineEnd(),d=!1):n&&(g.lineStart(),g.point(t,e),d=!1)}l=t,h=e,p=n}return e}}var jy=Ug(),qy=(Ug(),function(t){return t}),zy=(Ug(),Ug(),1/0),Vy=zy,Yy=-zy,Hy=Yy,Xy={point:function(t,e){t<zy&&(zy=t);Yy<t&&(Yy=t);e<Vy&&(Vy=e);Hy<e&&(Hy=e)},lineStart:ay,lineEnd:ay,polygonStart:ay,polygonEnd:ay,result:function(){var t=[[zy,Vy],[Yy,Hy]];return Yy=Hy=-(Vy=zy=1/0),t}};function Jy(m,v,b,x){return function(i,a){var u,l,h,r=v(a),e=i.invert(x[0],x[1]),c=Py(),p=v(c),f=!1,n={point:o,lineStart:s,lineEnd:d,polygonStart:function(){n.point=g,n.lineStart=y,n.lineEnd=_,l=[],u=[]},polygonEnd:function(){n.point=o,n.lineStart=s,n.lineEnd=d,l=Fy(l);var t=function(t,e){var n=e[0],i=e[1],r=[iy(n),-ty(n),0],o=0,s=0;jy.reset();for(var a=0,u=t.length;a<u;++a)if(h=(l=t[a]).length)for(var l,h,c=l[h-1],p=c[0],f=c[1]/2+Xg,d=iy(f),g=ty(f),y=0;y<h;++y,p=m,d=b,g=x,c=_){var _=l[y],m=_[0],v=_[1]/2+Xg,b=iy(v),x=ty(v),E=m-p,I=0<=E?1:-1,L=I*E,w=Yg<L,S=d*b;if(jy.add($g(S*I*iy(L),g*x+S*ty(L))),o+=w?E+I*Jg:E,w^n<=p^n<=m){var M=_y(gy(c),gy(_));by(M);var C=_y(r,M);by(C);var P=(w^0<=E?-1:1)*sy(C[2]);(P<i||i===P&&(M[0]||M[1]))&&(s+=w^0<=E?1:-1)}}return(o<-Vg||o<Vg&&jy<-Vg)^1&s}(u,e);l.length?(f||(a.polygonStart(),f=!0),Ty(l,Ky,t,b,a)):t&&(f||(a.polygonStart(),f=!0),a.lineStart(),b(null,null,1,a),a.lineEnd()),f&&(a.polygonEnd(),f=!1),l=u=null},sphere:function(){a.polygonStart(),a.lineStart(),b(null,null,1,a),a.lineEnd(),a.polygonEnd()}};function o(t,e){var n=i(t,e);m(t=n[0],e=n[1])&&a.point(t,e)}function t(t,e){var n=i(t,e);r.point(n[0],n[1])}function s(){n.point=t,r.lineStart()}function d(){n.point=o,r.lineEnd()}function g(t,e){h.push([t,e]);var n=i(t,e);p.point(n[0],n[1])}function y(){p.lineStart(),h=[]}function _(){g(h[0][0],h[0][1]),p.lineEnd();var t,e,n,i,r=p.clean(),o=c.result(),s=o.length;if(h.pop(),u.push(h),h=null,s)if(1&r){if(0<(e=(n=o[0]).length-1)){for(f||(a.polygonStart(),f=!0),a.lineStart(),t=0;t<e;++t)a.point((i=n[t])[0],i[1]);a.lineEnd()}}else 1<s&&2&r&&o.push(o.pop().concat(o.shift())),l.push(o.filter(Wy))}return n}}Ug();function Wy(t){return 1<t.length}function Ky(t,e){return((t=t.x)[0]<0?t[1]-Hg-Vg:Hg-t[1])-((e=e.x)[0]<0?e[1]-Hg-Vg:Hg-e[1])}var Zy=Jy(function(){return!0},function(c){var p,f=NaN,d=NaN,g=NaN;return{lineStart:function(){c.lineStart(),p=1},point:function(t,e){var n,i,r,o,s,a,u,l=0<t?Yg:-Yg,h=Zg(t-f);Zg(h-Yg)<Vg?(c.point(f,d=0<(d+e)/2?Hg:-Hg),c.point(g,d),c.lineEnd(),c.lineStart(),c.point(l,d),c.point(t,d),p=0):g!==l&&Yg<=h&&(Zg(f-g)<Vg&&(f-=g*Vg),Zg(t-l)<Vg&&(t-=l*Vg),i=d,o=e,u=iy((n=f)-(r=t)),d=Zg(u)>Vg?Qg((iy(i)*(a=ty(o))*iy(r)-iy(o)*(s=ty(i))*iy(n))/(s*a*u)):(i+o)/2,c.point(g,d),c.lineEnd(),c.lineStart(),c.point(l,d),p=0),c.point(f=t,d=e),g=l},lineEnd:function(){c.lineEnd(),f=d=NaN},clean:function(){return 2-p}}},function(t,e,n,i){var r;if(null==t)r=n*Hg,i.point(-Yg,r),i.point(0,r),i.point(Yg,r),i.point(Yg,0),i.point(Yg,-r),i.point(0,-r),i.point(-Yg,-r),i.point(-Yg,0),i.point(-Yg,r);else if(Zg(t[0]-e[0])>Vg){var o=t[0]<e[0]?Yg:-Yg;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])},[-Yg,-Hg]);var Qy=function(r,o){var S=ty(r),f=0<S,d=Zg(S)>Vg;function g(t,e){return ty(t)*ty(e)>S}function y(t,e,n){var i=[1,0,0],r=_y(gy(t),gy(e)),o=yy(r,r),s=r[0],a=o-s*s;if(!a)return!n&&t;var u=S*o/a,l=-S*s/a,h=_y(i,r),c=vy(i,u);my(c,vy(r,l));var p=h,f=yy(c,p),d=yy(p,p),g=f*f-d*(yy(c,c)-1);if(!(g<0)){var y=ry(g),_=vy(p,(-f-y)/d);if(my(_,c),_=dy(_),!n)return _;var m,v=t[0],b=e[0],x=t[1],E=e[1];b<v&&(m=v,v=b,b=m);var I=b-v,L=Zg(I-Yg)<Vg;if(!L&&E<x&&(m=x,x=E,E=m),L||I<Vg?L?0<x+E^_[1]<(Zg(_[0]-v)<Vg?x:E):x<=_[1]&&_[1]<=E:Yg<I^(v<=_[0]&&_[0]<=b)){var w=vy(p,(-f+y)/d);return my(w,c),[_,dy(w)]}}}function _(t,e){var n=f?r:Yg-r,i=0;return t<-n?i|=1:n<t&&(i|=2),e<-n?i|=4:n<e&&(i|=8),i}return Jy(g,function(a){var u,l,h,c,p;return{lineStart:function(){c=h=!1,p=1},point:function(t,e){var n,i=[t,e],r=g(t,e),o=f?r?0:_(t,e):r?_(t+(t<0?Yg:-Yg),e):0;if(!u&&(c=h=r)&&a.lineStart(),r!==h&&((n=y(u,i))&&!Cy(u,n)&&!Cy(i,n)||(i[0]+=Vg,i[1]+=Vg,r=g(i[0],i[1]))),r!==h)p=0,r?(a.lineStart(),n=y(i,u),a.point(n[0],n[1])):(n=y(u,i),a.point(n[0],n[1]),a.lineEnd()),u=n;else if(d&&u&&f^r){var s;o&l||!(s=y(i,u,!0))||(p=0,f?(a.lineStart(),a.point(s[0][0],s[0][1]),a.point(s[1][0],s[1][1]),a.lineEnd()):(a.point(s[1][0],s[1][1]),a.lineEnd(),a.lineStart(),a.point(s[0][0],s[0][1])))}!r||u&&Cy(u,i)||a.point(i[0],i[1]),u=i,h=r,l=o},lineEnd:function(){h&&a.lineEnd(),u=null},clean:function(){return p|(c&&h)<<1}}},function(t,e,n,i){!function(t,e,n,i,r,o){if(n){var s=ty(e),a=iy(e),u=i*n;null==r?(r=e+i*Jg,o=e-u/2):(r=My(s,r),o=My(s,o),(0<i?r<o:o<r)&&(r+=i*Jg));for(var l,h=r;0<i?o<h:h<o;h-=u)l=dy([s,-a*ty(h),-a*iy(h)]),t.point(l[0],l[1])}}(i,r,o,n,t,e)},f?[0,-r]:[-Yg,r-Yg])};function $y(i){return function(t){var e=new t_;for(var n in i)e[n]=i[n];return e.stream=t,e}}function t_(){}function e_(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),fy(n,t.stream(Xy));var s=Xy.result(),a=Math.min(i/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),u=+e[0][0]+(i-a*(s[1][0]+s[0][0]))/2,l=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([u,l])}t_.prototype={constructor:t_,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var n_=ty(30*Kg),i_=function(t,e){return+e?(P=t,N=e,function(r){var n,i,o,s,a,u,l,h,c,p,f,d,g={point:t,lineStart:e,lineEnd:_,polygonStart:function(){r.polygonStart(),g.lineStart=m},polygonEnd:function(){r.polygonEnd(),g.lineStart=e}};function t(t,e){t=P(t,e),r.point(t[0],t[1])}function e(){h=NaN,g.point=y,r.lineStart()}function y(t,e){var n=gy([t,e]),i=P(t,e);O(h,c,l,p,f,d,h=i[0],c=i[1],l=t,p=n[0],f=n[1],d=n[2],16,r),r.point(h,c)}function _(){g.point=t,r.lineEnd()}function m(){e(),g.point=v,g.lineEnd=b}function v(t,e){y(n=t,e),i=h,o=c,s=p,a=f,u=d,g.point=y}function b(){O(h,c,l,p,f,d,i,o,n,s,a,u,16,r),(g.lineEnd=_)()}return g}):(n=t,$y({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}}));var n,P,N;function O(t,e,n,i,r,o,s,a,u,l,h,c,p,f){var d=s-t,g=a-e,y=d*d+g*g;if(4*N<y&&p--){var _=i+l,m=r+h,v=o+c,b=ry(_*_+m*m+v*v),x=sy(v/=b),E=Zg(Zg(v)-1)<Vg||Zg(n-u)<Vg?(n+u)/2:$g(m,_),I=P(E,x),L=I[0],w=I[1],S=L-t,M=w-e,C=g*S-d*M;(N<C*C/y||.3<Zg((d*S+g*M)/y-.5)||i*l+r*h+o*c<n_)&&(O(t,e,n,i,r,o,L,w,E,_/=b,m/=b,v,p,f),f.point(L,w),O(L,w,E,_,m,v,s,a,u,l,h,c,p,f))}}};var r_=$y({point:function(t,e){this.stream.point(t*Kg,e*Kg)}});function o_(t){return s=function(){return t},_=150,m=480,v=250,L=I=E=x=b=0,S=Zy,M=w=null,C=qy,N=i_(i,P=.5),n.stream=function(t){return g&&y===t?g:g=r_(S(h,N(C(y=t))))},n.clipAngle=function(t){return arguments.length?(S=+t?Qy(w=t*Kg,6*Kg):(w=null,Zy),o()):w*Wg},n.clipExtent=function(t){return arguments.length?(C=null==t?(M=p=f=d=null,qy):Uy(M=+t[0][0],p=+t[0][1],f=+t[1][0],d=+t[1][1]),o()):null==M?null:[[M,p],[f,d]]},n.scale=function(t){return arguments.length?(_=+t,r()):_},n.translate=function(t){return arguments.length?(m=+t[0],v=+t[1],r()):[m,v]},n.center=function(t){return arguments.length?(b=t[0]%360*Kg,x=t[1]%360*Kg,r()):[b*Wg,x*Wg]},n.rotate=function(t){return arguments.length?(E=t[0]%360*Kg,I=t[1]%360*Kg,L=2<t.length?t[2]%360*Kg:0,r()):[E*Wg,I*Wg,L*Wg]},n.precision=function(t){return arguments.length?(N=i_(i,P=t*t),o()):ry(P)},n.fitExtent=function(t,e){return e_(n,t,e)},n.fitSize=function(t,e){return e_(n,[[0,0],t],e)},function(){return a=s.apply(this,arguments),n.invert=a.invert&&e,r()}();function n(t){return[(t=c(t[0]*Kg,t[1]*Kg))[0]*_+u,l-t[1]*_]}function e(t){return(t=c.invert((t[0]-u)/_,(l-t[1])/_))&&[t[0]*Wg,t[1]*Wg]}function i(t,e){return[(t=a(t,e))[0]*_+u,l-t[1]*_]}function r(){c=xy(h=Iy(E,I,L),a);var t=a(b,x);return u=m-t[0]*_,l=v+t[1]*_,o()}function o(){return g=y=null,n}var s,a,u,l,h,c,p,f,d,g,y,_,m,v,b,x,E,I,L,w,S,M,C,P,N}function s_(t,e){return[t,ny(oy((Hg+e)/2))]}function a_(r){var o,s,a,u=o_(r),e=u.center,l=u.scale,n=u.translate,h=u.clipExtent,c=null;function i(){var e,t=Yg*l(),n=u((e=Iy((e=u.rotate())[0]*Kg,e[1]*Kg,2<e.length?e[2]*Kg:0),i.invert=function(t){return(t=e.invert(t[0]*Kg,t[1]*Kg))[0]*=Wg,t[1]*=Wg,t},i).invert([0,0]));function i(t){return(t=e(t[0]*Kg,t[1]*Kg))[0]*=Wg,t[1]*=Wg,t}return h(null==c?[[n[0]-t,n[1]-t],[n[0]+t,n[1]+t]]:r===s_?[[Math.max(n[0]-t,c),o],[Math.min(n[0]+t,s),a]]:[[c,Math.max(n[1]-t,o)],[s,Math.min(n[1]+t,a)]])}return u.scale=function(t){return arguments.length?(l(t),i()):l()},u.translate=function(t){return arguments.length?(n(t),i()):n()},u.center=function(t){return arguments.length?(e(t),i()):e()},u.clipExtent=function(t){return arguments.length?(null==t?c=o=s=a=null:(c=+t[0][0],o=+t[0][1],s=+t[1][0],a=+t[1][1]),i()):null==c?null:[[c,o],[s,a]]},i()}function u_(t,e){return[ny(oy((Hg+e)/2)),-t]}s_.invert=function(t,e){return[t,2*Qg(ey(e))-Hg]},u_.invert=function(t,e){return[-e,2*Qg(ey(t))-Hg]};var l_=function(){var t=a_(u_),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],2<t.length?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};function h_(t,n,i,r){var e,o=t.properties||{},s="Feature"===t.type?t.geometry:t;if("GeometryCollection"===s.type){var a=[];return le(t,function(t){var e=h_(t,n,i,r);e&&a.push(e)}),Ft(a)}var u=me(t),l=50<u[1]&&50<u[3];e=l?{type:s.type,coordinates:function e(t,n){if("object"!=typeof t[0])return n(t);return t.map(function(t){return e(t,n)})}(s.coordinates,c_(s))}:Or(s);var h,c=(new Vc).read(e),p=zt(Vt(n,i),"meters"),f=sd.bufferOp(c,p);if(!function t(e){if(Array.isArray(e[0]))return t(e[0]);return isNaN(e[0])}((f=(new Yc).write(f)).coordinates))return(h=l?{type:f.type,coordinates:function e(t,n){if("object"!=typeof t[0])return n.invert(t);return t.map(function(t){return e(t,n)})}(f.coordinates,c_(s))}:Tr(f)).geometry?h:Pt(h,o)}function c_(t){var e=Ni(t).geometry.coordinates.reverse(),n=e.map(function(t){return-t});return l_().center(e).rotate(n).scale(wt)}function p_(){for(var t=new Vc,e=t.read(JSON.stringify(arguments[0].geometry)),n=1;n<arguments.length;n++)e=Bg.union(e,t.read(JSON.stringify(arguments[n].geometry)));return{type:"Feature",geometry:e=(new Yc).write(e),properties:arguments[0].properties}}function f_(t,e){var n=we(t),i=we(e);if(fi(eo(i,{precision:4})).coordinates[0].length<4)return null;if(fi(eo(n,{precision:4})).coordinates[0].length<4)return null;var r=new Vc,o=r.read(eo(n)),s=r.read(eo(i)),a=Cg.intersection(o,s);return a.isEmpty()?null:Pt((new Yc).write(a))}function d_(t,e){return function(i,t,r){var o,s;if(!Array.isArray(t))throw new Error("Get closest expects an array as second argument");return t.forEach(function(t,e){var n=r(t,i);0<=n&&(void 0===s||n<s)&&(s=n,o=e)}),o}(t,e,function(t,e){return t-e})}function g_(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.properties||{},r=n.triangles,o=n.mask;if(null==e)throw new Error("cellSide is required");if(!Zt(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(o&&-1===["Polygon","MultiPolygon"].indexOf(Me(o)))throw new Error("options.mask must be a (Multi)Polygon");var s=t[0],a=t[1],u=t[2],l=t[3],h=(a+l)/2,c=(s+u)/2,p=2*e/Bn([s,h],[u,h],n)*(u-s),f=2*e/Bn([c,a],[c,l],n)*(l-a),d=p/2,g=2*d,y=Math.sqrt(3)/2*f,_=u-s,m=l-a,v=.75*g,b=y,x=(_-g)/(g-d/2),E=Math.floor(x),I=(E*v-d/2-_)/2-d/2+v/2,L=Math.floor((m-y)/y),w=(m-L*y)/2,S=y/2<L*y-m;S&&(w-=y/4);for(var M=[],C=[],P=0;P<6;P++){var N=2*Math.PI/6*P;M.push(Math.cos(N)),C.push(Math.sin(N))}for(var O=[],T=0;T<=E;T++)for(var k=0;k<=L;k++){var R=T%2==1;if((0!==k||!R)&&(0!==k||!S)){var D=T*v+s-I,A=k*b+a+w;if(R&&(A-=y/2),!0===r)__([D,A],p/2,f/2,i,M,C).forEach(function(t){o?f_(o,t)&&O.push(t):O.push(t)});else{var F=y_([D,A],p/2,f/2,i,M,C);o?f_(o,F)&&O.push(F):O.push(F)}}}return Ft(O)}function y_(t,e,n,i,r,o){for(var s=[],a=0;a<6;a++){var u=t[0]+e*r[a],l=t[1]+n*o[a];s.push([u,l])}return s.push(s[0].slice()),kt([s],i)}function __(t,e,n,i,r,o){for(var s=[],a=0;a<6;a++){var u=[];u.push(t),u.push([t[0]+e*r[a],t[1]+n*o[a]]),u.push([t[0]+e*r[(a+1)%6],t[1]+n*o[(a+1)%6]]),u.push(t),s.push(kt([u],i))}return s}function m_(t){if(t.features.length<=1)return t;var e,n,i,o=(e=t,n=Ue(),i=[],ce(e,function(t,e){var n=me(t);i.push({minX:n[0],minY:n[1],maxX:n[2],maxY:n[3],geojson:t,index:e})}),n.load(i),n),s=[],a={};return ce(t,function(t,e){if(a[e])return!0;for(o.remove({index:e},v_),a[e]=!0;;){var n=me(t),i=o.search({minX:n[0],minY:n[1],maxX:n[2],maxY:n[3]});if(0<i.length){var r=i.map(function(t){return a[t.index]=!0,o.remove({index:t.index},v_),t.geojson});r.push(t),t=p_.apply(this,r)}if(0===i.length)break}s.push(t)}),Ft(s)}function v_(t,e){return t.index===e.index}function b_(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.mask,o=[];if(null==e)throw new Error("cellSide is required");if(!Zt(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(Me(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=t[0],a=t[1],u=t[2],l=t[3],h=e/Bn([s,a],[u,a],n)*(u-s),c=e/Bn([s,a],[s,l],n)*(l-a),p=u-s,f=l-a,d=Math.floor(p/h),g=Math.floor(f/c),y=(f-g*c)/2,_=s+(p-d*h)/2,m=0;m<d;m++){for(var v=a+y,b=0;b<g;b++){var x=kt([[[_,v],[_,v+c],[_+h,v+c],[_+h,v],[_,v]]],i);r?f_(r,x)&&o.push(x):o.push(x),v+=c}_+=h}return Ft(o)}function x_(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.mask,o=[];if(null==e)throw new Error("cellSide is required");if(!Zt(e))throw new Error("cellSide is invalid");if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be array");if(4!==t.length)throw new Error("bbox must contain 4 numbers");if(r&&-1===["Polygon","MultiPolygon"].indexOf(Me(r)))throw new Error("options.mask must be a (Multi)Polygon");for(var s=e/Bn([t[0],t[1]],[t[2],t[1]],n)*(t[2]-t[0]),a=e/Bn([t[0],t[1]],[t[0],t[3]],n)*(t[3]-t[1]),u=0,l=t[0];l<=t[2];){for(var h=0,c=t[1];c<=t[3];){var p=null,f=null;u%2==0&&h%2==0?(p=kt([[[l,c],[l,c+a],[l+s,c],[l,c]]],i),f=kt([[[l,c+a],[l+s,c+a],[l+s,c],[l,c+a]]],i)):u%2==0&&h%2==1?(p=kt([[[l,c],[l+s,c+a],[l+s,c],[l,c]]],i),f=kt([[[l,c],[l,c+a],[l+s,c+a],[l,c]]],i)):h%2==0&&u%2==1?(p=kt([[[l,c],[l,c+a],[l+s,c+a],[l,c]]],i),f=kt([[[l,c],[l+s,c+a],[l+s,c],[l,c]]],i)):h%2==1&&u%2==1&&(p=kt([[[l,c],[l,c+a],[l+s,c],[l,c]]],i),f=kt([[[l,c+a],[l+s,c+a],[l+s,c],[l,c+a]]],i)),r?(f_(r,p)&&o.push(p),f_(r,f)&&o.push(f)):(o.push(p),o.push(f)),c+=a,h++}u++,l+=s}return Ft(o)}var E_=Object.freeze({projection:Ar,random:qu,clusters:Ku,helpers:ee,invariant:Ce,meta:_e,isolines:function(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},o=n.breaksProperties||[];if(Le(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks must be an Array");if(!Qt(r))throw new Error("commonProperties must be an Object");if(!Array.isArray(o))throw new Error("breaksProperties must be an Array");var s,a,u,l,h,c,p,f,d,g,y,_=Ae(t,{zProperty:i,flip:!0}),m=function(t,e,n,i,r){for(var o=[],s=1;s<e.length;s++){var a=+e[s],u=Object.assign({},i,r[s]);u[n]=a;var l=Bt(Oe(t,a),u);o.push(l)}return o}(_,e,i,r,o);function v(t){t[0]=t[0]*g+c,t[1]=t[1]*y+p}return Ft((s=m,a=_,u=me(t),l=u[2]-u[0],h=u[3]-u[1],c=u[0],p=u[1],f=a[0].length-1,d=a.length-1,g=l/f,y=h/d,s.forEach(function(t){ne(t,v)}),s))},convex:Nn,pointsWithinPolygon:kn,concave:function(t,a){if(!Qt(a=a||{}))throw new Error("options is invalid");if(!t)throw new Error("points is required");var u=a.maxEdge||1/0;if(!Zt(u))throw new Error("maxEdge is invalid");var n,i,e=Rn((n=[],i={},se(t,function(t){if(t.geometry){var e=t.geometry.coordinates.join("-");i.hasOwnProperty(e)||(n.push(t),i[e]=!0)}}),Ft(n)));if(e.features=e.features.filter(function(t){var e=t.geometry.coordinates[0][0],n=t.geometry.coordinates[0][1],i=t.geometry.coordinates[0][2],r=Bn(e,n,a),o=Bn(n,i,a),s=Bn(e,i,a);return r<=u&&o<=u&&s<=u}),e.features.length<1)return null;var r=pi(e,a);return 1===r.coordinates.length&&(r.coordinates=r.coordinates[0],r.type="Polygon"),Pt(r)},collect:function(t,e,n,r){var o=Ue(6),i=e.features.map(function(t){return{minX:t.geometry.coordinates[0],minY:t.geometry.coordinates[1],maxX:t.geometry.coordinates[0],maxY:t.geometry.coordinates[1],property:t.properties[n]}});return o.load(i),t.features.forEach(function(e){e.properties||(e.properties={});var t=me(e),n=o.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}),i=[];n.forEach(function(t){On([t.minX,t.minY],e)&&i.push(t.property)}),e.properties[r]=i}),t},flip:function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.mutate;if(!t)throw new Error("geojson is required");return!1!==n&&void 0!==n||(t=Gn(t)),ne(t,function(t){var e=t[0],n=t[1];t[0]=n,t[1]=e}),t},simplify:function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=void 0!==e.tolerance?e.tolerance:1,i=e.highQuality||!1,r=e.mutate||!1;if(!t)throw new Error("geojson is required");if(n&&n<0)throw new Error("invalid tolerance");return!0!==r&&(t=Gn(t)),le(t,function(t){!function(t,e,n){var i=t.type;if("Point"===i||"MultiPoint"===i)return;fi(t,!0);var r=t.coordinates;switch(i){case"LineString":t.coordinates=vi(r,e,n);break;case"MultiLineString":t.coordinates=r.map(function(t){return vi(t,e,n)});break;case"Polygon":t.coordinates=bi(r,e,n);break;case"MultiPolygon":t.coordinates=r.map(function(t){return bi(t,e,n)})}}(t,n,i)}),t},bezierSpline:Ii,tag:function(t,n,i,r){return t=Gn(t),n=Gn(n),se(t,function(e){e.properties||(e.properties={}),se(n,function(t){void 0===e.properties[r]&&On(e,t)&&(e.properties[r]=t.properties[i])})}),t},sample:function(t,e){if(!t)throw new Error("featurecollection is required");if(null==e)throw new Error("num is required");if("number"!=typeof e)throw new Error("num must be a number");return Ft(function(t,e){var n,i,r=t.slice(0),o=t.length,s=o-e;for(;o-- >s;)i=Math.floor((o+1)*Math.random()),n=r[i],r[i]=r[o],r[o]=n;return r.slice(s)}(t.features,e))},envelope:wi,square:Si,circle:Ci,midpoint:function(t,e){return Mi(t,Bn(t,e)/2,Pi(t,e))},center:Ni,centerOfMass:function t(e,n){switch(Me(e)){case"Point":return e;case"Polygon":var i=[];ne(e,function(t){i.push(t)});var r,o,s,a,u,l,h,c,p=Oi(e,n),f=p.geometry.coordinates,d=0,g=0,y=0,_=i.map(function(t){return[t[0]-f[0],t[1]-f[1]]});for(r=0;r<i.length-1;r++)a=(o=_[r])[0],l=o[1],u=(s=_[r+1])[0],y+=c=a*(h=s[1])-u*l,d+=(a+u)*c,g+=(l+h)*c;if(0===y)return p;var m=1/(.5*y*6);return Ot([f[0]+m*d,f[1]+m*g],n);default:var v=Nn(e);return v?t(v,n):Oi(e,n)}},centroid:Oi,combine:function(t){var i={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}},e=Object.keys(i).reduce(function(t,e){return t[e.replace("Multi","")]=e,t},{});function n(t,e,n){n?i[e].coordinates=i[e].coordinates.concat(t.geometry.coordinates):i[e].coordinates.push(t.geometry.coordinates),i[e].properties.push(t.properties)}return se(t,function(t){t.geometry&&(i[t.geometry.type]?n(t,t.geometry.type,!0):e[t.geometry.type]&&n(t,e[t.geometry.type],!1))}),Ft(Object.keys(i).filter(function(t){return i[t].coordinates.length}).sort().map(function(t){return Pt({type:t,coordinates:i[t].coordinates},{collectedProperties:i[t].properties})}))},distance:Bn,explode:Ti,bbox:me,tesselate:function(t){if(!t.geometry||"Polygon"!==t.geometry.type&&"MultiPolygon"!==t.geometry.type)throw new Error("input must be a Polygon or MultiPolygon");var e={type:"FeatureCollection",features:[]};return"Polygon"===t.geometry.type?e.features=ir(t.geometry.coordinates):t.geometry.coordinates.forEach(function(t){e.features=e.features.concat(ir(t))}),e},bboxPolygon:Li,booleanPointInPolygon:On,nearestPoint:rr,nearestPointOnLine:Mr,nearestPointToLine:function(t,n,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var i=e.units,r=e.properties||{};if(!t)throw new Error("points is required");if(!(t=function(t){var e=[];switch(t.geometry?t.geometry.type:t.type){case"GeometryCollection":return le(t,function(t){"Point"===t.type&&e.push({type:"Feature",properties:{},geometry:t})}),{type:"FeatureCollection",features:e};case"FeatureCollection":return t.features=t.features.filter(function(t){return"Point"===t.geometry.type}),t;default:throw new Error("points must be a Point Collection")}}(t)).features.length)throw new Error("points must contain features");if(!n)throw new Error("line is required");if("LineString"!==Me(n))throw new Error("line must be a LineString");var o=1/0,s=null;return se(t,function(t){var e=Fr(t,n,{units:i});e<o&&(o=e,s=t)}),s&&(s.properties=Object.assign({dist:o},s.properties,r)),s},planepoint:function(t,e){var n=ve(t),i=we(e).coordinates[0];if(i.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");var r=e.properties||{},o=r.a,s=r.b,a=r.c,u=n[0],l=n[1],h=i[0][0],c=i[0][1],p=void 0!==o?o:i[0][2],f=i[1][0],d=i[1][1],g=void 0!==s?s:i[1][2],y=i[2][0],_=i[2][1],m=void 0!==a?a:i[2][2];return(m*(u-h)*(l-d)+p*(u-f)*(l-_)+g*(u-y)*(l-c)-g*(u-h)*(l-_)-m*(u-f)*(l-c)-p*(u-y)*(l-d))/((u-h)*(l-d)+(u-f)*(l-_)+(u-y)*(l-c)-(u-h)*(l-_)-(u-f)*(l-c)-(u-y)*(l-d))},tin:Rn,bearing:Pi,destination:Mi,kinks:function(t){var e,n,o={type:"FeatureCollection",features:[]};if("LineString"===(n="Feature"===t.type?t.geometry:t).type)e=[n.coordinates];else if("MultiLineString"===n.type)e=n.coordinates;else if("MultiPolygon"===n.type)e=[].concat.apply([],n.coordinates);else{if("Polygon"!==n.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=n.coordinates}return e.forEach(function(r){e.forEach(function(t){for(var e=0;e<r.length-1;e++)for(var n=e;n<t.length-1;n++){if(r===t){if(1===Math.abs(e-n))continue;if(0===e&&n===r.length-2&&r[e][0]===r[r.length-1][0]&&r[e][1]===r[r.length-1][1])continue}var i=Gr(r[e][0],r[e][1],r[e+1][0],r[e+1][1],t[n][0],t[n][1],t[n+1][0],t[n+1][1]);i&&o.features.push(Ot([i[0],i[1]]))}})}),o},pointOnFeature:Ur,area:qr,along:function(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i;if("Feature"===t.type)i=t.geometry.coordinates;else{if("LineString"!==t.type)throw new Error("input must be a LineString Feature or Geometry");i=t.coordinates}if(!Zt(e))throw new Error("distance must be a number");for(var r=0,o=0;o<i.length&&!(r<=e&&o===i.length-1);o++){if(e<=r){var s=e-r;if(s){var a=Pi(i[o],i[o-1])-180;return Mi(i[o],s,a,n)}return Ot(i[o])}r+=Bn(i[o],i[o+1],n)}return Ot(i[i.length-1])},length:Xr,lineSlice:function(t,e,n){var i=be(n);if("LineString"!==Me(n))throw new Error("line must be a LineString");for(var r,o=Mr(n,t),s=Mr(n,e),a=[(r=o.properties.index<=s.properties.index?[o,s]:[s,o])[0].geometry.coordinates],u=r[0].properties.index+1;u<r[1].properties.index+1;u++)a.push(i[u]);return a.push(r[1].geometry.coordinates),Dt(a,n.properties)},lineSliceAlong:Jr,pointGrid:to,truncate:eo,flatten:function(t){if(!t)throw new Error("geojson is required");var e=[];return ce(t,function(t){e.push(t)}),Ft(e)},lineIntersect:wr,lineChunk:function(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.units,r=n.reverse;if(!t)throw new Error("geojson is required");if(e<=0)throw new Error("segmentLength must be greater than 0");var o=[];return ce(t,function(t){r&&(t.geometry.coordinates=t.geometry.coordinates.reverse()),function(t,e,n,i){var r=Xr(t,{units:n});if(r<=e)return i(t);var o=r/e;Number.isInteger(o)||(o=Math.floor(o)+1);for(var s=0;s<o;s++){var a=Jr(t,e*s,e*(s+1),{units:n});i(a,s)}}(t,e,i,function(t){o.push(t)})}),Ft(o)},unkinkPolygon:function(t){var n=[];return ce(t,function(e){"Polygon"===e.geometry.type&&se(ro(e),function(t){n.push(kt(t.geometry.coordinates,e.properties))})}),Ft(n)},greatCircle:function(t,e,n){if("object"!=typeof(n=n||{}))throw new Error("options is invalid");var i=n.properties,r=n.npoints,o=n.offset;return t=ve(t),e=ve(e),i=i||{},r=r||100,o=o||10,new yo({x:t[0],y:t[1]},{x:e[0],y:e[1]},i).Arc(r,{offset:o}).json()},lineSegment:Lr,lineSplit:function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var n=Me(t),i=Me(e);if("LineString"!==n)throw new Error("line must be LineString");if("FeatureCollection"===i)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===i)throw new Error("splitter cannot be a GeometryCollection");var r=eo(e,{precision:7});switch(i){case"Point":return mo(t,r);case"MultiPoint":return _o(t,r);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return _o(t,wr(t,r))}},lineArc:xo,polygonToLine:Io,lineToPolygon:wo,bboxClip:function(t,e){var n,i=(n=t).geometry?n.geometry.type:n.type,r=be(t),o=t.properties;switch(i){case"LineString":case"MultiLineString":var s=[];return"LineString"===i&&(r=[r]),r.forEach(function(t){Co(t,e,s)}),1===s.length?Dt(s[0],o):Bt(s,o);case"Polygon":return kt(To(r,e),o);case"MultiPolygon":return Ut(r.map(function(t){return To(t,e)}),o);default:throw new Error("geometry "+i+" not supported")}},lineOverlap:Bo,sector:function(t,e,n,i,r){if(!Qt(r=r||{}))throw new Error("options is invalid");if(!t)throw new Error("center is required");if(null==n)throw new Error("bearing1 is required");if(null==i)throw new Error("bearing2 is required");if(!e)throw new Error("radius is required");if("object"!=typeof r)throw new Error("options must be an object");if(Uo(n)===Uo(i))return Ci(t,e,r);var o=be(t),s=xo(t,e,n,i,r),a=[[o]];return ne(s,function(t){a[0].push(t)}),a[0].push(o),kt(a)},rhumbBearing:Cr,rhumbDistance:Nr,rhumbDestination:jo,polygonTangents:function(t,e){var n,i,r,o=be(t),s=be(e);switch(Me(e)){case"Polygon":n=s[0][0],i=s[0][0],r=zo(s[0][0],s[0][s[0].length-1],o);var a=qo(s[0],o,r,void 0,n,i);n=a[0],i=a[1];break;case"MultiPolygon":n=s[0][0][0],i=s[0][0][0],r=zo(s[0][0][0],s[0][0][s[0][0].length-1],o),s.forEach(function(t){var e=qo(t[0],o,r,void 0,n,i);n=e[0],i=e[1]})}return Ft([Ot(n),Ot(i)])},rewind:function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.reverse||!1,i=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if("boolean"!=typeof n)throw new Error("<reverse> must be a boolean");if("boolean"!=typeof i)throw new Error("<mutate> must be a boolean");!1===i&&(t=Gn(t));var r=[];switch(t.type){case"GeometryCollection":return le(t,function(t){Yo(t,n)}),t;case"FeatureCollection":return se(t,function(t){se(Yo(t,n),function(t){r.push(t)})}),Ft(r)}return Yo(t,n)},isobands:function(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.zProperty||"elevation",r=n.commonProperties||{},o=n.breaksProperties||[];if(Le(t,"Point","Input must contain Points"),!e)throw new Error("breaks is required");if(!Array.isArray(e))throw new Error("breaks is not an Array");if(!Qt(r))throw new Error("commonProperties is not an Object");if(!Array.isArray(o))throw new Error("breaksProperties is not an Array");var s,a,u,l,h,c,p,f,d,g,y,_=Jo(t,{zProperty:i,flip:!0}),m=function(t,e,n){for(var i=[],r=1;r<e.length;r++){var o=+e[r-1],s=+e[r],a=Ws(Js(Zo(t,o,s-o))),u={};u.groupedRings=a,u[n]=o+"-"+s,i.push(u)}return i}(_,e,i);function v(t){t[0]=t[0]*g+c,t[1]=t[1]*y+p}return s=m,a=_,u=me(t),l=u[2]-u[0],h=u[3]-u[1],c=u[0],p=u[1],f=a[0].length-1,d=a.length-1,g=l/f,y=h/d,s.forEach(function(t){t.groupedRings.forEach(function(t){t.forEach(function(t){t.forEach(v)})})}),Ft((m=s).map(function(t,e){if(o[e]&&!Qt(o[e]))throw new Error("Each mappedProperty is required to be an Object");var n=Object.assign({},r,o[e]);return n[i]=t[i],Ut(t.groupedRings,n)}))},transformRotate:Qs,transformScale:$s,transformTranslate:function(t,n,i,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var r=e.units,o=e.zTranslation,s=e.mutate;if(!t)throw new Error("geojson is required");if(null==n||isNaN(n))throw new Error("distance is required");if(o&&"number"!=typeof o&&isNaN(o))throw new Error("zTranslation is not a number");if(o=void 0!==o?o:0,0===n&&0===o)return t;if(null==i||isNaN(i))throw new Error("direction is required");return n<0&&(n=-n,i=-i),!1!==s&&void 0!==s||(t=Gn(t)),ne(t,function(t){var e=be(jo(t,n,i,{units:r}));t[0]=e[0],t[1]=e[1],o&&3===t.length&&(t[2]+=o)}),t},lineOffset:function(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.units;if(!t)throw new Error("geojson is required");if(null==e||isNaN(e))throw new Error("distance is required");var r=Me(t),o=t.properties;switch(r){case"LineString":return ra(t,e,i);case"MultiLineString":var s=[];return ce(t,function(t){s.push(ra(t,e,i).geometry.coordinates)}),Bt(s,o);default:throw new Error("geometry "+r+" is not supported")}},polygonize:function(t){var e=ca.fromGeoJson(t);e.deleteDangles(),e.deleteCutEdges();var n=[],i=[];return e.getEdgeRings().filter(function(t){return t.isValid()}).forEach(function(t){t.isHole()?n.push(t):i.push(t)}),n.forEach(function(t){la.findEdgeRingContaining(t,i)&&i.push(t)}),Ft(i.map(function(t){return t.toPolygon()}))},booleanDisjoint:function(t,n){var i;return ce(t,function(e){ce(n,function(t){if(!1===i)return!1;i=function(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!function(t,e){return t[0]===e[0]&&t[1]===e[1]}(t.coordinates,e.coordinates);case"LineString":return!pa(e,t);case"Polygon":return!On(t,e)}break;case"LineString":switch(e.type){case"Point":return!pa(t,e);case"LineString":return!function(t,e){if(0<wr(t,e).features.length)return!0;return!1}(t,e);case"Polygon":return!fa(e,t)}break;case"Polygon":switch(e.type){case"Point":return!On(e,t);case"LineString":return!fa(t,e);case"Polygon":return!function(t,e){for(var n=0;n<t.coordinates[0].length;n++)if(On(t.coordinates[0][n],e))return!0;for(var i=0;i<e.coordinates[0].length;i++)if(On(e.coordinates[0][i],t))return!0;return!1}(e,t)}}}(e.geometry,t.geometry)})}),i},booleanContains:function(t,e){var n=Me(t),i=Me(e),r=we(t),o=we(e),s=be(t),a=be(e);switch(n){case"Point":switch(i){case"Point":return ya(s,a);default:throw new Error("feature2 "+i+" geometry not supported")}case"MultiPoint":switch(i){case"Point":return function(t,e){var n,i=!1;for(n=0;n<t.coordinates.length;n++)if(ya(t.coordinates[n],e.coordinates)){i=!0;break}return i}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++){for(var i=!1,r=0;r<t.coordinates.length;r++)if(ya(e.coordinates[n],t.coordinates[r])){i=!0;break}if(!i)return!1}return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"Point":return Wr(o,r,{ignoreEndVertices:!0});case"LineString":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(Wr({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!0})&&(n=!0),!Wr({type:"Point",coordinates:e.coordinates[i]},t,{ignoreEndVertices:!1}))return!1;return n}(r,o);case"MultiPoint":return function(t,e){for(var n=!1,i=0;i<e.coordinates.length;i++)if(Wr(e.coordinates[i],t,{ignoreEndVertices:!0})&&(n=!0),!Wr(e.coordinates[i],t))return!1;if(n)return!0;return!1}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"Point":return On(o,r,{ignoreBoundary:!0});case"LineString":return function(t,e){var n=!1,i=0,r=me(t),o=me(e);if(!ga(r,o))return!1;for(;i<e.coordinates.length-1;i++){if(On({type:"Point",coordinates:(s=e.coordinates[i],a=e.coordinates[i+1],[(s[0]+a[0])/2,(s[1]+a[1])/2])},t,{ignoreBoundary:!0})){n=!0;break}}var s,a;return n}(r,o);case"Polygon":return function(t,e){var n=me(t),i=me(e);if(!ga(n,i))return!1;for(var r=0;r<e.coordinates[0].length;r++)if(!On(e.coordinates[0][r],t))return!1;return!0}(r,o);case"MultiPoint":return function(t,e){for(var n=0;n<e.coordinates.length;n++)if(!On(e.coordinates[n],t,{ignoreBoundary:!0}))return!1;return!0}(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},booleanCrosses:function(t,e){var n=Me(t),i=Me(e),r=we(t),o=we(e);switch(n){case"MultiPoint":switch(i){case"LineString":return _a(r,o);case"Polygon":return va(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"LineString":switch(i){case"MultiPoint":return _a(o,r);case"LineString":return function(t,e){if(0<wr(t,e).features.length)for(var n=0;n<t.coordinates.length-1;n++)for(var i=0;i<e.coordinates.length-1;i++){var r=!0;if(0!==i&&i!==e.coordinates.length-2||(r=!1),ba(t.coordinates[n],t.coordinates[n+1],e.coordinates[i],r))return!0}return!1}(r,o);case"Polygon":return ma(r,o);default:throw new Error("feature2 "+i+" geometry not supported")}case"Polygon":switch(i){case"MultiPoint":return va(o,r);case"LineString":return ma(o,r);default:throw new Error("feature2 "+i+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},booleanClockwise:Vo,booleanOverlap:Pa,booleanPointOnLine:Wr,booleanEqual:function(t,e){if(!t)throw new Error("feature1 is required");if(!e)throw new Error("feature2 is required");return Me(t)===Me(e)&&new Ca({precision:6}).compare(fi(t),fi(e))},booleanWithin:Zr,clone:Gn,cleanCoords:fi,clustersDbscan:function(n,t,e){if("object"!=typeof(e=e||{}))throw new Error("options is invalid");var i=e.minPoints,r=e.units;if(Le(n,"Point","Input must contain Points"),null==t)throw new Error("maxDistance is required");if(!(0<Math.sign(t)))throw new Error("Invalid maxDistance");if(!(null==i||0<Math.sign(i)))throw new Error("Invalid minPoints");n=Gn(n),i=i||3;var o=new Ra.DBSCAN,s=o.run(ue(n),Wt(t,r),i,Bn),a=-1;return s.forEach(function(t){a++,t.forEach(function(t){var e=n.features[t];e.properties||(e.properties={}),e.properties.cluster=a,e.properties.dbscan="core"})}),o.noise.forEach(function(t){var e=n.features[t];e.properties||(e.properties={}),e.properties.cluster?e.properties.dbscan="edge":e.properties.dbscan="noise"}),n},clustersKmeans:function(t,e){if("object"!=typeof(e=e||{}))throw new Error("options is invalid");var n=e.numberOfClusters,i=e.mutate;Le(t,"Point","Input must contain Points");var r=t.features.length;r<(n=n||Math.round(Math.sqrt(r/2)))&&(n=r),!1!==i&&void 0!==i||(t=Gn(t));var o=ue(t),s=o.slice(0,n),a=qa(o,n,s),u={};return a.centroids.forEach(function(t,e){u[e]=t}),se(t,function(t,e){var n=a.idxs[e];t.properties.cluster=n,t.properties.centroid=u[n]}),t},pointToLineDistance:Fr,booleanParallel:function(t,e){if(!t)throw new Error("line1 is required");if(!e)throw new Error("line2 is required");if("LineString"!==za(t,"line1"))throw new Error("line1 must be a LineString");if("LineString"!==za(e,"line2"))throw new Error("line2 must be a LineString");for(var n,i,r,o,s=Lr(fi(t)).features,a=Lr(fi(e)).features,u=0;u<s.length;u++){var l=s[u].geometry.coordinates;if(!a[u])break;var h=a[u].geometry.coordinates;if(i=h,void 0,r=Ht(Cr((n=l)[0],n[1])),o=Ht(Cr(i[0],i[1])),r!==o)return!1}return!0},shortestPath:function(t,e,n){if(!Qt(n=n||{}))throw new Error("options is invalid");var i=n.resolution,r=n.minDistance,o=n.obstacles||Ft([]);if(!t)throw new Error("start is required");if(!e)throw new Error("end is required");if(i&&!Zt(i)||i<=0)throw new Error("options.resolution must be a number, greater than 0");if(r)throw new Error("options.minDistance is not yet implemented");var s=ve(t),a=ve(e);switch(t=Ot(s),e=Ot(a),Me(o)){case"FeatureCollection":if(0===o.features.length)return Dt([s,a]);break;case"Polygon":o=Ft([Pt(we(o))]);break;default:throw new Error("invalid obstacles")}var u=o;u.features.push(t),u.features.push(e);var l=me($s(Li(me(u)),1.15));i=i||Bn([l[0],l[1]],[l[2],l[1]],n)/100,u.features.pop(),u.features.pop();for(var h=l[0],c=l[1],p=l[2],f=l[3],d=i/Bn([h,c],[p,c],n)*(p-h),g=i/Bn([h,c],[h,f],n)*(f-c),y=p-h,_=f-c,m=Math.floor(y/d),v=Math.floor(_/g),b=(y-m*d)/2,x=[],E=[],I=[],L=[],w=1/0,S=1/0,M=f-(_-v*g)/2,C=0;c<=M;){for(var P=[],N=[],O=h+b,T=0;O<=p;){var k=Ot([O,M]),R=Wa(k,o);P.push(R?0:1),N.push(O+"|"+M);var D=Bn(k,t);!R&&D<w&&(w=D,I={x:T,y:C});var A=Bn(k,e);!R&&A<S&&(S=A,L={x:T,y:C}),O+=d,T++}E.push(P),x.push(N),M-=g,C++}var F=new Ha(E,{diagonal:!0}),B=F.grid[I.y][I.x],G=F.grid[L.y][L.x],U=Ya.search(F,B,G),j=[s];return U.forEach(function(t){var e=x[t.x][t.y].split("|");j.push([+e[0],+e[1]])}),j.push(a),fi(Dt(j))},voronoi:function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var r,o,n,i=e.bbox||[-180,-85,180,85];if(!t)throw new Error("points is required");if(!Array.isArray(i))throw new Error("bbox is invalid");return Le(t,"Point","points"),Ft((r=Za,o=Qa,n=null,s.polygons=function(t){return s(t).polygons()},s.links=function(t){return s(t).links()},s.triangles=function(t){return s(t).triangles()},s.x=function(t){return arguments.length?(r="function"==typeof t?t:Ka(+t),s):r},s.y=function(t){return arguments.length?(o="function"==typeof t?t:Ka(+t),s):o},s.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],s):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},s.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],s):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},s).x(function(t){return t.geometry.coordinates[0]}).y(function(t){return t.geometry.coordinates[1]}).extent([[i[0],i[1]],[i[2],i[3]]]).polygons(t.features).map(Ou));function s(i){return new Nu(i.map(function(t,e){var n=[Math.round(r(t,e,i)/Mu)*Mu,Math.round(o(t,e,i)/Mu)*Mu];return n.index=e,n.data=t,n}),n)}},ellipse:Tu,centerMean:Ru,centerMedian:function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.counter||10;if(!Zt(n))throw new Error("counter must be a number");var i=e.weight,r=Ru(t,{weight:e.weight}),o=Ft([]);return se(t,function(t){o.features.push(Oi(t,{weight:t.properties[i]}))}),o.properties={tolerance:e.tolerance,medianCandidates:[]},function t(o,e,n,i){var r=n.properties.tolerance||.001;var s=0;var a=0;var u=0;var l=0;se(n,function(t){var e=t.properties.weight,n=null==e?1:e;if(!Zt(n=Number(n)))throw new Error("weight value must be a number");if(0<n){l+=1;var i=n*Bn(t,o);0===i&&(i=1);var r=n/i;s+=t.geometry.coordinates[0]*r,a+=t.geometry.coordinates[1]*r,u+=r}});if(l<1)throw new Error("no features to measure");var h=s/u;var c=a/u;return 1===l||0===i||Math.abs(h-e[0])<r&&Math.abs(c-e[1])<r?Ot([h,c],{medianCandidates:n.properties.medianCandidates}):(n.properties.medianCandidates.push([h,c]),t([h,c],o,n,i-1))}(r.geometry.coordinates,[0,0],o,n)},standardDeviationalEllipse:function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var n=e.steps||64,i=e.weight,r=e.properties||{};if(!Zt(n))throw new Error("steps must be a number");if(!Qt(r))throw new Error("properties must be a number");var o=ue(t).length,s=Ru(t,{weight:i}),a=0,u=0,l=0;se(t,function(t){var e=t.properties[i]||1,n=Du(be(t),be(s));a+=Math.pow(n.x,2)*e,u+=Math.pow(n.y,2)*e,l+=n.x*n.y*e});var h=a-u,c=Math.sqrt(Math.pow(h,2)+4*Math.pow(l,2)),p=2*l,f=Math.atan((h+c)/p),d=180*f/Math.PI,g=0,y=0,_=0;se(t,function(t){var e=t.properties[i]||1,n=Du(be(t),be(s));g+=Math.pow(n.x*Math.cos(f)-n.y*Math.sin(f),2)*e,y+=Math.pow(n.x*Math.sin(f)+n.y*Math.cos(f),2)*e,_+=e});var m=Math.sqrt(2*g/_),v=Math.sqrt(2*y/_),b=Tu(s,m,v,{units:"degrees",angle:d,steps:n,properties:r}),x=kn(t,Ft([b])),E={meanCenterCoordinates:be(s),semiMajorAxis:m,semiMinorAxis:v,numberOfFeatures:o,angle:d,percentageWithinEllipse:100*ue(x).length/o};return b.properties.standardDeviationalEllipse=E,b},difference:function(t,e){var n=we(t),i=we(e),r=t.properties||{};if(n=Gg(n),i=Gg(i),!n)return null;if(!i)return Pt(n,r);var o=new Vc,s=o.read(n),a=o.read(i),u=Cg.difference(s,a);return u.isEmpty()?null:Pt((new Yc).write(u),r)},buffer:function(t,n,e){var i=(e=e||{}).units,r=e.steps||64;if(!t)throw new Error("geojson is required");if("object"!=typeof e)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===n)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");r=r||64,i=i||"kilometers";var o=[];switch(t.type){case"GeometryCollection":return le(t,function(t){var e=h_(t,n,i,r);e&&o.push(e)}),Ft(o);case"FeatureCollection":return se(t,function(t){var e=h_(t,n,i,r);e&&se(e,function(t){t&&o.push(t)})}),Ft(o)}return h_(t,n,i,r)},union:p_,intersect:f_,dissolve:function(t,e){if(!Qt(e=e||{}))throw new Error("options is invalid");var a=e.propertyName;Le(t,"Polygon","dissolve");var n=Gn(t),u=n.features,l=[];u.forEach(function(t,e){t.properties.origIndexPosition=e});var h=xr();for(var c in h.load(n),u){var p=u[c],f=!1;if(h.search(p).features.forEach(function(t){p=u[c];var e=t.properties.origIndexPosition;if(0<l.length&&0!==e)if(e>l[l.length-1])e-=l.length;else{var n=d_(e,l);0!==n&&(e-=n)}if(e!==+c){var i,r,o,s=u[e];if(s&&p)if(void 0===a||s.properties[a]===p.properties[a])if(Pa(p,s)&&(i=s,r=Dt(ue(p)),o=Dt(ue(i)),0<wr(r,o).features.length))u[c]=p_(p,s),l.push(t.properties.origIndexPosition),l.sort(function(t,e){return t-e}),h.remove(t),u.splice(e,1),p.properties.origIndexPosition=c,h.remove(p,function(t,e){return t.properties.origIndexPosition===e.properties.origIndexPosition}),f=!0}}),f){if(!p)continue;p.properties.origIndexPosition=c,h.insert(p),c--}}return u.forEach(function(t){delete t.properties.origIndexPosition,delete t.bbox}),n},hexGrid:g_,mask:function(t,e){var n,r,o,i,s,a,u=kt((n=e)&&n.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]]),l=(r=[],o=[],ce(t,function(t){var e=t.geometry.coordinates,n=e[0],i=e.slice(1);r.push(kt([n])),i.forEach(function(t){o.push(kt([t]))})}),[Ft(r),Ft(o)]),h=l[0],c=l[1];return h=m_(h),c=m_(c),i=h,s=c,(a=[]).push(u.geometry.coordinates[0]),ce(i,function(t){a.push(t.geometry.coordinates[0])}),ce(s,function(t){a.push(t.geometry.coordinates[0])}),kt(a)},squareGrid:b_,triangleGrid:x_,interpolate:function(e,t,a){if("object"!=typeof(a=a||{}))throw new Error("options is invalid");var u=a.gridType,l=a.property,h=a.weight;if(!e)throw new Error("points is required");if(Le(e,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(void 0!==h&&"number"!=typeof h)throw new Error("weight must be a number");l=l||"elevation",u=u||"square",h=h||1;var n,i=me(e);switch(u){case"point":case"points":n=to(i,t,a);break;case"square":case"squares":n=b_(i,t,a);break;case"hex":case"hexes":n=g_(i,t,a);break;case"triangle":case"triangles":n=x_(i,t,a);break;default:throw new Error("invalid gridType")}var c=[];return se(n,function(r){var o=0,s=0;se(e,function(t){var e,n=Bn("point"===u?r:Oi(r),t,a);if(void 0!==l&&(e=t.properties[l]),void 0===e&&(e=t.geometry.coordinates[2]),void 0===e)throw new Error("zValue is missing");0===n&&(o=e);var i=1/Math.pow(n,h);s+=i,o+=i*e});var t=Gn(r);t.properties[l]=o/s,c.push(t)}),Ft(c)},pointOnSurface:Ur,polygonToLineString:Io,lineStringToPolygon:wo,inside:On,within:kn,bezier:Ii,nearest:rr,pointOnLine:Mr,lineDistance:Xr,radians2degrees:Xt,degrees2radians:Jt,distanceToDegrees:Yt,distanceToRadians:Vt,radiansToDistance:zt,bearingToAngle:Ht,convertDistance:Wt,toMercator:Or,toWgs84:Tr,randomPosition:Au,randomPoint:Fu,randomPolygon:Bu,randomLineString:Gu,getCluster:zu,clusterEach:Vu,clusterReduce:Yu,createBins:Hu,applyFilter:Xu,propertiesContainsFilter:Ju,filterProperties:Wu,earthRadius:wt,factors:St,unitsFactors:Mt,areaFactors:Ct,feature:Pt,geometry:Nt,point:Ot,points:Tt,polygon:kt,polygons:Rt,lineString:Dt,lineStrings:At,featureCollection:Ft,multiLineString:Bt,multiPoint:Gt,multiPolygon:Ut,geometryCollection:jt,round:qt,radiansToLength:zt,lengthToRadians:Vt,lengthToDegrees:Yt,bearingToAzimuth:Ht,radiansToDegrees:Xt,degreesToRadians:Jt,convertLength:Wt,convertArea:Kt,isNumber:Zt,isObject:Qt,validateBBox:$t,validateId:te,getCoord:ve,getCoords:be,containsNumber:xe,geojsonType:Ee,featureOf:Ie,collectionOf:Le,getGeom:we,getGeomType:Se,getType:Me,coordEach:ne,coordReduce:ie,propEach:re,propReduce:oe,featureEach:se,featureReduce:ae,coordAll:ue,geomEach:le,geomReduce:he,flattenEach:ce,flattenReduce:pe,segmentEach:fe,segmentReduce:de,lineEach:ge,lineReduce:ye}),I_=B.Class.extend({options:{left:0,bottom:0,right:0,top:0},initialize:function(t){B.setOptions(this,t)},getLeft:function(){return this.options.left},setLeft:function(t){this.options.left=t},getBottom:function(){return this.options.bottom},setBottom:function(t){this.options.bottom=t},getRight:function(){return this.options.right},setRight:function(t){this.options.right=t},getTop:function(){return this.options.top},setTop:function(t){this.options.top=t},getLeftTop:function(){return new B.Point(this.getLeft(),this.getTop())},getRightBottom:function(){return new B.Point(this.getRight(),this.getBottom())},toLatLngBounds:function(t){if(!this.isValid())return null;var e=null;if(t&&!t.isEPSG4326()){var n=t.createProj(),i=this.getLeftTop(),r=this.getRightBottom(),o=n.projection.unproject(i),s=n.projection.unproject(r);if(o.lng>=s.lng||o.lat<=s.lat)return null;e=new B.LatLngBounds(o,s)}else e=new B.LatLngBounds([this.getBottom(),this.getLeft()],[this.getTop(),this.getRight()]);return e},isValid:function(){return null!=this.options.left&&null!=this.options.right&&null!=this.options.bottom&&null!=this.options.top&&!(this.options.left>this.options.right||this.options.bottom>this.options.top)},isNull:function(){return this.options.left===this.options.right&&this.options.bottom===this.options.top},containsPoint:function(t){return!(!t||this.isNull())&&(t.x>=this.options.left&&t.x<=this.options.right&&t.y>=this.options.bottom&&t.y<=this.options.top)},clone:function(){return new I_(this.options)},getCenter:function(){var t=new B.Point(0,0);return t.x=.5*(this.options.left+this.options.right),t.y=.5*(this.options.top+this.options.bottom),t},getWidth:function(){return this.isNull()?0:this.options.right-this.options.left},getHeight:function(){return this.isNull()?0:this.options.top-this.options.bottom},readJson:function(t){t&&(this.options.left=t.min_x?t.min_x:0,this.options.bottom=t.min_y?t.min_y:0,this.options.right=t.max_x?t.max_x:0,this.options.top=t.max_y?t.max_y:0)},toJson:function(){return{min_x:this.options.left,min_y:this.options.bottom,max_x:this.options.right,max_y:this.options.top}},containsBounds:function(t){return!(!t||this.isNull())&&(t.getLeft()>=this.options.left&&t.getRight()<=this.options.right&&t.getTop()<=this.options.top&&t.getBottom()>=this.options.bottom)},add:function(t){t&&(this.options.left=Math.min(this.options.left,t.getLeft()),this.options.right=Math.max(this.options.right,t.getRight()),this.options.top=Math.max(this.options.top,t.getTop()),this.options.bottom=Math.min(this.options.bottom,t.getBottom()))},isIntersect:function(t){if(!t||t.isNull()||this.isNull())return!1;var e=this.getLeft(),n=this.getRight(),i=this.getBottom(),r=this.getTop(),o=t.getLeft(),s=t.getRight(),a=t.getBottom(),u=t.getTop(),l=Math.abs(e+n-o-s),h=Math.abs(e-n)+Math.abs(o-s),c=Math.abs(i+r-a-u),p=Math.abs(i-r)+Math.abs(a-u);return l<=h&&c<=p},isIntersect2:function(t){if(!t)return!1;var e=this.getLeft(),n=this.getRight(),i=this.getBottom(),r=this.getTop(),o=t.getLeft(),s=t.getRight(),a=t.getBottom(),u=t.getTop(),l=Math.abs(e+n-o-s),h=Math.abs(e-n)+Math.abs(o-s),c=Math.abs(i+r-a-u),p=Math.abs(i-r)+Math.abs(a-u);return l<=h&&c<=p},intersectRect:function(t,e){return t.isIntersect(e)?(this.options.left=Math.max(t.getLeft(),e.getLeft()),this.options.right=Math.min(t.getRight(),e.getRight()),this.options.top=Math.min(t.getTop(),e.getTop()),this.options.bottom=Math.max(t.getBottom(),e.getBottom()),!0):(this.setNull(),!1)},setNull:function(){this.options.left=0,this.options.right=0,this.options.top=0,this.options.bottom=0},extend:function(t,e){this.options.left+=t,this.options.right+=t,this.options.top+=e,this.options.bottom+=e},toPolygon:function(){return this.isNull()?null:E_.polygon([[[this.getLeft(),this.getTop()],[this.getRight(),this.getTop()],[this.getRight(),this.getBottom()],[this.getLeft(),this.getBottom()],[this.getLeft(),this.getTop()]]])},toGeometry:function(){if(this.isNull())return null;var t=this.getLeft(),e=this.getTop(),n=this.getRight(),i=this.getBottom(),r=[new B.Point(t,e),new B.Point(n,e),new B.Point(n,i),new B.Point(t,i),new B.Point(t,e)];return new It({points:r,polyCount:[r.length],subCount:1})}});I_.createFromLatLngBounds=function(t,e){if(!t)return null;var n=null;if(e&&!e.isEPSG4326()){var i=e.createProj(),r=i.projection.project(t.getSouthWest()),o=i.projection.project(t.getNorthEast());n=new I_({left:r.x,bottom:r.y,right:o.x,top:o.y})}else n=new I_({left:t.getWest(),bottom:t.getSouth(),right:t.getEast(),top:t.getNorth()});return n},I_.createFromPoints=function(t){if(!t||0===t.length)return null;var e=t[0],i=e.x,r=e.y,o=e.x,s=e.y;return t.forEach(function(t){var e=t.x,n=t.y;i=Math.min(i,e),r=Math.min(r,n),o=Math.max(o,e),s=Math.max(s,n)}),new I_({left:i,bottom:r,right:o,top:s})};var L_,w_={GID:"gid",GEOM:"geom",VERSION:"version"},S_={lastId:0,stamp:function(){return++this.lastId},firstId:-9,virtualId:function(){return--this.firstId},projTransform:function(t,e,n){if(!t||!e||!n)return null;var i=e.projection.unproject(t);return i?n.projection.project(i):null},clone:function(t){var e=this.typeof(t),n=void 0,i=void 0,r=void 0;if("array"===e)n=[];else{if("object"!==e)return t;n={}}if("array"===e){for(i=0,r=t.length;i<r;i++)n.push(this.clone(t[i]));return n}if("object"!==e)return null;for(i in t){var o=t[i];o&&o.clone?n[i]=o.clone():n[i]=this.clone(o)}return n},typeof:function(t){var e=Object.prototype.toString;return t instanceof Element?"element":{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[e.call(t)]},extend:function(t){var e,n=void 0,i=void 0,r=void 0;for(i=1,e=arguments.length;i<e;i++)for(n in r=arguments[i])t[n]=r[n];return t},mergeOptions:function(t){if(!t)return null;t.options||(t.options={});var e,n=void 0,i=void 0,r=void 0;for(i=1,e=arguments.length;i<e;i++)for(n in r=arguments[i])t.options[n]=r[n];return t.options},getUid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}).toLowerCase()},uniqueArray:function(t){if(!t||0===t.length)return t;var e=new Set(t);return[].concat(w(e))},rotatePoint:function(t,e,n){var i=Math.cos(n),r=Math.sin(n),o=t.x-e.x,s=t.y-e.y;t.x=o*i-s*r+e.x,t.y=o*r+s*i+e.y},rotatePointNew:function(t,e,n,i){var r=Math.cos(i),o=Math.sin(i),s=t-n.x,a=e-n.y;return[s*r-a*o+n.x,s*o+a*r+n.y]},getDistance:function(t,e,n,i){return Math.sqrt(Math.pow(t-n,2)+Math.pow(e-i,2))},isPointInPoint:function(t,e,n,i,r){return this.getDistance(t,e,n,i)<=r},isPointNearestOnLine:function(t,e,n,i,r,o,s){return this.getNearestDistance(t,e,n,i,r,o)<=s},getNearestDistance:function(t,e,n,i,r,o){var s,a,u;if(s=this.getDistance(t,e,r,o),this.IS0(s))return s;if(a=this.getDistance(n,i,r,o),this.IS0(a))return a;if(u=this.getDistance(t,e,n,i),this.IS0(u))return s;if(a*a+u*u<=s*s)return a;if(s*s+u*u<=a*a)return s;var l=(s+a+u)/2;return 2*Math.sqrt(l*(l-s)*(l-a)*(l-u))/u},IS0:function(t){return-1e-9<t&&t<1e-9},getPointFoot:function(t,e,n,i,r,o){var s=o-i,a=n-r,u=r*i-n*o;return{x:(a*a*t-s*a*e-s*u)/(s*s+a*a),y:(-s*a*t+s*s*e-a*u)/(s*s+a*a)}},convArc2PLine:function(t,e,n,i,r,o,s,a){if(!(t&&e&&n&&i))return!1;var u=a||45*Math.abs(s-o)/Math.PI,l=(s-o)/(u-1),h=0;for(h=0;h<u-1;h++){var c=new B.Point(0,0);c.x=e.x+n*Math.cos(o),c.y=e.y+i*Math.sin(o),t.push(c),o+=l}if(0<u){var p=new B.Point(0,0);p.x=e.x+n*Math.cos(s),p.y=e.y+i*Math.sin(s),t.push(p)}if(!this.IS0(r))for(var f=0;f<t.length;f++)this.rotatePoint(t[f],e,r)},isNumber:function(t){return!(!/^\d+(\.\d+)?$/.test(t)&&!/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/.test(t))},polygonArea:function(t){for(var e=0,n=t?t.length:0,i=0;i<n-1;i++){var r=t[i],o=t[i+1];e+=-.5*(o[1]+r[1])*(o[0]-r[0])}return e},isPointNearLinesect:function(t,e,n,i,r,o,s){var a=Math.atan2(i-e,n-t),u=r-t,l=o-e,h=new B.Point;return this.RotatePoint(u,l,0,0,Math.cos(-a),Math.sin(-a),h),u=h.x,l=h.y,!!(this.IsInZone(l,s)&&r>=Math.min(t,n)-s&&r<=Math.max(t,n)+s&&o>=Math.min(e,i)-s&&o<Math.max(e,i)+s)},RotatePoint:function(t,e,n,i,r,o,s){var a=t-n,u=e-i;t=a*r-u*o+n,e=a*o+u*r+i,s.x=t,s.y=e},IsInZone:function(t,e){return this.IS0(Math.abs(t)-Math.abs(e))||Math.abs(t)<=Math.abs(e)},isSysField:function(t){for(var e in w_)if(w_[e]==t)return!0;return!1}},M_={UNKNOWN:0,POINT:1,LINE:2,LINESTRING:1002,MULTILINE:22,MULTILINESTRING:1022,POLYGON:3,MULTIPOINT:4,MULTIPOLYGON:5,ZIPPOINT:6,ZIPLINE:7,ZIPPOLYGON:8,ZIPMULTIPOINT:9,ZIPMULTIPOLYGON:10,TEXT:11,Circle:100},C_={UNKNOWN:"unknown",ADD:"add",MODIFY:"modify",DELETE:"delete",EDIT_COLLECTION:"edit_collection"},P_=B.Evented.extend((f(L_={options:{id:-1,mapPoints:null,polyCount:null,subCount:0,properties:{},projInfo:null,symbol:null,renderItem:null,editAction:C_.UNKNOWN,geometry:null,version:0},initialize:function(t){B.setOptions(this,t),null!=this.options.version&&null!=this.options.version||(this.options.version=0),this._bounds=null,this._proj=null},getVersion:function(){return this.options.version},setVersion:function(t){this.options.version=t},getEditAction:function(){return this.options.editAction},setEditAction:function(t){var e=C_.UNKNOWN;if(null!=t)switch(t){case C_.ADD:e=C_.ADD;break;case C_.MODIFY:e=C_.MODIFY;break;case C_.DELETE:e=C_.DELETE}this.options.editAction=e},getID:function(){return this.options.id},setID:function(t){this.options.id=t},getMapPoints:function(){return this.options.mapPoints},setMapPoints:function(t){this.options.mapPoints=t},getSubCount:function(){return this.options.subCount},setSubCount:function(t){this.options.subCount=t},getPolyCount:function(){return this.options.polyCount},setPolyCount:function(t){this.options.polyCount=t},getProperties:function(){return this.options.properties},setProperties:function(t){this.options.properties=t},getProjInfo:function(){return this.options.projInfo},setProjInfo:function(t){this.options.projInfo=t}},"getProjInfo",function(){return this.options.projInfo}),f(L_,"setProj",function(t){this._proj=t}),f(L_,"getProj",function(){return this._proj}),f(L_,"getRenderItem",function(){return this.options.renderItem}),f(L_,"setRenderItem",function(t){this.options.renderItem=t}),f(L_,"getSymbol",function(){return this.options.symbol?this.options.symbol:this.options.renderItem&&this.options.renderItem.isVisible()?this.options.renderItem.getSymbol():null}),f(L_,"setSymbol",function(t){this.options.symbol=t}),f(L_,"getType",function(){return 0}),f(L_,"getBounds",function(){if(this._bounds)return this._bounds;var t=this.getMapPoints();return t&&0!==t.length?(this._bounds=I_.createFromPoints(t),this._bounds):null}),f(L_,"getPixelPointFromMapPoint",function(t,e,n){var i=null;this._proj?i=this._proj:this.options.projInfo&&(i=this.options.projInfo.createProj(),this._proj=i);var r=null;return r=i&&i.projection&&!this.options.projInfo.isEPSG4326()?i.projection.unproject(B.point(e,n)):new B.LatLng(n,e),t.latLngToLayerPoint(r).round()}),f(L_,"getMapPointFromPixel",function(t,e,n){var i=t.layerPointToLatLng(B.point(e,n)),r=null;return this._proj?r=this._proj:this.options.projInfo&&(r=this.options.projInfo.createProj(),this._proj=r),r&&r.projection&&!this.options.projInfo.isEPSG4326()?r.projection.project(B.point(i.lng,i.lat)):new B.Point(i.lng,i.lat)}),f(L_,"getPixelPoints",function(r,t,e){var o=this;if(!(e=e||this.getMapPoints())||0===e.length)return null;if(!r)return null;var s=null;return this._proj?s=this._proj:this.options.projInfo&&(s=this.options.projInfo.createProj(),this._proj=s),this._pixelPoints=new Array(e.length),e.forEach(function(t,e){var n=null;n=s&&s.projection&&!o.options.projInfo.isEPSG4326()?s.projection.unproject(t):new B.LatLng(t.y,t.x);var i=r.latLngToLayerPoint(n);o._pixelPoints[e]=i.round()}),this._pixelPoints}),f(L_,"toPixelGeometry",function(t,e){var n=this.getMapPoints(),i=n?n.length:0;if(!n||0===i)return null;var r=this.getType();if(r===M_.LINE&&i<2)return null;if(r===M_.POLYGON&&i<3)return null;var o=this.getPixelPoints(t,e,n),s=this.getSubCount(),a=this.getPolyCount();return new It({points:o,subCount:s,polyCount:a})}),f(L_,"clone",function(){return S_.clone(this)}),f(L_,"move",function(){return!1}),f(L_,"romate",function(){return!1}),f(L_,"addNode",function(){return!1}),f(L_,"editNode",function(){return!1}),f(L_,"cliLine",function(){return null}),f(L_,"transform",function(t){var e=this.clone();if(!t)return e;var n=t.createProj();if(!n)return e;var i=this.getProjInfo(),r=null;if(r=i?i.createProj():B.CRS.EPSG4326,n.code===r.code)return e;var o=e.getMapPoints(),s=[];return o.forEach(function(t){var e=S_.projTransform(t,r,n);s.push(e)}),e.setMapPoints(s),e}),L_)),N_=P_.extend({initialize:function(t){P_.prototype.initialize.call(this,t)},getSize:function(){var t=this.getSymbol();return t?t.getSize():0},getType:function(){return M_.POINT},getSubCount:function(){return this.options.mapPoints?this.options.mapPoints.length:0},getPolyCount:function(){var t=this.options.mapPoints;if(t&&0<t.length){var n=new Array(t.length);return this.options.mapPoints.forEach(function(t,e){n[e]=1}),n}return null},isMulti:function(){return 1<this.getSubCount()},splitToSingle:function(){var n=this,i=[];this.isMulti()?this.getMapPoints().forEach(function(t){var e=new N_({id:n.getID(),mapPoints:[t],polyCount:[1],subCount:1,properties:n.getProperties(),projInfo:n.getProjInfo(),renderItem:n.getRenderItem()});i.push(e)}):i.push(this);return i},toGeoJSON:function(){var t=this.getMapPoints();if(!t||0===t.length)return null;var e="",n=[];if(1<t.length)e="MultiPoint",t.forEach(function(t){n.push([t.x,t.y])});else{e="Point";var i=t[0];n=[i.x,i.y]}return{type:"Feature",geometry:{type:e,coordinates:n},properties:this.getProperties()}}}),O_=P_.extend({initialize:function(t){P_.prototype.initialize.call(this,t)},getType:function(){return M_.LINE},isMulti:function(){return 1<this.getSubCount()},toGeoJSON:function(){var t=this.getMapPoints();if(!t||0===t.length)return null;var e={},n=[],i=null;if(1===this.getSubCount())e.type="LineString",t.forEach(function(t){n.push([t.x,t.y])});else{e.type="MultiLineString";for(var r=0,o=this.getSubCount(),s=this.getPolyCount(),a=0;a<o;a++){for(var u=[],l=s[a],h=0;h<l;h++)i=t[r+h],u.push([i.x,i.y]);r+=l,n.push(u)}}return e.coordinates=n,{type:"Feature",geometry:e,properties:this.properties}}}),T_=P_.extend({initialize:function(t){P_.prototype.initialize.call(this,t)},getType:function(){return M_.POLYGON},toGeoJSON:function(){var t=this.getMapPoints();if(!t||0===t.length)return null;for(var e={type:"Polygon"},n=[],i=0,r=this.getPolyCount(),o=this.getSubCount(),s=0;s<o;s++){for(var a=[],u=r[s],l=0;l<u;l++){var h=t[i+l];a.push([h.x,h.y])}n.push(a),i+=u}return e.coordinates=n,{type:"Feature",geometry:e,properties:this.properties}},toLineStrings:function(){var t=this.getMapPoints();if(!t||0===t.length)return null;for(var e=[],n=0,i=this.getPolyCount(),r=this.getSubCount(),o=0;o<r;o++){for(var s=[],a=i[o],u=0;u<a;u++){var l=t[n+u];s.push([l.x,l.y])}n+=a;var h={type:"LineString"};h.coordinates=s;var c={type:"Feature",geometry:h,properties:this.properties};e.push(c)}return e}}),k_=P_.extend({initialize:function(t){P_.prototype.initialize.call(this,t),this._polygons=[]},getPolygons:function(){return this._polygons},setPolygons:function(t){this._polygons=t},addPolygon:function(t){this._polygons||(this._polygons=[]),this._polygons.push(t)},getType:function(){return M_.MULTIPOLYGON},getMapPoints:function(){var n=[];return this._polygons&&this._polygons.forEach(function(t){var e=t.getMapPoints();e&&0<e.length&&(n=n.concat(e))}),n},getSubCount:function(){var e=0;return this._polygons&&this._polygons.forEach(function(t){e+=t.getSubCount()}),e},getPolyCount:function(){var n=[];return this._polygons&&this._polygons.forEach(function(t){var e=t.getPolyCount();e&&0<e.length&&(n=n.concat(e))}),n},toGeoJSON:function(){if(!this._polygons||0===this._polygons.length)return null;for(var t={type:"MultiPolygon"},e=[],n=0;n<this._polygons.length;n++){var i=this._polygons[n];if(i){var r=i.getMapPoints(),o=i.getPolyCount(),s=i.getSubCount();if(r&&!(r.length<2)&&o&&0!==o.length&&0!==s){for(var a=0,u=[],l=0;l<s;l++){for(var h=[],c=o[l],p=0;p<c;p++){var f=r[a+p];h.push([f.x,f.y])}u.push(h),a+=c}e.push(u)}}}return t.coordinates=e,{type:"Feature",geometry:t,properties:this.properties}}}),R_="POINT",D_="LINESTRING",A_="POLYGON",F_="MULTIPOINT",B_="MULTILINESTRING",G_="MULTIPOLYGON",U_=1,j_=2,q_=P_.extend({options:{id:-1,properties:null,projInfo:null,symbol:null,renderItem:null,editAction:C_.UNKNOWN,geometry:null},initialize:function(t){B.setOptions(this,t),this._bounds=null,(this._proj=null)!=this.options.version&&null!=this.options.version||(this.options.version=0)},centroid:function(){return E_.centroid(this.getGeometry())},addRing:function(t){if(!t||t.length<=4)return!1;var e=this.getType();if(e==M_.POLYGON||e==M_.MULTIPOLYGON){var n=t.map(function(t){return[t.x,t.y]});S_.polygonArea(n)<0&&n.reverse();var i=E_.polygon([n]);if(e==M_.POLYGON){if(!E_.booleanContains(this.getGeometry(),i))return!1;var r=this.getCoordinates();return r.splice(r.length-1,0,n),!0}for(var o=this.getCoordinates(),s=0,a=o.length;s<a;s++){var u=E_.polygon(o[s]);if(E_.booleanContains(u,i))return o[s].splice(o[s].length-1,0,n),!0}}return!1},getType:function(){var t=M_.UNKNOWN;if(this.options.geometry&&this.options.geometry.type)switch(this.options.geometry.type.toUpperCase()){case R_:t=M_.POINT;break;case F_:t=M_.MULTIPOINT;break;case D_:t=M_.LINE;break;case B_:t=M_.MULTILINE;break;case A_:t=M_.POLYGON;break;case G_:t=M_.MULTIPOLYGON}return t},getBounds:function(t){if(!this.options.geometry||!this.options.geometry.type)return null;if(t&&(this._bounds=null),this._bounds)return S_.clone(this._bounds);var e=this.options.geometry.type,n=this.options.geometry.coordinates;switch(e.toUpperCase()){case R_:this._bounds=this._compouteBounds1D(n);break;case F_:case D_:this._bounds=this._compouteBounds2D(n);break;case B_:case A_:this._bounds=this._compouteBounds3D(n);break;case G_:this._bounds=this._compouteBounds4D(n)}return this._bounds&&S_.clone(this._bounds)},_compouteBounds1D:function(t){if(t&&2==t.length){return new I_({left:t[0],right:t[0],top:t[1],bottom:t[1]})}return null},_compouteBounds2D:function(t){if(t){var e=t,n=e.length;if(0<n){for(var i=0,r=0,o=0,s=0,a=0;a<n;a++)s=0===a?(i=r=e[a][0],o=e[a][1]):(i=Math.min(e[a][0],i),r=Math.max(e[a][0],r),o=Math.max(e[a][1],o),Math.min(e[a][1],s));return new I_({left:i,right:r,top:o,bottom:s})}return null}return null},_compouteBounds3D:function(t){if(t){var e=t,n=e.length;if(0<n){for(var i=null,r=0;r<n;r++)0===r?i=this._compouteBounds2D(e[r]):i.add(this._compouteBounds2D(e[r]));return i}return null}return null},_compouteBounds4D:function(t){if(!t)return null;var e=t,n=e.length;if(0<n){for(var i=null,r=0;r<n;r++)0===r?i=this._compouteBounds3D(e[r]):i.add(this._compouteBounds3D(e[r]));return i}},splitToSingle:function(){var t=[];if(this.getType()===M_.MULTIPOINT){var e=this.getGeometry();if(e&&e.coordinates&&0<e.coordinates.length)for(var n=e.coordinates,i=n.length,r=0;r<i;r++){var o=P_.createGeoJSONFeatureFromGeoJSON({type:"Point",coordinates:n[r]});o&&(o.setID(this.getID()),o.setProperties(this.getProperties()),o.setProjInfo(this.getProjInfo()),o.setRenderItem(this.getRenderItem()),t.push(o))}}else this.getType()===M_.POINT&&t.push(this);return t},getSize:function(){var t=this.getSymbol();return t?t.getSize():0},getMapPoints:function(){this.options.mapPoints=[],this.options.polyCount=[],this.options.subCount=0;var t=null,e=this.getGeometry(),n=e.coordinates;if(!e||!n||0==n.length)return null;var i=this.getType(),r=[];switch(i){case M_.POINT:r.push(new B.Point(n[0],n[1])),this.options.subCount=1,this.options.polyCount=[1],t=r;break;case M_.MULTIPOINT:n&&n.forEach(function(t){r.push(new B.Point(t[0],t[1]))}),this.options.subCount=r.length,this.options.polyCount=Array.apply(void 0,w(new Array(r.length))).map(function(){return 1}),t=r;break;case M_.LINE:case M_.LINESTRING:n&&n.forEach(function(t){r.push(new B.Point(t[0],t[1]))}),this.options.subCount=1,this.options.polyCount=[r.length],t=r;break;case M_.MULTILINE:case M_.MULTILINESTRING:for(var o=n.length,s=0;s<o;s++){for(var a=n[s],u=a.length,l=0;l<u;l++)r.push(new B.Point(a[l][0],a[l][1]));this.options.polyCount||(this.options.polyCount=[]),this.options.polyCount.push(u)}this.options.subCount=o,t=r;break;case M_.POLYGON:for(var h=n.length,c=0;c<h;c++){for(var p=n[c],f=p.length,d=0;d<f;d++)r.push(new B.Point(p[d][0],p[d][1]));this.options.polyCount||(this.options.polyCount=[]),this.options.polyCount.push(f)}t=r,this.options.subCount=h}return t},getPolygons:function(){if(this.getType()!==M_.MULTIPOLYGON)return null;var t=this.getGeometry(),n=[];return t&&t.coordinates&&0<t.coordinates.length&&t.coordinates.forEach(function(t){var e=P_.createGeoJSONFeatureFromGeoJSON(E_.polygon(t));n.push(e)}),n},getSubCount:function(){return this.options.subCount},setSubCount:function(t){this.options.subCount=t},getPolyCount:function(){return this.options.polyCount},setPolyCount:function(t){this.options.polyCount=t},getGeometry:function(){return this.options.geometry},getCoordinates:function(){return this.options.geometry?this.options.geometry.coordinates:null},move:function(t,e){if(null==t||null==e||null==t||null==e)return!1;var n=!1;if(this.options.geometry&&this.options.geometry.type){var i=this.options.geometry.type,r=this.options.geometry.coordinates;switch(i.toUpperCase()){case R_:for(var o=r.length,s=0;s<o;s+=2)r[s]+=t,r[s+1]+=e;n=!0;break;case F_:case D_:for(var a=r.length,u=0;u<a;u++)r[u][0]+=t,r[u][1]+=e;n=!0;break;case B_:case A_:for(var l=r.length,h=0;h<l;h++)for(var c=r[h].length,p=0;p<c;p++)r[h][p][0]+=t,r[h][p][1]+=e;n=!0;break;case G_:for(var f=r.length,d=0;d<f;d++)for(var g=r[d].length,y=0;y<g;y++)for(var _=r[d][y].length,m=0;m<_;m++)r[d][y][m][0]+=t,r[d][y][m][1]+=e;n=!0}}return n&&this._bounds&&this._bounds.extend(t,e),n},romate:function(t,e){if(!t||!e)return!1;var n=!1,i=[];if(this.options.geometry&&this.options.geometry.type){var r=this.options.geometry.type,o=this.options.geometry.coordinates;switch(r.toUpperCase()){case R_:for(var s=o.length,a=0;a<s;a+=2)(i=S_.rotatePointNew(o[a],o[a+1],t,e))&&(o[a]=i[0],o[a+1]=i[1]);n=!0;break;case F_:case D_:for(var u=o.length,l=0;l<u;l++)(i=S_.rotatePointNew(o[l][0],o[l][1],t,e))&&(o[l][0]=i[0],o[l][1]=i[1]);n=!0;break;case B_:case A_:for(var h=o.length,c=0;c<h;c++)for(var p=o[c].length,f=0;f<p;f++)(i=S_.rotatePointNew(o[c][f][0],o[c][f][1],t,e))&&(o[c][f][0]=i[0],o[c][f][1]=i[1]);n=!0;break;case G_:for(var d=o.length,g=0;g<d;g++)for(var y=o[g].length,_=0;_<y;_++)for(var m=o[g][_].length,v=0;v<m;v++)(i=S_.rotatePointNew(o[g][_][v][0],o[g][_][v][1],t,e))&&(o[g][_][v][0]=i[0],o[g][_][v][1]=i[1]);n=!0}}return n&&(this._bounds=null,this.getBounds()),n},addNode:function(t){if(!t||!t.snapPoint||null==t.subIndex||null==t.pointIndex)return!1;var e=!1,n=t.pointIndex,i=t.subIndex,r=t.snapPoint,o=[r.x,r.y],s=t.geoIndex;if(n<0)return!1;if(this.options.geometry&&this.options.geometry.type){var a=this.options.geometry.type,u=this.options.geometry.coordinates;switch(a.toUpperCase()){case D_:var l=u.length;0<=n&&n<l&&(u.splice(n+1,0,o),e=!0);break;case B_:case A_:var h=u.length;0<=i&&i<h&&0<=n&&n<u[i].length&&(u[i].splice(n+1,0,o),e=!0);break;case G_:var c=u.length;0<=s&&s<c&&0<=i&&i<u[s].length&&0<=n&&n<u[s][i].length&&(u[s][i].splice(n+1,0,o),e=!0)}}return e},deleteNode:function(t){if(!t||null==t.subIndex||null==t.pointIndex)return!1;var e=!1,n=t.pointIndex,i=t.subIndex,r=t.geoIndex;if(n<0)return!1;if(this.options.geometry&&this.options.geometry.type){var o=this.options.geometry.type,s=this.options.geometry.coordinates;switch(o.toUpperCase()){case D_:var a=s.length;3<=a&&0<=n&&n<a&&(s.splice(n,1),e=!0);break;case B_:var u=s.length;0<=i&&i<u&&3<=s[i].length&&0<=n&&n<s[i].length&&(s[i].splice(n,1),e=!0);break;case A_:var l=s.length;if(0<=i&&i<l)if(4<s[i].length&&(0==n||n==s[i].length-1)){var h=s[i][1];s[i].splice(0,1),s[i].splice(s[i].length-1,1,h),e=!0}else 4<s[i].length&&0<n&&n<s[i].length-1&&(s[i].splice(n,1),e=!0);break;case G_:var c=s.length;if(0<=r&&r<c&&0<=i&&i<s[r].length&&4<s[r][i].length)if(0==n||n==s[r][i].length-1){var p=s[r][i][1];s[r][i].splice(0,1),s[r][i].splice(s[r][i].length-1,1,p),e=!0}else 0<n&&n<s[r][i].length-1&&(s[r][i].splice(n,1),e=!0)}}return e},editNode:function(t,e){if(!t||null==t.subIndex||null==t.pointIndex||!e)return!1;var n=!1,i=t.pointIndex,r=t.subIndex,o=[e.x,e.y],s=t.geoIndex;if(i<0)return!1;if(this.options.geometry&&this.options.geometry.type){var a=this.options.geometry.type,u=this.options.geometry.coordinates;switch(a.toUpperCase()){case D_:var l=u.length;0<=i&&i<l&&(u[i]=o,n=!0);break;case B_:var h=u.length;0<=r&&r<h&&0<=i&&i<u[r].length&&(u[r][i]=o,n=!0);break;case A_:var c=u.length;if(0<=r&&r<c){var p=u[r].length;0<=i&&i<p&&(u[r][i]=o,0==i&&(u[r][p-1]=o),i+1==p&&(u[r][0]=o),n=!0)}break;case G_:var f=u.length;if(0<=s&&s<f){var d=u[s].length;if(0<=r&&r<d){var g=u[s][r].length;0<=i&&i<g&&(u[s][r][i]=o,0==i&&(u[s][r][g-1]=o),i+1==g&&(u[s][r][0]=o),n=!0)}}}}return n&&(this._bounds=null,this.getBounds()),n},clipLine:function(t){if(!t||!t.snapPoint||null==t.subIndex||null==t.pointIndex)return null;var e=t.snapPoint,n=t.pointIndex,i=t.subIndex,r=t.isInLine,o=[e.x,e.y];if(n<0)return null;var s=null,a=null;if(this.options.geometry&&this.options.geometry.type){var u=this.options.geometry.type,l=this.options.geometry.coordinates;switch(u.toUpperCase()){case D_:var h=l.length;if(0<=n&&n<h)if(r){var c=l.slice(n+1);if(c&&0<c.length&&(c.unshift(o),s=E_.lineString(c,this.getProperties()))){var p=h-(n+1);l.splice(n+1,p,o)}}else if(2<h&&0<n&&n+1<h){var f=l.slice(n);if(f&&2<=f.length&&(s=E_.lineString(f,this.getProperties()))){var d=h-n;l.splice(n,d,o)}}break;case B_:var g=l.length;if(0<=i&&i<g&&0<=n&&n<l[i].length)if(r){var y=l[i].slice(n+1);if(y&&0<y.length&&(y.unshift(o),s=E_.lineString(y,this.getProperties()))){var _=g-(n+1);l[i].splice(n+1,_,o)}}else if(1==g){if(2<g&&0<n&&n+1<g){var m=l[i].slice(n);if(m&&2<=m.length&&(s=E_.lineString(m,this.getProperties()))){var v=g-n;l[i].splice(n,v,o)}}}else if(1<g&&2<g&&0<n&&n+1<g){var b=l[i].slice(n);if(b&&2<=b.length&&(s=E_.lineString(b,this.getProperties()))){var x=g-n;l[i].splice(n,x,o)}}}}return s&&(this._bounds=null,this.getBounds(),a={newSourceFeature:this,newGeoJSON:s}),a},convertToPointFeatures:function(){var i=this,t=this.getMapPoints(),r=[];return t&&t.forEach(function(t){var e={geometry:{type:"Point",coordinates:[t.x,t.y]},type:"Feature"},n=P_.createGeoJSONFeatureFromGeoJSON(e);n&&(n.setProjInfo(i.getProjInfo()),n.setProj(i.getProj()),r.push(n))}),r},polygonToLine:function(){var t=this.getType(),e=this.getCoordinates();if(!e||0==e.length)return null;var n=[];switch(t){case M_.POLYGON:for(var i=e.length,r=0;r<i;r++){var o=e[r].length;n.push([e[r].slice(0,o-1)])}break;case M_.MULTIPOLYGON:for(var s=e.length,a=0;a<s;a++)for(var u=e[a].length,l=0;l<u;l++){var h=e[a][l].length;n.push([e[a][l].slice(0,h-1)])}}return n&&0<n.length?E_.multiLineString(n):null},getSubCoords:function(t,e){if(!t||!e)return null;if(this.getType()!=t.type||this.getType()!=e.type)return null;var n=this.getType(),i=0,r=0,o=0,s=0,a=0,u=this.getCoordinates();if(!u||0==u.length)return null;var l=null;switch(n){case M_.POINT:return null;case M_.MULTIPOINT:(i=t.pointIndex)<=(r=e.pointIndex)&&r<u.length&&(l=u.slice(i,r+1));break;case M_.LINE:case M_.LINESTRING:(i=t.pointIndex)<=(r=e.pointIndex)&&r<u.length&&(l=u.slice(i,r+1));break;case M_.MULTILINESTRING:case M_.MULTILINE:if(i=t.pointIndex,r=e.pointIndex,(o=t.subIndex)==(s=e.subIndex)&&i<=r&&o<u.length){var h=u[o];h&&0<h.length&&r<h.length&&(l=h.slice(i,r+1))}break;case M_.POLYGON:if(i=t.pointIndex,r=e.pointIndex,(o=t.subIndex)==(s=e.subIndex)&&i<=r&&o<u.length){var c=u[o];c&&0<c.length&&r<c.length&&(l=c.slice(i,r+1))}break;case M_.MULTIPOLYGON:if(i=t.pointIndex,r=e.pointIndex,o=t.subIndex,s=e.subIndex,(a=t.geoIndex)==e.geoIndex&&o==s&&i<=r&&a<u.length){var p=u[a];if(p&&0<p.length&&s<p.length){var f=p[s];f&&0<f.length&&r<f.length&&(l=f.slice(i,r+1))}}}return l=l&&S_.clone(l)},replaceSubCoords:function(t,e,n){if(!t||!e||!n||0==n.length)return!1;if(this.getType()!=t.type||this.getType()!=e.type)return!1;var i,r,o=this.getType(),s=0,a=0,u=0,l=this.getCoordinates();if(!l||0==l.length)return!1;i=t.pointIndex,r=e.pointIndex;(t.isInLine?S_.isPointInPoint(t.intersectPoint.x,t.intersectPoint.y,n[0][0],n[0][1],1e-9):S_.isPointInPoint(t.points[0].x,t.points[0].y,n[0][0],n[0][1],1e-9))||(n=S_.clone(n).reverse());var h=!1;switch(o){case M_.POLYGON:if(s==a&&i<=r&&s<l.length){var c=l[s];c&&0<c.length&&r<c.length&&(c.splice.apply(c,[i+1,r-i].concat(w(n))),h=!0)}break;case M_.MULTIPOLYGON:if(s=t.subIndex,a=e.subIndex,(u=t.geoIndex)==e.geoIndex&&s==a&&i<=r&&u<l.length){var p=l[u];if(p&&0<p.length&&a<p.length){var f=p[a];f&&0<f.length&&r<f.length&&(f.splice.apply(f,[i+1,r-i].concat(w(n))),h=!0)}}}return h},isPolygonFirstPoint:function(t,e){var n=this.getType(),i=this.getCoordinates();if(!i||0==i.length)return!1;var r=!1;switch(n){case M_.POLYGON:for(var o=i.length,s=0;s<o;s++)if(r=S_.isPointInPoint(i[s][0][0],i[s][0][1],t,e,1e-9))return!0;break;case M_.MULTIPOLYGON:for(var a=i.length,u=0;u<a;u++){for(var l=i[u].length,h=0;h<l;h++){i[u][h].length;if(r=S_.isPointInPoint(i[u][h][0][0],i[u][h][0][1],t,e,1e-9))return!0}if(r)return!0}}return r},eliminateGaps:function(t){var e=this.getType(),n=t&&t.getType(),i=null;e!=M_.POLYGON&&e!=M_.MULTIPOLYGON||n!=M_.POLYGON&&n!=M_.MULTIPOLYGON||(i=E_.lineIntersect(this.getGeometry(),t.getGeometry()));var r=i&&i.features;if(!r||r.length<=1)return!1;for(var o=r.length,s=!1,a=0;a<o-1;a++){S_.isPointInPoint();var u=r[a],l=r[a+1],h=E_.getType(u),c=E_.getType(l);if("Point"!=h||"Point"!=c)return!1;var p=u.geometry.coordinates,f=l.geometry.coordinates;if(this.isPolygonFirstPoint(f[0],f[1])){var d=[].concat(w(f));f=[].concat(w(p)),p=[].concat(w(d))}var g=p&&2==p.length?new B.Point(p[0],p[1]):null,y=f&&2==f.length?new B.Point(f[0],f[1]):null,_=null,m=this.getPointIndex(g,1e-9),v=this.getPointIndex(y,1e-9);if(m&&v&&m.pointIndex>v.pointIndex&&(_=S_.clone(m),m=S_.clone(v),v=S_.clone(_)),m&&v&&m.pointIndex==v.pointIndex&&(m.isInLine||v.isInLine)){var b=m.isInLine?m.points:v.isInLine?v.points:null;if(b&&2==b.length)(f[0]-p[0])*(b[1].x-b[0].x)<0&&(_=S_.clone(m),m=S_.clone(v),v=S_.clone(_))}var x=this.getSubCoords(m,v);if(!x||0==x.length)return!1;m.isInLine&&x.splice(0,1,p),v.isInLine&&x.push(f);var E=t.getPointIndex(g,1e-9),I=t.getPointIndex(y,1e-9);if(E&&I&&E.pointIndex>I.pointIndex&&(_=S_.clone(E),E=S_.clone(I),I=S_.clone(_)),E&&I&&E.pointIndex==I.pointIndex&&(E.isInLine||I.isInLine)){var L=E.isInLine?E.points:I.isInLine?I.points:null;if(L&&2==L.length)(f[0]-p[0])*(L[1].x-L[0].x)<0&&(_=S_.clone(E),E=S_.clone(I),I=S_.clone(_))}if(!(s=t.replaceSubCoords(E,I,x,1e-9)))break}return s&&t.getBounds(!0),s},getPointIndex:function(t,e){e=e||1e-9;var n=this.getGeometry();if(!n||!n.coordinates||!t)return null;t=t.clone();var i=n.coordinates,r=this.getType(),o=null,s=U_|j_;switch(r){case M_.POINT:if(2==i.length)S_.isPointInPoint(i[0],i[1],t.x,t.y,e)&&(o={points:[new B.Point(i[0],i[1])],pointIndex:0,type:r});break;case M_.MULTIPOINT:for(var a=i.length,u=0;u<a;u++){if(S_.isPointInPoint(i[u][0],i[u][1],t.x,t.y,e)){o={points:[new B.Point(i[u][0],i[u][1])],pointIndex:u,type:r};break}}break;case M_.LINE:case M_.LINESTRING:(o=this._getSubPointIndex(i,t,s,e))&&(o.type=r);break;case M_.MULTILINE:case M_.MULTILINESTRING:case M_.POLYGON:for(var l=i.length,h=0;h<l;h++)if(o=this._getSubPointIndex(i[h],t,s,e)){o.subIndex=h,o.type=r;break}break;case M_.MULTIPOLYGON:for(var c=i.length,p=0;p<c;p++){for(var f=i[p],d=f.length,g=0;g<d;g++)if(o=this._getSubPointIndex(f[g],t,s,e)){o.subIndex=g;break}if(o){o.geoIndex=p,o.type=r;break}}}return o},_getSubPointIndex:function(t,e,n,i){if(i=i||1e-9,!t||t.length<2||!e)return null;e=e.clone();for(var r=null,o=t.length,s=null,a=0;a<o-1;a++){var u=t[a],l=t[a+1];if(u&&l){var h=!1;if(0<(n&U_)&&((h=S_.isPointInPoint(u[0],u[1],e.x,e.y,i))&&(r={points:[s=new B.Point(u[0],u[1])],pointIndex:a,pointCount:o,isInLine:!1}),h||(h=S_.isPointInPoint(l[0],l[1],e.x,e.y,i))&&(r={points:[s=new B.Point(l[0],l[1])],pointIndex:a+1,pointCount:o,isInLine:!1})),h||0<(n&j_)&&(h=S_.isPointNearLinesect(u[0],u[1],l[0],l[1],e.x,e.y,1e-9))&&(s=S_.getPointFoot(e.x,e.y,u[0],u[1],l[0],l[1]),r={points:[new B.Point(u[0],u[1]),new B.Point(l[0],l[1])],pointIndex:a,intersectPoint:s,pointCount:o,isInLine:!0}),h)break}}return r},union:function(t,e){var n=!(1<arguments.length&&void 0!==e)||e;if(!t)return null;if(!this.getGeometry()||!t.getGeometry())return null;var i=this.getType(),r=t.getType(),o=n?this.getProperties():t.getProperties(),s=null,a=this.getCoordinates(),u=t.getCoordinates(),l=[];if(i==M_.POINT||i==M_.MULTIPOINT){if(r==M_.POINT||r==M_.MULTIPOINT){i==M_.POINT?l.push(a):l.push.apply(l,w(a)),r==M_.POINT?l.push(u):l.push.apply(l,w(u));var h=E_.multiPoint(l);h&&(s=P_.createGeoJSONFeatureFromGeoJSON(h))&&s.setProperties(o)}}else if(i==M_.LINE||i==M_.MULTILINE){if(r==M_.LINE||r==M_.MULTILINE){i==M_.LINE?l.push(a):l.push.apply(l,w(a)),r==M_.LINE?l.push(u):l.push.apply(l,w(u));var c=E_.multiLineString(l);c&&(s=P_.createGeoJSONFeatureFromGeoJSON(c))&&s.setProperties(o)}}else if(!(i!=M_.POLYGON&&i!=M_.MULTIPOLYGON||r!=M_.POLYGON&&r!=M_.MULTIPOLYGON)){i==M_.POLYGON?l.push(a):l.push.apply(l,w(a)),r==M_.POLYGON?l.push(u):l.push.apply(l,w(u));var p=[];l.forEach(function(t){p.push(E_.polygon(t))});var f=E_.union.apply(E_,p);(s=P_.createGeoJSONFeatureFromGeoJSON(f))&&s.setProperties(o)}return s},toGeoJSON:function(){return{type:"Feature",properties:this.getProperties(),geometry:this.getGeometry()}}});P_.createFeatureFromGeoJSON=function(t){if(!t||!t.geometry)return null;var e=null;"Feature"===t.type&&(e=t.geometry);var n;n=null!=t.id?t.id:-1;var i=e.coordinates;if(!i||0===i.length)return null;var r=void 0,o=void 0,s=void 0,a=void 0,u=void 0,l=[],h=[];switch(e.type){case"Point":return u=new B.Point(i[0],i[1]),new N_({mapPoints:[u],polyCount:[1],subCount:1,id:n});case"MultiPoint":for(s=i.length,r=0;r<s;r++){var c=i[r];u=new B.Point(c[0],c[1]),l.push(u)}return h=Array.apply(void 0,w(new Array(l.length))).map(function(){return 1}),new N_({mapPoints:l,polyCount:h,subCount:l.length,id:n});case"LineString":case"MultiLineString":if(!i[0])return null;var p=i[0];if(B.Util.isArray(p[0])){for(s=i.length,r=0;r<s;r++){var f=i[r];if(f&&0<f.length)for(a=f.length,h.push(a),o=0;o<a;o++)u=f[o],l.push(new B.Point(u[0],u[1]))}return new O_({mapPoints:l,polyCount:h,subCount:s,id:n})}for(s=i.length,r=0;r<s;r++)u=i[r],l.push(new B.Point(u[0],u[1]));return new O_({mapPoints:l,polyCount:[l.length],subCount:1,id:n});case"Polygon":for(s=i.length,r=0;r<s;r++){var d=i[r];if(d&&0<d.length)for(a=d.length,h.push(a),o=0;o<a;o++)u=d[o],l.push(new B.Point(u[0],u[1]))}return new T_({mapPoints:l,polyCount:h,subCount:s,id:n});case"MultiPolygon":for(var g=i.length,y=new k_({id:n}),_=0;_<g;_++){var m=i[_];for(s=m.length,h=[],l=[],r=0;r<s;r++){var v=m[r];if(v&&0<v.length)for(a=v.length,h.push(a),o=0;o<a;o++)u=v[o],l.push(new B.Point(u[0],u[1]))}var b=new T_({mapPoints:l,polyCount:h,subCount:s,id:-1});y.addPolygon(b)}return y}return null},P_.createGeoJSONFeatureFromAttributes=function(t){if(!t)return null;var e,n=null;return e=null!=t.gid?t.gid:-1,t.geom&&(n=JSON.parse(t.geom)),new q_({geometry:n,id:e,version:null==t.version||null==t.version?0:t.version})},P_.createGeoJSONFeatureFromGeoJSON=function(t){if(!t||!t.geometry)return null;var e=null;"Feature"===t.type&&(e=t.geometry);var n;n=null!=t.id?t.id:-1;var i=e.coordinates;return i&&0!==i.length?new q_({geometry:e,id:n,version:null==t.version||null==t.version?0:t.version}):null},P_.createLinesFromMultiLine=function(t){if(t&&"MultiLineString"===t.type){for(var e=t.coordinates,n=e?e.length:0,i=[],r=0;r<n;r++){var o={type:"LineString",coordinates:e[r]};i.push(o)}return i}return null},P_.createPolygonFromMultiPolygon=function(t){if(t&&"MultiPolygon"===t.type){for(var e=t.coordinates,n=e?e.length:0,i=[],r=0;r<n;r++){var o={type:"Polygon",coordinates:e[r]};i.push(o)}return i}return null};var z_="geographic",V_="arithmetic",Y_={renderItemId:"",renderItem:null,layerIndexList:null},H_=(c(X_,[{key:"readJson",value:function(t){this.options.renderItemId=t.render_item_id,this.options.layerIndexList=t.symbol_layer_level_list}},{key:"toJson",value:function(t){t.render_item_id=this.options.renderItemId,t.symbol_layer_level_list=this.options.layerIndexList}},{key:"getRenderItemId",value:function(){return this.options.renderItemId}},{key:"setRenderItemId",value:function(t){this.options.renderItemId=t}},{key:"getRenderItem",value:function(){return this.options.renderItem}},{key:"setRenderItem",value:function(t){this.options.renderItem=t}},{key:"getLayerIndexList",value:function(){return this.options.layerIndexList}},{key:"setLayerIndexList",value:function(t){this.options.layerIndexList=t}}]),X_);function X_(t){h(this,X_),this.options=S_.mergeOptions(this,Y_,t)}var J_={legendClasses:null,isMerged:!1},W_=(c(K_,[{key:"readJson",value:function(t){var n=this;t&&(this.options.isMerged=t.symbols_are_grduated,t.legend_class_list&&0<t.legend_class_list.length&&(this.options.legendClasses=[],t.legend_class_list.forEach(function(t){var e=new H_;e.readJson(t),n.options.legendClasses.push(e)})))}},{key:"toJson",value:function(t){if(t)if(t.symbols_are_grduated=this.options.isMerged,this.options.legendClasses&&0<this.options.legendClasses.length){var n=[];this.options.legendClasses.forEach(function(t){var e={};t.toJson(e),n.push(e)}),t.legend_class_list=n}else t.legend_class_list=null}},{key:"getLegendClasses",value:function(){return this.options.legendClasses}},{key:"setLegendClasses",value:function(t){this.options.legendClasses=t}},{key:"isMerged",value:function(){return this.options.isMerged}},{key:"setIsMerged",value:function(t){this.options.isMerged=t}},{key:"getLayerIndexList",value:function(){var t=this.options.legendClasses;if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){var e=t.getLayerIndexList();e&&0!==e.length&&e.forEach(function(t){-1!==t&&-1===n.indexOf(t)&&n.push(t)})}),n.sort(),n}}]),K_);function K_(t){h(this,K_),this.options=S_.mergeOptions(this,J_,t)}var Z_="",Q_="simple_marker_symbol",$_="char_marker_symbol",tm="picture_marker_symbol",em="arrow_marker_symbol",nm="multi_layer_marker_symbol",im="simple_line_symbol",rm="carto_line_symbol",om="marker_line_symbol",sm="hash_line_symbol",am="multi_layer_line_symbol",um="simple_fill_symbol",lm="gradient_fill_symbol",hm="marker_fill_symbol",cm="line_fill_symbol",pm="picture_fill_symbol",fm="multi_layer_fill_symbol",dm="text_symbol",gm={UNKNOW_SYMBOL:"unknow_symbol",MARKER_SYMBOL:"mark_symbol",LINE_SYMBOL:"line_symbol",FILL_SYMBOL:"fill_symbol",TEXT_SYMBOL:"text_symbol"},ym=j(function(t,e){function l(t){for(var e in 334<=t&&t<=360&&(t-=360),c){var n=c[e];if(n.hueRange&&t>=n.hueRange[0]&&t<=n.hueRange[1])return c[e]}return"Color not found"}function s(t){if(null===h)return Math.floor(t[0]+Math.random()*(t[1]+1-t[0]));var e=t[1]||1,n=t[0]||0,i=(h=(9301*h+49297)%233280)/233280;return Math.floor(n+i*(e-n))}function n(t,e,n){var i=n[0][0],r=n[n.length-1][0],o=n[n.length-1][1],s=n[0][1];c[t]={hueRange:e,lowerBounds:n,saturationRange:[i,r],brightnessRange:[o,s]}}function a(t){var e=t[0];0===e&&(e=1),360===e&&(e=359),e/=360;var n=t[1]/100,i=t[2]/100,r=Math.floor(6*e),o=6*e-r,s=i*(1-n),a=i*(1-o*n),u=i*(1-(1-o)*n),l=256,h=256,c=256;switch(r){case 0:l=i,h=u,c=s;break;case 1:l=a,h=i,c=s;break;case 2:l=s,h=i,c=u;break;case 3:l=s,h=a,c=i;break;case 4:l=u,h=s,c=i;break;case 5:l=i,h=s,c=a}return[Math.floor(255*l),Math.floor(255*h),Math.floor(255*c)]}function u(t){var e=t[0],n=t[1]/100,i=t[2]/100,r=(2-n)*i;return[e,Math.round(n*i/(r<1?r:2-r)*1e4)/100,r/2*100]}var h,c,i;c={},n("monochrome",h=null,[[0,0],[100,0]]),n("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),n("orange",[19,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),n("yellow",[47,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),n("green",[63,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),n("blue",[179,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),n("purple",[258,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),n("pink",[283,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]]),i=function t(e){if(void 0!==(e=e||{}).seed&&null!==e.seed&&e.seed===parseInt(e.seed,10))h=e.seed;else if("string"==typeof e.seed)h=function(t){for(var e=0,n=0;n!==t.length&&!(e>=Number.MAX_SAFE_INTEGER);n++)e+=t.charCodeAt(n);return e}(e.seed);else{if(void 0!==e.seed&&null!==e.seed)throw new TypeError("The seed value must be an integer or string");h=null}var n,i;if(null===e.count||void 0===e.count)return function(t,e){switch(e.format){case"hsvArray":return t;case"hslArray":return u(t);case"hsl":var n=u(t);return"hsl("+n[0]+", "+n[1]+"%, "+n[2]+"%)";case"hsla":var i=u(t),r=e.alpha||Math.random();return"hsla("+i[0]+", "+i[1]+"%, "+i[2]+"%, "+r+")";case"rgbArray":return a(t);case"rgb":return"rgb("+a(t).join(", ")+")";case"rgba":var o=a(t);return r=e.alpha||Math.random(),"rgba("+o.join(", ")+", "+r+")";default:return function(t){var e=a(t);function n(t){var e=t.toString(16);return 1==e.length?"0"+e:e}return"#"+n(e[0])+n(e[1])+n(e[2])}(t)}}([n=function(t){var e=s(function(t){if("number"==typeof parseInt(t)){var e=parseInt(t);if(e<360&&0<e)return[e,e]}if("string"==typeof t)if(c[t]){var n=c[t];if(n.hueRange)return n.hueRange}else if(t.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var i=function(t){t=3===(t=t.replace(/^#/,"")).length?t.replace(/(.)/g,"$1$1"):t;var e=parseInt(t.substr(0,2),16)/255,n=parseInt(t.substr(2,2),16)/255,i=parseInt(t.substr(4,2),16)/255,r=Math.max(e,n,i),o=r-Math.min(e,n,i),s=r?o/r:0;switch(r){case e:return[(n-i)/o%6*60||0,s,r];case n:return[60*((i-e)/o+2)||0,s,r];case i:return[60*((e-n)/o+4)||0,s,r]}}(t)[0];return[i,i]}return[0,360]}(t.hue));return e<0&&(e=360+e),e}(e),i=function(t,e){if("monochrome"===e.hue)return 0;if("random"===e.luminosity)return s([0,100]);var n=function(t){return l(t).saturationRange}(t),i=n[0],r=n[1];switch(e.luminosity){case"bright":i=55;break;case"dark":i=r-10;break;case"light":r=55}return s([i,r])}(n,e),function(t,e,n){var i=function(t,e){for(var n=l(t).lowerBounds,i=0;i<n.length-1;i++){var r=n[i][0],o=n[i][1],s=n[i+1][0],a=n[i+1][1];if(r<=e&&e<=s){var u=(a-o)/(s-r);return u*e+(o-u*r)}}return 0}(t,e),r=100;switch(n.luminosity){case"dark":r=i+20;break;case"light":i=(r+i)/2;break;case"random":i=0,r=100}return s([i,r])}(n,i,e)],e);var r=e.count,o=[];for(e.count=null;r>o.length;)h&&e.seed&&(e.seed+=1),o.push(t(e));return e.count=r,o},t&&t.exports&&(e=t.exports=i),e.randomColor=i}).randomColor,_m=(c(mm,null,[{key:"createRGBAColor",value:function(t,e){void 0===t&&(t=0),void 0===e&&(e=255);var n=new mm;return n.alpha=e,n.red=this.getRed(t),n.green=this.getGreen(t),n.blue=this.getBlue(t),n}},{key:"getRed",value:function(t){return t>>16}},{key:"getGreen",value:function(t){return t>>8&255}},{key:"getBlue",value:function(t){return 255&t}},{key:"createRandom",value:function(){var t=ym({format:"rgbArray",luminosity:"light"});return t&&4<=t.length&&(t[3]*=255),t=this.createFromArray(t)}},{key:"createFromArray",value:function(t){if(!t||t.length<3)return null;var e=new mm(t[0],t[1],t[2]);return 3<t.length&&(e.alpha=t[3]),e}}]),c(mm,[{key:"getColorValue",value:function(){return this.red<<16|this.green<<8|this.blue}},{key:"hexValue",value:function(){var t=this.red.toString(16),e=this.green.toString(16),n=this.blue.toString(16);return"#"+(this.red<16?"0"+t:t)+(this.green<16?"0"+e:e)+(this.blue<16?"0"+n:n)}},{key:"toArray",value:function(){return[this.red,this.green,this.blue,this.alpha]}},{key:"getStrColor",value:function(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha/255+")"}},{key:"clone",value:function(){return bt.clone(this)}}]),mm);function mm(t,e,n,i){h(this,mm),this.red=t||0,this.green=e||0,this.blue=n||0,this.alpha=void 0!==i?i:255}var vm={name:"",label:"",color:null,group:""},bm=(c(xm,[{key:"mergeOptions",value:function(){this.options||(this.options={}),bt.extend.apply(bt,[this.options].concat(Array.prototype.slice.call(arguments)))}}]),c(xm,[{key:"readJson",value:function(t){this.id=t.id,this.options.name=t.name,this.options.label=t.label,this.options.group=t.group,this.options.color=_m.createFromArray(t.color)}},{key:"toJson",value:function(t){t&&(t.id=this.id,t.class=this.class,t.name=this.options.name,t.label=this.options.label,t.group=this.options.group,this.options.color?t.color=this.options.color.toArray():t.color=null)}},{key:"clone",value:function(){var t={};return this.toJson(t),xm.readFromJson(t)}},{key:"setName",value:function(t){this.options.name=t}},{key:"getName",value:function(){return this.options.name}},{key:"setLabel",value:function(t){this.options.label=t}},{key:"getLabel",value:function(){return this.options.label}},{key:"getColor",value:function(){return this.options.color}},{key:"setColor",value:function(t){this.options.color=t}},{key:"getGroup",value:function(){return this.options.group}},{key:"setGroup",value:function(t){this.options.group=t}},{key:"getID",value:function(){return this.id}},{key:"getClass",value:function(){return this.class}},{key:"getType",value:function(){return this.type}},{key:"getSymbolLayerCount",value:function(){return 1}},{key:"getSymbolLayer",value:function(){return this}},{key:"needLoadResource",value:function(){return!1}},{key:"loadResources",value:function(){return Promise.resolve()}}]),xm);function xm(t){h(this,xm),this.mergeOptions(vm,t),this.options.color||(this.options.color=_m.createRandom()),this.id=bt.getUid(),this.class=Z_,this.type=gm.UNKNOW_SYMBOL}var Em={id:"",symbol:null,name:"",label:"",visible:!0},Im=(c(Lm,[{key:"readJson",value:function(t){t&&(this.options.id=t.id,this.options.name=t.name,this.options.label=t.label,this.options.visible=t.visible,t.symbol&&(this.options.symbol=bm.readFromJson(t.symbol)))}},{key:"toJson",value:function(t){if(t)if(t.id=this.options.id,t.name=this.options.name,t.label=this.options.label,t.visible=this.options.visible,this.options.symbol){var e={};this.options.symbol.toJson(e),t.symbol=e}else t.symbol=null}},{key:"getID",value:function(){return this.options.id}},{key:"setID",value:function(t){this.options.id=t}},{key:"getSymbol",value:function(){return this.options.symbol}},{key:"setSymbol",value:function(t){this.options.symbol=t}},{key:"getName",value:function(){return this.options.name}},{key:"setName",value:function(t){this.options.name=t}},{key:"getLabel",value:function(){return this.options.label}},{key:"setLabel",value:function(t){this.options.label=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}},{key:"clone",value:function(){var t=S_.extend({},this.options);return t.symbol=this.options.symbol?this.options.symbol.clone():null,new Lm(t)}}]),Lm);function Lm(t){h(this,Lm),this.options=S_.mergeOptions(this,Em,t),this.options.id||(this.options.id=S_.getUid())}function wm(t){h(this,wm),t=t||{},this.test_mask=void 0!==t.test_mask?t.test_mask:Cm.OVERLAP_ELEM_POINT,this.set_mask=void 0!==t.set_mask?t.set_mask:Cm.OVERLAP_ELEM_POINT,this.set_value=void 0!==t.set_value?t.set_value:Cm.OVERLAP_ELEM_POINT,this.elem_range_type=void 0!==t.elem_range_type?t.elem_range_type:Pm,this.avoid_edge=void 0===t.avoid_edge||t.avoid_edge,this.entire_visble=void 0!==t.entire_visble?t.entire_visble:1}var Sm={UNKNOWN:0,POINT:1,LINE:2,POLYGON:3,TEXT:4,NETWORK:5,TABULAR:6,FLOW:7},Mm={UNKNOWN:0,POINT:1,LINE:2,POLYGON:3,TEXT:4,NETWORK:5,TABULAR:6,FLOW:7,COLLECTION:8},Cm={OVERLAP_ELEM_NONE:0,OVERLAP_ELEM_POINT:1,OVERLAP_ELEM_LINE:2,OVERLAP_ELEM_POLYGON:4,OVERLAP_ELEM_LABEL:8,OVERLAP_ELEM_SHIELD:16,OVERLAP_ELEM_CUSTEM_1:32,OVERLAP_ELEM_CUSTEM_2:64,OVERLAP_ELEM_CUSTEM_3:128,OVERLAP_ELEM_FEATURE_ALL:7,OVERLAP_ELEM_ALL:255},Pm=0,Nm={defaultRenderItem:null,legendGroup:null,rotationField:"",rotationType:z_,sizeField:"",colorField:"",transparencyField:"",transPercent:0,avoidFlag:Cm.OVERLAP_ELEM_POINT},Om=(c(Tm,[{key:"readJson",value:function(t){t&&(this.options.avoidFlag=t.avoid_flag||Cm.OVERLAP_ELEM_NONE,t.color_renderer&&(this.options.colorField=t.color_renderer.field),t.rotation_renderer&&(this.options.rotationField=t.rotation_renderer.field,this.options.rotationType=t.rotation_renderer.rotation_type),t.size_renderer&&(this.options.sizeField=t.size_renderer.field),t.transparency_renderer&&(this.options.transparencyField=t.transparency_renderer.field),this.options.transPercent=t.transpercent,t.legend_group&&(this.options.legendGroup=new W_,this.options.legendGroup.readJson(t.legend_group)),t.default_render_item&&(this.options.defaultRenderItem=new Im,this.options.defaultRenderItem.readJson(t.default_render_item)))}},{key:"toJson",value:function(t){if(t){if(t.avoid_flag=this.options.avoidFlag,t.class=this.type,t.color_renderer={field:this.options.colorField},t.rotation_renderer={field:this.options.rotationField,rotation_type:this.options.rotationType},t.size_renderer={field:this.options.sizeField},t.transparency_renderer={field:this.options.transparencyField},t.transpercent=this.options.transPercent,this.options.legendGroup){var e={};this.options.legendGroup.toJson(e),t.legend_group=e}else t.legend_group=null;if(this.options.defaultRenderItem){var n={};this.options.defaultRenderItem.toJson(n),t.default_render_item=n}else t.default_render_item=null}}},{key:"getType",value:function(){return this.type}},{key:"setDefaultRenderItem",value:function(t){this.options.defaultRenderItem=t}},{key:"getDefaultRenderItem",value:function(){return this.options.defaultRenderItem}},{key:"getLegendGroup",value:function(){return this.options.legendGroup}},{key:"setLegendGroup",value:function(t){this.options.legendGroup=t}},{key:"getRotationField",value:function(){return this.options.rotationField}},{key:"setRotationField",value:function(t){this.options.rotationField=t}},{key:"getRotationType",value:function(){return this.options.rotationType}},{key:"setRotationType",value:function(t){this.options.rotationType=t}},{key:"getSizeField",value:function(){return this.options.sizeField}},{key:"setSizeField",value:function(t){this.options.sizeField=t}},{key:"getTransparencyField",value:function(){return this.options.transparencyField}},{key:"setTransparencyField",value:function(t){this.options.transparencyField=t}},{key:"getTransPercent",value:function(){return this.options.transPercent}},{key:"setTransPercent",value:function(t){this.options.transPercent=t}},{key:"getColorField",value:function(){return this.options.colorField}},{key:"setColorField",value:function(t){this.options.colorField=t}},{key:"getUsedFields",value:function(){var t=[];return this.options.rotationField&&t.push(this.options.rotationField),this.options.sizeField&&t.push(this.options.sizeField),this.options.colorField&&t.push(this.options.colorField),this.options.transparencyField&&t.push(this.options.transparencyField),S_.uniqueArray(t)}},{key:"findRenderItem",value:function(t,e){var n=this.options.defaultRenderItem;return this.isDynamic(t)&&(n=this.changeStyleByField(n,t,e)),n.isVisible()?n:null}},{key:"bDrawByLegendGroup",value:function(){var t=this.getLegendGroup();return!(!t||!t.isMerged())}},{key:"isDynamic",value:function(t){var e=!1;return t===Sm.POINT||t===Mm.POINT?(this.options.rotationField||this.options.sizeField||this.options.colorField)&&(e=!0):t!==Sm.POLYGON&&t!==Mm.POLYGON||this.options.transparencyField&&(e=!0),e}},{key:"changeStyleByField",value:function(t,e,n){if(!t||!t.symbol||!n)return t;var i=t.clone(),r=i.getSymbol();if(e===Sm.POINT||e===Mm.POINT){if(this.options.rotationField){var o=n[this.options.rotationField.toLowerCase()]||0;this.options.rotationType===V_&&(o=-1*(o-90)),r.setAngle(o)}if(this.options.sizeField){var s=n[this.options.sizeField.toLowerCase()];s&&r.setSize(s)}if(this.options.colorField){var a=n[this.options.colorField.toLowerCase()]||0,u=_m.createRGBAColor(a);a&&r.setColor(u)}}else if((e===Sm.POLYGON||e===Mm.POLYGON)&&this.options.transparencyField){var l=n[this.options.transparencyField.toLowerCase()]||0;l=255*(1-(l=parseInt(l))%100/100),r.setTranspercent(l)}return i}},{key:"getAvoidFlag",value:function(){return this.options.avoidFlag}},{key:"setAvoidFlag",value:function(t){this.options.avoidFlag=t}},{key:"isAvoidPoint",value:function(){return!!(this.options.avoidFlag&Cm.OVERLAP_ELEM_POINT)}},{key:"clone",value:function(){var t={};return this.toJson(t),Tm.readFromJson(t)}}]),Tm);function Tm(t){h(this,Tm),this.options=S_.mergeOptions(this,Nm,t),this.type=""}var km={SYMBOLIC_SIMPLE:"simple_render",SYMBOLIC_UNIQUE_VALUE:"unique_value_render",SYMBOLIC_CLASS_BREAKS:"class_breaks_render"},Rm={},Dm=(y(Am,Om),c(Am,[{key:"readJson",value:function(t){t&&d(Am.prototype.__proto__||Object.getPrototypeOf(Am.prototype),"readJson",this).call(this,t)}},{key:"toJson",value:function(t){t&&d(Am.prototype.__proto__||Object.getPrototypeOf(Am.prototype),"toJson",this).call(this,t)}},{key:"getRenderItemList",value:function(){return[this.options.defaultRenderItem]}}]),Am);function Am(t){h(this,Am);var e=_(this,(Am.__proto__||Object.getPrototypeOf(Am)).call(this));return e.options=S_.mergeOptions(e,Rm,t),e.type=km.SYMBOLIC_SIMPLE,e}var Fm={minBreak:0,maxBreak:0},Bm=(y(Gm,Im),c(Gm,[{key:"readJson",value:function(t){t&&(d(Gm.prototype.__proto__||Object.getPrototypeOf(Gm.prototype),"readJson",this).call(this,t),this.options.minBreak=t.maxinum_break,this.options.maxBreak=t.mininum_break)}},{key:"toJson",value:function(t){t&&(d(Gm.prototype.__proto__||Object.getPrototypeOf(Gm.prototype),"toJson",this).call(this,t),t.maxinum_break=this.options.minBreak,t.mininum_break=this.options.maxBreak)}},{key:"getMinBreak",value:function(){return this.options.minBreak}},{key:"setMinBreak",value:function(t){this.options.minBreak=t}},{key:"getMaxBreak",value:function(){return this.options.maxBreak}},{key:"setMaxBreak",value:function(t){this.options.maxBreak=t}},{key:"clone",value:function(){var t=S_.extend({},this.options);return t.symbol=this.options.symbol?this.options.symbol.clone():null,new Gm(t)}}]),Gm);function Gm(t){h(this,Gm);var e=_(this,(Gm.__proto__||Object.getPrototypeOf(Gm)).call(this));return e.options=S_.mergeOptions(e,Fm,t),e}var Um={uniqueValues:null},jm=(y(qm,Im),c(qm,[{key:"readJson",value:function(t){t&&(d(qm.prototype.__proto__||Object.getPrototypeOf(qm.prototype),"readJson",this).call(this,t),this.options.uniqueValues=t.unique_value_list)}},{key:"toJson",value:function(t){t&&(d(qm.prototype.__proto__||Object.getPrototypeOf(qm.prototype),"toJson",this).call(this,t),t.unique_value_list=this.options.uniqueValues)}},{key:"clone",value:function(){var t=S_.extend({},this.options);return t.symbol=this.options.symbol?this.options.symbol.clone():null,new qm(t)}},{key:"getUniqueValues",value:function(){return this.options.uniqueValues}},{key:"setUniqueValues",value:function(t){this.options.uniqueValues=t}}]),qm);function qm(t){h(this,qm);var e=_(this,(qm.__proto__||Object.getPrototypeOf(qm)).call(this));return e.options=S_.mergeOptions(e,Um,t),e}var zm={items:null},Vm=(y(Ym,Om),c(Ym,[{key:"readJson",value:function(i){if(i&&(d(Ym.prototype.__proto__||Object.getPrototypeOf(Ym.prototype),"readJson",this).call(this,i),i.render_item_list&&0<i.render_item_list.length)){var r=[];i.render_item_list.forEach(function(t){if(i.class===km.SYMBOLIC_CLASS_BREAKS){var e=new Bm;e.readJson(t),r.push(e)}else if(i.class===km.SYMBOLIC_UNIQUE_VALUE){var n=new jm;n.readJson(t),r.push(n)}}),this.setItems(r)}}},{key:"toJson",value:function(t){if(t)if(d(Ym.prototype.__proto__||Object.getPrototypeOf(Ym.prototype),"toJson",this).call(this,t),this.options.items&&0<this.options.items.length){var n=[];this.options.items.forEach(function(t){var e={};t.toJson(e),n.push(e)}),t.render_item_list=n}else t.render_item_list=null}},{key:"getItems",value:function(){return this.options.items}},{key:"setItems",value:function(t){this.options.items=t}},{key:"getItemByName",value:function(t){var e=this.options.items;if(!e||0===e.length)return null;for(var n=0;n<e.length;n++){var i=e[n];if(i&&i.getName()===t)return i}return null}},{key:"getRenderItemList",value:function(){return this.options.items}}]),Ym);function Ym(t){h(this,Ym);var e=_(this,(Ym.__proto__||Object.getPrototypeOf(Ym)).call(this));return e.options=S_.mergeOptions(e,zm,t),e}var Hm={classifyFields:null,colorBandIdx:-1},Xm=(y(Jm,Vm),c(Jm,[{key:"readJson",value:function(t){t&&(d(Jm.prototype.__proto__||Object.getPrototypeOf(Jm.prototype),"readJson",this).call(this,t),this.options.classifyFields=t.field_list,this.options.colorBandIdx=t.color_band_index)}},{key:"toJson",value:function(t){t&&(d(Jm.prototype.__proto__||Object.getPrototypeOf(Jm.prototype),"toJson",this).call(this,t),t.field_list=this.options.classifyFields,t.color_band_index=this.options.colorBandIdx)}},{key:"getClassifyFields",value:function(){return this.options.classifyFields}},{key:"setClassifyFields",value:function(t){this.options.classifyFields=t}},{key:"getUsedFields",value:function(){var t=d(Jm.prototype.__proto__||Object.getPrototypeOf(Jm.prototype),"getUsedFields",this).call(this);return t=t||[],this.options.classifyFields&&0<this.options.classifyFields.length&&(t=t.concat(this.options.classifyFields)),S_.uniqueArray(t)}},{key:"findRenderItem",value:function(t,e){var n=this.getDefaultRenderItem(),i=this.getItems();if(i&&i.length&&this.options.classifyFields&&0<this.options.classifyFields.length)for(var r=this.options.classifyFields,o=r.length,s=0;s<i.length;s++){var a=i[s];if(a){var u=a.getUniqueValues();if(u&&u.length===r.length){for(var l=!0,h=0;h<o;h++)if(e[r[h].toLowerCase()]!==u[h]){l=!1;break}if(l){n=a;break}}}}return this.isDynamic(t)&&(n=this.changeStyleByField(n,t,e)),n.isVisible()?n:null}}]),Jm);function Jm(t){h(this,Jm);var e=_(this,(Jm.__proto__||Object.getPrototypeOf(Jm)).call(this));return e.options=S_.mergeOptions(e,Hm,t),e.type=km.SYMBOLIC_UNIQUE_VALUE,e}var Wm={field:"",colorBandIdx:-1},Km=(y(Zm,Vm),c(Zm,[{key:"readJson",value:function(t){if(t&&(d(Zm.prototype.__proto__||Object.getPrototypeOf(Zm.prototype),"readJson",this).call(this,t),this.options.field=t.field,this.options.colorBandIdx=t.color_band_index,t.render_item_list&&0<t.render_item_list.length)){var n=[];t.render_item_list.forEach(function(t){var e=new Bm;e.readJson(t),n.push(e)}),this.setItems(n)}}},{key:"toJson",value:function(t){t&&(d(Zm.prototype.__proto__||Object.getPrototypeOf(Zm.prototype),"toJson",this).call(this,t),t.field=this.options.field,t.color_band_index=this.options.colorBandIdx)}},{key:"getField",value:function(){return this.options.field}},{key:"setField",value:function(t){this.options.field=t}},{key:"getUsedFields",value:function(){var t=d(Zm.prototype.__proto__||Object.getPrototypeOf(Zm.prototype),"getUsedFields",this).call(this);return t=t||[],this.options.field&&t.push(this.options.field),S_.uniqueArray(t)}},{key:"findRenderItem",value:function(t,e){var n=this.getDefaultRenderItem(),i=this.getItems();if(i&&i.length&&this.options.field){var r=e[this.options.field.toLowerCase()];if(void 0!==r){r=parseFloat(r);for(var o=0;o<i.length;o++){var s=i[o];if(s){var a=parseFloat(s.getMinBreak()),u=parseFloat(s.getMaxBreak());if(a<=r&&r<=u){n=s;break}}}}}return this.isDynamic(t)&&(n=this.changeStyleByField(n,t,e)),n.isVisible()?n:null}}]),Zm);function Zm(t){h(this,Zm);var e=_(this,(Zm.__proto__||Object.getPrototypeOf(Zm)).call(this));return e.options=S_.mergeOptions(e,Wm,t),e.type=km.SYMBOLIC_CLASS_BREAKS,e}Om.readFromJson=function(t){if(!t)return null;var e=null;switch(t.class){case km.SYMBOLIC_SIMPLE:(e=new Dm).readJson(t);break;case km.SYMBOLIC_UNIQUE_VALUE:(e=new Xm).readJson(t);break;case km.SYMBOLIC_CLASS_BREAKS:(e=new Km).readJson(t);break;default:(e=new Om).readJson(t)}return e},Om.createDefault=function(t){var e=null;switch(t){case Mm.POINT:case Sm.POINT:e=bm.createDefaultSymbol(gm.MARKER_SYMBOL);break;case Mm.LINE:case Sm.LINE:e=bm.createDefaultSymbol(gm.LINE_SYMBOL);break;case Mm.POLYGON:case Sm.POLYGON:e=bm.createDefaultSymbol(gm.FILL_SYMBOL)}var n=new Im({symbol:e});return new Dm({defaultRenderItem:n})};var Qm="",$m="simple_render_text_style",tv="multi_render_text_style",ev={priorityField:"",enable:!1,isRelate:!1,avoidFlag:Cm.OVERLAP_ELEM_POINT|Cm.OVERLAP_ELEM_LABEL,ignoreFieldValues:null,maxScale:0,minScale:0,labelWeight:0,useScale:!1},nv=(c(iv,[{key:"mergeOptions",value:function(){this.options||(this.options={}),S_.extend.apply(S_,[this.options].concat(Array.prototype.slice.call(arguments)))}}]),c(iv,[{key:"readJson",value:function(t){t&&(this.options.priorityField=t.priority_field,this.options.enable=t.enable,this.options.isRelate=t.has_relate,this.options.avoidFlag=t.avoid_flag,this.options.ignoreFieldValues=t.excluded_label_list,this.options.maxScale=t.max_scale||0,this.options.minScale=t.min_scale||0,this.options.labelWeight=t.label_weight||0,(this.options.minScale||this.options.maxScale)&&(this.options.useScale=!0))}},{key:"toJson",value:function(t){t&&(t.class=this.type,t.priority_field=this.options.priorityField,t.enable=this.options.enable,t.has_relate=this.options.isRelate,t.avoid_flag=this.options.avoidFlag,t.excluded_label_list=this.options.ignoreFieldValues,t.max_scale=this.options.maxScale||0,t.min_scale=this.options.minScale||0,t.label_weight=this.options.labelWeight||0,this.options.useScale||(t.max_scale=0,t.min_scale=0))}},{key:"getPriorityField",value:function(){return this.options.priorityField}},{key:"setPriorityField",value:function(t){this.options.priorityField=t}},{key:"isEnable",value:function(){return this.options.enable}},{key:"setEnable",value:function(t){this.options.enable=t}},{key:"isRelate",value:function(){return this.options.isRelate}},{key:"setIsRelate",value:function(t){this.options.isRelate=t}},{key:"getAvoidFlag",value:function(){return this.options.avoidFlag}},{key:"setAvoidFlag",value:function(t){this.options.avoidFlag=t}},{key:"getIgnoreFieldValues",value:function(){return this.options.ignoreFieldValues}},{key:"setIgnoreFieldValues",value:function(t){this.options.ignoreFieldValues=t}},{key:"getMaxScale",value:function(){return this.options.maxScale}},{key:"setMaxScale",value:function(t){this.options.maxScale=t}},{key:"getMinScale",value:function(){return this.options.minScale}},{key:"setMinScale",value:function(t){this.options.minScale=t}},{key:"getLabelWeight",value:function(){return this.options.labelWeight}},{key:"setLabelWeight",value:function(t){this.options.labelWeight=t}},{key:"getUsedFields",value:function(){var e=[];return this.options.priorityField&&e.push(this.options.priorityField),this.options.ignoreFieldValues&&0<this.options.ignoreFieldValues.length&&this.options.ignoreFieldValues.forEach(function(t){t&&t.field_name&&e.push(t.field_name)}),S_.uniqueArray(e)}},{key:"isQuery",value:function(t){if(!this.isEnable())return!1;if(void 0===t)return!0;if(this._isQuery=!1,!this.options.useScale)return this._isQuery=!0;if(0<=t){t=1/t;var e=this.options.minScale,n=this.options.maxScale;if(0===n&&0===e)return this._isQuery=!0;if(0===n&&0<e&&1/e<=t)return this._isQuery=!0;if(0<n&&0===e&&t<=1/n)return this._isQuery=!0;if(0<n&&0<e&&t<=1/n&&1/e<=t)return this._isQuery=!0}return!1}},{key:"isSortByPriority",value:function(){return!!this.options.priorityField}},{key:"isIgnore",value:function(t){if(t=t||{},this.options.ignoreFieldValues&&0<this.options.ignoreFieldValues.length)for(var e=this.options.ignoreFieldValues,n=0;n<e.length;n++){var i=e[n],r=i.field_name,o=i.value_list,s=t[r];if(-1!==o.indexOf(s))return!0}return!1}},{key:"useScale",value:function(){return this.options.useScale}},{key:"setUseScale",value:function(t){this.options.useScale=t}},{key:"clone",value:function(){var t={};return this.toJson(t),iv.readFromJson(t)}}]),iv);function iv(t){h(this,iv),this.mergeOptions(ev,t),this.type=Qm,this._isQuery=!1}var rv=0,ov=1,sv="",av="marker_label_position",uv="line_label_position",lv="fill_label_position",hv={AROUND_POINT:"around_point",ON_POINT_TOP:"on_point_top",SPECIFIED_ANGLE:"specified_angle",ANGLE_FIELD:"angle_field"},cv=0,pv=1,fv=2,dv=3,gv=4,yv=5,_v=6,mv=7,vv=0,bv=1,xv=2,Ev=3,Iv=4,Lv=1,wv=2,Sv=4,Mv=0,Cv={duplicateLabels:ov},Pv=(c(Nv,[{key:"mergeOptions",value:function(){this.options||(this.options={}),S_.extend.apply(S_,[this.options].concat(Array.prototype.slice.call(arguments)))}}]),c(Nv,[{key:"readJson",value:function(t){t&&(this.options.duplicateLabels=t.duplicate_labels)}},{key:"toJson",value:function(t){t&&(t.class=this.type,t.duplicate_labels=this.options.duplicateLabels)}},{key:"getType",value:function(){return this.type}},{key:"getDuplicateLabels",value:function(){return this.options.duplicateLabels}},{key:"setDuplicateLabels",value:function(t){this.options.duplicateLabels=t}},{key:"clone",value:function(){var t={};return this.toJson(t),Nv.createFromJson(t)}}]),Nv);function Nv(t){h(this,Nv),this.options=this.mergeOptions(Cv,t),this.type=sv}function Ov(t,e,n,i){h(this,Ov),this.type=t,this.value=e,this.line=n,this.column=i}var Tv={blockOpen:"(",blockClose:")",escapeOpen:"'",escapeClose:"'",sentinels:["and","or","&&","||","not"],operators:["=","<",">","!"],textEscape:["'"],compare_operator:{"=":function(t,e){return t==e},"<>":function(t,e){return t!=e},"!=":function(t,e){return t!=e},">":function(t,e){return e<t},">=":function(t,e){return e<=t},"<":function(t,e){return t<e},"<=":function(t,e){return t<=e},or:function(t,e){return t||e},and:function(t,e){return t&&e},is:function(t,e){return t==e},like:function(t,e){return!!t&&-1<t.indexOf(e)},not:function(t){return!t}},getFilterFields:function(t){if(!t)return null;var e=[];return function t(e,n){if(e&&0!=e.length)for(var i=e.length,r=0;r<i;r++){var o=e[r];"array"==(Array.isArray(o)?"array":void 0===o?"undefined":g(o))?t(o,n):"expression"==o.type&&o.key&&n.push(o.key)}}(this.parse(t),e),e},compareFilter:function(t,e){if(!t)return!0;if(!e)return!1;var n=this.parse(t);return!(!n||0==n.length)&&this.compareItems(n,e)},compareItems:function(t,e){if(!t||!e||0==t.length)return!1;for(var n=t.length,i=!0,r="",o=!1,s=function(t){o&&(t=!t,o=!1),i="and"==r.toLowerCase()?i&&t:"or"==r.toLowerCase()&&i||t},a=0;a<n;a++){var u=t[a],l="";"array"==(Array.isArray(u)?"array":void 0===u?"undefined":g(u))?s(this.compareItems(u,e)):"expression"==u.type?s(this.compareItem(u,e)):"conjunction"==u.type&&(l="not"==u.value.toLowerCase()?(o=!0,r):u.value),r=l}return i},compareItem:function(t,e){if(!t||!e||null==e[t.key.toLowerCase()]&&null==e[t.key.toUpperCase()])return!1;var n=null==e[t.key.toLowerCase()]?e[t.key.toUpperCase()]:e[t.key.toLowerCase()],i=t.value,r=t.operator;return"<"==r?n<i:">"==r?i<n:"="==r?n==i:"<="==r?n<=i:">="==r?i<=n:"<>"==r&&n!=i},parse:function(t){var a=t;if(-1<t.indexOf(" in ")){var e=/(.*?)in\s+\((.*?)\)\s+(and|or)|(.*?)in\s+\((.*?)\)$/g,n="",i=t.length;for(a="";n=e.exec(t);){var r=[],o=[],s="";e.lastIndex!=i?(r=n[1],o=n[2].split(","),s=n[3]):e.lastIndex==i&&(r=n[4],o=n[5].split(","));var u=o.length;a+="(";var l=r.split(":");o.forEach(function(t,e,n){var i=(t=t.replace(/(^\s*\')|(\'\s*$)/g,"")).split(":"),r=i.length,o="";if(e<u-1){for(var s=0;s<r;s++)o+=l[s]+" = "+i[s]+" and ";o=o.slice(0,-4),a+="("+o+") or "}else{for(s=0;s<r;s++)o+=l[s]+" = "+i[s]+" and ";o=o.slice(0,-4),a+="("+o+")"}}),a+=")",""!=s&&(a+=" "+s+" ")}}return this.parse_where(a)},array_contains:function(t,e){return-1!=t.indexOf(e)},parse_where:function(t){var e=this.parse_blocks(t),n=this.parse_compound_phrases(e,[]),i=this,r=this;return n.map(function t(e){return Array.isArray(e)?e.map(t):r.array_contains(i.sentinels,e.toLowerCase())?{type:"conjunction",value:e}:i.parse_discriminant(e)},this)},parse_discriminant:function(t){for(var e,n="",i="",r="",o=!1,s=0;s<t.length;s++)e=t[s],o&&e===o?o=!1:o||!this.array_contains(this.textEscape,e)?this.array_contains(this.operators,e)?i+=e:""!==i?r+=e:n+=e:o=e;return{type:"expression",key:n,operator:i,value:r}},parse_blocks:function(t){for(var e,n=[],i=[],r=!1,o="",s=n,a=0;a<t.length;a++)if(e=t[a],r)o+=e,e===this.escapeClose&&(r=!1);else if(e!==this.escapeOpen)if(e!==this.blockOpen)e!==this.blockClose?o+=e:(""!==o.trim()&&n.push(o),n=i.pop(),o="");else{""!==o.trim()&&n.push(o);var u=[];n.push(u),i.push(n),n=u,o=""}else o+=e,r=!0;return""!==o.trim()&&n.push(o),s},parse_compound_phrases:function(t,i){var r=this;return t.forEach(function(t){var e=Array.isArray(t)?"array":void 0===t?"undefined":g(t);if("array"==e){var n=r.parse_compound_phrases(t,[]);i.push(n)}else"string"==e&&(i=i.concat(r.parse_compound_phrase(t)).filter(function(t){return""!==t}))}),i},parse_compound_phrase:function(t){for(var e,n=!1,i="",r="",o=[""],s=0;s<t.length;s++)e=t[s],n?(o[o.length-1]+=r+e,r="",e===i&&(n=!1)):(this.array_contains(this.textEscape,e)&&(n=!0,i=e)," "!=e?(r+=e,this.array_contains(this.sentinels,r.toLowerCase())&&(o.push(r),o.push(""),r="")):(o[o.length-1]+=r,r=""));return""!=r&&(o[o.length-1]+=r),""===o[o.length-1]&&o.pop(),o},filterByClause:function(t,e){if(!e)return!0;var n=this.parse(e);return this.filterByParsedClause(t,n)},filterByParsedClause:function(t,e){if(!e)return!1;for(var n=e.length,i=0;i<n;i++){if(d=e[i]){var r=null;if(Array.isArray(d))r=this.filterByParsedClause(t,d);else{if(!(a=d.type))continue;if("expression"===a){var o=d.key;if(!o)continue;o=o.toLowerCase();var s=d.operator,a=d.type,u=d.value,l=t[o],h=this.compare_operator[s];h&&(r=h(l,u),d.result=r)}}}}for(var c=0;c<n;c++){if(d=e[c])if(a=d.type)if("conjunction"===a)if("not"===(g=d.value.toLowerCase()))(y=e[c+1]).result=this.compare_operator[g](y.result)}for(var p=null,f=0;f<n;f++){var d;if(d=e[f])if(a=d.type)if("expression"===a&&null===p)p=d.result;else if("conjunction"===a){var g;if("not"===(g=d.value.toLowerCase()))continue;for(var y=e[++f],_=!0;f<n;)"expression"===y.type&&(_=y.result),y=e[++f];p=this.compare_operator[g](p,_)}}return p}};Ov.EOS="EOS",Ov.DOT="DOT",Ov.GT="GT",Ov.GE="GE",Ov.LE="LE",Ov.LT="LT",Ov.ASSIGN="ASSIGN",Ov.EQ="EQ",Ov.ELLIPSES="ELLIPSES",Ov.CONCAT="CONCAT",Ov.NUMBER="NUMBER",Ov.KEYWORD="KEYWORD",Ov.IDENTIFIER="IDENTIFIER",Ov.STRING="STRING",Ov.SEMICOLON="SEMICOLON",Ov.PLUS="PLUS",Ov.MINUS="MINUS",Ov.MUL="MUL",Ov.DIV="DIV",Ov.MOD="MOD",Ov.MOD="POW",Ov.COMMA="COMMA",Ov.LPATTERN="LEFT PATTERN",Ov.RPATTERN="RIGHT PATTERN",Ov.LBRACKET="LEFT BRACKET",Ov.RBRACKET="RIGHT BRACKET",Ov.LBRACE="LEFT BRACE",Ov.RBRACE="RIGHT BRACE",Ov.COMMENT="COMMENT",Ov.HASH="#";var kv=(c(Rv,[{key:"is_digit_or_letter",value:function(t){return this.is_digit(t)||this.is_letter(t)}},{key:"is_digit",value:function(t){return!![1,1,1,1,1,1,1,1,1,1][t]}},{key:"is_hex",value:function(t){return/^[0-9a-fA-F]$/.test(t)}},{key:"is_letter",value:function(t){return/^[a-zA-Z_\u4e00-\u9fa5]$/.test(t)}},{key:"lookahead",value:function(t,e){return e?(this.pos+=t,this.source[this.pos]):this.source[this.pos+t]}},{key:"eat",value:function(t){this.pos+=t}},{key:"croak",value:function(){throw new Error("lexer error at "+this.line+":"+this.column)}},{key:"token",value:function(t,e,n){return this.pos+=t,this.column+=t,new Ov(e,n,this.line,this.column)}},{key:"scan_integer",value:function(){var t=void 0;if(t=this.lookahead(0),!is_digit(t))return this.croak();for(var e=0;;){if(!is_digit(t))return e;e=10*e+parseInt(t,10),t=this.lookahead(1,!0)}}},{key:"scan_longstring",value:function(){var t=[];"["!=this.lookahead(0)&&this.croak();var e=this.lookahead(1,!0),n=0;if("="==e)for(n++;;){if("="!=(e=this.lookahead(1,!0))){if(e="[")break;return this.croak()}n++}else if("["!=e)return this.croak();for(;;){if("]"==(e=this.lookahead(1,!0))){var i=void 0;for(this.eat(1),i=0;i<n;i++)if("="!=(e=this.lookahead(i))&&null==e)return this.croak();if(i==n){if("]"==(e=this.lookahead(n)))return this.lookahead(2+n,!0),t.join("");if(null==e)return this.croak()}}else if(null==e)return this.croak();t.push(e)}}},{key:"scan",value:function(){for(var t=void 0,e=void 0,n=void 0,i=void 0,r=void 0,o=void 0,s=void 0;;)switch(r=this.lookahead(0),o=this.lookahead(1),s=this.lookahead(2),r){case void 0:return this.token(0,Ov.EOS,Ov.EOS);case"\f":case"\r":case" ":case"\t":this.column++,this.lookahead(1,!0);continue;case"\n":this.line++,this.column=0,this.lookahead(1,!0);continue;case";":return this.token(1,Ov.SEMICOLON,";");case"+":return this.token(1,Ov.PLUS,"+");case"-":if("-"!=o)return this.token(1,Ov.MINUS,"-");if("["!=s)for(o=this.lookahead(1,!0),i=[];;){if("\n"==(o=this.lookahead(1,!0))||null==o)return this.column++,this.token(0,Ov.COMMENT,i.join(""));i.push(o)}return this.lookahead(2,!0),i=this.scan_longstring(),this.token(0,Ov.COMMENT,i);case"*":return this.token(1,Ov.MUL,"*");case"/":return this.token(1,Ov.DIV,"/");case"%":return this.token(1,Ov.MOD,"%");case"^":return this.token(1,Ov.POW,"%");case",":return this.token(1,Ov.COMMA,",");case"(":return this.token(1,Ov.LPATTERN,"(");case")":return this.token(1,Ov.RPATTERN,")");case"[":return"["==o||"="==o?(n=this.scan_longstring(),this.token(0,Ov.STRING,n)):this.token(1,Ov.LBRACKET,"[");case"]":return this.token(1,Ov.RBRACKET,"]");case"{":return this.token(1,Ov.LBRACE,"{");case"}":return this.token(1,Ov.RBRACE,"}");case"=":return"="==o?this.token(2,Ov.EQ,"=="):this.token(1,Ov.ASSIGN,"=");case">":return"="==o?this.token(2,Ov.GE,">="):this.token(1,Ov.GT,">");case"<":return"="==o?this.token(2,Ov.LE,"<="):this.token(1,Ov.LT,"<");case"~":return"="==o?this.token(2,Ov.NE,"~="):this.croak();case".":return"."==o?"."==s?this.token(3,Ov.ELLIPSES,"..."):this.token(2,Ov.CONCAT,"+"):this.token(1,Ov.DOT,".");case"'":for(n=[];;){if((o=this.lookahead(1,!0))==r)return this.token(1,Ov.STRING,n.join(""));if(null==o)return this.croak();n.push(o)}case"#":return this.token(1,Ov.HASH,"#");case'"':for(n=[];;){if((o=this.lookahead(1,!0))==r)return this.token(1,Ov.STRING,n.join(""));if(null==o)return this.croak();n.push(o)}default:if(this.is_digit(r)){var a=0;if("x"==o||"X"==o){if(this.eat(1),o=this.lookahead(1),!this.is_hex(o))return this.croak();for(;;){if(o=this.lookahead(1,!0),!this.is_hex(o))return this.token(0,Ov.NUMBER,a);a=16*a+parseInt(o,16)}}for(o=r;a=10*a+parseInt(o,10),o=this.lookahead(1,!0),this.is_digit(o););if("."==o)for(e=1;o=this.lookahead(1,!0),this.is_digit(o);)a=(e*=.1)*parseInt(o,10)+a;if("E"==o||"e"==o){var u=(e="-"==(o=this.lookahead(1,!0))?(this.eat(1),-1):("+"==o&&this.eat(1),1))*this.scan_integer();a*=Math.pow(10,u)}return this.token(0,Ov.NUMBER,a)}if(this.is_letter(r))for(t=[r];;){if(o=this.lookahead(1,!0),!this.is_digit_or_letter(o))return t=t.join(""),this.keywords[t]?this.token(0,Ov.KEYWORD,t):this.token(0,Ov.IDENTIFIER,t);if(null==o)return this.croak();t.push(o)}return this.croak()}}}]),Rv);function Rv(t){h(this,Rv),this.source=t,this.size=t.length,this.pos=0,this.column=1,this.line=1,this.keywords={and:1,break:1,do:1,else:1,elseif:1,end:1,false:1,for:1,function:1,if:1,in:1,local:1,nil:1,not:1,or:1,repeat:1,return:1,then:1,true:1,until:1,while:1}}var Dv=(c(Av,[{key:"extend",value:function(){return new Av(this)}},{key:"lookup",value:function(t){for(var e=this;e;){if(e.vars.hasOwnProperty(t))return e;e=e.parent}return null}},{key:"get",value:function(t){var e=this.lookup(t);if(e)return e.vars[t];throw new Error("Undefined variable "+t)}},{key:"set",value:function(t,e){var n=this.lookup(t);if(!n)throw new Error("Undefined variable "+t);n.vars[t]=e}},{key:"def",value:function(t,e){return this.vars[t]=e}}]),Av);function Av(t){h(this,Av),this.vars={},this.parent=t}var Fv=(c(Bv,[{key:"to_js",value:function(){return v(this.ast);function m(t){return""+function(t){switch(t){case"#-":return"-";default:return t}}(t.op)+v(t.argument)}function v(t){switch(t.type){case"Program":return""+v(t.body);case"Chunk":return t.body.map(v).join("\n");case"LocalStatement":return(_=t).variables.map(function(t,e){return"let "+t.name+" = "+v(_.init[e])}).join("\n");case"Literal":return y=t,JSON.stringify(y.value);case"Identifier":return t.name;case"ExpressionStatement":return v(t.expression);case"CallExpression":return v((g=t).callee)+"("+g.params.map(function(t){return v(t)}).join(",")+")";case"BinaryExpression":return"("+v((d=t).left)+" "+d.op+" "+v(d.right)+")";case"UnaryExpression":return m(t);case"DoStatement":return"\n{\n\n"+v(t.body)+"\n\n}\n";case"BreakStatement":return"break";case"TableExpression":return f=0,"{"+t.fields.map(function(t){return"Recfield"==t.type?'"'+v(t.key)+'": '+v(t.value):'"'+f+++'": '+v(t.value)}).join(",")+"}";case"MemberExpression":return v((p=t).object)+"."+v(p.property);case"AssignExpression":return(c=t).left.map(function(t,e){return""+v(t)+c.op+v(c.right[e])}).join("\n");case"IfStatement":return l=(u=t).elseif.map(function(t){return"else if ("+v(t.cond)+") {\n                    "+v(t.body)+"\n                }"}).join("\n"),h="",u.else&&(h="else {\n                    "+v(u.else)+"\n                }"),"\nif ("+v(u.cond)+") {\n    "+v(u.body)+"\n}\n"+l+"\n"+h;case"FornumStatement":return"\n            for (let "+v((a=t).id)+" = "+v(a.begin)+"; "+v(a.id)+" < "+v(a.end)+"; "+v(a.id)+" += "+v(a.step)+") {\n                "+v(a.body)+"\n            }\n";case"ForlistStatement":return s=(o=t).left.map(function(t,e){return"let "+v(t)+"=value["+e+"]"}).join("\n"),"\n            for (const iterator = "+v(o.right)+";;) {\n                let value = iterator();\n                if (value[0] == undefined) break\n\n                "+s+"\n                "+v(o.body)+"\n            }";case"WhileStatement":return"while("+v((r=t).cond)+") {\n                "+v(r.body)+"\n            }";case"RepeatStatement":return"\n                for (;;) {\n                    "+v((i=t).body)+"\n                    if ("+v(i.cond)+") {\n                        break\n                    }\n                }\n            ";case"FunctionDeclaration":return n=(e=t).params.map(function(t){return v(t)}).join(","),"function "+v(e.id)+"("+n+") {\n                "+v(e.body)+"\n            }";case"ReturnStatement":return"return "+t.params.map(function(t){return v(t)}).join(",");default:throw new Error("Dunno how to generate for "+JSON.stringify(t))}var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y,_}}}]),Bv);function Bv(t){h(this,Bv),this.ast=t}var Gv={or:function(t,e){return t||e},and:function(t,e){return t&&e},"<":function(t,e){return t<e},">":function(t,e){return e<t},"<=":function(t,e){return t<=e},">=":function(t,e){return e<=t},"==":function(t,e){return t==e},"~=":function(t,e){return t!=e},"..":function(t,e){return""+t+e},"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"^":function(t){return math.pow(t,right)},"#-":function(t){return-t},not:function(t){return!t},"#":function(t){if("string"!=typeof t)throw new Error("attempt to get length of a nonstring value");return t.length}},Uv=(c(jv,[{key:"interprete",value:function(){return this.evaluate(this.ast,this.env)}},{key:"evaluate",value:function(t,e){switch(t.type){case"Program":return this.evaluate(t.body,e);case"Chunk":return this.evaluate_chunk(t,e);case"Identifier":return this.evaluate_identifier(t,e);case"Literal":return this.evaluate_literal(t,e);case"AssignExpression":return this.evaluate_assign_expression(t,e);case"LocalStatement":return this.evaluate_local_stat(t,e);case"ExpressionStatement":return this.evaluate_expression_stat(t,e);case"CallExpression":return this.evaluate_call_expression(t,e);case"UnaryExpression":return this.evaluate_unary_expression(t,e);case"BinaryExpression":return this.evaluate_binary_expression(t,e);case"DoStatement":return this.evaluate_do_statment(t,e);case"BreakStatement":return this.evaluate_break_statment(t,e);case"ReturnStatement":return this.evaluate_return_statment(t,e);case"FunctionDeclaration":return this.evaluate_function_declaration(t,e);case"TableExpression":return this.evaluate_table_expression(t,e);case"MemberExpression":return this.evaluate_member_expression(t,e);case"IfStatement":return this.evaluate_if_statement(t,e);case"FornumStatement":return this.evaluate_fornum_statement(t,e);case"ForlistStatement":return this.evaluate_forlist_statement(t,e);case"WhileStatement":return this.evaluate_while_statement(t,e);case"RepeatStatement":return this.evaluate_repeat_statement(t,e);default:throw new Error("unknow ast node with "+t.type)}}},{key:"evaluate_program",value:function(t,e){return this.evaluate(t.body,e)}},{key:"evaluate_chunk",value:function(t,e){for(var n=void 0,i=0;i<t.body.length;i++)n=this.evaluate(t.body[i],e);return n}},{key:"evaluate_table_expression",value:function(t,r){var o={},s=this,a=1;return t.fields.map(function(t){if("Recfield"==t.type){var e=t.key.name,n=s.evaluate(t.value,r);o[e]=n}else{var i=s.evaluate(t.value,r);o[a++]=i}}),o}},{key:"evaluate_literal",value:function(t){return t.value}},{key:"evaluate_assign_expression",value:function(t,e){for(var n=0;n<t.left.length;n++){var i=t.left[n];"Identifier"==i.type?e.set(i.name,this.evaluate(t.right[n],e)):"MemberExpression"==i.type&&(e.get(i.object.name)[i.property.name]=this.evaluate(t.right[n],e))}}},{key:"evaluate_do_statment",value:function(t,e){return this.evaluate(t.body,e.extend())}},{key:"evaluate_break_statment",value:function(){}},{key:"evaluate_return_statment",value:function(t,e){var n=this,i=t.params.map(function(t){return n.evaluate(t,e)});return i[i.length-1]}},{key:"evaluate_binary_expression",value:function(t,e){return(0,Gv[t.op])(this.evaluate(t.left,e),this.evaluate(t.right,e))}},{key:"evaluate_unary_expression",value:function(t,e){return(0,Gv[t.op])(this.evaluate(t.argument,e))}},{key:"evaluate_fornum_statement",value:function(t,e){var n=e.extend(),i=this.evaluate(t.begin,n),r=this.evaluate(t.end,n),o=this.evaluate(t.step,n);n.def(t.id.name,i);for(var s=i;s<r;s+=o)n.set(t.id.name,s),this.evaluate(t.body,n)}},{key:"evaluate_forlist_statement",value:function(t,e){for(var n=e.extend(),i=t.left,r=this.evaluate(t.right,n),o=0;o<i.length;o++)n.def(i[o].name,null);for(;;){var s=r();if(s.done)break;for(var a=0;a<i.length;a++)n.set(i[a].name,s.value[a]);this.evaluate(t.body,n)}}},{key:"evaluate_while_statement",value:function(t,e){for(var n=e.extend();this.evaluate(t.cond,n);)this.evaluate(t.body,n)}},{key:"evaluate_repeat_statement",value:function(t,e){for(var n=e.extend();this.evaluate(t.body,n),1!=this.evaluate(t.cond,n););}},{key:"evaluate_identifier",value:function(t,e){return e.get(t.name)}},{key:"evaluate_call_expression",value:function(t,e){var n=this.evaluate(t.callee,e),i=this;return n.apply(null,t.params.map(function(t){return i.evaluate(t,e)}))}},{key:"evaluate_if_statement",value:function(t,e){if(this.evaluate(t.cond,e))return this.evaluate(t.body,e),!0;for(var n=0;n<t.elseif.length;n++){var i=t.elseif[n];if(this.evaluate(i,e))return!0}return t.else&&this.evaluate(t.else,e),!1}},{key:"evaluate_member_expression",value:function(t,e){var n=void 0,i=void 0;return"."==t.sep&&(n=e.get(t.object.name),i=t.property.name),n[i]}},{key:"evaluate_expression_stat",value:function(t,e){return this.evaluate(t.expression,e)}},{key:"evaluate_local_stat",value:function(t,e){for(var n=t.variables,i=t.init,r=0;r<n.length;r++){var o=n[r],s=i[r];e.def(o.name,this.evaluate(s,e))}}},{key:"evaluate_function_declaration",value:function(s,a){var u=this;function t(){for(var t=s.params,e=a.extend(),n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];for(var o=0;o<t.length;++o)e.def(t[o].name,i[o]);return u.evaluate(s.body,e)}var e=void 0;return"Identifier"==s.id.type&&(e=s.id.name),a.def(e,t),t}}]),jv);function jv(t,e){h(this,jv),this.ast=t,this.env=e}var qv=(c(zv,[{key:"program",value:function(t){return this.visitor({body:t,type:"Program"})}},{key:"chunk",value:function(t){return this.visitor({body:t,type:"Chunk"})}},{key:"do_stat",value:function(t){return this.visitor({body:t,type:"DoStatement"})}},{key:"break_stat",value:function(){return this.visitor({type:"BreakStatement"})}},{key:"return_stat",value:function(t){return this.visitor({params:t,type:"ReturnStatement"})}},{key:"expr_stat",value:function(t){return this.visitor({expression:t,type:"ExpressionStatement"})}},{key:"func_stat",value:function(t,e,n){return this.visitor({id:t,params:e,body:n,type:"FunctionDeclaration"})}},{key:"local_stat",value:function(t,e){return this.visitor({init:e,variables:t,type:"LocalStatement"})}},{key:"if_stat",value:function(t,e,n,i){return this.visitor({cond:t,body:e,elseif:n,else:i,type:"IfStatement"})}},{key:"fornum_stat",value:function(t,e,n,i,r){return this.visitor({id:t,begin:e,end:n,step:i,body:r,type:"FornumStatement"})}},{key:"forlist_stat",value:function(t,e,n,i){return this.visitor({id:t,left:e,right:n,body:i,type:"ForlistStatement"})}},{key:"while_stat",value:function(t,e){return this.visitor({cond:t,body:e,type:"WhileStatement"})}},{key:"repeat_stat",value:function(t,e){return this.visitor({cond:t,body:e,type:"RepeatStatement"})}},{key:"identifier",value:function(t){return this.visitor({name:t,type:"Identifier"})}},{key:"literal",value:function(t,e){return this.visitor({value:t,raw:e,type:"Literal"})}},{key:"unary_expr",value:function(t,e){return this.visitor({op:t,argument:e,type:"UnaryExpression"})}},{key:"binary_expr",value:function(t,e,n){return this.visitor({op:t,left:e,right:n,type:"BinaryExpression"})}},{key:"call_expr",value:function(t,e){return this.visitor({callee:t,params:e,type:"CallExpression"})}},{key:"member_expr",value:function(t,e,n){return this.visitor({object:t,sep:e,property:n,type:"MemberExpression"})}},{key:"assign_expr",value:function(t,e,n){return this.visitor({op:t,left:e,right:n,type:"AssignExpression"})}},{key:"table_expr",value:function(t){return this.visitor({fields:t,type:"TableExpression"})}},{key:"recfield",value:function(t,e){return this.visitor({key:t,value:e,type:"Recfield"})}},{key:"listfield",value:function(t){return this.visitor({value:t,type:"Listfield"})}},{key:"comment",value:function(t){return this.visitor({value:t,type:"Comment"})}}]),zv);function zv(e){h(this,zv),this.visitor=function(t){return e&&e(t),t}}var Vv={or:{prec:1,left:1,binary:1},and:{prec:2,left:1,binary:1},"<":{prec:3,left:1,binary:1},">":{prec:3,left:1,binary:1},"<=":{prec:3,left:1,binary:1},">=":{prec:3,left:1,binary:1},"==":{prec:3,left:1,binary:1},"~=":{prec:3,left:1,binary:1},"..":{prec:4,left:0,binary:1},"+":{prec:5,left:1,binary:1},"-":{prec:5,left:1,binary:1},"*":{prec:6,left:1,binary:1},"/":{prec:6,left:1,binary:1},"%":{prec:4,left:1,binary:1},not:{prec:7,left:1,binary:0},"#":{prec:7,left:1,binary:0},"u-":{prec:7,left:1,binary:0},"^":{prec:8,left:0,binary:1}},Yv=(c(Hv,[{key:"croak",value:function(t){throw new SyntaxError(t)}},{key:"next",value:function(){var t=this.cur_token;return this.cur_token=this.lexer.scan(),t}},{key:"match",value:function(t,e){if(t){if(e&&this.cur_token.type==t&&this.cur_token.val==e){var n=this.cur_token;return this.next(),n}if(this.cur_token.type==t){var i=this.cur_token;return this.next(),i}}this.croak()}},{key:"consume",value:function(t,e){if(t){if(e&&this.cur_token.type==t&&this.cur_token.value==e){var n=this.cur_token;return this.next(),n}if(this.cur_token.type==t){var i=this.cur_token;return this.next(),i}}return this.cur_token}},{key:"anchor",value:function(){this.location.push({line:this.cur_token.line,column:this.cur_token.column})}},{key:"parse",value:function(){return this.next(),this.anchor(),this.ast.program(this.parse_chunk())}},{key:"parse_chunk",value:function(){for(var t=[];!this.is_block_follow();){if("return"==this.cur_token.value){t.push(this.parse_stat()),this.consume(Ov.SEMICOLON);break}var e=this.parse_stat();this.consume(Ov.SEMICOLON),t.push(e)}return this.ast.chunk(t)}},{key:"parse_block",value:function(){return this.parse_chunk()}},{key:"parse_stat",value:function(){switch(this.cur_token.value){case"do":return this.parse_do_stat();case"break":return this.parse_break_stat();case"return":return this.parse_return_stat();case"function":return this.parse_func_stat();case"local":return this.parse_local_stat();case"if":return this.parse_if_stat();case"for":return this.parse_for_stat();case"while":return this.parse_while_stat();case"repeat":return this.parse_repeat_stat();default:return this.parse_expr_stat()}}},{key:"parse_do_stat",value:function(){this.match(Ov.KEYWORD,"do");var t=this.ast.do_stat(this.parse_block());return this.match(Ov.KEYWORD,"end"),t}},{key:"parse_break_stat",value:function(){return this.match(Ov.KEYWORD,"break"),this.ast.break_stat()}},{key:"parse_return_stat",value:function(){this.next();var t=this.parse_explist1();return this.ast.return_stat(t)}},{key:"parse_func_stat",value:function(){this.match(Ov.KEYWORD,"function");var t=this.parse_funcname();this.match(Ov.LPATTERN);var e=this.parse_parlist();this.match(Ov.RPATTERN);var n=this.parse_block();return this.match(Ov.KEYWORD,"end"),this.ast.func_stat(t,e,n)}},{key:"parse_parlist",value:function(){var t=[];if(this.is_param())for(t.push(this.parse_param());","==this.cur_token.value;)this.next(),t.push(this.parse_param());return t}},{key:"parse_param",value:function(){return this.parse_name()}},{key:"parse_funcname",value:function(){for(var t=this.parse_name();"."==this.cur_token.value;)this.next(),t=this.ast.member_expr(t,".",this.parse_name());return":"==this.cur_token.value&&(this.next(),t=this.ast.member_expr(t,":",this.parse_name())),t}},{key:"parse_local_stat",value:function(){if(this.match(Ov.KEYWORD,"local"),"function"==this.cur_token.value){this.next();var t=this.parse_name();this.match(Ov.LPATTERN);var e=this.parse_parlist();this.match(Ov.RPATTERN);var n=this.parse_block();return this.match(Ov.KEYWORD,"end"),this.ast.call_expr(t,e,n)}var i=[],r=[];for(i.push(this.parse_name());","==this.cur_token.value;)this.next(),i.push(this.parse_name());return"="==this.cur_token.value&&(this.next(),r=this.parse_explist1()),this.ast.local_stat(i,r)}},{key:"parse_if_stat",value:function(){this.match(Ov.KEYWORD,"if");var t=this.parse_cond();this.match(Ov.KEYWORD,"then");for(var e=this.parse_block(),n=[],i=null;"elseif"==this.cur_token.value;){this.next();var r=this.parse_cond();this.match(Ov.KEYWORD,"then");var o=this.parse_block();n.push(this.ast.if_stat(r,o,[]))}return"else"==this.cur_token.value&&(this.next(),i=this.parse_block()),this.match(Ov.KEYWORD,"end"),this.ast.if_stat(t,e,n,i)}},{key:"parse_cond",value:function(){return this.parse_expr()}},{key:"parse_for_stat",value:function(){this.match(Ov.KEYWORD,"for");var t=this.parse_name();if("="==this.cur_token.value){this.next();var e=this.parse_exp1();this.match(Ov.COMMA,",");var n=this.parse_exp1(),i=this.ast.literal(1);","==this.cur_token.value&&(this.next(),i=this.parse_exp1());var r=this.parse_forbody();return this.match(Ov.KEYWORD,"end"),this.ast.fornum_stat(t,e,n,i,r)}for(var o=[t];","==this.cur_token.value;)this.next(),o.push(this.parse_name());this.match(Ov.KEYWORD,"in");var s=this.parse_exp1(),a=this.parse_forbody();return this.match(Ov.KEYWORD,"end"),this.ast.forlist_stat(t,o,s,a)}},{key:"parse_forbody",value:function(){return this.match(Ov.KEYWORD,"do"),this.parse_block()}},{key:"parse_while_stat",value:function(){this.match(Ov.KEYWORD,"while");var t=this.parse_cond();this.match(Ov.KEYWORD,"do");var e=this.parse_block();return this.match(Ov.KEYWORD,"end"),this.ast.while_stat(t,e)}},{key:"parse_repeat_stat",value:function(){this.match(Ov.KEYWORD,"repeat");var t=this.parse_block();this.match(Ov.KEYWORD,"until");var e=this.parse_cond();return this.ast.repeat_stat(e,t)}},{key:"parse_expr_stat",value:function(){var t=this.parse_primaryexp();if("CallExpression"==t.type)return this.ast.expr_stat(t);var e=this.parse_assignment([t]);return this.ast.expr_stat(e)}},{key:"parse_assignment",value:function(t){if("="==this.cur_token.value){this.next();var e=this.parse_explist1();return this.ast.assign_expr("=",t,e)}this.match(Ov.COMMA),t.push(this.parse_primaryexp()),this.parse_assignment(t)}},{key:"parse_explist1",value:function(){for(var t=[this.parse_expr()];","==this.cur_token.value;)this.next(),t.push(this.parse_expr());return t}},{key:"parse_expr",value:function(){return this.parse_subexpr()}},{key:"parse_subexpr",value:function(t){t=t||0;var e=void 0;if(this.is_unary()){var n=this.parse_unary(),i=this.parse_subexpr();e=this.ast.unary_expr(n,i)}else e=this.parse_simpleexp();for(;this.is_binary()&&Vv[this.cur_token.value].prec>=t;){var r=this.next(),o=Vv[r.value],s=void 0;s=o.left?o.prec+1:o.prec;var a=this.parse_subexpr(s);e=this.ast.binary_expr(r.value,e,a)}return e}},{key:"parse_simpleexp",value:function(){if(this.cur_token.type==Ov.NUMBER||this.cur_token.type==Ov.STRING){var t=this.next();return this.ast.literal(t.value)}if(this.cur_token.type!=Ov.KEYWORD)return"{"==this.cur_token.value?this.parse_constructor():this.parse_primaryexp();switch(this.cur_token.value){case"nil":return this.next(),this.ast.literal(null);case"true":return this.next(),this.ast.literal(!0);case"false":return this.next(),this.ast.literal(!1);case"...":return this.next(),this.ast.literal("...");case"function":var e=this.cur_token,n=this.ast.literal(e.line+":"+e.column);this.next(),this.match(Ov.LPATTERN);var i=this.parse_parlist();this.match(Ov.RPATTERN);var r=this.parse_block();return this.match(Ov.KEYWORD,"end"),this.ast.func_stat(n,i,r);default:this.croak()}}},{key:"parse_primaryexp",value:function(){for(var t=this.parse_prefixexp(),e=void 0;;){switch(this.cur_token.value){case".":this.next(),e=this.parse_name(),t=this.ast.member_expr(t,".",e);break;case"[":this.next(),e=this.parse_expr(),t=this.ast.member_expr(t,"[",e),this.match(Ov.RBRACKET);break;case":":this.next(),e=this.parse_expr(),t=this.ast.member_expr(t,":",e);var n=this.parse_funcargs();t=this.ast.call_expr(t,n)}if("("!=this.cur_token.value&&"{"!=this.cur_token.value&&this.cur_token.type!=Ov.STRING)return t;var i=this.parse_funcargs();t=this.ast.call_expr(t,i)}}},{key:"parse_funcargs",value:function(){var t=[];return"("==this.cur_token.value?(this.next(),")"!=this.cur_token.value&&(t=this.parse_explist1()),this.match(Ov.RPATTERN),t):this.cur_token.type==Ov.STRING?this.ast.literal(this.cur_token.value):this.parse_constructor()}},{key:"parse_constructor",value:function(){var t=[];if(this.match(Ov.LBRACE),"}"!=this.cur_token.value){for(t.push(this.parse_field());this.is_fieldsep();)this.parse_fieldsep(),t.push(this.parse_field());this.is_fieldsep()&&this.parse_fieldsep()}return this.match(Ov.RBRACE),this.ast.table_expr(t)}},{key:"parse_fieldsep",value:function(){if(","==this.cur_token.value||";"==this.cur_token.value){var t=this.next();return this.ast.literal(t.value)}this.croak()}},{key:"parse_field",value:function(){return"["==this.cur_token.value||this.cur_token.type==Ov.IDENTIFIER?this.parse_recfield():this.parse_listfield()}},{key:"parse_recfield",value:function(){var t,e=void 0;return"["==this.cur_token.value?(e=this.parse_exp1(),this.match(Ov.RBRACKET)):e=this.parse_name(),this.match(Ov.ASSIGN),t=this.parse_exp1(),this.ast.recfield(e,t)}},{key:"parse_listfield",value:function(){return this.ast.listfield(this.parse_expr())}},{key:"parse_prefixexp",value:function(){if("("!=this.cur_token.value)return this.parse_name();this.match(Ov.LPATTERN);var t=this.parse_expr();return this.match(Ov.RPATTERN),t}},{key:"parse_exp1",value:function(){return this.parse_expr()}},{key:"parse_unary",value:function(){var t=this.next();switch(t.value){case"-":return"#-";default:return t.value}}},{key:"parse_name",value:function(){return this.ast.identifier(this.match(Ov.IDENTIFIER).value)}},{key:"is_unary",value:function(){switch(this.cur_token.value){case"#":case"-":case"not":return!0;default:return!1}}},{key:"is_fieldsep",value:function(){switch(this.cur_token.value){case",":case";":return!0;default:return!1}}},{key:"is_binary",value:function(){return!(!Vv[this.cur_token.value]||!Vv[this.cur_token.value].binary)}},{key:"is_param",value:function(){return this.cur_token.type==Ov.IDENTIFIER}},{key:"is_block_follow",value:function(){switch(this.cur_token.value){case"else":case"elseif":case"end":case"until":case"EOS":return!0}return!1}}]),Hv);function Hv(t,e){h(this,Hv),this.lexer=t,this.cur_token=null,this.ast=new qv(function(t){return e&&e(t),t}),this.location=[]}var Xv={parserExpress:function(t,e){if(!t)return"";var n=new kv(t),i=new Yv(n).parse(),r=new Dv,o=new Fv(i);new Uv(i,r).interprete();var s=o.to_js();return s=s+";"+function(t){if(!t)return"";var e=t.indexOf("function");if(-1==e)return"";var n=t.indexOf("(");return-1==n?"":t.slice(e,n)}(s)+"(...values)",window.eval(s)}},Jv={textSymbol:null,labelPosition:null,fieldList:null,name:"",filter:"",express:""},Wv=(c(Kv,[{key:"readJson",value:function(t){t&&(t.text_symbol&&(this.options.textSymbol=bm.readFromJson(t.text_symbol)),t.label_position&&(this.options.labelPosition=Pv.createFromJson(t.label_position)),this.options.fieldList=t.field_list,this.options.name=t.name,this.options.filter=t.filter,this.options.express=t.express)}},{key:"toJson",value:function(t){t&&(t.text_symbol=null,this.options.textSymbol&&(t.text_symbol={},this.options.textSymbol.toJson(t.text_symbol)),t.label_position=null,this.options.labelPosition&&(t.label_position={},this.options.labelPosition.toJson(t.label_position)),t.field_list=this.options.fieldList,t.name=this.options.name,t.filter=this.options.filter,t.express=this.options.express)}},{key:"getTextSymbol",value:function(){return this.options.textSymbol}},{key:"setTextSymbol",value:function(t){this.options.textSymbol=t}},{key:"getLabelPosition",value:function(){return this.options.labelPosition}},{key:"setLabelPosition",value:function(t){this.options.labelPosition=t}},{key:"getFieldList",value:function(){return this.options.fieldList}},{key:"setFieldList",value:function(t){this.options.fieldList=t}},{key:"getName",value:function(){return this.options.name}},{key:"setName",value:function(t){this.options.name=t}},{key:"getFilter",value:function(){return this.options.filter}},{key:"setFilter",value:function(t){this.options.filter=t}},{key:"getExpress",value:function(){return this.options.express}},{key:"setExpress",value:function(t){this.options.express=t}},{key:"getUsedFields",value:function(){var t=[];if(this.options.fieldList&&0<this.options.fieldList.length&&(t=t.concat(this.options.fieldList)),this.options.filter){var e=Tv.getFilterFields(this.options.filter);e&&0<e.length&&(t=t.concat(e))}return S_.uniqueArray(t)}},{key:"getText",value:function(n){n=n||{};var t="";if(this.options.express&&-1!==this.options.express.indexOf("function")){var i=[];this.options.fieldList&&this.options.fieldList.forEach(function(t){var e=n[t]||"";i.push(e)}),t=Xv.parserExpress(this.options.express,i)}else{var e=this.options.fieldList[0];t=n[e]||""}return t.toString()}},{key:"compareFilter",value:function(t){return Tv.compareFilter(this.options.filter,t)}}]),Kv);function Kv(t){h(this,Kv),this.options=S_.extend({},Jv,t)}var Zv={renderItem:null},Qv=(y($v,nv),c($v,[{key:"readJson",value:function(t){t&&(d($v.prototype.__proto__||Object.getPrototypeOf($v.prototype),"readJson",this).call(this,t),t.render_text_item&&(this.options.renderItem=new Wv,this.options.renderItem.readJson(t.render_text_item)))}},{key:"toJson",value:function(t){t&&(d($v.prototype.__proto__||Object.getPrototypeOf($v.prototype),"toJson",this).call(this,t),t.render_text_item=null,this.options.renderItem&&(t.render_text_item={},this.options.renderItem.toJson(t.render_text_item)))}},{key:"getRenderItem",value:function(){return this.options.renderItem}},{key:"setRenderItem",value:function(t){this.options.renderItem=t}},{key:"getUsedFields",value:function(){var t=d($v.prototype.__proto__||Object.getPrototypeOf($v.prototype),"getUsedFields",this).call(this);if(t=t||[],this.options.renderItem){var e=this.options.renderItem.getUsedFields();e&&0<e.length&&(t=t.concat(e))}return S_.uniqueArray(t)}},{key:"getRenderItemList",value:function(){return this.options.renderItem?[this.options.renderItem]:null}}]),$v);function $v(t){h(this,$v);var e=_(this,($v.__proto__||Object.getPrototypeOf($v)).call(this));return e.mergeOptions(Zv,t),e.type=$m,e}var tb={renderItemList:null},eb=(y(nb,nv),c(nb,[{key:"readJson",value:function(t){var n=this;t&&(d(nb.prototype.__proto__||Object.getPrototypeOf(nb.prototype),"readJson",this).call(this,t),t.render_text_item_list&&0<t.render_text_item_list.length&&(this.options.renderItemList=[],t.render_text_item_list.forEach(function(t){if(t){var e=new Wv;e.readJson(t),n.options.renderItemList.push(e)}})))}},{key:"toJson",value:function(n){n&&(d(nb.prototype.__proto__||Object.getPrototypeOf(nb.prototype),"toJson",this).call(this,n),n.render_text_item_list=null,this.options.renderItemList&&0<this.options.renderItemList.length&&(n.render_text_item_list=[],this.options.renderItemList.forEach(function(t){if(t){var e={};t.toJson(e),n.render_text_item_list.push(e)}})))}},{key:"getRenderItemList",value:function(){return this.options.renderItemList}},{key:"setRenderItemList",value:function(t){this.options.renderItemList=t}},{key:"getUsedFields",value:function(){var n=d(nb.prototype.__proto__||Object.getPrototypeOf(nb.prototype),"getUsedFields",this).call(this);return n=n||[],this.options.renderItemList&&0<this.options.renderItemList.length&&this.options.renderItemList.forEach(function(t){var e=t.getUsedFields();e&&0<e.length&&(n=n.concat(e))}),S_.uniqueArray(n)}}]),nb);function nb(t){h(this,nb);var e=_(this,(nb.__proto__||Object.getPrototypeOf(nb)).call(this));return e.mergeOptions(tb,t),e.type=tv,e}var ib={aroundOffset:0,positionType:hv.AROUND_POINT,specifiedAngle:0,angleField:"",labelPosList:null},rb=(y(ob,Pv),c(ob,[{key:"readJson",value:function(t){t&&(d(ob.prototype.__proto__||Object.getPrototypeOf(ob.prototype),"readJson",this).call(this,t),this.options.aroundOffset=t.arround_offset,this.options.positionType=t.position_type,this.options.specifiedAngle=t.specified_angle,this.options.angleField=t.angle_field,this.options.labelPosList=t.position_list)}},{key:"toJson",value:function(t){t&&(d(ob.prototype.__proto__||Object.getPrototypeOf(ob.prototype),"toJson",this).call(this,t),t.arround_offset=this.options.aroundOffset,t.position_type=this.options.positionType,t.specified_angle=this.options.specifiedAngle,t.angle_field=this.options.angleField,t.position_list=this.options.labelPosList)}},{key:"getAroundOffset",value:function(){return this.options.aroundOffset}},{key:"setAroundOffset",value:function(t){this.options.aroundOffset=t}},{key:"getPositionType",value:function(){return this.options.positionType}},{key:"setPositionType",value:function(t){this.options.positionType=t}},{key:"getSpecifiedAngle",value:function(){return this.options.specifiedAngle}},{key:"setSpecifiedAngle",value:function(t){this.options.specifiedAngle=t}},{key:"getAngleField",value:function(){return this.options.angleField}},{key:"setAngleField",value:function(t){this.options.angleField=t}},{key:"getLabelPosList",value:function(){return this.options.labelPosList}},{key:"setLabelPosList",value:function(t){this.options.labelPosList=t}}]),ob);function ob(t){h(this,ob);var e=_(this,(ob.__proto__||Object.getPrototypeOf(ob)).call(this));return e.mergeOptions(ib,t),e.type=av,e.options.labelPosList||(e.options.labelPosList=[pv,yv,dv,mv,gv,cv,fv,_v]),e}var sb={positionType:bv,vertPos:wv,offset:0,joinAdjacent:!1},ab=(y(ub,Pv),c(ub,[{key:"readJson",value:function(t){t&&(d(ub.prototype.__proto__||Object.getPrototypeOf(ub.prototype),"readJson",this).call(this,t),this.options.positionType=t.position_type,this.options.vertPos=t.text_vert_place,this.options.offset=t.offset,this.options.joinAdjacent=t.joint)}},{key:"toJson",value:function(t){t&&(d(ub.prototype.__proto__||Object.getPrototypeOf(ub.prototype),"toJson",this).call(this,t),t.position_type=this.options.positionType,t.text_vert_place=this.options.vertPos,t.offset=this.options.offset,t.joint=this.options.joinAdjacent)}},{key:"getPositionType",value:function(){return this.options.positionType}},{key:"setPositionType",value:function(t){this.options.positionType=t}},{key:"getVertPos",value:function(){return this.options.vertPos}},{key:"setVertPos",value:function(t){this.options.vertPos=t}},{key:"getOffset",value:function(){return this.options.offset}},{key:"setOffset",value:function(t){this.options.offset=t}},{key:"isJoinAdjacent",value:function(){return this.options.joinAdjacent}},{key:"setJoinAdjacent",value:function(t){this.options.joinAdjacent=t}},{key:"isVertPosOnLine",value:function(){return!!(this.options.vertPos&Lv)}},{key:"isVertPosAboveLine",value:function(){return!!(this.options.vertPos&wv)}},{key:"isVertPosBelowLine",value:function(){return!!(this.options.vertPos&Sv)}},{key:"getVertPosList",value:function(){var t=[];return this.isVertPosAboveLine()&&t.push(wv),this.isVertPosOnLine()&&t.push(Lv),this.isVertPosBelowLine()&&t.push(Sv),t}}]),ub);function ub(t){h(this,ub);var e=_(this,(ub.__proto__||Object.getPrototypeOf(ub)).call(this));return e.mergeOptions(sb,t),e.type=uv,e}var lb={positionType:Mv,onlyInPolygon:!1},hb=(y(cb,Pv),c(cb,[{key:"readJson",value:function(t){t&&(d(cb.prototype.__proto__||Object.getPrototypeOf(cb.prototype),"readJson",this).call(this,t),this.options.positionType=t.position_type,this.options.onlyInPolygon=t.only_in_polygon)}},{key:"toJson",value:function(t){t&&(d(cb.prototype.__proto__||Object.getPrototypeOf(cb.prototype),"toJson",this).call(this,t),t.position_type=this.options.positionType,t.only_in_polygon=this.options.onlyInPolygon)}},{key:"getPositionType",value:function(){return this.options.positionType}},{key:"setPositionType",value:function(t){this.options.positionType=t}},{key:"isOnlyInPolygon",value:function(){return this.options.onlyInPolygon}},{key:"setOnlyInPolygon",value:function(t){this.options.onlyInPolygon=t}}]),cb);function cb(t){h(this,cb);var e=_(this,(cb.__proto__||Object.getPrototypeOf(cb)).call(this));return e.mergeOptions(lb,t),e.type=lv,e}var pb={hasHalo:!1,size:1,color:null},fb=(c(db,[{key:"readJson",value:function(t){t&&(this.options.hasHalo=t.enable,this.options.size=bt.poundToPixel(t.size),this.options.color=_m.createFromArray(t.color))}},{key:"toJson",value:function(t){t&&(t.enable=this.options.hasHalo,t.size=bt.pixelToPound(this.options.size),this.options.color?t.color=this.options.color.toArray():t.color=null)}},{key:"hasHalo",value:function(){return this.options.hasHalo}},{key:"setHasHalo",value:function(t){this.options.hasHalo=t}},{key:"getSize",value:function(){return this.options.size}},{key:"setSize",value:function(t){this.options.size=t}},{key:"getColor",value:function(){return this.options.color}},{key:"setColor",value:function(t){this.options.color=t}}]),db);function db(t){h(this,db),this.options=bt.extend({},pb,t),this.options.color||(this.options.color=_m.createRandom())}var gb={bold:!1,italic:!1,underline:!1,strikeout:!1,size:16,fontFace:"宋体",faceIndex:0,fontFileName:""},yb=(c(_b,[{key:"readJson",value:function(t){t&&(this.options.bold=t.bold,this.options.italic=t.italic,this.options.underline=t.underline,this.options.strikeout=t.strikeout,this.options.size=bt.poundToPixel(t.font_size),this.options.fontFace=t.family_name,this.options.faceIndex=t.face_index,this.options.fontFileName=t.font_file_name)}},{key:"toJson",value:function(t){t&&(t.bold=this.options.bold,t.italic=this.options.italic,t.underline=this.options.underline,t.strikeout=this.options.strikeout,t.font_size=bt.pixelToPound(this.options.size),t.family_name=this.options.fontFace,t.face_index=this.options.faceIndex,t.font_file_name=this.options.fontFileName)}},{key:"isBold",value:function(){return this.options.bold}},{key:"setBold",value:function(t){this.options.bold=t}},{key:"isItalic",value:function(){return this.options.italic}},{key:"setItalic",value:function(t){this.options.italic=t}},{key:"isUnderline",value:function(){return this.options.underline}},{key:"setUnderline",value:function(t){this.options.underline=t}},{key:"isStrikeout",value:function(){return this.options.strikeout}},{key:"setStrikeout",value:function(t){this.options.strikeout=t}},{key:"getSize",value:function(){return this.options.size}},{key:"setSize",value:function(t){this.options.size=t}},{key:"getFontFace",value:function(){return this.options.fontFace}},{key:"setFontFace",value:function(t){this.options.fontFace=t}},{key:"getFontStr",value:function(){var t="";return this.isItalic()&&(t+="italic"),this.isBold()&&(t+=" bold"),t+=" "+this.getSize()+"px",t+=" "+this.getFontFace()}}]),_b);function _b(t){h(this,_b),this.options=bt.extend({},gb,t)}var mb={fontInfo:null,interval:0,wordInterval:0,lineSpacing:0,offsetX:0,offsetY:0,leftMargin:1,topMargin:1,rightMargin:1,bottomMargin:1,halo:null,wrap:!0,wordCountPerLine:6,maxLineCount:2,wrapChar:"",alignment:1,angle:0},vb=(c(bb,[{key:"readJson",value:function(t){t&&(t.font_info&&(this.options.fontInfo=new yb,this.options.fontInfo.readJson(t.font_info)),this.options.interval=bt.poundToPixel(t.interval),this.options.wordInterval=bt.poundToPixel(t.word_interval),this.options.lineSpacing=bt.poundToPixel(t.line_spacing),this.options.offsetX=bt.poundToPixel(t.offset_x),this.options.offsetY=bt.poundToPixel(t.offset_y),this.options.leftMargin=bt.poundToPixel(t.margin_left),this.options.topMargin=bt.poundToPixel(t.margin_top),this.options.rightMargin=bt.poundToPixel(t.margin_right),this.options.bottomMargin=bt.poundToPixel(t.margin_bottom),t.halo&&(this.options.halo=new fb,this.options.halo.readJson(t.halo)),this.options.wrap=t.wrap,this.options.wordCountPerLine=t.word_count_per_line,this.options.wrapChar=t.wrap_char,this.options.angle=t.angle)}},{key:"toJson",value:function(t){t&&(t.font_info=null,this.options.fontInfo&&(t.font_info={},this.options.fontInfo.toJson(t.font_info)),t.interval=bt.pixelToPound(this.options.interval),t.word_interval=bt.pixelToPound(this.options.wordInterval),t.line_spacing=bt.pixelToPound(this.options.lineSpacing),t.offset_x=bt.pixelToPound(this.options.offsetX),t.offset_y=bt.pixelToPound(this.options.offsetY),t.margin_left=bt.pixelToPound(this.options.leftMargin),t.margin_top=bt.pixelToPound(this.options.topMargin),t.margin_right=bt.pixelToPound(this.options.rightMargin),t.margin_bottom=bt.pixelToPound(this.options.bottomMargin),t.halo=null,this.options.halo&&(t.halo={},this.options.halo.toJson(t.halo)),t.wrap=this.options.wrap,t.word_count_per_line=this.options.wordCountPerLine,t.wrap_char=this.options.wrapChar,t.angle=this.options.angle)}},{key:"getFontInfo",value:function(){return this.options.fontInfo}},{key:"setFontInfo",value:function(t){this.options.fontInfo=t}},{key:"getInterval",value:function(){return this.options.interval}},{key:"setInterval",value:function(t){this.options.interval=t}},{key:"getWordInterval",value:function(){return this.options.wordInterval}},{key:"setWordInterval",value:function(t){this.options.wordInterval=t}},{key:"getLineSpacing",value:function(){return this.options.lineSpacing}},{key:"setLineSpacing",value:function(t){this.options.lineSpacing=t}},{key:"getOffsetX",value:function(){return this.options.offsetX}},{key:"setOffsetX",value:function(t){this.options.offsetX=t}},{key:"getOffsetY",value:function(){return this.options.offsetY}},{key:"setOffsetY",value:function(t){this.options.offsetY=t}},{key:"getLeftMargin",value:function(){return this.options.leftMargin}},{key:"setLeftMargin",value:function(t){this.options.leftMargin=t}},{key:"getRightMargin",value:function(){return this.options.rightMargin}},{key:"setRightMargin",value:function(t){this.options.rightMargin=t}},{key:"getTopMargin",value:function(){return this.options.topMargin}},{key:"setTopMargin",value:function(t){this.options.topMargin=t}},{key:"getBottomMargin",value:function(){return this.options.bottomMargin}},{key:"setBottomMargin",value:function(t){this.options.bottomMargin=t}},{key:"getHalo",value:function(){return this.options.halo}},{key:"setHalo",value:function(t){this.options.halo=t}},{key:"isWrap",value:function(){return this.options.wrap}},{key:"setWrap",value:function(t){this.options.wrap=t}},{key:"getWordCountPerLine",value:function(){return this.options.wordCountPerLine}},{key:"setWordCountPerLine",value:function(t){this.options.wordCountPerLine=t}},{key:"getMaxLineCount",value:function(){return this.options.maxLineCount}},{key:"setMaxLineCount",value:function(t){this.options.maxLineCount=t}},{key:"getWrapChar",value:function(){return this.options.wrapChar}},{key:"setWrapChar",value:function(t){this.options.wrapChar=t}},{key:"getAlignment",value:function(){return this.options.alignment}},{key:"setAlignment",value:function(t){this.options.alignment=t}},{key:"getAngle",value:function(){return this.options.angle}},{key:"setAngle",value:function(t){this.options.angle=t}}]),bb);function bb(t){h(this,bb),this.options=bt.extend({},mb,t),this.options.fontInfo||(this.options.fontInfo=new yb),this.options.halo||(this.options.halo=new fb({color:new _m(255,255,0,255)}))}var xb={textInfo:null,fillSymbol:null},Eb=(y(Ib,bm),c(Ib,[{key:"readJson",value:function(t){t&&(d(Ib.prototype.__proto__||Object.getPrototypeOf(Ib.prototype),"readJson",this).call(this,t),t.text_info&&(this.options.textInfo=new vb,this.options.textInfo.readJson(t.text_info)),t.background_fill_symbol&&(this.options.fillSymbol=bm.readFromJson(t.background_fill_symbol)))}},{key:"toJson",value:function(t){t&&(d(Ib.prototype.__proto__||Object.getPrototypeOf(Ib.prototype),"toJson",this).call(this,t),t.text_info=null,this.options.textInfo&&(t.text_info={},this.options.textInfo.toJson(t.text_info)),t.background_fill_symbol=null,this.options.fillSymbol&&(t.background_fill_symbol={},this.options.fillSymbol.toJson(t.background_fill_symbol)))}},{key:"getTextInfo",value:function(){return this.options.textInfo}},{key:"setTextInfo",value:function(t){this.options.textInfo=t}},{key:"getFillSymbol",value:function(){return this.options.fillSymbol}},{key:"setFillSymbol",value:function(t){this.options.fillSymbol=t}},{key:"getFontSize",value:function(){var t=0;return this.options.textInfo&&(t=this.options.textInfo.getFontInfo().getSize()),t}},{key:"setFontSize",value:function(t){this.options.textInfo||(this.options.textInfo=new vb),this.options.textInfo.getFontInfo().setSize(t)}},{key:"validFillSymbol",value:function(){return!!this.options.fillSymbol}}]),Ib);function Ib(t){h(this,Ib);var e=_(this,(Ib.__proto__||Object.getPrototypeOf(Ib)).call(this));return e.mergeOptions(xb,t),t&&t.color||(e.options.color=new _m(0,0,0,255)),e.options.textInfo||(e.options.textInfo=new vb),e.type=gm.TEXT_SYMBOL,e.class=dm,e}nv.readFromJson=function(t){if(!t)return null;var e=null;switch(t.class){case $m:e=new Qv;break;case tv:e=new eb}return e&&e.readJson(t),e},nv.createDefault=function(t){var e=null;switch(t){case Sm.POINT:case Mm.POINT:e=new rb;break;case Sm.LINE:case Mm.LINE:e=new ab;break;case Sm.POLYGON:case Mm.POLYGON:e=new hb}var n=new Eb,i=new Wv({textSymbol:n,labelPosition:e});return new Qv({renderItem:i})},Pv.createFromJson=function(t){var e=null;switch(t.class){case av:e=new rb;break;case uv:e=new ab;break;case lv:e=new hb}return e&&e.readJson(t),e};var Lb="se",wb="se-vector-service",Sb="se-select",Mb="se-edit",Cb="se-temp",Pb={DB_STRING:1043,DB_INTEGER:23,DB_INT:23,DB_BIGINT:20,DB_DATETIME:1114,DB_TIME:1083,DB_DATE:1082,DB_FLOAT:700,DB_DOUBLE:701,DB_BLOB:"blob",DB_LONGBLOB:"longblob",DB_BOOL:"bool",getTextMemo:function(t){var e="";if(t)switch(t=t.toLowerCase()){case this.DB_STRING:e="文本型";break;case this.DB_INT:case this.DB_BIGINT:case this.DB_INTEGER:e="整数型";break;case this.DB_TIME:case this.DB_DATE:case this.DB_DATETIME:e="日期型";break;case this.DB_FLOAT:case this.DB_DOUBLE:e="数值型";break;case this.DB_LONGBLOB:case this.DB_BLOB:e="二进制型";break;case this.DB_BOOL:e="布尔型";break;default:e="未知"}else e="未知";return e},isNumber:function(t){return t===this.DB_INTEGER||t===this.DB_BIGINT||t===this.DB_DOUBLE||t===this.DB_INT||t===this.DB_FLOAT},isString:function(t){return t===this.DB_STRING||t===this.DB_DATETIME||t===this.DB_TIME||t===this.DB_DATE}},Nb=B.Class.extend({options:{name:"",type:Pb.DB_STRING,length:0,isNull:!0,index:"",isGid:!1,isSys:!1},initialize:function(t){B.setOptions(this,t)},getName:function(){return this.options.name},getType:function(){return this.options.type},getLength:function(){return this.options.length},isNull:function(){return this.options.isNull},getIndex:function(){return this.options.index},isSysField:function(){return this.options.isSys},readJson:function(t){t&&(this.options.name=t.name?t.name:"",this.options.type=t.type?t.type:Pb.DB_STRING,this.options.length=t.width?t.width:0,this.options.isNull=!!t.is_null,this.options.index=t.index,this.options.isGid=!!t.is_gid,this.options.isSys=!!t.is_sys)}}),Ob=B.Class.extend({options:{proj4:"",code:"",description:"",wkt:"",name:"",srid:0,authName:"EPSG"},initialize:function(t){B.setOptions(this,t)},getProj4:function(){return this.options.proj4},getCode:function(){return this.options.code},getName:function(){return this.options.name},getWkt:function(){return this.options.wkt},getDescription:function(){return this.options.description},getSrid:function(){return this.options.srid},createProj:function(){return this.options.proj4?new W.CRS(this.options.code,this.options.proj4):null},readJson:function(t){t&&(this.options.name=t.name?t.name:"",this.options.proj4=t.proj4?t.proj4:"",this.options.wkt=t.wkt?t.wkt:"",this.options.srid=t.srid,this.options.authName=t.auth_name?t.auth_name:"EPSG",this.options.code=this.options.authName+":"+this.options.srid)},isEPSG4326:function(){return"EPSG:4326"===this.options.code||"4326"===this.options.code},project:function(t){if(!t)return null;var e=this.createProj();return e&&!this.isEPSG4326()?e.projection.project(t):new B.Point(t.lng,t.lat)},unproject:function(t){if(!t)return null;var e=this.createProj();return e?e.projection.unproject(t):new B.LatLng(t.y,t.x)}}),Tb=(c(kb,[{key:"getInt8",value:function(){var t=this.dataview.getInt8(this.pos,!0);return this.pos++,t}},{key:"getUint8",value:function(){var t=this.dataview.getUint8(this.pos,!0);return this.pos++,t}},{key:"getInt16",value:function(){var t=this.dataview.getInt16(this.pos,!0);return this.pos+=2,t}},{key:"getUint16",value:function(){var t=this.dataview.getUint16(this.pos,!0);return this.pos+=2,t}},{key:"getInt32",value:function(){var t=this.dataview.getInt32(this.pos,!0);return this.pos+=4,t}},{key:"getUint32",value:function(){var t=this.dataview.getUint32(this.pos,!0);return this.pos+=4,t}},{key:"getFloat64",value:function(){var t=this.dataview.getFloat64(this.pos,!0);return this.pos+=8,t}},{key:"getFloat32",value:function(){var t=this.dataview.getFloat32(this.pos,!0);return this.pos+=4,t}},{key:"getBool",value:function(){return 0!==this.getInt8()}},{key:"size",value:function(){return this.dataview.byteLength}},{key:"getBits",value:function(t){var e=this.dataview.buffer.slice(this.pos,this.pos+t);return this.pos+=t,e}},{key:"get_vchar_v2",value:function(){var t=0,e=this.getUint8();return 253<e?254===e?t=this.getUint16():255===e&&(t=this.getUint32()):t=e,t}},{key:"setData",value:function(t){if(t){for(var e=(t=atob(t)).length,n=new ArrayBuffer(e),i=new Uint8Array(n),r=0;r<e;r++)i[r]=t[r].charCodeAt();this.dataview=new DataView(n)}}},{key:"binayUtf8ToString",value:function(t,e){var n=0,i="",r=0,o=0;for(n=e;n<t.length;)(o=t[n])>>>7==0?(i+=String.fromCharCode(t[n]),n+=1):252==(252&o)?(r=(3&t[n])<<30,r|=(63&t[n+1])<<24,r|=(63&t[n+2])<<18,r|=(63&t[n+3])<<12,r|=(63&t[n+4])<<6,r|=63&t[n+5],i+=String.fromCharCode(r),n+=6):248==(248&o)?(r=(7&t[n])<<24,r|=(63&t[n+1])<<18,r|=(63&t[n+2])<<12,r|=(63&t[n+3])<<6,r|=63&t[n+4],i+=String.fromCharCode(r),n+=5):240==(240&o)?(r=(15&t[n])<<18,r|=(63&t[n+1])<<12,r|=(63&t[n+2])<<6,r|=63&t[n+3],i+=String.fromCharCode(r),n+=4):224==(224&o)?(r=(31&t[n])<<12,r|=(63&t[n+1])<<6,r|=63&t[n+2],i+=String.fromCharCode(r),n+=3):192==(192&o)?(r=(63&t[n])<<6,r|=63&t[n+1],i+=String.fromCharCode(r),n+=2):(i+=String.fromCharCode(t[n]),n+=1);return i}},{key:"getString",value:function(t){var e=this.getBits(t),n=new Int8Array(e);return this.binayUtf8ToString(n,0)}}]),kb);function kb(t){h(this,kb),this.pos=0,this.dataview=t}var Rb={set_double_bit:function(t,e,n){var i=7-e;t.setInt8(i,n,!0)},decodePoint:function(t){for(var e=t.get_vchar_v2(),n=t.get_vchar_v2(),i=new Array(n),r=new Array(n),o=new ArrayBuffer(8),s=new DataView(o),a=new ArrayBuffer(8),u=new DataView(a),l=0;l<n;l++){s.setFloat64(0,0,!0),u.setFloat64(0,0,!0);for(var h=0;h<=e+1;h++){var c=t.getInt8();this.set_double_bit(s,h,c);var p=t.getInt8();this.set_double_bit(u,h,p)}var f=s.getFloat64(0,!0),d=u.getFloat64(0,!0),g=new B.Point(f,d);i[l]=g,r[l]=1}return{points:i,polyCount:r,subCount:n}},decodeLine:function(t){for(var e=t.get_vchar_v2(),n=t.get_vchar_v2(),i=[],r=new Array(n),o=new ArrayBuffer(8),s=new DataView(o),a=new ArrayBuffer(8),u=new DataView(a),l=0;l<n;l++){for(var h=t.get_vchar_v2(),c=0;c<h;c++){s.setFloat64(0,0,!0),u.setFloat64(0,0,!0);for(var p=0;p<=e+1;p++){var f=t.getInt8();this.set_double_bit(s,p,f);var d=t.getInt8();this.set_double_bit(u,p,d)}var g=s.getFloat64(0,!0),y=u.getFloat64(0,!0),_=new B.Point(g,y);i.push(_)}r[l]=h}return{points:i,polyCount:r,subCount:n}},decodePolygon:function(t){for(var e=t.get_vchar_v2(),n=t.get_vchar_v2(),i=[],r=new Array(n),o=new Array(n),s=new ArrayBuffer(8),a=new DataView(s),u=new ArrayBuffer(8),l=new DataView(u),h=0;h<n;h++){var c=t.getBool();o[h]=c}for(var p=0;p<n;p++){for(var f=t.get_vchar_v2(),d=0;d<f;d++){a.setFloat64(0,0,!0),l.setFloat64(0,0,!0);for(var g=0;g<=e+1;g++){var y=t.getInt8();this.set_double_bit(a,g,y);var _=t.getInt8();this.set_double_bit(l,g,_)}var m=a.getFloat64(0,!0),v=l.getFloat64(0,!0),b=new B.Point(m,v);i.push(b)}r[p]=f}return{points:i,polyCount:r,subCount:n}}},Db=B.Evented.extend({initialize:function(t){B.setOptions(this,t),this.id=-1,this.name="",this.type=Sm.UNKNOWN,this.version=-1,this.pvVersion=0,this.fieldInfos=null,this.cacheFieldInfos=null,this.bounds=null,this.features=null,this.projInfo=null,this.lastIds=null,this._subPackFeatures=null},clone:function(){var t=new Db(this.options);return t.id=this.id,t.name=this.name,t.type=this.type,t.version=this.version,t.pvVersion=this.pvVersion,t.fieldInfos=this.fieldInfos,t.cacheFieldInfos=this.cacheFieldInfos,t.bounds=this.bounds,t.projInfo=this.projInfo,t},getType:function(){return this.type},getID:function(){return this.id},setID:function(t){this.id=t},getBounds:function(){return this.bounds},setBounds:function(t){this.bounds=t},getProjInfo:function(){return this.projInfo},getName:function(){return this.name},getVersion:function(){return this.version},setVersion:function(t){this.version=t},getPvVersion:function(){return this.pvVersion},setPvVersion:function(t){this.pvVersion=t},getFieldInfos:function(){return this.fieldInfos},setFieldInfos:function(t){this.fieldInfos=t},getFeatures:function(){return this.features},updateRecordset:function(t,e){var n=t.attr_list,i=t.feature_id_list,r=t.field_list,o=t.geo_list;if(i&&0!==i.length&&o&&0!==o.length&&i.length===o.length){var s=n&&n.length&&n.length===i.length*r.length,a=i.length,u=r?r.length:0,l=0,h=-1,c=null;this.features=new Array;var p=0,f=0,d=null,g=null;switch(this._proj?g=this._proj:this.getProjInfo()&&(g=this.getProjInfo().createProj(),this._proj=g),this.type){case Sm.POINT:for(l=0;l<a;l++){h=i[l];var y=o[l];(d=new Tb).setData(y);var _=Rb.decodePoint(d);if(_){(c=new N_({mapPoints:_.points,polyCount:_.polyCount,subCount:_.subCount,id:h,projInfo:this.projInfo})).setProj(g),s&&(f=l*u,this._updateGeoAttrsExt(c,n,r,f));var m=e.findRenderItem(this.type,c.getProperties());c.setRenderItem(m),m&&(this.features[p++]=c)}}break;case Sm.LINE:for(l=0;l<a;l++){h=i[l];var v=o[l];(d=new Tb).setData(v);var b=Rb.decodeLine(d);if(b&&b.points&&2<=b.points.length){(c=new O_({mapPoints:b.points,polyCount:b.polyCount,subCount:b.subCount,id:h,projInfo:this.projInfo})).setProj(g),s&&(f=l*u,this._updateGeoAttrsExt(c,n,r,f));var x=e.findRenderItem(this.type,c.getProperties());c.setRenderItem(x),x&&(this.features[p++]=c)}}break;case Sm.POLYGON:for(l=0;l<a;l++){h=i[l];var E=o[l];(d=new Tb).setData(E);var I=Rb.decodePolygon(d);if(I&&I.points&&3<=I.points.length){(c=new T_({mapPoints:I.points,polyCount:I.polyCount,subCount:I.subCount,id:h,projInfo:this.projInfo})).setProj(g),s&&(f=l*u,this._updateGeoAttrsExt(c,n,r,f));var L=e.findRenderItem(this.type,c.getProperties());c.setRenderItem(L),L&&(this.features[p++]=c)}}}t.sub_pack_index&&(this._subPackFeatures||(this._subPackFeatures={}),this._subPackFeatures[t.sub_pack_index]=this.features)}},_updateGeoAttrsExt:function(t,e,n,i){if(!t||!e||!n)return!1;for(var r=n.length,o={},s=0;s<r;s++){var a=n[s].toLowerCase(),u=this.getFieldInfo(a),l=e[s+i];u.getType()===Pb.DB_INTEGER?l=parseInt(l):u.getType()===Pb.DB_DOUBLE&&(l=parseFloat(l)),o[a]=l}return t.setProperties(o),!0},readJson:function(t){if(t&&(this.id=void 0!==t.data_id?t.data_id:-1,this.name=t.name?t.name:"",t.bbox&&(this.bounds=new I_,this.bounds.readJson(t.bbox)),t.crs&&(this.projInfo=new Ob,this.projInfo.readJson(t.crs)),this.version=void 0!==t.data_version?t.data_version:-1,this.pvVersion=t.pv_info?t.pv_info.pv_version:0,this.type=t.type?t.type:0,t.fields_list&&0<t.fields_list.length)){this.fieldInfos=[],this.cacheFieldInfos=[];for(var e=t.fields_list,n=e.length,i=0;i<n;i++){var r=e[i];if(r){var o=new Nb;o.readJson(r),this.fieldInfos.push(o),r.cached&&this.cacheFieldInfos.push(o)}}}},getFieldInfo:function(t){if(!t)return null;var e=null;if(this.fieldInfos&&0<this.fieldInfos.length){t=t.toLowerCase();for(var n=this.fieldInfos.length,i=0;i<n;i++){var r=this.fieldInfos[i];if(null!==r&&r.getName().toLowerCase()===t){e=r;break}}}return e},getFieldNames:function(){if(!this.fieldInfos||0===this.fieldInfos.length)return null;for(var t=this.fieldInfos.length,e=[],n=0;n<t;n++){var i=this.fieldInfos[n];i&&e.push(i.getName())}return e},getlatLngBounds:function(){return this.bounds?this.bounds.toLatLngBounds(this.projInfo):null},mergeFeatures:function(){if(this._subPackFeatures){var t=Object.keys(this._subPackFeatures);if(t&&0!==t.length){t.sort(function(t,e){return t-e});for(var e=t.length,n=this._subPackFeatures[t[0]],i=1;i<e;i++){var r=t[i],o=this._subPackFeatures[r];n=n.concat(o)}this.features=n,this._subPackFeatures=null}}},hasFeatureData:function(){return!!(this.features&&0<this.features.length)},clearData:function(){this.features=null,this._subPackFeatures=null},getLocalFeaturesByIds:function(n){if(!n||0===n.length||!this.features||0===this.features.length)return null;var i=[];return this.features.forEach(function(t){if(t){var e=t.getID();-1!==n.indexOf(e)&&i.push(t)}}),i}}),Ab=(c(Fb,null,[{key:"createEditHistory",value:function(t,e,n,i){var r=null;return n===C_.EDIT_COLLECTION?t&&i&&0<i.length&&((r=new Fb).datasetId=t,r.action=n,r.group=i):t&&e&&0<e.length&&(n!==C_.ADD&&n!==C_.MODIFY&&n!==C_.DELETE||((r=new Fb).datasetId=t,r.features=e,r.action=n)),r}}]),Fb);function Fb(){h(this,Fb),this.datasetId=void 0,this.features=[],this.action=C_.UNKNOWN,this.group=[]}function Bb(t,e){h(this,Bb),this.key=t,this.subKey=0,this.level=-50,this.to=-50,this.type=e}var Gb=0,Ub=1,jb=2,qb=3,zb=4,Vb=0,Yb=1,Hb=2,Xb=3,Jb=function(t,e){this.x=t||0,this.y=e||0};window.L&&window.L.Point&&(Jb=window.L.Point);var Wb=(c(Kb,null,[{key:"pointsToSeRect",value:function(t){var r=new Kb;return t&&0!==t.length&&t.forEach(function(t,e){if(t){var n=t.x,i=t.y;0===e?(r.left=n,r.right=n,r.bottom=i,r.top=i):(r.left=Math.min(r.left,n),r.right=Math.max(r.right,n),r.bottom=Math.min(r.bottom,i),r.top=Math.max(r.top,i))}}),r}}]),c(Kb,[{key:"load",value:function(t){this.left=t.getFloat64(),this.top=t.getFloat64(),this.right=t.getFloat64(),this.bottom=t.getFloat64()}},{key:"isNull",value:function(){return this.left>this.right||this.bottom>this.top}},{key:"isIntersect",value:function(t){return!t.isNull()&&!this.isNull()&&this.right>=t.left&&this.left<=t.right&&this.bottom<=t.top&&this.top>=t.bottom}},{key:"mergeRect",value:function(t){t.isNull()||(this.isNull()?(this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom):(this.left=Math.min(this.left,t.left),this.top=Math.max(this.top,t.top),this.right=Math.max(this.right,t.right),this.bottom=Math.min(this.bottom,t.bottom)))}},{key:"minX",value:function(){return this.left}},{key:"minY",value:function(){return this.bottom}},{key:"width",value:function(){return this.right-this.left}},{key:"height",value:function(){return this.top-this.bottom}}]),Kb);function Kb(t){h(this,Kb),t=t||{},this.left=t.left||0,this.bottom=t.bottom||0,this.right=t.right||0,this.top=t.top||0}var Zb=(c(Qb,[{key:"load",value:function(t,e){this.key=t.getInt32(),this.level=t.getInt8(),this.minLevel=t.getInt8();var n=t.getInt16();if(this.bound=new Wb,this.bound.left=t.getFloat32(),this.bound.top=t.getFloat32(),this.bound.right=t.getFloat32(),this.bound.bottom=t.getFloat32(),e[this.key]=this,0<n){this.subNodes||(this.subNodes=[]);for(var i=0;i<n;i++){var r=new Qb;r.load(t,e),this.subNodes.push(r)}}}},{key:"query",value:function(t,e,n,i){if(!this.bound.isNull()&&this.bound.isIntersect(e)&&!(n<this.level+9)){if(n<this.level+12&&0<this.subNodes.length){var r=new Bb(this.key,Ub);t.push(r)}if(n>=this.level+9){var o=new Bb(this.key,Gb);t.push(o)}for(var s=this.subNodes?this.subNodes.length:0,a=0;a<s;a++)this.subNodes[a].query(t,e,n,i)}}}]),Qb);function Qb(){h(this,Qb),this.key=0,this.level=0,this.bound=null,this.subNodes=[],this.minLevel=-50,this.pv_isNull=!1,this.bpv_isNull=!1}function $b(){h(this,$b),this.subKey=0,this.level=-50,this.bound=null,this.minLevel=-50,this.prtFeatures=[]}function tx(t){h(this,tx),t=t||{},this.id=t.id||0,this.level=t.level||0,this.key=t.key||"",this.bound=t.bound||null,this.fieldValues=t.fieldValues||[],this.pointList=t.pointList||[],this.clockWise=t.clockWise||[]}function ex(t){h(this,ex),t=t||{},this.geoId=t.geoId||0,this.subId=t.subId||0,this.bClockWise=!1!==t.bClockWise,this.ptArray=t.ptArray||[],this.bound=t.bound||null,this.ptIdx=t.ptIdx||new Array(2),this.fieldValues=t.fieldValues||[]}function nx(){h(this,nx),this.nodeLevel=-50,this.boundleLevel=-50,this.nodeFeatures=[],this.boundleFeatures=[]}var ix=(c(rx,[{key:"getZoomInValue",value:function(t){return Math.pow(2,this.nBitLvl-t)}},{key:"getDiff",value:function(t){return this.getZoomInValue(this.nBitLvl+t)}},{key:"getScale",value:function(t){return this.getZoomInValue(this.nBitLvl-t)}}]),rx);function rx(){h(this,rx),this.nBitLvl=30}function ox(t){return t<=0?0:t===1/0?30:parseInt(Math.log(t)/Math.log(2))+(t<1?-1:0)}function sx(t){var e=Math.max(t.width(),t.height());return 0===e?30:ox(1/e)}var ax=(c(ux,[{key:"buildIndex",value:function(){if(this.keys=[],this.bounds&&this.bounds.isValid()&&0<this.size)for(var t=this.bounds.getWidth(),e=this.bounds.getHeight(),n=t/this.size,i=e/this.size,r=this.bounds.getLeft(),o=this.bounds.getBottom(),s=0;s<this.size;s++){for(var a=new Array,u=0;u<this.size;u++){var l=new I_({left:r+s*n,bottom:o+u*i,right:r+(s+1)*n,top:o+(u+1)*i});a.push({bounds:l,values:[]})}this.keys.push(a)}}},{key:"insert",value:function(t,e){var n=this.find(e);if(n&&0<n.length&&t){for(var i=n?n.length:0,r=0;r<i;r++){var o=n[r].x,s=n[r].y,a=this.keys[o][s].values;a&&a.indexOf(t)<0||(this.keys[o][s].values=[]),this.keys[o][s].values.push(t)}return!0}return!1}},{key:"remove",value:function(t,e){var n=this.find(e);if(n&&0<n.length&&t)for(var i=n?n.length:0,r=0;r<i;r++){var o=n[r].x,s=n[r].y,a=this.keys[o][s].values,u=a&&a.indexOf(t);0<=u&&this.keys[o][s].values.splice(u,1)}}},{key:"find",value:function(t){var e=[];if(t){var n=t.getLeft(),i=t.getRight(),r=t.getTop(),o=t.getTop(),s=n==i&&r==o,a=this.keys?this.keys.length:0,u=!1,l=null;s&&(l=new B.Point(n,r));for(var h=0;h<a;h++){for(var c=this.keys[h]?this.keys[h].length:0,p=0;p<c;p++){var f=this.keys[h][p].bounds;if(f&&(u=s?f.containsPoint(l):t.isIntersect2(f))&&(e.push({x:h,y:p}),s))break}if(u&&s)break}}return e}},{key:"getObjects",value:function(t){var e=this.find(t),n=[];if(e&&0<e.length)for(var i=e?e.length:0,r=0;r<i;r++){var o=e[r].x,s=e[r].y,a=this.keys[o][s].values;a&&0<a.length&&(n=n.concat(a))}var u=this.unique(n);return u&&u.sort(this._compare),u}},{key:"unique",value:function(t){if(!t)return[];for(var e=[],n=0,i=t.length;n<i;n++){for(var r=n+1;r<i;r++)t[n]==t[r]&&++n;e.push(t[n])}return e}},{key:"_compare",value:function(t,e){return t&&e?t<0?0<=e?1:t<e?1:-1:0<=e?t<e?-1:1:-1:0}},{key:"clear",value:function(){this.bounds={},this.size=100,this.keys=[]}}]),ux);function ux(t){h(this,ux),this.bounds=t.bounds?t.bounds:{},this.size=t.size&&0<t.size?t.size:100,this.keys=[]}var lx="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function hx(t,e){return t(e={exports:{}},e.exports),e.exports}hx(function(O,T){!function(t){var e=T&&!T.nodeType&&T,n=O&&!O.nodeType&&O,i="object"==typeof lx&&lx;i.global!==i&&i.window!==i&&i.self!==i||(t=i);var r,o,_=2147483647,m=36,v=1,b=26,s=38,a=700,x=72,E=128,I="-",u=/^xn--/,l=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=m-v,L=Math.floor,w=String.fromCharCode;function S(t){throw RangeError(c[t])}function f(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function d(t,e){var n=t.split("@"),i="";return 1<n.length&&(i=n[0]+"@",t=n[1]),i+f((t=t.replace(h,".")).split("."),e).join(".")}function M(t){for(var e,n,i=[],r=0,o=t.length;r<o;)55296<=(e=t.charCodeAt(r++))&&e<=56319&&r<o?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}function C(t){return f(t,function(t){var e="";return 65535<t&&(e+=w((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=w(t)}).join("")}function P(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function N(t,e,n){var i=0;for(t=n?L(t/a):t>>1,t+=L(t/e);p*b>>1<t;i+=m)t=L(t/p);return L(i+(p+1)*t/(t+s))}function g(t){var e,n,i,r,o,s,a,u,l,h,c,p=[],f=t.length,d=0,g=E,y=x;for((n=t.lastIndexOf(I))<0&&(n=0),i=0;i<n;++i)128<=t.charCodeAt(i)&&S("not-basic"),p.push(t.charCodeAt(i));for(r=0<n?n+1:0;r<f;){for(o=d,s=1,a=m;f<=r&&S("invalid-input"),c=t.charCodeAt(r++),(m<=(u=c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:m)||u>L((_-d)/s))&&S("overflow"),d+=u*s,!(u<(l=a<=y?v:y+b<=a?b:a-y));a+=m)s>L(_/(h=m-l))&&S("overflow"),s*=h;y=N(d-o,e=p.length+1,0==o),L(d/e)>_-g&&S("overflow"),g+=L(d/e),d%=e,p.splice(d++,0,g)}return C(p)}function y(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d,g,y=[];for(p=(t=M(t)).length,e=E,o=x,s=n=0;s<p;++s)(c=t[s])<128&&y.push(w(c));for(i=r=y.length,r&&y.push(I);i<p;){for(a=_,s=0;s<p;++s)e<=(c=t[s])&&c<a&&(a=c);for(a-e>L((_-n)/(f=i+1))&&S("overflow"),n+=(a-e)*f,e=a,s=0;s<p;++s)if((c=t[s])<e&&++n>_&&S("overflow"),c==e){for(u=n,l=m;!(u<(h=l<=o?v:o+b<=l?b:l-o));l+=m)g=u-h,d=m-h,y.push(w(P(h+g%d,0))),u=L(g/d);y.push(w(P(u,0))),o=N(n,f,i==r),n=0,++i}++n,++e}return y.join("")}if(r={version:"1.3.2",ucs2:{decode:M,encode:C},decode:g,encode:y,toASCII:function(t){return d(t,function(t){return l.test(t)?"xn--"+y(t):t})},toUnicode:function(t){return d(t,function(t){return u.test(t)?g(t.slice(4).toLowerCase()):t})}},e&&n)if(O.exports==e)n.exports=r;else for(o in r)r.hasOwnProperty(o)&&(e[o]=r[o]);else t.punycode=r}(lx)});function cx(t,e,n,i){e=e||"&",n=n||"=";var r={};if("string"!=typeof t||0===t.length)return r;var o=/\+/g;t=t.split(e);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var a,u,l=t.length;0<s&&s<l&&(l=s);for(var h=0;h<l;++h){var c,p,f,d,g=t[h].replace(o,"%20"),y=g.indexOf(n);p=0<=y?(c=g.substr(0,y),g.substr(y+1)):(c=g,""),f=decodeURIComponent(c),d=decodeURIComponent(p),a=r,u=f,Object.prototype.hasOwnProperty.call(a,u)?Array.isArray(r[f])?r[f].push(d):r[f]=[r[f],d]:r[f]=d}return r}function px(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function fx(n,i,r,t){return i=i||"&",r=r||"=",null===n&&(n=void 0),"object"==typeof n?Object.keys(n).map(function(t){var e=encodeURIComponent(px(t))+r;return Array.isArray(n[t])?n[t].map(function(t){return e+encodeURIComponent(px(t))}).join(i):e+encodeURIComponent(px(n[t]))}).join(i):t?encodeURIComponent(px(t))+r+encodeURIComponent(px(n)):""}var dx,gx=hx(function(t,e){e.decode=e.parse=cx,e.encode=e.stringify=fx}),yx=(gx.decode,gx.parse,gx.encode,gx.stringify,(dx=Error)&&(_x.__proto__=dx),(_x.prototype=Object.create(dx&&dx.prototype)).constructor=_x);function _x(t,e){dx.call(this,e),this.message=e,this.key=t}function mx(t,e){void 0===e&&(e=[]),this.parent=t,this.bindings={};for(var n=0,i=e;n<i.length;n+=1){var r=i[n],o=r[0],s=r[1];this.bindings[o]=s}}mx.prototype.concat=function(t){return new mx(this,t)},mx.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},mx.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var vx={kind:"null"},bx={kind:"number"},xx={kind:"string"},Ex={kind:"boolean"},Ix={kind:"color"},Lx={kind:"object"},wx={kind:"value"},Sx={kind:"collator"},Mx={kind:"formatted"},Cx={kind:"resolvedImage"};function Px(t,e){return{kind:"array",itemType:t,N:e}}function Nx(t){if("array"!==t.kind)return t.kind;var e=Nx(t.itemType);return"number"==typeof t.N?"array<"+e+", "+t.N+">":"value"===t.itemType.kind?"array":"array<"+e+">"}var Ox=[vx,bx,xx,Ex,Ix,Mx,Lx,Px(wx),Cx];function Tx(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Tx(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(var n=0,i=Ox;n<i.length;n+=1){if(!Tx(i[n],e))return null}}return"Expected "+Nx(t)+" but found "+Nx(e)+" instead."}var kx=hx(function(t,e){var f={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function d(t){return(t=Math.round(t))<0?0:255<t?255:t}function n(t){return t<0?0:1<t?1:t}function g(t){return"%"===t[t.length-1]?d(parseFloat(t)/100*255):d(parseInt(t))}function y(t){return"%"===t[t.length-1]?n(parseFloat(t)/100):n(parseFloat(t))}function _(t,e,n){return n<0?n+=1:1<n&&--n,6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{e.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in f)return f[n].slice();if("#"===n[0])return 4===n.length?0<=(e=parseInt(n.substr(1),16))&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&0<=(e=parseInt(n.substr(1),16))&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=n.indexOf("("),r=n.indexOf(")");if(-1!==i&&r+1===n.length){var o=n.substr(0,i),s=n.substr(i+1,r-(i+1)).split(","),a=1;switch(o){case"rgba":if(4!==s.length)return null;a=y(s.pop());case"rgb":return 3!==s.length?null:[g(s[0]),g(s[1]),g(s[2]),a];case"hsla":if(4!==s.length)return null;a=y(s.pop());case"hsl":if(3!==s.length)return null;var u=(parseFloat(s[0])%360+360)%360/360,l=y(s[1]),h=y(s[2]),c=h<=.5?h*(l+1):h+l-h*l,p=2*h-c;return[d(255*_(p,c,u+1/3)),d(255*_(p,c,u)),d(255*_(p,c,u-1/3)),a];default:return null}}return null}}catch(t){}}).parseCSSColor,Rx=function(t,e,n,i){void 0===i&&(i=1),this.r=t,this.g=e,this.b=n,this.a=i};Rx.parse=function(t){if(t){if(t instanceof Rx)return t;if("string"==typeof t){var e=kx(t);if(e)return new Rx(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},Rx.prototype.toString=function(){var t=this.toArray(),e=t[0],n=t[1],i=t[2],r=t[3];return"rgba("+Math.round(e)+","+Math.round(n)+","+Math.round(i)+","+r+")"},Rx.prototype.toArray=function(){var t=this.r,e=this.g,n=this.b,i=this.a;return 0===i?[0,0,0,0]:[255*t/i,255*e/i,255*n/i,i]},Rx.black=new Rx(0,0,0,1),Rx.white=new Rx(1,1,1,1),Rx.transparent=new Rx(0,0,0,0),Rx.red=new Rx(1,0,0,1);var Dx=function(t,e,n){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Dx.prototype.compare=function(t,e){return this.collator.compare(t,e)},Dx.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};function Ax(t,e,n,i,r){this.text=t,this.image=e,this.scale=n,this.fontStack=i,this.textColor=r}var Fx=function(t){this.sections=t};Fx.fromString=function(t){return new Fx([new Ax(t,null,null,null,null)])},Fx.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some(function(t){return 0!==t.text.length||t.image&&0!==t.image.name.length})},Fx.factory=function(t){return t instanceof Fx?t:Fx.fromString(t)},Fx.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map(function(t){return t.text}).join("")},Fx.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];if(i.image)t.push(["image",i.image.name]);else{t.push(i.text);var r={};i.fontStack&&(r["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(r["font-scale"]=i.scale),i.textColor&&(r["text-color"]=["rgba"].concat(i.textColor.toArray())),t.push(r)}}return t};var Bx=function(t){this.name=t.name,this.available=t.available};function Gx(t,e,n,i){return"number"==typeof t&&0<=t&&t<=255&&"number"==typeof e&&0<=e&&e<=255&&"number"==typeof n&&0<=n&&n<=255?void 0===i||"number"==typeof i&&0<=i&&i<=1?null:"Invalid rgba value ["+[t,e,n,i].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof i?[t,e,n,i]:[t,e,n]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ux(t){if(null===t)return vx;if("string"==typeof t)return xx;if("boolean"==typeof t)return Ex;if("number"==typeof t)return bx;if(t instanceof Rx)return Ix;if(t instanceof Dx)return Sx;if(t instanceof Fx)return Mx;if(t instanceof Bx)return Cx;if(Array.isArray(t)){for(var e,n=t.length,i=0,r=t;i<r.length;i+=1){var o=Ux(r[i]);if(e){if(e===o)continue;e=wx;break}e=o}return Px(e||wx,n)}return Lx}function jx(t){var e=typeof t;return null===t?"":"string"==e||"number"==e||"boolean"==e?String(t):t instanceof Rx||t instanceof Fx||t instanceof Bx?t.toString():JSON.stringify(t)}Bx.prototype.toString=function(){return this.name},Bx.fromString=function(t){return new Bx({name:t,available:!1})},Bx.prototype.serialize=function(){return["image",this.name]};var qx=function(t,e){this.type=t,this.value=e};qx.parse=function(t,e){if(2!==t.length)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!function t(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Rx)return!0;if(e instanceof Dx)return!0;if(e instanceof Fx)return!0;if(e instanceof Bx)return!0;if(Array.isArray(e)){for(var n=0,i=e;n<i.length;n+=1)if(!t(i[n]))return!1;return!0}if("object"!=typeof e)return!1;for(var r in e)if(!t(e[r]))return!1;return!0}(t[1]))return e.error("invalid value");var n=t[1],i=Ux(n),r=e.expectedType;return"array"!==i.kind||0!==i.N||!r||"array"!==r.kind||"number"==typeof r.N&&0!==r.N||(i=r),new qx(i,n)},qx.prototype.evaluate=function(){return this.value},qx.prototype.eachChild=function(){},qx.prototype.possibleOutputs=function(){return[this.value]},qx.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Rx?["rgba"].concat(this.value.toArray()):this.value instanceof Fx?this.value.serialize():this.value};function zx(t){this.name="ExpressionEvaluationError",this.message=t}zx.prototype.toJSON=function(){return this.message};var Vx={string:xx,number:bx,boolean:Ex,object:Lx},Yx=function(t,e){this.type=t,this.args=e};Yx.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n,i=1,r=t[0];if("array"===r){var o,s;if(2<t.length){var a=t[1];if("string"!=typeof a||!(a in Vx)||"object"===a)return e.error('The item type argument of "array" must be one of string, number, boolean',1);o=Vx[a],i++}else o=wx;if(3<t.length){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);s=t[2],i++}n=Px(o,s)}else n=Vx[r];for(var u=[];i<t.length;i++){var l=e.parse(t[i],i,wx);if(!l)return null;u.push(l)}return new Yx(n,u)},Yx.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var n=this.args[e].evaluate(t);if(!Tx(this.type,Ux(n)))return n;if(e===this.args.length-1)throw new zx("Expected value to be of type "+Nx(this.type)+", but found "+Nx(Ux(n))+" instead.")}return null},Yx.prototype.eachChild=function(t){this.args.forEach(t)},Yx.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},Yx.prototype.serialize=function(){var t=this.type,e=[t.kind];if("array"===t.kind){var n=t.itemType;if("string"===n.kind||"number"===n.kind||"boolean"===n.kind){e.push(n.kind);var i=t.N;("number"==typeof i||1<this.args.length)&&e.push(i)}}return e.concat(this.args.map(function(t){return t.serialize()}))};function Hx(t){this.type=Mx,this.sections=t}Hx.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[1];if(!Array.isArray(n)&&"object"==typeof n)return e.error("First argument must be an image or text section.");for(var i=[],r=!1,o=1;o<=t.length-1;++o){var s=t[o];if(r&&"object"==typeof s&&!Array.isArray(s)){r=!1;var a=null;if(s["font-scale"]&&!(a=e.parse(s["font-scale"],1,bx)))return null;var u=null;if(s["text-font"]&&!(u=e.parse(s["text-font"],1,Px(xx))))return null;var l=null;if(s["text-color"]&&!(l=e.parse(s["text-color"],1,Ix)))return null;var h=i[i.length-1];h.scale=a,h.font=u,h.textColor=l}else{var c=e.parse(t[o],1,wx);if(!c)return null;var p=c.type.kind;if("string"!==p&&"value"!==p&&"null"!==p&&"resolvedImage"!==p)return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");r=!0,i.push({content:c,scale:null,font:null,textColor:null})}}return new Hx(i)},Hx.prototype.evaluate=function(n){return new Fx(this.sections.map(function(t){var e=t.content.evaluate(n);return Ux(e)===Cx?new Ax("",e,null,null,null):new Ax(jx(e),null,t.scale?t.scale.evaluate(n):null,t.font?t.font.evaluate(n).join(","):null,t.textColor?t.textColor.evaluate(n):null)}))},Hx.prototype.eachChild=function(t){for(var e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t(i.content),i.scale&&t(i.scale),i.font&&t(i.font),i.textColor&&t(i.textColor)}},Hx.prototype.possibleOutputs=function(){return[void 0]},Hx.prototype.serialize=function(){for(var t=["format"],e=0,n=this.sections;e<n.length;e+=1){var i=n[e];t.push(i.content.serialize());var r={};i.scale&&(r["font-scale"]=i.scale.serialize()),i.font&&(r["text-font"]=i.font.serialize()),i.textColor&&(r["text-color"]=i.textColor.serialize()),t.push(r)}return t};function Xx(t){this.type=Cx,this.input=t}Xx.parse=function(t,e){if(2!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,xx);return n?new Xx(n):e.error("No image name provided.")},Xx.prototype.evaluate=function(t){var e=this.input.evaluate(t),n=!1;return t.availableImages&&-1<t.availableImages.indexOf(e)&&(n=!0),new Bx({name:e,available:n})},Xx.prototype.eachChild=function(t){t(this.input)},Xx.prototype.possibleOutputs=function(){return[void 0]},Xx.prototype.serialize=function(){return["image",this.input.serialize()]};var Jx={"to-boolean":Ex,"to-color":Ix,"to-number":bx,"to-string":xx},Wx=function(t,e){this.type=t,this.args=e};Wx.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var n=t[0];if(("to-boolean"===n||"to-string"===n)&&2!==t.length)return e.error("Expected one argument.");for(var i=Jx[n],r=[],o=1;o<t.length;o++){var s=e.parse(t[o],o,wx);if(!s)return null;r.push(s)}return new Wx(i,r)},Wx.prototype.evaluate=function(t){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(t));if("color"===this.type.kind){for(var e,n,i=0,r=this.args;i<r.length;i+=1){if(n=null,(e=r[i].evaluate(t))instanceof Rx)return e;if("string"==typeof e){var o=t.parseColor(e);if(o)return o}else if(Array.isArray(e)&&!(n=e.length<3||4<e.length?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":Gx(e[0],e[1],e[2],e[3])))return new Rx(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new zx(n||"Could not parse color from value '"+("string"==typeof e?e:String(JSON.stringify(e)))+"'")}if("number"!==this.type.kind)return"formatted"===this.type.kind?Fx.fromString(jx(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?Bx.fromString(jx(this.args[0].evaluate(t))):jx(this.args[0].evaluate(t));for(var s=null,a=0,u=this.args;a<u.length;a+=1){if(null===(s=u[a].evaluate(t)))return 0;var l=Number(s);if(!isNaN(l))return l}throw new zx("Could not convert "+JSON.stringify(s)+" to number.")},Wx.prototype.eachChild=function(t){this.args.forEach(t)},Wx.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},Wx.prototype.serialize=function(){if("formatted"===this.type.kind)return new Hx([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Xx(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};function Kx(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null}var Zx=["Unknown","Point","LineString","Polygon"];Kx.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Kx.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?Zx[this.feature.type]:this.feature.type:null},Kx.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Kx.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e=e||(this._parseColorCache[t]=Rx.parse(t))};var Qx=function(t,e,n,i){this.name=t,this.type=e,this._evaluate=n,this.args=i};Qx.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Qx.prototype.eachChild=function(t){this.args.forEach(t)},Qx.prototype.possibleOutputs=function(){return[void 0]},Qx.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Qx.parse=function(n,t){var e,i=n[0],r=Qx.definitions[i];if(!r)return t.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0);for(var o=Array.isArray(r)?r[0]:r.type,s=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,a=s.filter(function(t){var e=t[0];return!Array.isArray(e)||e.length===n.length-1}),u=null,l=0,h=a;l<h.length;l+=1){var c=h[l],p=c[0],f=c[1];u=new iE(t.registry,t.path,null,t.scope);for(var d=[],g=!1,y=1;y<n.length;y++){var _=n[y],m=Array.isArray(p)?p[y-1]:p.type,v=u.parse(_,1+d.length,m);if(!v){g=!0;break}d.push(v)}if(!g)if(Array.isArray(p)&&p.length!==d.length)u.error("Expected "+p.length+" arguments, but found "+d.length+" instead.");else{for(var b=0;b<d.length;b++){var x=Array.isArray(p)?p[b]:p.type,E=d[b];u.concat(b+1).checkSubtype(x,E.type)}if(0===u.errors.length)return new Qx(i,o,f,d)}}if(1===a.length)(e=t.errors).push.apply(e,u.errors);else{for(var I=(a.length?a:s).map(function(t){var e,n=t[0];return e=n,Array.isArray(e)?"("+e.map(Nx).join(", ")+")":"("+Nx(e.type)+"...)"}).join(" | "),L=[],w=1;w<n.length;w++){var S=t.parse(n[w],1+L.length);if(!S)return null;L.push(Nx(S.type))}t.error("Expected arguments of type "+I+", but found ("+L.join(", ")+") instead.")}return null},Qx.register=function(t,e){for(var n in Qx.definitions=e)t[n]=Qx};var $x=function(t,e,n){this.type=Sx,this.locale=n,this.caseSensitive=t,this.diacriticSensitive=e};function tE(t){if(t instanceof Qx){if("get"===t.name&&1===t.args.length)return!1;if("feature-state"===t.name)return!1;if("has"===t.name&&1===t.args.length)return!1;if("properties"===t.name||"geometry-type"===t.name||"id"===t.name)return!1;if(/^filter-/.test(t.name))return!1}var e=!0;return t.eachChild(function(t){e&&!tE(t)&&(e=!1)}),e}function eE(t,e){if(t instanceof Qx&&0<=e.indexOf(t.name))return!1;var n=!0;return t.eachChild(function(t){n&&!eE(t,e)&&(n=!1)}),n}$x.parse=function(t,e){if(2!==t.length)return e.error("Expected one argument.");var n=t[1];if("object"!=typeof n||Array.isArray(n))return e.error("Collator options argument must be an object.");var i=e.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,Ex);if(!i)return null;var r=e.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,Ex);if(!r)return null;var o=null;return n.locale&&!(o=e.parse(n.locale,1,xx))?null:new $x(i,r,o)},$x.prototype.evaluate=function(t){return new Dx(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},$x.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},$x.prototype.possibleOutputs=function(){return[void 0]},$x.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var nE=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};nE.parse=function(t,e){if(2!==t.length||"string"!=typeof t[1])return e.error("'var' expression requires exactly one string literal argument.");var n=t[1];return e.scope.has(n)?new nE(n,e.scope.get(n)):e.error('Unknown variable "'+n+'". Make sure "'+n+'" has been bound in an enclosing "let" expression before using it.',1)},nE.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},nE.prototype.eachChild=function(){},nE.prototype.possibleOutputs=function(){return[void 0]},nE.prototype.serialize=function(){return["var",this.name]};var iE=function(t,e,n,i,r){void 0===e&&(e=[]),void 0===i&&(i=new mx),void 0===r&&(r=[]),this.registry=t,this.path=e,this.key=e.map(function(t){return"["+t+"]"}).join(""),this.scope=i,this.errors=r,this.expectedType=n};function rE(t,e){for(var n,i,r=t.length-1,o=0,s=r,a=0;o<=s;)if(n=t[a=Math.floor((o+s)/2)],i=t[a+1],n<=e){if(a===r||e<i)return a;o=a+1}else{if(!(e<n))throw new zx("Input is not a number.");s=a-1}return 0}iE.prototype.parse=function(t,e,n,i,r){return void 0===r&&(r={}),e?this.concat(e,n,i)._parse(t,r):this._parse(t,r)},iE.prototype._parse=function(t,e){function n(t,e,n){return"assert"===n?new Yx(e,[t]):"coerce"===n?new Wx(e,[t]):t}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var i=t[0];if("string"!=typeof i)return this.error("Expression name must be a string, but found "+typeof i+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var r=this.registry[i];if(r){var o=r.parse(t,this);if(!o)return null;if(this.expectedType){var s=this.expectedType,a=o.type;if("string"!==s.kind&&"number"!==s.kind&&"boolean"!==s.kind&&"object"!==s.kind&&"array"!==s.kind||"value"!==a.kind)if("color"!==s.kind&&"formatted"!==s.kind&&"resolvedImage"!==s.kind||"value"!==a.kind&&"string"!==a.kind){if(this.checkSubtype(s,a))return null}else o=n(o,s,e.typeAnnotation||"coerce");else o=n(o,s,e.typeAnnotation||"assert")}if(!(o instanceof qx)&&"resolvedImage"!==o.type.kind&&function e(t){{if(t instanceof nE)return e(t.boundExpression);if(t instanceof Qx&&"error"===t.name)return!1;if(t instanceof $x)return!1}var n=t instanceof Wx||t instanceof Yx;var i=!0;t.eachChild(function(t){i=n?i&&e(t):i&&t instanceof qx});if(!i)return!1;return tE(t)&&eE(t,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(o)){var u=new Kx;try{o=new qx(o.type,o.evaluate(u))}catch(t){return this.error(t.message),null}}return o}return this.error('Unknown expression "'+i+'". If you wanted a literal array, use ["literal", [...]].',0)}return void 0===t?this.error("'undefined' value invalid. Use null instead."):"object"==typeof t?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof t+" instead.")},iE.prototype.concat=function(t,e,n){var i="number"==typeof t?this.path.concat(t):this.path,r=n?this.scope.concat(n):this.scope;return new iE(this.registry,i,e||null,r,this.errors)},iE.prototype.error=function(t){for(var e=[],n=arguments.length-1;0<n--;)e[n]=arguments[n+1];var i=""+this.key+e.map(function(t){return"["+t+"]"}).join("");this.errors.push(new yx(i,t))},iE.prototype.checkSubtype=function(t,e){var n=Tx(t,e);return n&&this.error(n),n};function oE(t,e,n){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var i=0,r=n;i<r.length;i+=1){var o=r[i],s=o[0],a=o[1];this.labels.push(s),this.outputs.push(a)}}oE.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var n=e.parse(t[1],1,bx);if(!n)return null;var i=[],r=null;e.expectedType&&"value"!==e.expectedType.kind&&(r=e.expectedType);for(var o=1;o<t.length;o+=2){var s=1===o?-1/0:t[o],a=t[o+1],u=o,l=o+1;if("number"!=typeof s)return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',u);if(i.length&&i[i.length-1][0]>=s)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',u);var h=e.parse(a,l,r);if(!h)return null;r=r||h.type,i.push([s,h])}return new oE(r,n,i)},oE.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;return i>=e[r-1]?n[r-1].evaluate(t):n[rE(e,i)].evaluate(t)},oE.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1){t(n[e])}},oE.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}))},oE.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)0<e&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var sE=aE;function aE(t,e,n,i){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=i,this.p2x=n,this.p2y=i}function uE(t,e,n){return t*(1-n)+e*n}aE.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},aE.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},aE.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},aE.prototype.solveCurveX=function(t,e){var n,i,r,o,s;for(void 0===e&&(e=1e-6),r=t,s=0;s<8;s++){if(o=this.sampleCurveX(r)-t,Math.abs(o)<e)return r;var a=this.sampleCurveDerivativeX(r);if(Math.abs(a)<1e-6)break;r-=o/a}if((r=t)<(n=0))return n;if((i=1)<r)return i;for(;n<i;){if(o=this.sampleCurveX(r),Math.abs(o-t)<e)return r;o<t?n=r:i=r,r=.5*(i-n)+n}return r},aE.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var lE=Object.freeze({__proto__:null,number:uE,color:function(t,e,n){return new Rx(uE(t.r,e.r,n),uE(t.g,e.g,n),uE(t.b,e.b,n),uE(t.a,e.a,n))},array:function(t,n,i){return t.map(function(t,e){return uE(t,n[e],i)})}}),hE=.95047,cE=1,pE=1.08883,fE=4/29,dE=6/29,gE=3*dE*dE,yE=dE*dE*dE,_E=Math.PI/180,mE=180/Math.PI;function vE(t){return yE<t?Math.pow(t,1/3):t/gE+fE}function bE(t){return dE<t?t*t*t:gE*(t-fE)}function xE(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function EE(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function IE(t){var e=EE(t.r),n=EE(t.g),i=EE(t.b),r=vE((.4124564*e+.3575761*n+.1804375*i)/hE),o=vE((.2126729*e+.7151522*n+.072175*i)/cE);return{l:116*o-16,a:500*(r-o),b:200*(o-vE((.0193339*e+.119192*n+.9503041*i)/pE)),alpha:t.a}}function LE(t){var e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=cE*bE(e),n=hE*bE(n),i=pE*bE(i),new Rx(xE(3.2404542*n-1.5371385*e-.4985314*i),xE(-.969266*n+1.8760108*e+.041556*i),xE(.0556434*n-.2040259*e+1.0572252*i),t.alpha)}function wE(t,e,n,i,r){this.type=t,this.operator=e,this.interpolation=n,this.input=i,this.labels=[],this.outputs=[];for(var o=0,s=r;o<s.length;o+=1){var a=s[o],u=a[0],l=a[1];this.labels.push(u),this.outputs.push(l)}}var SE={forward:IE,reverse:LE,interpolate:function(t,e,n){return{l:uE(t.l,e.l,n),a:uE(t.a,e.a,n),b:uE(t.b,e.b,n),alpha:uE(t.alpha,e.alpha,n)}}},ME={forward:function(t){var e=IE(t),n=e.l,i=e.a,r=e.b,o=Math.atan2(r,i)*mE;return{h:o<0?360+o:o,c:Math.sqrt(i*i+r*r),l:n,alpha:t.a}},reverse:function(t){var e=t.h*_E,n=t.c;return LE({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:(i=t.h,r=e.h,i+n*(180<(o=r-i)||o<-180?o-360*Math.round(o/360):o)),c:uE(t.c,e.c,n),l:uE(t.l,e.l,n),alpha:uE(t.alpha,e.alpha,n)};var i,r,o}};function CE(t,e,n,i){var r=i-n,o=t-n;return 0==r?0:1===e?o/r:(Math.pow(e,o)-1)/(Math.pow(e,r)-1)}wE.interpolationFactor=function(t,e,n,i){var r=0;if("exponential"===t.name)r=CE(e,t.base,n,i);else if("linear"===t.name)r=CE(e,1,n,i);else if("cubic-bezier"===t.name){var o=t.controlPoints;r=new sE(o[0],o[1],o[2],o[3]).solve(CE(e,1,n,i))}return r},wE.parse=function(t,e){var n=t[0],i=t[1],r=t[2],o=t.slice(3);if(!Array.isArray(i)||0===i.length)return e.error("Expected an interpolation type expression.",1);if("linear"===i[0])i={name:"linear"};else if("exponential"===i[0]){var s=i[1];if("number"!=typeof s)return e.error("Exponential interpolation requires a numeric base.",1,1);i={name:"exponential",base:s}}else{if("cubic-bezier"!==i[0])return e.error("Unknown interpolation type "+String(i[0]),1,0);var a=i.slice(1);if(4!==a.length||a.some(function(t){return"number"!=typeof t||t<0||1<t}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);i={name:"cubic-bezier",controlPoints:a}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(r=e.parse(r,2,bx)))return null;var u=[],l=null;"interpolate-hcl"===n||"interpolate-lab"===n?l=Ix:e.expectedType&&"value"!==e.expectedType.kind&&(l=e.expectedType);for(var h=0;h<o.length;h+=2){var c=o[h],p=o[h+1],f=h+3,d=h+4;if("number"!=typeof c)return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',f);if(u.length&&u[u.length-1][0]>=c)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',f);var g=e.parse(p,d,l);if(!g)return null;l=l||g.type,u.push([c,g])}return"number"===l.kind||"color"===l.kind||"array"===l.kind&&"number"===l.itemType.kind&&"number"==typeof l.N?new wE(l,n,i,r,u):e.error("Type "+Nx(l)+" is not interpolatable.")},wE.prototype.evaluate=function(t){var e=this.labels,n=this.outputs;if(1===e.length)return n[0].evaluate(t);var i=this.input.evaluate(t);if(i<=e[0])return n[0].evaluate(t);var r=e.length;if(i>=e[r-1])return n[r-1].evaluate(t);var o=rE(e,i),s=e[o],a=e[o+1],u=wE.interpolationFactor(this.interpolation,i,s,a),l=n[o].evaluate(t),h=n[o+1].evaluate(t);return"interpolate"===this.operator?lE[this.type.kind.toLowerCase()](l,h,u):"interpolate-hcl"===this.operator?ME.reverse(ME.interpolate(ME.forward(l),ME.forward(h),u)):SE.reverse(SE.interpolate(SE.forward(l),SE.forward(h),u))},wE.prototype.eachChild=function(t){t(this.input);for(var e=0,n=this.outputs;e<n.length;e+=1){t(n[e])}},wE.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()}))},wE.prototype.serialize=function(){var t;t="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],n=0;n<this.labels.length;n++)e.push(this.labels[n],this.outputs[n].serialize());return e};function PE(t,e){this.type=t,this.args=e}PE.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var n=null,i=e.expectedType;i&&"value"!==i.kind&&(n=i);for(var r=[],o=0,s=t.slice(1);o<s.length;o+=1){var a=s[o],u=e.parse(a,1+r.length,n,void 0,{typeAnnotation:"omit"});if(!u)return null;n=n||u.type,r.push(u)}var l=i&&r.some(function(t){return Tx(i,t.type)});return new PE(l?wx:n,r)},PE.prototype.evaluate=function(t){for(var e,n=null,i=0,r=0,o=this.args;r<o.length;r+=1){if(i++,(n=o[r].evaluate(t))&&n instanceof Bx&&!n.available&&(e=e||n.name,n=null,i===this.args.length&&(n=e)),null!==n)break}return n},PE.prototype.eachChild=function(t){this.args.forEach(t)},PE.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.args.map(function(t){return t.possibleOutputs()}))},PE.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};function NE(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e}NE.prototype.evaluate=function(t){return this.result.evaluate(t)},NE.prototype.eachChild=function(t){for(var e=0,n=this.bindings;e<n.length;e+=1){t(n[e][1])}t(this.result)},NE.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var n=[],i=1;i<t.length-1;i+=2){var r=t[i];if("string"!=typeof r)return e.error("Expected string, but found "+typeof r+" instead.",i);if(/[^a-zA-Z0-9_]/.test(r))return e.error("Variable names must contain only alphanumeric characters or '_'.",i);var o=e.parse(t[i+1],i+1);if(!o)return null;n.push([r,o])}var s=e.parse(t[t.length-1],t.length-1,e.expectedType,n);return s?new NE(n,s):null},NE.prototype.possibleOutputs=function(){return this.result.possibleOutputs()},NE.prototype.serialize=function(){for(var t=["let"],e=0,n=this.bindings;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];t.push(r,o.serialize())}return t.push(this.result.serialize()),t};function OE(t,e,n){this.type=t,this.index=e,this.input=n}OE.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1,bx),i=e.parse(t[2],2,Px(e.expectedType||wx));if(!n||!i)return null;var r=i.type;return new OE(r.itemType,n,i)},OE.prototype.evaluate=function(t){var e=this.index.evaluate(t),n=this.input.evaluate(t);if(e<0)throw new zx("Array index out of bounds: "+e+" < 0.");if(e>=n.length)throw new zx("Array index out of bounds: "+e+" > "+(n.length-1)+".");if(e!==Math.floor(e))throw new zx("Array index must be an integer, but found "+e+" instead.");return n[e]},OE.prototype.eachChild=function(t){t(this.index),t(this.input)},OE.prototype.possibleOutputs=function(){return[void 0]},OE.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};function TE(t,e){this.type=Ex,this.needle=t,this.haystack=e}TE.parse=function(t,e){if(3!==t.length)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var n,i=e.parse(t[1],1,wx),r=e.parse(t[2],2,wx);return i&&r?"boolean"!==(n=i.type).kind&&"string"!==n.kind&&"number"!==n.kind&&"null"!==n.kind&&"value"!==n.kind?e.error("Expected first argument to be of type boolean, string, number or null, but found "+Nx(i.type)+" instead"):new TE(i,r):null},TE.prototype.evaluate=function(t){var e,n,i=this.needle.evaluate(t),r=this.haystack.evaluate(t);if(!i||!r)return!1;if("boolean"!=typeof(e=i)&&"string"!=typeof e&&"number"!=typeof e)throw new zx("Expected first argument to be of type boolean, string or number, but found "+Nx(Ux(i))+" instead.");if(n=r,!Array.isArray(n)&&"string"!=typeof n)throw new zx("Expected second argument to be of type array or string, but found "+Nx(Ux(r))+" instead.");return 0<=r.indexOf(i)},TE.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},TE.prototype.possibleOutputs=function(){return[!0,!1]},TE.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};function kE(t,e,n,i,r,o){this.inputType=t,this.type=e,this.input=n,this.cases=i,this.outputs=r,this.otherwise=o}kE.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var n,i;e.expectedType&&"value"!==e.expectedType.kind&&(i=e.expectedType);for(var r={},o=[],s=2;s<t.length-1;s+=2){var a=t[s],u=t[s+1];Array.isArray(a)||(a=[a]);var l=e.concat(s);if(0===a.length)return l.error("Expected at least one branch label.");for(var h=0,c=a;h<c.length;h+=1){var p=c[h];if("number"!=typeof p&&"string"!=typeof p)return l.error("Branch labels must be numbers or strings.");if("number"==typeof p&&Math.abs(p)>Number.MAX_SAFE_INTEGER)return l.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof p&&Math.floor(p)!==p)return l.error("Numeric branch labels must be integer values.");if(n){if(l.checkSubtype(n,Ux(p)))return null}else n=Ux(p);if(void 0!==r[String(p)])return l.error("Branch labels must be unique.");r[String(p)]=o.length}var f=e.parse(u,s,i);if(!f)return null;i=i||f.type,o.push(f)}var d=e.parse(t[1],1,wx);if(!d)return null;var g=e.parse(t[t.length-1],t.length-1,i);return g?"value"!==d.type.kind&&e.concat(1).checkSubtype(n,d.type)?null:new kE(n,i,d,r,o,g):null},kE.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(Ux(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},kE.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},kE.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.outputs.map(function(t){return t.possibleOutputs()})).concat(this.otherwise.possibleOutputs())},kE.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],n=[],i={},r=0,o=Object.keys(this.cases).sort();r<o.length;r+=1){var s=o[r];void 0===(c=i[this.cases[s]])?(i[this.cases[s]]=n.length,n.push([this.cases[s],[s]])):n[c][1].push(s)}for(var a=function(t){return"number"===e.inputType.kind?Number(t):t},u=0,l=n;u<l.length;u+=1){var h=l[u],c=h[0],p=h[1];1===p.length?t.push(a(p[0])):t.push(p.map(a)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};function RE(t,e,n){this.type=t,this.branches=e,this.otherwise=n}function DE(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function AE(t,e,n,i){return 0===i.compare(e,n)}function FE(a,u,l){var h="=="!==a&&"!="!==a;return s.parse=function(t,e){if(3!==t.length&&4!==t.length)return e.error("Expected two or three arguments.");var n=t[0],i=e.parse(t[1],1,wx);if(!i)return null;if(!DE(n,i.type))return e.concat(1).error('"'+n+"\" comparisons are not supported for type '"+Nx(i.type)+"'.");var r=e.parse(t[2],2,wx);if(!r)return null;if(!DE(n,r.type))return e.concat(2).error('"'+n+"\" comparisons are not supported for type '"+Nx(r.type)+"'.");if(i.type.kind!==r.type.kind&&"value"!==i.type.kind&&"value"!==r.type.kind)return e.error("Cannot compare types '"+Nx(i.type)+"' and '"+Nx(r.type)+"'.");h&&("value"===i.type.kind&&"value"!==r.type.kind?i=new Yx(r.type,[i]):"value"!==i.type.kind&&"value"===r.type.kind&&(r=new Yx(i.type,[r])));var o=null;if(4===t.length){if("string"!==i.type.kind&&"string"!==r.type.kind&&"value"!==i.type.kind&&"value"!==r.type.kind)return e.error("Cannot use collator to compare non-string types.");if(!(o=e.parse(t[3],3,Sx)))return null}return new s(i,r,o)},s.prototype.evaluate=function(t){var e=this.lhs.evaluate(t),n=this.rhs.evaluate(t);if(h&&this.hasUntypedArgument){var i=Ux(e),r=Ux(n);if(i.kind!==r.kind||"string"!==i.kind&&"number"!==i.kind)throw new zx('Expected arguments for "'+a+'" to be (string, string) or (number, number), but found ('+i.kind+", "+r.kind+") instead.")}if(this.collator&&!h&&this.hasUntypedArgument){var o=Ux(e),s=Ux(n);if("string"!==o.kind||"string"!==s.kind)return u(t,e,n)}return this.collator?l(t,e,n,this.collator.evaluate(t)):u(t,e,n)},s.prototype.eachChild=function(t){t(this.lhs),t(this.rhs),this.collator&&t(this.collator)},s.prototype.possibleOutputs=function(){return[!0,!1]},s.prototype.serialize=function(){var e=[a];return this.eachChild(function(t){e.push(t.serialize())}),e},s;function s(t,e,n){this.type=Ex,this.lhs=t,this.rhs=e,this.collator=n,this.hasUntypedArgument="value"===t.type.kind||"value"===e.type.kind}}RE.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var n;e.expectedType&&"value"!==e.expectedType.kind&&(n=e.expectedType);for(var i=[],r=1;r<t.length-1;r+=2){var o=e.parse(t[r],r,Ex);if(!o)return null;var s=e.parse(t[r+1],r+1,n);if(!s)return null;i.push([o,s]),n=n||s.type}var a=e.parse(t[t.length-1],t.length-1,n);return a?new RE(n,i,a):null},RE.prototype.evaluate=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];if(r.evaluate(t))return o.evaluate(t)}return this.otherwise.evaluate(t)},RE.prototype.eachChild=function(t){for(var e=0,n=this.branches;e<n.length;e+=1){var i=n[e],r=i[0],o=i[1];t(r),t(o)}t(this.otherwise)},RE.prototype.possibleOutputs=function(){var t;return(t=[]).concat.apply(t,this.branches.map(function(t){t[0];return t[1].possibleOutputs()})).concat(this.otherwise.possibleOutputs())},RE.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};function BE(t,e,n,i,r){this.type=xx,this.number=t,this.locale=e,this.currency=n,this.minFractionDigits=i,this.maxFractionDigits=r}var GE=FE("==",function(t,e,n){return e===n},AE),UE=FE("!=",function(t,e,n){return e!==n},function(t,e,n,i){return!AE(0,e,n,i)}),jE=FE("<",function(t,e,n){return e<n},function(t,e,n,i){return i.compare(e,n)<0}),qE=FE(">",function(t,e,n){return n<e},function(t,e,n,i){return 0<i.compare(e,n)}),zE=FE("<=",function(t,e,n){return e<=n},function(t,e,n,i){return i.compare(e,n)<=0}),VE=FE(">=",function(t,e,n){return n<=e},function(t,e,n,i){return 0<=i.compare(e,n)});BE.parse=function(t,e){if(3!==t.length)return e.error("Expected two arguments.");var n=e.parse(t[1],1,bx);if(!n)return null;var i=t[2];if("object"!=typeof i||Array.isArray(i))return e.error("NumberFormat options argument must be an object.");var r=null;if(i.locale&&!(r=e.parse(i.locale,1,xx)))return null;var o=null;if(i.currency&&!(o=e.parse(i.currency,1,xx)))return null;var s=null;if(i["min-fraction-digits"]&&!(s=e.parse(i["min-fraction-digits"],1,bx)))return null;var a=null;return i["max-fraction-digits"]&&!(a=e.parse(i["max-fraction-digits"],1,bx))?null:new BE(n,r,o,s,a)},BE.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},BE.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},BE.prototype.possibleOutputs=function(){return[void 0]},BE.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};function YE(t){this.type=bx,this.input=t}YE.parse=function(t,e){if(2!==t.length)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var n=e.parse(t[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?e.error("Expected argument of type string or array, but found "+Nx(n.type)+" instead."):new YE(n):null},YE.prototype.evaluate=function(t){var e=this.input.evaluate(t);if("string"==typeof e)return e.length;if(Array.isArray(e))return e.length;throw new zx("Expected value to be of type string or array, but found "+Nx(Ux(e))+" instead.")},YE.prototype.eachChild=function(t){t(this.input)},YE.prototype.possibleOutputs=function(){return[void 0]},YE.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var HE={"==":GE,"!=":UE,">":qE,"<":jE,">=":VE,"<=":zE,array:Yx,at:OE,boolean:Yx,case:RE,coalesce:PE,collator:$x,format:Hx,image:Xx,in:TE,interpolate:wE,"interpolate-hcl":wE,"interpolate-lab":wE,length:YE,let:NE,literal:qx,match:kE,number:Yx,"number-format":BE,object:Yx,step:oE,string:Yx,"to-boolean":Wx,"to-color":Wx,"to-number":Wx,"to-string":Wx,var:nE};function XE(t,e){var n=e[0],i=e[1],r=e[2],o=e[3];n=n.evaluate(t),i=i.evaluate(t),r=r.evaluate(t);var s=o?o.evaluate(t):1,a=Gx(n,i,r,s);if(a)throw new zx(a);return new Rx(n/255*s,i/255*s,r/255*s,s)}function JE(t,e){return t in e}function WE(t,e){var n=e[t];return void 0===n?null:n}function KE(t){return{type:t}}Qx.register(HE,{error:[{kind:"error"},[xx],function(t,e){var n=e[0];throw new zx(n.evaluate(t))}],typeof:[xx,[wx],function(t,e){return Nx(Ux(e[0].evaluate(t)))}],"to-rgba":[Px(bx,4),[Ix],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Ix,[bx,bx,bx],XE],rgba:[Ix,[bx,bx,bx,bx],XE],has:{type:Ex,overloads:[[[xx],function(t,e){return JE(e[0].evaluate(t),t.properties())}],[[xx,Lx],function(t,e){var n=e[0],i=e[1];return JE(n.evaluate(t),i.evaluate(t))}]]},get:{type:wx,overloads:[[[xx],function(t,e){return WE(e[0].evaluate(t),t.properties())}],[[xx,Lx],function(t,e){var n=e[0],i=e[1];return WE(n.evaluate(t),i.evaluate(t))}]]},"feature-state":[wx,[xx],function(t,e){return WE(e[0].evaluate(t),t.featureState||{})}],properties:[Lx,[],function(t){return t.properties()}],"geometry-type":[xx,[],function(t){return t.geometryType()}],id:[wx,[],function(t){return t.id()}],zoom:[bx,[],function(t){return t.globals.zoom}],"heatmap-density":[bx,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[bx,[],function(t){return t.globals.lineProgress||0}],accumulated:[wx,[],function(t){return void 0===t.globals.accumulated?null:t.globals.accumulated}],"+":[bx,KE(bx),function(t,e){for(var n=0,i=0,r=e;i<r.length;i+=1){n+=r[i].evaluate(t)}return n}],"*":[bx,KE(bx),function(t,e){for(var n=1,i=0,r=e;i<r.length;i+=1){n*=r[i].evaluate(t)}return n}],"-":{type:bx,overloads:[[[bx,bx],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)-i.evaluate(t)}],[[bx],function(t,e){return-e[0].evaluate(t)}]]},"/":[bx,[bx,bx],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)/i.evaluate(t)}],"%":[bx,[bx,bx],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)%i.evaluate(t)}],ln2:[bx,[],function(){return Math.LN2}],pi:[bx,[],function(){return Math.PI}],e:[bx,[],function(){return Math.E}],"^":[bx,[bx,bx],function(t,e){var n=e[0],i=e[1];return Math.pow(n.evaluate(t),i.evaluate(t))}],sqrt:[bx,[bx],function(t,e){var n=e[0];return Math.sqrt(n.evaluate(t))}],log10:[bx,[bx],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN10}],ln:[bx,[bx],function(t,e){var n=e[0];return Math.log(n.evaluate(t))}],log2:[bx,[bx],function(t,e){var n=e[0];return Math.log(n.evaluate(t))/Math.LN2}],sin:[bx,[bx],function(t,e){var n=e[0];return Math.sin(n.evaluate(t))}],cos:[bx,[bx],function(t,e){var n=e[0];return Math.cos(n.evaluate(t))}],tan:[bx,[bx],function(t,e){var n=e[0];return Math.tan(n.evaluate(t))}],asin:[bx,[bx],function(t,e){var n=e[0];return Math.asin(n.evaluate(t))}],acos:[bx,[bx],function(t,e){var n=e[0];return Math.acos(n.evaluate(t))}],atan:[bx,[bx],function(t,e){var n=e[0];return Math.atan(n.evaluate(t))}],min:[bx,KE(bx),function(e,t){return Math.min.apply(Math,t.map(function(t){return t.evaluate(e)}))}],max:[bx,KE(bx),function(e,t){return Math.max.apply(Math,t.map(function(t){return t.evaluate(e)}))}],abs:[bx,[bx],function(t,e){var n=e[0];return Math.abs(n.evaluate(t))}],round:[bx,[bx],function(t,e){var n=e[0].evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[bx,[bx],function(t,e){var n=e[0];return Math.floor(n.evaluate(t))}],ceil:[bx,[bx],function(t,e){var n=e[0];return Math.ceil(n.evaluate(t))}],"filter-==":[Ex,[xx,wx],function(t,e){var n=e[0],i=e[1];return t.properties()[n.value]===i.value}],"filter-id-==":[Ex,[wx],function(t,e){var n=e[0];return t.id()===n.value}],"filter-type-==":[Ex,[xx],function(t,e){var n=e[0];return t.geometryType()===n.value}],"filter-<":[Ex,[xx,wx],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<o}],"filter-id-<":[Ex,[wx],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<r}],"filter->":[Ex,[xx,wx],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&o<r}],"filter-id->":[Ex,[wx],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&r<i}],"filter-<=":[Ex,[xx,wx],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&r<=o}],"filter-id-<=":[Ex,[wx],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&i<=r}],"filter->=":[Ex,[xx,wx],function(t,e){var n=e[0],i=e[1],r=t.properties()[n.value],o=i.value;return typeof r==typeof o&&o<=r}],"filter-id->=":[Ex,[wx],function(t,e){var n=e[0],i=t.id(),r=n.value;return typeof i==typeof r&&r<=i}],"filter-has":[Ex,[wx],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Ex,[],function(t){return null!==t.id()}],"filter-type-in":[Ex,[Px(xx)],function(t,e){return 0<=e[0].value.indexOf(t.geometryType())}],"filter-id-in":[Ex,[Px(wx)],function(t,e){return 0<=e[0].value.indexOf(t.id())}],"filter-in-small":[Ex,[xx,Px(wx)],function(t,e){var n=e[0];return 0<=e[1].value.indexOf(t.properties()[n.value])}],"filter-in-large":[Ex,[xx,Px(wx)],function(t,e){var n=e[0],i=e[1];return function(t,e,n,i){for(;n<=i;){var r=n+i>>1;if(e[r]===t)return!0;e[r]>t?i=r-1:n=1+r}return!1}(t.properties()[n.value],i.value,0,i.value.length-1)}],all:{type:Ex,overloads:[[[Ex,Ex],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)&&i.evaluate(t)}],[KE(Ex),function(t,e){for(var n=0,i=e;n<i.length;n+=1){if(!i[n].evaluate(t))return!1}return!0}]]},any:{type:Ex,overloads:[[[Ex,Ex],function(t,e){var n=e[0],i=e[1];return n.evaluate(t)||i.evaluate(t)}],[KE(Ex),function(t,e){for(var n=0,i=e;n<i.length;n+=1){if(i[n].evaluate(t))return!0}return!1}]]},"!":[Ex,[Ex],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Ex,[xx],function(t,e){var n=e[0],i=t.globals&&t.globals.isSupportedScript;return!i||i(n.evaluate(t))}],upcase:[xx,[xx],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[xx,[xx],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[xx,KE(wx),function(e,t){return t.map(function(t){return jx(t.evaluate(e))}).join("")}],"resolved-locale":[xx,[Sx],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var ZE=function(t,e){var n;this.expression=t,this._warningHistory={},this._evaluator=new Kx,this._defaultValue=e?"color"===(n=e).type&&function(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}(n.default)?new Rx(0,0,0,0):"color"===n.type?Rx.parse(n.default)||null:void 0===n.default?null:n.default:null,this._enumValues=e&&"enum"===e.type?e.values:null};function QE(t,e){var n,i,r=new iE(HE,[],e?(i={color:Ix,string:xx,number:bx,enum:xx,boolean:Ex,formatted:Mx,resolvedImage:Cx},"array"!==(n=e).type?i[n.type]:Px(i[n.value]||wx,n.length)):void 0),o=r.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return o?{result:"success",value:new ZE(o,e)}:{result:"error",value:r.errors}}ZE.prototype.evaluateWithoutErrorHandling=function(t,e,n,i,r){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=n,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=r,this.expression.evaluate(this._evaluator)};var $E={type:"boolean",default:!(ZE.prototype.evaluate=function(t,e,n,i,r){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=n||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=r||null;try{var o=this.expression.evaluate(this._evaluator);if(null==o||"number"==typeof o&&o!=o)return this._defaultValue;if(this._enumValues&&!(o in this._enumValues))throw new zx("Expected value to be one of "+Object.keys(this._enumValues).map(function(t){return JSON.stringify(t)}).join(", ")+", but found "+JSON.stringify(o)+" instead.");return o}catch(t){return this._warningHistory[t.message]||(this._warningHistory[t.message]=!0,"undefined"!=typeof console&&console.warn(t.message)),this._defaultValue}}),transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function tI(t){if(null==t)return function(){return!0};!function t(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return 2<=e.length&&"$id"!==e[1]&&"$type"!==e[1];case"in":return 3<=e.length&&Array.isArray(e[2]);case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var n=0,i=e.slice(1);n<i.length;n+=1){var r=i[n];if(!t(r)&&"boolean"!=typeof r)return!1}return!0;default:return!0}}(t)&&(t=nI(t));var n=QE(t,$E);if("error"===n.result)throw new Error(n.value.map(function(t){return t.key+": "+t.message}).join(", "));return function(t,e){return n.value.evaluate(t,e)}}function eI(t,e){return t<e?-1:e<t?1:0}function nI(t){if(!t)return!0;var e,n=t[0];return t.length<=1?"any"!==n:"=="===n?iI(t[1],t[2],"=="):"!="===n?sI(iI(t[1],t[2],"==")):"<"===n||">"===n||"<="===n||">="===n?iI(t[1],t[2],n):"any"===n?(e=t.slice(1),["any"].concat(e.map(nI))):"all"===n?["all"].concat(t.slice(1).map(nI)):"none"===n?["all"].concat(t.slice(1).map(nI).map(sI)):"in"===n?rI(t[1],t.slice(2)):"!in"===n?sI(rI(t[1],t.slice(2))):"has"===n?oI(t[1]):"!has"!==n||sI(oI(t[1]))}function iI(t,e,n){switch(t){case"$type":return["filter-type-"+n,e];case"$id":return["filter-id-"+n,e];default:return["filter-"+n,t,e]}}function rI(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return 200<e.length&&!e.some(function(t){return typeof t!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(eI)]]:["filter-in-small",t,["literal",e]]}}function oI(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function sI(t){return["!",t]}var aI;(aI=Error)&&(uI.__proto__=aI),(uI.prototype=Object.create(aI&&aI.prototype)).constructor=uI;function uI(t,e,n,i){aI.call(this,[t,n].filter(function(t){return t}).join(": ")),i&&(this.identifier=i),null!=e&&e.__line__&&(this.line=e.__line__)}var lI;(lI=Error)&&(hI.__proto__=lI),(hI.prototype=Object.create(lI&&lI.prototype)).constructor=hI;function hI(t){lI.call(this,t.message);var e=(this.error=t).message.match(/line (\d+)/);this.line=e?parseInt(e[1],10):0}var cI,pI=hx(function(t,e){var n,i,r,o,s,a,u,l,h,c,p,f,d=(h=[18,22],c=[22,24],p={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(t,e,n,i,r,o){var s=o.length-1;switch(r){case 1:this.$=new String(t.replace(/\\(\\|")/g,"$1").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b")),this.$.__line__=this._$.first_line;break;case 2:this.$=new Number(t),this.$.__line__=this._$.first_line;break;case 3:this.$=null;break;case 4:this.$=new Boolean(!0),this.$.__line__=this._$.first_line;break;case 5:this.$=new Boolean(!1),this.$.__line__=this._$.first_line;break;case 6:return this.$=o[s-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=o[s-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[o[s-2],o[s]];break;case 16:this.$={},this.$[o[s][0]]=o[s][1];break;case 17:this.$=o[s-2],o[s-2][o[s][0]]=o[s][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[o[s]];break;case 21:this.$=o[s-2],o[s-2].push(o[s])}},table:[{3:5,4:n=[1,12],5:6,6:i=[1,13],7:3,8:r=[1,9],9:4,10:o=[1,10],11:s=[1,11],12:1,13:2,15:7,16:8,17:a=[1,14],23:u=[1,15]},{1:[3]},{14:[1,16]},g(l=[14,18,22,24],[2,7]),g(l,[2,8]),g(l,[2,9]),g(l,[2,10]),g(l,[2,11]),g(l,[2,12]),g(l,[2,3]),g(l,[2,4]),g(l,[2,5]),g([14,18,21,22,24],[2,1]),g(l,[2,2]),{3:20,4:n,18:[1,17],19:18,20:19},{3:5,4:n,5:6,6:i,7:3,8:r,9:4,10:o,11:s,13:23,15:7,16:8,17:a,23:u,24:[1,21],25:22},{1:[2,6]},g(l,[2,13]),{18:[1,24],22:[1,25]},g(h,[2,16]),{21:[1,26]},g(l,[2,18]),{22:[1,28],24:[1,27]},g(c,[2,20]),g(l,[2,14]),{3:20,4:n,20:29},{3:5,4:n,5:6,6:i,7:3,8:r,9:4,10:o,11:s,13:30,15:7,16:8,17:a,23:u},g(l,[2,19]),{3:5,4:n,5:6,6:i,7:3,8:r,9:4,10:o,11:s,13:31,15:7,16:8,17:a,23:u},g(h,[2,17]),g(h,[2,15]),g(c,[2,21])],defaultActions:{16:[2,6]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){var e=this,n=[0],i=[null],r=[],o=this.table,s="",a=0,u=0,l=1,h=r.slice.call(arguments,1),c=Object.create(this.lexer),p={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(p.yy[f]=this.yy[f]);c.setInput(t,p.yy),p.yy.lexer=c,p.yy.parser=this,void 0===c.yylloc&&(c.yylloc={});var d=c.yylloc;r.push(d);var g=c.options&&c.options.ranges;"function"==typeof p.yy.parseError?this.parseError=p.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var y,_,m,v,b,x,E,I,L,w,S={};;){if(m=n[n.length-1],void 0===(v=this.defaultActions[m]?this.defaultActions[m]:(null==y&&(w=void 0,"number"!=typeof(w=c.lex()||l)&&(w=e.symbols_[w]||w),y=w),o[m]&&o[m][y]))||!v.length||!v[0]){var M="";for(x in L=[],o[m])this.terminals_[x]&&2<x&&L.push("'"+this.terminals_[x]+"'");M=c.showPosition?"Parse error on line "+(a+1)+":\n"+c.showPosition()+"\nExpecting "+L.join(", ")+", got '"+(this.terminals_[y]||y)+"'":"Parse error on line "+(a+1)+": Unexpected "+(y==l?"end of input":"'"+(this.terminals_[y]||y)+"'"),this.parseError(M,{text:c.match,token:this.terminals_[y]||y,line:c.yylineno,loc:d,expected:L})}if(v[0]instanceof Array&&1<v.length)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+y);switch(v[0]){case 1:n.push(y),i.push(c.yytext),r.push(c.yylloc),n.push(v[1]),y=null,_?(y=_,_=null):(u=c.yyleng,s=c.yytext,a=c.yylineno,d=c.yylloc);break;case 2:if(E=this.productions_[v[1]][1],S.$=i[i.length-E],S._$={first_line:r[r.length-(E||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(E||1)].first_column,last_column:r[r.length-1].last_column},g&&(S._$.range=[r[r.length-(E||1)].range[0],r[r.length-1].range[1]]),void 0!==(b=this.performAction.apply(S,[s,u,a,p.yy,v[1],i,r].concat(h))))return b;E&&(n=n.slice(0,-1*E*2),i=i.slice(0,-1*E),r=r.slice(0,-1*E)),n.push(this.productions_[v[1]][0]),i.push(S.$),r.push(S._$),I=o[n[n.length-2]][n[n.length-1]],n.push(I);break;case 3:return!0}}return!0}},f={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t,e){return this.yy=e||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,n=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(i=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],n=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var o in r)this[o]=r[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,e,n,i;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),o=0;o<r.length;o++)if((n=this._input.match(this.rules[r[o]]))&&(!e||n[0].length>e[0].length)){if(e=n,i=o,this.options.backtrack_lexer){if(!1!==(t=this.test_match(n,r[o])))return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?!1!==(t=this.test_match(e,r[i]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,n){switch(n){case 0:break;case 1:return 6;case 2:return e.yytext=e.yytext.substr(1,e.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}},p.lexer=f,new((y.prototype=p).Parser=y));function g(t,e,n,i){for(n=n||{},i=t.length;i--;n[t[i]]=e);return n}function y(){this.yy={}}e.parser=d,e.Parser=d.Parser,e.parse=function(){return d.parse.apply(d,arguments)}}),fI=(pI.parser,pI.Parser,pI.parse,B.Evented.extend((f(cI={initialize:function(t){B.setOptions(this,t),this.id="",this.name="",this.type=Mm.UNKNOWN,this.version=0,this.fieldInfos=null,this.bounds=null,this.features=[],this.projInfo=null,this.edits=[],this.spatialIndex=null},clone:function(){var t=new fI(this.options);return t.id=this.id,t.name=this.name,t.type=this.type,t.version=this.version,t.fieldInfos=this.fieldInfos,t.bounds=this.bounds,t.projInfo=this.projInfo,t.spatialIndex=this.spatialIndex,t},getType:function(){return this.type},getIntType:function(){var t=0;switch(this.type){case Mm.POINT:t=Sm.POINT;break;case Mm.LINE:t=Sm.LINE;break;case Mm.POLYGON:t=Sm.POLYGON}return t},getID:function(){return this.id},setID:function(t){this.id=t},getBounds:function(){return this.bounds},setBounds:function(t){this.bounds=t},getProjInfo:function(){return this.projInfo},getProj:function(){if(this._proj)return this._proj;var t=null;return this.projInfo&&(t=this.projInfo.createProj()),t},getName:function(){return this.name},getVersion:function(){return this.version},setVersion:function(t){this.version=t},getFieldInfos:function(){return this.fieldInfos},getFieldNames:function(){var e=[];return this.fieldInfos&&this.fieldInfos.forEach(function(t){e.push(t.getName())}),e},setFieldInfos:function(t){this.fieldInfos=t},getFeatures:function(){return this.features},updateFields:function(o){var s=this;this.setFieldInfos(o);var a=o?o.length:0;return this.features&&this.features.forEach(function(t){if(0<a){var e=t.getProperties();if(e){for(var n=s.createEmptyProperties(),i=0;i<a;i++){var r=o[i].getName();r in e&&(n[r]=e[r])}t.setProperties(n)}else t.setProperties(s.createEmptyProperties())}else t.setProperties({})}),!0},getLocalFeaturesIds:function(){var n=[];return this.features&&this.features.forEach(function(t){var e=t.getID();null!=e&&0<=e&&n.push(e)}),n},getLocalFeaturesIdsByBox:function(t,e,n){var i=this,r=[],o=[];this.queryFeaturesByBBoxAndFilters(t,null,r,!1,!0,n);var s=[];return r.forEach(function(t){o.push(t.id),e&&s.push(i.features[t.sIndex])}),e&&(this.features=s),o},_compare:function(t,e){if(t&&e){var n=t.getID(),i=e.getID();return n<0?0<=i?1:n<i?1:-1:0<=i?n<i?-1:1:-1}return 0},compouteBounds2D:function(t){if(t){var e=t,n=e.length;if(0<n){for(var i=0,r=0,o=0,s=0,a=0;a<n;a++)s=0===a?(i=r=e[a][0],o=e[a][1]):(i=Math.min(e[a][0],i),r=Math.max(e[a][0],r),o=Math.max(e[a][1],o),Math.min(e[a][1],s));return new I_({left:i,right:r,top:o,bottom:s})}return null}return null},queryFeatureIdsByNotFilterForCombine:function(){for(var t=[],e=this.features?this.features.length:0,n=0;n<e;n++){var i=this.features[n];i.getEditAction()===C_.DELETE&&0<=i.getID()?t.push(i.getID()):i.getEditAction()===C_.MODIFY&&0<=i.getID()&&t.push(i.getID())}return t},queryFeaturesByFilterNew:function(t){if(!t)return[];for(var e=tI(t),n=[],i=this.features?this.features.length:0,r=0;r<i;r++){var o=this.features[r];if(o.getEditAction()!==C_.UNKNOWN&&o.getEditAction()!==C_.DELETE)e({},{properties:o.getProperties()})&&n.push({geometry:o.getGeometry(),properties:o.getProperties(),type:"Feature",id:o.getID()})}return n},queryFeaturesByFilter:function(t){var e=this;if(null===t||null===t.filter)return[];var n=t.filter,i=t.page_count?t.page_count:5,r=t.page_num?t.page_num:1;(i<=0||50<i)&&(i=5),r<=0&&(r=1);for(var o=[],s=this.features?this.features.length:0,a=0;a<s;a++){var u=this.features[a];if(u.getEditAction()!==C_.DELETE)tI(n)({},{properties:u.getProperties()})&&o.push(a)}var l=o.length,h=[];if(0<l){var c=(r-1)*i,p=r*i,f=o.slice(c,p);f&&f.forEach(function(t){h.push(e.features[t])})}return{total:l,features:h}},queryFeaturesByIndex:function(t){var e=null;return this.spatialIndex&&t&&(e=this.spatialIndex.getObjects(t)),this.getFeaturesByIds(e)},queryFeaturesForDraw:function(t){for(var e=this.features,n=e?e.length:0,i=[],r=0;r<n;r++){var o=e[r];o.getEditAction()!=C_.DELETE&&(i.push(o),t&&t.push({id:o.getID(),sIndex:r}))}return i},queryFeaturesByBBoxAndFilters:function(t,e,n,i,r,o){var s=[];if(t&&!t.isNull()){t.toGeometry();for(var a=t.toPolygon(),u=this.features,l=u?u.length:0,h=new I_,c=0;c<l;c++){var p=u[c];if(r&&p.getEditAction()!=C_.UNKNOWN)n&&n.push({id:p.getID(),sIndex:c});else if(r&&p.getEditAction()!=C_.DELETE&&o&&0<o.length&&0<=o.indexOf(p.getID()))n&&n.push({id:p.getID(),sIndex:c});else{if(p.getEditAction()!=C_.DELETE){var f=!1;switch(p.getType()){case M_.POINT:f=E_.booleanContains(a,p.getGeometry());break;case M_.MULTIPOINT:for(var d=p.getCoordinates(),g=0,y=d.length;g<y&&!(f=E_.booleanContains(a,E_.point(d[g])));g++);break;case M_.LINE:var _=p.getBounds();if(t.containsBounds(_)){f=!0;break}if(!h.intersectRect(t,_))break;f=E_.booleanCrosses(a,p.getGeometry());break;case M_.MULTILINE:var m=p.getBounds();if(t.containsBounds(m)){f=!0;break}if(!h.intersectRect(t,m))break;for(var v=P_.createLinesFromMultiLine(p.getGeometry()),b=v?v.length:0,x=0;x<b&&!(f=E_.booleanCrosses(a,v[x]));x++);break;case M_.POLYGON:var E=p.getBounds();if(t.containsBounds(E)){f=!0;break}if(!h.intersectRect(t,E))break;if(E.containsBounds(t)&&E_.booleanContains(p.getGeometry(),a)){f=!0;break}f=E_.booleanOverlap(a,p.getGeometry());break;case M_.MULTIPOLYGON:var I=p.getBounds();if(t.containsBounds(I)){f=!0;break}if(!h.intersectRect(t,I))break;for(var L=P_.createPolygonFromMultiPolygon(p.getGeometry()),w=L?L.length:0,S=0;S<w;S++){var M=P_.createGeoJSONFeatureFromGeoJSON({type:"Feature",geometry:L[S]});if(M){var C=M.getBounds();if(t.containsBounds(C)){f=!0;break}if(h.intersectRect(t,C)){var P=M.getGeometry();if(C.containsBounds(t)&&E_.booleanContains(P,a)){f=!0;break}f=E_.booleanOverlap(a,P)}if(f)break}}}if(f)if(e)tI(e)({},{properties:p.getProperties()})&&(s.push(p),n&&n.push({id:p.getID(),sIndex:c}));else s.push(p),n&&n.push({id:p.getID(),sIndex:c})}if(i&&1==s.length)break}}}return s},selectByPoint:function(t,e){return this.queryFeaturesByBBoxAndFilters(t,e,null,!0)},syncProperties:function(t){var e=this.fieldInfos,n=e?e.length:0;if(0<n){if(t){for(var i=this.createEmptyProperties(),r=0;r<n;r++){var o=e[r].getName();S_.isSysField(o)||o in t&&(i[o]=t[o])}return i}return this.createEmptyProperties()}return{}},updateRecordset:function(t){var i=this;if(!t||0==t.length)return!1;var r=null;this._proj?r=this._proj:this.getProjInfo()&&(r=this.getProjInfo().createProj(),this._proj=r),t.forEach(function(t){var e=P_.createGeoJSONFeatureFromAttributes(t);if(e){e.setProjInfo(i.projInfo),e.setProj(r),e.setID(t.gid);var n=i.syncProperties(t);e.setProperties(n),i.features||(i.features=[]),i.features.push(e)}}),this.features.sort(this._compare)},readJson:function(t){if(t&&(this.id=void 0!==t.id?t.id:null,this.name=t.name?t.name:"",t.bounds&&(this.bounds=new I_,this.bounds.readJson(t.bounds)),t.srs&&(this.projInfo=new Ob,this.projInfo.readJson(t.srs)),this.version=void 0!==t.version?t.version:0,this.type=t.type?t.type:Mm.UNKNOWN,t.fields&&0<t.fields.length)){this.fieldInfos=[];for(var e=t.fields,n=e.length,i=0;i<n;i++){var r=e[i];if(r){var o=new Nb;o.readJson(r),this.fieldInfos.push(o)}}}},getFieldInfo:function(t){if(!t)return null;var e=null;if(this.fieldInfos&&0<this.fieldInfos.length){t=t.toLowerCase();for(var n=this.fieldInfos.length,i=0;i<n;i++){var r=this.fieldInfos[i];if(null!==r&&r.getName().toLowerCase()===t){e=r;break}}}return e}},"getFieldNames",function(){if(!this.fieldInfos||0===this.fieldInfos.length)return null;for(var t=this.fieldInfos.length,e=[],n=0;n<t;n++){var i=this.fieldInfos[n];i&&e.push(i.getName())}return e}),f(cI,"getlatLngBounds",function(){return this.bounds?this.bounds.toLatLngBounds(this.projInfo):null}),f(cI,"clearData",function(t){if(t)for(var e=(this.features?this.features.length:0)-1;0<=e;e--)this.features[e].getEditAction()==C_.UNKNOWN&&this.features.splice(e,1);else this.features=[]}),f(cI,"getFeaturesByIds",function(t){var n=this,i=this.features?this.features.length:0,r=[];return t&&t.forEach(function(t){for(var e=0;e<i;e++)n.features[e].getID()==t&&r.push(n.features[e])}),r}),f(cI,"getFeatureByIndex",function(t){var e=this.features?this.features.length:0;return 0<=t&&0<e&&t<e?this.features[t]:null}),f(cI,"getFeatureById",function(t){for(var e=this.features?this.features.length:0,n=0;n<e;n++)if(this.features[n].getID()===t)return this.features[n];return null}),f(cI,"getFeatureById",function(t){for(var e=this.features?this.features.length:0,n=0;n<e;n++)if(this.features[n].getID()===t)return this.features[n];return null}),f(cI,"getFeatureIndexById",function(t){for(var e=this.features?this.features.length:0,n=0;n<e;n++)if(this.features[n].getID()===t)return n;return-1}),f(cI,"updateBounds",function(t){t&&t.getBounds()&&(this.bounds?-1==this.bounds.getRight()&&0==this.bounds.getLeft()&&this.bounds.getRight()<this.bounds.getLeft()?this.bounds=t.getBounds():this.bounds.add(t.getBounds()):this.bounds=t.getBounds())}),f(cI,"addFeature",function(t){var e=null;if(t&&"Feature"===t.type&&t.geometry){var n=t.geometry.type.toUpperCase();this.type===Mm.POINT?n!==R_&&n!==F_||(e=P_.createGeoJSONFeatureFromGeoJSON(t)):this.type===Mm.LINE?n!==D_&&n!==B_||(e=P_.createGeoJSONFeatureFromGeoJSON(t)):this.type===Mm.POLYGON&&(n!==A_&&n!==G_||(e=P_.createGeoJSONFeatureFromGeoJSON(t)));var i=null;if(this._proj?i=this._proj:this.getProjInfo()&&(i=this.getProjInfo().createProj(),this._proj=i),e){e.setEditAction(C_.ADD),e.setProjInfo(this.projInfo),e.setProj(i),e.setID(S_.virtualId()),e.setProperties(t.properties);var r=this.createEmptyProperties(),o=e.getProperties();if(o)for(var s in o)s in r&&(r[s]=o[s]);e.setProperties(r),this.features||(this.features=[]),this.updateBounds(e),this.features.push(e)}}return e}),f(cI,"addFeatures",function(t){var c=this,p=null;return t&&t.forEach(function(t){if("Polygon"==t.geometry.type)for(var e=t.geometry.coordinates,n=e?e.length:0,i=0;i<n;i++){if(0==i)0<S_.polygonArea(e[i])&&e[i].reverse();else S_.polygonArea(e[i])<0&&e[i].reverse()}else if("MultiPolygon"==t.geometry.type)for(var r=t.geometry.coordinates,o=r?r.length:0,s=0;s<o;s++)for(var a=r[s],u=a?a.length:0,l=0;l<u;l++){if(0==l)0<S_.polygonArea(a[l])&&a[l].reverse();else S_.polygonArea(a[l])<0&&a[l].reverse()}var h=c.addFeature(t);h&&(p=p||[]).push(h.clone())}),p}),f(cI,"isEmptyObject",function(t){if(t)for(var e in t)return!1;return!0}),f(cI,"modifyFeatures",function(t){var n=this,i=[];return t&&t.forEach(function(t){var e=n.getFeatureIndexById(t.getID());0<=e&&(i.push(n.features[e].clone()),n.features[e]=t.clone(),n.features[e].setEditAction(C_.MODIFY),n.updateBounds(t))}),i}),f(cI,"deleteFeaturesByIds",function(t){var n=this,i=[];return t&&t.forEach(function(t){var e=n.getFeatureIndexById(t);0<=e&&(i.push(n.features[e].clone()),n.features[e].setEditAction(C_.DELETE))}),i}),f(cI,"deleteFeatures",function(t){var n=this,i=[];return t&&t.forEach(function(t){var e=n.getFeatureIndexById(t.getID());0<=e&&(i.push(n.features[e].clone()),n.features[e].setEditAction(C_.DELETE))}),i}),f(cI,"modifyAttributes",function(t,e){var n=!0;if(t&&0<t.length&&e)for(var i=t.length,r=0;r<i;r++){var o=t[r],s=this.getFeatureIndexById(o);if(0<=s){var a=this.features[s].getProperties();if(this.isEmptyObject(a)&&(a=this.createEmptyProperties()),a){for(var u in e)a.hasOwnProperty(u)&&(a[u]=e[u],n=n||!0);n&&(this.features[s].setProperties(a),this.features[s].setEditAction(C_.MODIFY))}}}return n}),f(cI,"updateFeaturesByEditHistoryForUndo",function(t){var o=this,s=null;if(t&&t.action===C_.EDIT_COLLECTION){var e=t.group;e&&0<e.length&&e.forEach(function(t){var e=t.features;if(e&&0<e.length)switch(t.action){case C_.ADD:var i=!1;e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());if(0<=e){var n=o.features[e].clone();n.setEditAction(C_.DELETE),o.features[e]=n,i=i||!0}}),i&&(s=s||[]).push(t);break;case C_.MODIFY:var r=null;e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());if(0<=e){var n=o.features[e].clone();o.features[e]=t.clone(),(r=r||[]).push(n)}}),r&&0<r.length&&(s=s||[]).push({action:C_.MODIFY,features:r});break;case C_.DELETE:var n=!1;e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());0<=e&&(o.features[e]=t.clone(),n=n||!0)}),n&&(s=s||[]).push(t)}})}else if(t&&t.features&&0<t.features.length){var n=t.features;switch(t.action){case C_.ADD:n.forEach(function(t){var e=o.getFeatureIndexById(t.getID());0<=e&&o.features[e].setEditAction(C_.DELETE)});break;case C_.MODIFY:n.forEach(function(t){var e=o.getFeatureIndexById(t.getID());if(0<=e){var n=o.features[e].clone();o.features[e]=t.clone(),(s=s||[]).push(n)}});break;case C_.DELETE:n.forEach(function(t){var e=o.getFeatureIndexById(t.getID());0<=e&&(o.features[e]=t.clone())})}}return s}),f(cI,"updateFeaturesByEditHistoryForRedo",function(t){var o=this,s=null;if(t&&t.action===C_.EDIT_COLLECTION)t.group&&0<t.group.length&&t.group.forEach(function(t){var e=t.features;switch(t.action){case C_.ADD:var i=!1;e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());if(0<=e){var n=o.features[e].clone();n.setEditAction(C_.ADD),o.features[e]=n,i=i||!0}}),i&&(s=s||[]).push(t);break;case C_.MODIFY:var r=null;e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());if(0<=e){var n=o.features[e].clone();o.features[e]=t.clone(),o.features[e].setEditAction(C_.MODIFY),(r=r||[]).push(n)}}),r&&0<r.length&&(s=s||[]).push({action:C_.MODIFY,features:r});break;case C_.DELETE:var n=!1;e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());0<=e&&(o.features[e]=t.clone(),o.features[e].setEditAction(C_.DELETE),n=n||!0)}),n&&(s=s||[]).push(t)}});else if(t&&t.features&&0<t.features.length){var e=t.features;switch(t.action){case C_.ADD:e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());0<=e&&o.features[e].setEditAction(C_.ADD)});break;case C_.MODIFY:e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());if(0<=e){var n=o.features[e].clone();o.features[e]=t.clone(),o.features[e].setEditAction(C_.MODIFY),(s=s||[]).push(n)}});break;case C_.DELETE:e.forEach(function(t){var e=o.getFeatureIndexById(t.getID());0<=e&&(o.features[e]=t.clone(),o.features[e].setEditAction(C_.DELETE))})}}return s}),f(cI,"createEmptyProperties",function(){var i={};return this.fieldInfos&&this.fieldInfos.forEach(function(t){if(!S_.isSysField(t.getName())){var e=null;if(!t.isNull())switch(t.getType()){case Pb.DB_INTEGER:case Pb.DB_INT:case Pb.DB_BIGINT:case Pb.DB_FLOAT:case Pb.DB_DOUBLE:e=0;break;case Pb.DB_DATETIME:case Pb.DB_DATE:case Pb.DB_TIME:case Pb.DB_STRING:e="";break;case Pb.DB_BOOL:e="false"}var n=t.getName();i[n]=e}}),i}),f(cI,"getEditFeatures",function(){var t=null,e=null;return this.features&&this.features.forEach(function(t){switch(t.getEditAction()){case C_.ADD:t.getGeometry()&&(e=e||[]).push({gid:t.getID(),action:1,geometry:t.getGeometry(),properties:t.getProperties(),version:t.getVersion()});break;case C_.MODIFY:t.getGeometry()&&(e=e||[],t.getID()<0?e.push({gid:t.getID(),action:1,geometry:t.getGeometry(),properties:t.getProperties(),version:t.getVersion()}):e.push({gid:t.getID(),action:2,geometry:t.getGeometry(),properties:t.getProperties(),version:t.getVersion()}));break;case C_.DELETE:t.getGeometry()&&(e=e||[],0<=t.getID()&&e.push({gid:t.getID(),action:3,geometry:t.getGeometry(),properties:t.getProperties(),version:t.getVersion()}))}}),e&&0<e.length&&(t={id:this.getID(),version:this.getVersion(),features:e}),t}),f(cI,"buildSpatialIndex",function(){var t=new ax({bounds:this.bounds});t.buildIndex(),this.spatialIndex=t}),f(cI,"queryByFilters",function(t,e,i){(e=e||[])&&0!=e.length||(e=[],this.fieldInfos&&this.fieldInfos.forEach(function(t){e.push(t.getName())})),dt({data:{dataset_list:[{dataset_id:this.getID(),field_list:e,filters:t}],query_define:{query_geo:!1}},success:function(t){if(t.status!==st.SUCCESS_CLOUD)throw new Error("daqueryByFilters error:"+t.message);var e=t.result?t.result:null,n=e&&e.dataset_list?e.dataset_list:[];n&&0<n.length&&i&&i(n[0])}})}),f(cI,"selectByQueryDefine",function(t,e){var n,i=null;if(t)switch(t.type){case lt.BOUNDS:var r=t.bbox;if(r){var o=[];o.push([r.min_x,r.min_y],[r.max_x,r.min_y],[r.max_x,r.max_y],[r.min_x,r.max_y],[r.min_x,r.min_y]),i=this.createPolygonGeoJSON(o)}break;case lt.CIRCLE:var s=t.center,a=t.radius,u=[];S_.convArc2PLine(u,s,a,a,0,0,2*Math.PI);var l=[];u&&u.forEach(function(t){l.push([t.x,t.y])}),i=this.createPolygonGeoJSON(l);break;case lt.INTERSECTS:i=t.feature}return n=P_.createGeoJSONFeatureFromGeoJSON(i),this.queryFeaturesByFeature(n,e)}),f(cI,"createPolygonGeoJSON",function(t){return t&&4<=t.length?{type:"Feature",geometry:{type:"Polygon",coordinates:[t]}}:null}),f(cI,"queryFeaturesByFeature",function(t,e){var n=[],i=t?t.getBounds():null;if(t&&i&&!i.isNull())for(var r=t.getGeometry(),o=this.features,s=o?o.length:0,a=new I_,u=0;u<s;u++){var l=o[u];if(l.getEditAction()!=C_.DELETE){var h=!1;switch(l.getType()){case M_.POINT:h=E_.booleanContains(r,l.getGeometry());break;case M_.MULTIPOINT:for(var c=l.getCoordinates(),p=0,f=c.length;p<f&&!(h=E_.booleanContains(r,E_.point(c[p])));p++);break;case M_.LINE:var d=l.getBounds();if(i.containsBounds(d)){h=!0;break}if(!a.intersectRect(i,d))break;h=E_.booleanCrosses(r,l.getGeometry());break;case M_.MULTILINE:var g=l.getBounds();if(i.containsBounds(g)){h=!0;break}if(!a.intersectRect(i,g))break;for(var y=P_.createLinesFromMultiLine(l.getGeometry()),_=y?y.length:0,m=0;m<_&&!(h=E_.booleanCrosses(r,y[m]));m++);break;case M_.POLYGON:var v=l.getBounds();if(i.containsBounds(v)){h=!0;break}if(!a.intersectRect(i,v))break;if(v.containsBounds(i)&&E_.booleanContains(l.getGeometry(),r)){h=!0;break}h=E_.booleanOverlap(r,l.getGeometry());break;case M_.MULTIPOLYGON:var b=l.getBounds();if(i.containsBounds(b)){h=!0;break}if(!a.intersectRect(i,b))break;for(var x=P_.createPolygonFromMultiPolygon(l.getGeometry()),E=x?x.length:0,I=0;I<E;I++){var L=P_.createGeoJSONFeatureFromGeoJSON({type:"Feature",geometry:x[I]});if(L){var w=L.getBounds();if(i.containsBounds(w)){h=!0;break}if(a.intersectRect(i,w)){var S=L.getGeometry();if(w.containsBounds(i)&&E_.booleanContains(S,r)){h=!0;break}h=E_.booleanOverlap(r,S)}if(h)break}}}if(h)if(e)tI(e)({},{properties:l.getProperties()})&&n.push(l);else n.push(l)}}return n}),cI))),dI={SELAYER:"vector_layer",SEGROUPLAYER:"group_layer"},gI=B.Evented.extend({options:{},initialize:function(t){B.setOptions(this,t),this.id=S_.stamp(),this.sId=-1,this.visible=!0,this.selected=!0,this.editable=!1,this.snapable=!1,this.clip=!0,this.type=dI.SELAYER,this.dataset=null,this.renderStyle=null,this.renderTextStyle=null,this.minScale=0,this.maxScale=0,this.name="",this.filter=null,this.label="",this._parentLayerId=-1,this.itemFilter="",this.subFilters=null,this._features=[]},clone:function(){var t=new gI(this.options);return t.id=this.id,t.sId=this.sId,t.visible=this.visible,t.selected=this.selected,t.editable=this.editable,t.snapable=this.snapable,t.clip=this.clip,t.dataset=this.dataset?this.dataset.clone():null,t.renderStyle=this.renderStyle?this.renderStyle.clone():null,t.renderTextStyle=this.renderTextStyle?this.renderTextStyle.clone():null,t.minScale=this.minScale,t.maxScale=this.maxScale,t.name=this.name,t.filter=this.filter,t.label=this.label,t._parentLayerId=this._parentLayerId,t.itemFilter=this.itemFilter,t.subFilters=this.subFilters,t},getItemFilter:function(){return this.itemFilter},getType:function(){return this.type},getFeatures:function(){return this._features},getParentLayerId:function(){return this._parentLayerId},setParentLayerId:function(t){this._parentLayerId=t},getName:function(){return this.name},setName:function(t){this.name=t,this.label=t},getID:function(){return this.id},isVisible:function(){return this.visible},setVisible:function(t){this.visible=t},isSelected:function(){return this.selected},setSelected:function(t){this.selected=t},getMinScale:function(){return this.minScale},setMinScale:function(t){this.minScale=t},getMaxScale:function(){return this.maxScale},setMaxScale:function(t){this.maxScale=t},getFilter:function(){return this.filter},setFilter:function(t){this.filter=t},getDataset:function(){return this.dataset},getDatasetType:function(){return this.dataset?this.dataset.getType():Sm.UNKNOWN},getRenderStyle:function(){return this.renderStyle},setRenderStyle:function(t){this.renderStyle=t},getRenderTextStyle:function(){return this.renderTextStyle},setRenderTextStyle:function(t){this.renderTextStyle=t},getRequestObj:function(t,e,n,i){if(!this.visible||!this.dataset)return!1;if(!this.isQuery(e))return!1;if(n){var r=this.dataset.id,o=i.findDatasetById(r),s={};return s.id=o.id,s.version=o.version,s.filter=this.getFilter(),s.fields=o.getFieldNames(),t.push(s),!0}var a=this.dataset,u={avoid_overlapping:!0};u.dataset_id=a.id,u.dataset_ver=a.version,u.pvVersion=a.getPvVersion(),u.field_list=this.getRequestFields(e),u.filter=this.getFilter(),u.geo_clip=this.clip,u.layer_id=this.id,u.type=a.type,u.itemFilter=this.itemFilter,t.push(u)},getRequestObjExt:function(t,e){if(this.visible&&this.dataset&&this.isQuery(e)){var n=this.dataset,i={avoid_overlapping:!0};i.dataset_id=n.id,i.dataset_ver=n.version,i.pvVersion=n.getPvVersion(),i.field_list=this.getRequestFields(e),i.filter=this.getFilter(),i.geo_clip=this.clip,i.layer_id=this.id,i.type=n.type,i.itemFilter=this.itemFilter,t.push(i)}},clearData:function(){this._features=[]},isQuery:function(t){if(void 0===t)return!0;if(0<=t){t=1/t;var e=this.minScale,n=this.maxScale;if(0===n&&0===e)return!0;if(0===n&&0<e&&1/e<=t)return!0;if(0<n&&0===e&&t<=1/n)return!0;if(0<n&&0<e&&t<=1/n&&1/e<=t)return!0}return!1},isQueryLabel:function(t){return!(!this.renderTextStyle||!this.renderTextStyle.isQuery(t))},updateData:function(t){this.renderStyle||(this.renderStyle=Om.createDefault(this.dataset.getType())),this.renderTextStyle||(this.renderTextStyle=nv.createDefault(this.dataset.getType())),this.dataset.updateRecordset(t,this.renderStyle)},readJson:function(t,e){if(t&&t.dataset_info&&e){this.expand=!!t.expand,this.filter=t.filter||"",this.sId=void 0!==t.id?t.id:-1,this.name=t.name?t.name:"",this.label=t.label?t.label:"",this.visible=!!t.visible,this.selected=!!t.selectable,this.minScale=t.min_scale?t.min_scale:0,this.maxScale=t.max_scale?t.max_scale:0;var n=t.dataset_info;this.providerType=n.provider_type,this.dtUrl=n.dt_url;var i=n.id;this.dataset=this._createDtFromInfo(i,e),this.dataset&&(t.render_style&&(this.renderStyle=Om.readFromJson(t.render_style)),t.render_text_style&&(this.renderTextStyle=nv.readFromJson(t.render_text_style)))}},toJson:function(){var t={};this.renderStyle&&this.renderStyle.toJson(t);var e={};return this.renderTextStyle&&this.renderTextStyle.toJson(e),{class:this.getType(),expand:this.expand,filter:this.filter,id:this.id,name:this.name,label:this.label,visible:this.visible,selectable:this.selected,min_scale:this.minScale,max_scale:this.maxScale,dataset_info:{dt_url:this.dtUrl,feature_type:this.dataset.getType(),id:this.dataset.getID(),provider_type:this.providerType},render_style:t,render_text_style:e}},_createDtFromInfo:function(t,e){if(!e||!e.length)return null;for(var n=null,i=0;i<e.length;i++){var r=e[i];if(r.data_id===t){n=r;break}}if(!n)return null;var o=new Db;return o.readJson(n),o},getRequestFields:function(t){var e=[];if(this.renderStyle){var n=this.renderStyle.getUsedFields();n&&0<n.length&&(e=e.concat(n))}if(this.isQueryLabel(t)){var i=this.renderTextStyle.getUsedFields();i&&0<i.length&&(e=e.concat(i))}return S_.uniqueArray(e)},draw:function(t,e){if(t.isCloudVer()){if(!this.visible||!this.renderStyle||!this.dataset)return;var n=this.getGroupFeatures(t);this.renderStyle.bDrawByLegendGroup()?this._drawFeaturesByMerged(e,n):this._drawFeatures(e,n)}else{if(!(this.visible&&this.renderStyle&&this.dataset&&this.dataset.features&&this.dataset.features.length))return;var i=this.getGroupFeatures(t);this.renderStyle.bDrawByLegendGroup()?this._drawFeaturesByMerged(e,i):this._drawFeatures(e,i)}},_drawFeatures:function(t,e){if(e)for(var n in e){var i=e[n];if(i){var r=i.renderItem,o=i.geometrys;r.getSymbol().draw(t,o)}}},_drawFeaturesByMerged:function(h,c){var t=this.renderStyle.getLegendGroup(),e=t.getLegendClasses(),n=t.getLayerIndexList();n&&0!==n.length&&n.forEach(function(l){e.forEach(function(t){var e=t.getLayerIndexList();if(e){var n=e.indexOf(l);if(-1!==n){var i=t.getRenderItemId(),r=c[i];if(r){var o=r.renderItem,s=r.geometrys,a=o.getSymbol();if(!(a.getSymbolLayerCount()<=n)){var u=a.getSymbolLayer(n);u&&u.draw(h,s)}}}}})})},getLayerRenderItem:function(){return this.renderStyle.findRenderItem(this.dataset.getType(),null)},getGroupFeatures:function(s){if(s.isCloudVer()){if(!this.visible||!this.dataset)return null;var t=s.getBounds(),e=this.dataset.getProjInfo(),n=(I_.createFromLatLngBounds(t,e),this.dataset.id),i=s.findDatasetById(n);this._features=[];var r=i&&i.queryFeaturesForDraw(this._features),o={},a=this.getLayerRenderItem();return r.forEach(function(t){if(t&&a){var e=a.getID();o[e]||(o[e]={geometrys:[],renderItem:a});var n=o[e].geometrys;if(t.getType()===M_.MULTIPOLYGON){var i=t.getPolygons();i&&0<i.length&&i.forEach(function(t){var e=t.toPixelGeometry(s);e&&n.push(e)})}else{var r=t.toPixelGeometry(s);r&&n.push(r)}}}),o}if(!(this.visible&&this.dataset&&this.dataset.features&&this.dataset.features.length))return null;var u=this.dataset.features,l={};return u.forEach(function(t){if(t&&t.getRenderItem()){var e=t.getRenderItem(),n=e.getID();l[n]||(l[n]={geometrys:[],renderItem:e});var i=l[n].geometrys;if(t.getType()===M_.MULTIPOLYGON){var r=t.getPolygons();r&&0<r.length&&r.forEach(function(t){var e=t.toPixelGeometry(s);e&&i.push(e)})}else{var o=t.toPixelGeometry(s);o&&i.push(o)}}}),l},getLocalFeaturesByIds:function(t){return this.dataset?this.dataset.getLocalFeaturesByIds(t):null},updateFileData:function(t,e){if(this.renderStyle||(this.renderStyle=Om.createDefault(this.dataset.getType())),this.renderTextStyle||(this.renderTextStyle=nv.createDefault(this.dataset.getType())),t&&0!==t.length){var n=this.dataset,i=!1,r=null;this.subFilters&&0<this.subFilters.length&&(r=this.subFilters,i=!0);for(var o=this.renderStyle,s=t.length,a=[],u=0;u<s;u++){var l=t[u];if(l){var h=l.properties;if(i&&r)if(!Tv.compareItems(r,h))continue;e&&(l=l.clone());var c=o.findRenderItem(n.getType(),l.getProperties());l.setRenderItem(c),c&&a.push(l)}}n.features=a}},loadResources:function(){if(!this.renderStyle)return null;var t=this.renderStyle.getRenderItemList();if(!t||0===t.length)return null;var n=[];t.forEach(function(t){if(t&&0!==t.length){var e=t.getSymbol();e&&e.needLoadResource()&&n.push(e.loadResources())}});var e=null;return 0<n.length&&(e=Promise.all(n)),e}}),yI={NULL:0,PAN:1,SELECT_BY_POINT:12,SELECT_BY_RECT:13,SELECT_BY_CIRCLE:14,SELECT_BY_POLYGON:15,ZOOM_IN_BY_RECT:16,ZOOM_OUT_BY_RECT:17,MEASURE_DISTANCE:19,MEASURE_AREA:20,CREATE_POINT:21,CREATE_POLYLINE:22,CREATE_HAND_LINE:23,CREATE_HAND_POLYGON:25,CREATE_RECT:26,CREATE_FILL_RECT:27,CREATE_CIRCLE:28,CREATE_FILL_CIRCLE:29,CREATE_ELLIPSE:30,CREATE_FILL_ELLIPSE:31,CREATE_POLYGON:32,IDENTIFY:51,IDENTIFY_EXT:8051,MOVE:1001,ROTATE:1002,EDIT_NODE:1003,ADD_NODE:1004,DELETE_NODE:5004,VIEW_NODE:5005,ADD_RING:5006,CLIP_LINE:1005,CLIP_POLYGON:1006},_I={baseImageUrl:"images/cursor/",imageList:{identify:"identify.cur",selectByPoint:"selectByPoint.cur",selectByRect:"selectByRect.cur",selectByCircle:"selectByCircle.cur",selectByPolygon:"selectByRegion.cur",measureDistance:"ruler.cur",measureArea:"measureArea.cur",zoomInByRect:"zoomInByRect.cur",zoomOutByRect:"zoomOutByRect.cur",createCircle:"createCircle.cur",createEllipse:"createEllipse.cur",createHandLine:"createHandLine.cur",createPolyline:"createLine.cur",createPoint:"createPoint.cur",createPolygon:"createPolygon.cur",createRect:"createRect.cur",addNode:"editAddNode.cur",editNode:"editReShape.cur",deleteNode:"deleteNode.cur",viewNode:"viewNode.cur",reMove:"reMove.cur",rotate:"rotate.cur",clipLine:"clipLine.cur"}};function mI(t){var e=_I.imageList;return e&&e[t]?_I.baseImageUrl+e[t]:""}var vI=B.Evented.extend({options:{},initialize:function(t,e){B.setOptions(this,e),this._map=t,this._offset=null,this._fadeFrame=null},setMouseStyle:function(t){var e=this._map.getContainer(),n="",i=!1;switch(t){case yI.IDENTIFY_EXT:case yI.IDENTIFY:n=mI("identify");break;case yI.SELECT_BY_POINT:n=mI("selectByPoint");break;case yI.SELECT_BY_RECT:n=mI("selectByRect");break;case yI.SELECT_BY_CIRCLE:n=mI("selectByCircle");break;case yI.SELECT_BY_POLYGON:n=mI("selectByPolygon");break;case yI.MEASURE_DISTANCE:n=mI("measureDistance");break;case yI.MEASURE_AREA:n=mI("measureArea");break;case yI.ZOOM_IN_BY_RECT:n=mI("zoomInByRect");break;case yI.ZOOM_OUT_BY_RECT:n=mI("zoomOutByRect");break;case yI.CREATE_POINT:n=mI("createPoint");break;case yI.CREATE_POLYLINE:n=mI("createPolyline");break;case yI.CREATE_HAND_LINE:case yI.CREATE_HAND_POLYGON:n=mI("createHandLine");break;case yI.CREATE_RECT:case yI.CREATE_FILL_RECT:n=mI("createRect");break;case yI.CREATE_CIRCLE:case yI.CREATE_FILL_CIRCLE:n=mI("createCircle");break;case yI.CREATE_ELLIPSE:case yI.CREATE_FILL_ELLIPSE:n=mI("createEllipse");break;case yI.CREATE_POLYGON:n=mI("createPolygon");break;case yI.MOVE:n=mI("reMove");break;case yI.ROTATE:n=mI("rotate");break;case yI.EDIT_NODE:n=mI("editNode");break;case yI.ADD_NODE:n=mI("addNode");break;case yI.VIEW_NODE:i=!0,n="pointer";break;case yI.DELETE_NODE:n=mI("deleteNode");break;case yI.CLIP_LINE:n=mI("clipLine");break;default:n=""}e.style.cursor=n?i?""+n:"url("+n+"),crosshair":""},setMapDragging:function(t){t?(this._map.dragging.enable(),this._map.doubleClickZoom.enable()):(this._map.dragging.disable(),this._map.doubleClickZoom.disable())},autoPanMap:function(t){if(this._map&&this._map.options.edit.autoPanForEdit){var e=t.containerPoint,n=this._map.options.edit.tolerance,i=this._map.getSize(),r=0,o=0;e.x<=n?r=-n:e.x+n>=i.x&&(r=n),e.y<=n?o=-n:e.y+n>=i.y&&(o=n),0==o&&0==r||this._map.panBy([r,o]),this._offset=[r,o]}else this._offset=null},adjust:function(t){return t&&this._offset?new B.Point(t.x+this._offset[0],t.y+this._offset[1]):null}}),bI=vI.extend({options:{style:{interactive:!1,color:"#ff0000",fillOpacity:0}},initialize:function(t,e){vI.prototype.initialize.call(this,t,e),this._enabled=!1,this._selectType="",this._clickPoints=null,this._feature=null,this._map&&this._map.on("action-change",this.handleActionChange,this)},handleActionChange:function(){this._finish()},enable:function(t){switch(this.disable(),this._enabled=!0,this._selectType=t,this.setMapDragging(!1),this.setMouseStyle(t),t){case yI.IDENTIFY_EXT:case yI.SELECT_BY_POINT:this._map.on("click",this._onClick,this);break;case yI.IDENTIFY:case yI.SELECT_BY_RECT:case yI.SELECT_BY_CIRCLE:this._map.on("mousedown",this._onMouseDown,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("mouseup",this._onMouseUp,this);break;case yI.SELECT_BY_POLYGON:this._map.on("click",this._onClick,this),this._map.on("dblclick",this._onDblClick,this),this._map.on("mousemove",this._onMouseMove,this)}},disable:function(){this._enabled&&(this._enabled=!1,this._selectType="",this.setMapDragging(!0),this.setMouseStyle(),this._map.off("click",this._onClick,this),this._map.off("mousedown",this._onMouseDown,this),this._map.off("mousemove",this._onMouseMove,this),this._map.off("mouseup",this._onMouseUp,this),this._map.off("dblclick",this._onDblClick,this))},_onClick:function(t){var e=t.latlng;if(this._clickPoints||(this._clickPoints=[]),0<this._clickPoints.length){var n=this._clickPoints[this._clickPoints.length-1];if(e.equals(n))return}switch(this._clickPoints.push(e),this._selectType){case yI.IDENTIFY_EXT:case yI.SELECT_BY_POINT:var i=t.originalEvent;this.fire("end",{isMultySelect:!(!i||!i.ctrlKey&&!i.shiftKey),selectType:this._selectType,points:[e]}),this._finish();break;case yI.SELECT_BY_POLYGON:var r=this._clickPoints.slice(0);this._feature?this._feature.setLatLngs(r):(this._feature=new B.Polygon(r,this.options.style),this._map.addLayer(this._feature))}},_onDblClick:function(){if(this._feature&&this._clickPoints&&0!==this._clickPoints.length)switch(this._selectType){case yI.SELECT_BY_POLYGON:var t=this._clickPoints.slice(0);if(t.length<=2)break;t.push(t[0]),this.fire("end",{selectType:this._selectType,points:t}),this._finish()}},_onMouseDown:function(t){var e=t.latlng;switch(this._clickPoints||(this._clickPoints=[]),this._clickPoints.push(e),this._selectType){case yI.IDENTIFY:case yI.SELECT_BY_RECT:this._feature||(this._feature=new B.Polygon([],this.options.style),this._map.addLayer(this._feature));break;case yI.SELECT_BY_CIRCLE:this._feature||(this._feature=new B.CircleMarker(e,this.options.style),this._feature.setRadius(0),this._map.addLayer(this._feature))}},_onMouseUp:function(t){if(this._feature){var e=t.latlng;switch(this._selectType){case yI.IDENTIFY:case yI.SELECT_BY_RECT:case yI.SELECT_BY_CIRCLE:var n=this._clickPoints[0];this.fire("end",{selectType:this._selectType,points:[n,e]}),this._finish()}}},_onMouseMove:function(t){if(this._feature){var e=t.latlng;switch(this._selectType){case yI.SELECT_BY_POLYGON:var n=this._clickPoints.slice(0);n.push(e),this._feature.setLatLngs(n);break;case yI.IDENTIFY:case yI.SELECT_BY_RECT:var i=this._clickPoints[0],r=this._toRect([i,e]);this._feature.setLatLngs(r);break;case yI.SELECT_BY_CIRCLE:var o=this._clickPoints[0];o=this._map.latLngToContainerPoint(o);var s=t.containerPoint,a=Math.sqrt((o.x-s.x)*(o.x-s.x)+(o.y-s.y)*(o.y-s.y));this._feature.setRadius(a)}}},_finish:function(){this._clickPoints=null,this._feature&&(this._map.removeLayer(this._feature),this._feature=null)},_toRect:function(t){if(!t||t.length<2)return[];var e=t[0],n=t[1],i=Math.min(e.lng,n.lng),r=Math.max(e.lng,n.lng),o=Math.min(e.lat,n.lat),s=Math.max(e.lat,n.lat);return[new B.LatLng(s,i),new B.LatLng(o,i),new B.LatLng(o,r),new B.LatLng(s,r),new B.LatLng(s,i)]}}),xI=B.Class.extend({options:{ids:null,layerId:""},initialize:function(t){B.setOptions(this,t)},setIds:function(t){this.options.ids=t},getIds:function(){return this.options.ids},getLayerId:function(){return this.options.layerId},setLayerId:function(t){this.options.layerId=t},hasId:function(t){var e=this.options.ids;return!(!e||0===e.length)&&-1!==e.indexOf(t)},addId:function(t){this.options.ids||(this.options.ids=[]),this.hasId(t)||this.options.ids.push(t)},getCount:function(){return this.options.ids?this.options.ids.length:0},isNull:function(){return!this.options.ids||0===this.options.ids.length}}),EI=B.Evented.extend({options:{},initialize:function(t,e){B.setOptions(this,e),this._map=t},select:function(i,t,e,n){var r=this;if(i&&t&&t.length){n=n||{};var o=function(t){n.success&&n.success(t)},s=function(t){n.error&&n.error(t)},a=this._map.seManager,u=!0;i===yI.IDENTIFY&&(u=!1),u&&(e&&i==yI.SELECT_BY_POINT||a.clearSelection());var l=this._getQueryLayerInfos();if(l&&l.length)if(this._map.isCloudVer()){var h=l.length,c=a.getSelectSetting(),p=c.tolerance,f=c.bQueryAll,d=null;this._map&&this._map.editManager()&&(this._map.editManager().center=null);for(var g=0;g<h;g++){var y=l[g],_=y.dataset_id,m=this._map.findDatasetById(_);if(m){var v=m.getProjInfo();if(i==yI.IDENTIFY||i===yI.IDENTIFY_EXT||i==yI.SELECT_BY_POINT){var b=(d=this._getQueryDefine(i,t,p)).bbox,x=new B.LatLngBounds([b.min_y,b.min_x],[b.max_y,b.max_x]),E=I_.createFromLatLngBounds(x,v),I=m.selectByPoint(E,null,!0),L=null;if(I&&0<I.length){var w=[{dataset_id:_,feature_id_list:[I[0].getID()],layer_id:y.layer_id}],S=this._handleResult(i,w);u&&this._addToSelection(S,e),i!==yI.IDENTIFY&&i!==yI.IDENTIFY_EXT||(L={dataset_id:_,name:m.getName(),feature:I[0],layer_id:y.layer_id}),this._map.editManager().center=this._map.editManager()&&this._map.editManager().getCenterExt(_,[I[0].getID()]),o(S)}if(i!==yI.IDENTIFY&&i!==yI.IDENTIFY_EXT||(a.fire("identify_end",{data:L}),this._map.fire("identify_end",{data:L})),L)break;if(!f&&I&&0<I.length)break}else{d=this._getQueryDefine(i,t,p,v);var M=m.selectByQueryDefine(d,null);if(M&&0<M.length&&function(){var e=[];M.forEach(function(t){e.push(t.getID())});var t=[{dataset_id:_,feature_id_list:e,layer_id:y.layer_id}],n=r._handleResult(i,t);u&&r._addToSelection(n),r._map.editManager().center=r._map.editManager()&&r._map.editManager().getCenterExt(_,e),o(n)}(),!f&&M&&0<M.length)break}}}this._map.fire("select-change")}else{var C=a.getSelectSetting(),P=C.tolerance,N=C.bQueryAll,O=this._getQueryDefine(i,t,P),T=1;N&&(T=l.length),pt({data:{dataset_list:l,query_define:O,effective_dataset_count:T},success:function(t){if(t.status===st.SUCCESS){var e=t.result.dataset_list,n=r._handleResult(i,e);u&&r._addToSelection(n),i!==yI.IDENTIFY&&i!==yI.IDENTIFY_EXT||r._handleIdentifyResult(n),o(n)}else s(t.message)},error:function(){s("select error")}})}else o()}},_handleResult:function(e,t){if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){t&&t.feature_id_list&&0!==t.feature_id_list.length&&(e===yI.SELECT_BY_POINT&&1<t.feature_id_list.length&&(t.feature_id_list=[t.feature_id_list[0]]),n.push(t))}),n},_getQueryDefine:function(t,e,n,i){var r={},o=null,s=null;switch(t){case yI.IDENTIFY:var a=e[0],u=e[1];a.equals(u)?r.bbox=this._pointToRect(a,n):r.bbox=this._pointsToRect(e),r.type=lt.BOUNDS;break;case yI.IDENTIFY_EXT:case yI.SELECT_BY_POINT:r.bbox=this._pointToRect(e[0],n),r.type=lt.BOUNDS;break;case yI.SELECT_BY_RECT:i&&(o=i.project(e[0]),s=i.project(e[1])),r.bbox=this._pointsToRectNew([o,s]),r.type=lt.BOUNDS;break;case yI.SELECT_BY_CIRCLE:i&&(o=i.project(e[0]),s=i.project(e[1])),r.center={x:o.x,y:o.y};var l=Math.pow(s.x-o.x,2)+Math.pow(s.y-o.y,2);r.radius=Math.sqrt(l),r.type=lt.CIRCLE;break;case yI.SELECT_BY_POLYGON:var h=[];e&&e.forEach(function(t){h.push(i.project(t))}),r.feature=this._pointsToFeatureNew(h),r.type=lt.INTERSECTS}return r},_pointsToFeature:function(t){var e=[];return t.forEach(function(t){e.push([t.lng,t.lat])}),{type:"Feature",geometry:{type:"Polygon",coordinates:[e]}}},_pointsToFeatureNew:function(t){var e=[];return t.forEach(function(t){e.push([t.x,t.y])}),{type:"Feature",geometry:{type:"Polygon",coordinates:[e]}}},_pointsToRect:function(t){var e=t[0],n=t[1];return{min_x:Math.min(e.lng,n.lng),min_y:Math.min(e.lat,n.lat),max_x:Math.max(e.lng,n.lng),max_y:Math.max(e.lat,n.lat)}},_pointsToRectNew:function(t){var e=t[0],n=t[1];return{min_x:Math.min(e.x,n.x),min_y:Math.min(e.y,n.y),max_x:Math.max(e.x,n.x),max_y:Math.max(e.y,n.y)}},_pointToRect:function(t,e){var n=this._map.getBounds(),i=e*((n.getEast()-n.getWest())/this._map.getSize().x);return{min_x:t.lng-i,min_y:t.lat-i,max_x:t.lng+i,max_y:t.lat+i}},_getQueryLayerInfos:function(){var t=this._map.seManager.getVectorServiceList();if(!t||0===t.length)return null;var i=[];return t.forEach(function(t){if(t){var e=t.getLayers(!0);e&&0!==e.length&&e.forEach(function(t){if(t&&t.selected&&t.dataset&&t.visible){var e=t.dataset,n={layer_id:t.id,dataset_id:e.id,dataset_ver:e.version,filter:t.getFilter()};i.push(n)}})}}),i},_addToSelection:function(t,a){if(t&&0!==t.length){var u=this._map.seManager;t.forEach(function(t){if(t&&t.feature_id_list&&0!==t.feature_id_list.length){var e=t.feature_id_list,n=t.layer_id,i=u.getVectorServiceByLayerId(n);if(i)if(a){var r=i.getSelectionByLayerID(n),o=i.getSelections();o&&o.forEach(function(t){t.getLayerId()!=n&&i.removeSelectionByLayerId(t.getLayerId())}),r?e&&e.forEach(function(t){r.addId(t)}):(r=new xI({layerId:n,ids:e}),i.addSelection(r))}else{var s=new xI({layerId:n,ids:e});i.addSelection(s)}}}),u.drawSelection()}},_handleIdentifyResult:function(t){if(t&&0!==t.length){var r=this._map.seManager,o=[];t.forEach(function(t){if(t&&t.feature_id_list&&0!==t.feature_id_list.length){var e=t.feature_id_list,n=t.layer_id,i=r.getLayerById(n).getLocalFeaturesByIds(e);i&&0<i.length&&(o=o.concat(i))}}),0<o.length&&r.showIdentifyFeatures(o),r.fire("identify_end",{data:t})}}}),II="没有可编辑图层",LI="编辑要素个数超过50个，无法编辑",wI="当前没有可编辑要素，请选择编辑要素",SI="一次只能选择一个要素进行节点编辑",MI="一次只能选择一个面要素进行面分割",CI="锁定要素失败",PI="添加要素失败",NI="删除要素失败",OI="修改图元失败",TI="分割要素失败",kI="请将分割点置于编辑要素容差范围内",RI="面分割失败",DI="请将节点置于编辑要素容差范围内",AI="请将节点置于编辑要素容差范围内",FI="同步数据集信息失败",BI="操作失败",GI="请先选择一个要素",UI={SMSCircle:"circle",SMSCross:"cross",SMSEclipse:"eclipse",SMSDiamond:"diamond",SMSSquare:"square",SMSStar:"star",SMSTriangle:"triangle",SMSX:"x",SMSGT:"gt",SMSNULL:"null",SMSDashCircle:"dash_circle"},jI={angle:0,size:10,halo:null},qI=(y(zI,bm),c(zI,[{key:"readJson",value:function(t){d(zI.prototype.__proto__||Object.getPrototypeOf(zI.prototype),"readJson",this).call(this,t),this.options.angle=t.angle,this.options.size=bt.poundToPixel(t.size),t.halo&&(this.options.halo=new fb,this.options.halo.readJson(t.halo))}},{key:"toJson",value:function(t){if(t)if(d(zI.prototype.__proto__||Object.getPrototypeOf(zI.prototype),"toJson",this).call(this,t),t.angle=this.options.angle,t.size=bt.pixelToPound(this.options.size),this.options.halo){var e={};this.options.halo.toJson(e),t.halo=e}else t.halo=null}},{key:"setAngle",value:function(t){this.options.angle=t}},{key:"getAngle",value:function(){return this.options.angle}},{key:"setSize",value:function(t){this.options.size=t}},{key:"getSize",value:function(){return this.options.size}},{key:"getHalo",value:function(){return this.options.halo}},{key:"setHalo",value:function(t){this.options.halo=t}},{key:"draw",value:function(e,t){var n=this;e&&t&&t.length&&this.isVisible()&&t.forEach(function(t){t&&t.points&&t.points.length&&t.points.forEach(function(t){n.drawPoint(e,t)})})}},{key:"drawPoint",value:function(){}},{key:"_drawHalo",value:function(t){var e=this.getHalo();if(e&&e.hasHalo()){var n=e.getColor().getStrColor(),i=e.getSize();t.save(),t.lineJoin="round",t.lineCap="round",t.strokeStyle=n,t.lineWidth=2*i,t.stroke(),t.restore()}}}]),zI);function zI(t){h(this,zI);var e=_(this,(zI.__proto__||Object.getPrototypeOf(zI)).call(this));return e.mergeOptions(jI,t),e.type=gm.MARKER_SYMBOL,e}var VI={locked:!1,visible:!0,xOffset:0,yOffset:0},YI=(y(HI,qI),c(HI,[{key:"readJson",value:function(t){d(HI.prototype.__proto__||Object.getPrototypeOf(HI.prototype),"readJson",this).call(this,t),this.options.locked=t.color_locked,this.options.visible=t.visible,this.options.xOffset=bt.poundToPixel(t.offset_x),this.options.yOffset=bt.poundToPixel(t.offset_y)}},{key:"toJson",value:function(t){t&&(d(HI.prototype.__proto__||Object.getPrototypeOf(HI.prototype),"toJson",this).call(this,t),t.color_locked=this.options.locked,t.visible=this.options.visible,t.offset_x=bt.pixelToPound(this.options.xOffset),t.offset_y=bt.pixelToPound(this.options.yOffset))}},{key:"isLocked",value:function(){return this.options.locked}},{key:"setLocked",value:function(t){this.options.locked=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}},{key:"setOffsetX",value:function(t){this.options.xOffset=t}},{key:"getOffsetX",value:function(){return this.options.xOffset}},{key:"setOffsetY",value:function(t){this.options.yOffset=t}},{key:"getOffsetY",value:function(){return this.options.yOffset}}]),HI);function HI(t){h(this,HI);var e=_(this,(HI.__proto__||Object.getPrototypeOf(HI)).call(this));return e.mergeOptions(VI,t),e}var XI={drawArc:function(t,e,n){var i=n/2;t.beginPath(),t.arc(e.x,e.y,i,0,2*Math.PI)},drawDashCircle:function(t,e,n){for(var i=n/2,r=4,o=0,s=(r=r/180*Math.PI*2)/2;s<=360;o+=r,s+=r)t.beginPath(),t.arc(e.x,e.y,i,o,s)},eclipse:function(t,e,n,i){t.save();var r=i<n?n:i,o=n/r,s=i/r;t.scale(o,s),t.beginPath(),t.moveTo((e.x+n)/o,e.y/s),t.arc(e.x/o,e.y/s,r,0,2*Math.PI),t.closePath(),t.restore()},drawEclipse:function(t,e,n){var i=n/2,r=n/4;i&&r&&(i==r?this.drawArc(t,e,i):this.eclipse(t,e,i,r))},drawTriangle:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(0,-.5*n),t.lineTo(.5*n,.5*n),t.lineTo(-.5*n,.5*n),t.closePath(),t.restore()},drawSquare:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,.5*n),t.lineTo(.5*n,.5*n),t.lineTo(.5*n,-.5*n),t.lineTo(-.5*n,-.5*n),t.closePath(),t.restore()},drawStar:function(t,e,n,i){t.save(),t.translate(e.x,e.y);var r=i+53;t.rotate(r*Math.PI/180);var o=Math.cos(.4*Math.PI)/Math.cos(.2*Math.PI)*n*1.3;t.beginPath(),t.moveTo(o,0);for(var s=0;s<9;s++)t.rotate(Math.PI/5),s%2==0?t.lineTo(o/.525731*.200811,0):t.lineTo(o,0);t.closePath(),t.restore()},drawDiamond:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,0),t.lineTo(0,.5*n),t.lineTo(.5*n,0),t.lineTo(0,-.5*n),t.closePath(),t.restore()},drawCross:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,0),t.lineTo(.5*n,0),t.moveTo(0,.5*n),t.lineTo(0,-.5*n),t.restore()},drawX:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,-.5*n),t.lineTo(.5*n,.5*n),t.moveTo(-.5*n,.5*n),t.lineTo(.5*n,-.5*n),t.restore()},drawGT:function(t,e,n,i){t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.beginPath(),t.moveTo(-.5*n,0),t.lineTo(0,0),t.lineTo(0,-.5*n),t.lineTo(.5*n,-.5*n),t.lineTo(.5*n,0),t.restore()},drawImage:function(t,e,n,i,r){t.save();var o=Math.round(n)>>1;if(t.translate(e.x,e.y),t.rotate(i*Math.PI/180),r.width===r.height)t.drawImage(r,-o,-o,n,n);else if(r.width>r.height){var s=n*r.height/r.width;t.drawImage(r,-o,-s/2,n,s)}else{var a=n*r.width/r.height;t.drawImage(r,-a/2,-o,a,n)}t.restore()},drawArrow:function(t,e,n,i,r,o){r/=2,o/=2,t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.moveTo(-r,o),t.lineTo(r,0),t.lineTo(-r,-o),t.lineTo(-r,o),t.restore()},drawPath:function(t,e,n){if(e&&0!==e.length){n&&t.beginPath();for(var i=e.length,r=0;r<i;r++){var o=e[r];0===r?t.moveTo(o.x,o.y):t.lineTo(o.x,o.y)}}}},JI={hasOutline:!1,outlineColor:null,outlineWidth:1,simpleMarkerStyle:UI.SMSCircle},WI=(y(KI,YI),c(KI,[{key:"readJson",value:function(t){d(KI.prototype.__proto__||Object.getPrototypeOf(KI.prototype),"readJson",this).call(this,t),this.options.hasOutline=t.has_outline,this.options.outlineColor=_m.createFromArray(t.outline_color),this.options.outlineWidth=bt.poundToPixel(t.outline_width),this.options.simpleMarkerStyle=t.simple_marker_symbol_type}},{key:"toJson",value:function(t){t&&(d(KI.prototype.__proto__||Object.getPrototypeOf(KI.prototype),"toJson",this).call(this,t),t.has_outline=this.options.hasOutline,this.options.outlineColor?t.outline_color=this.options.outlineColor.toArray():t.outline_color=null,t.outline_width=bt.pixelToPound(this.options.outlineWidth),t.simple_marker_symbol_type=this.options.simpleMarkerStyle)}},{key:"hasOutline",value:function(){return this.options.hasOutline}},{key:"setHasOutline",value:function(t){this.options.hasOutline=t}},{key:"getOutlineWidth",value:function(){return this.options.outlineWidth}},{key:"setOutlineWidth",value:function(t){this.options.outlineWidth=t}},{key:"getOutlineColor",value:function(){return this.options.outlineColor}},{key:"setOutlineColor",value:function(t){this.options.outlineColor=t}},{key:"getSimpleMarkerStyle",value:function(){return this.options.simpleMarkerStyle}},{key:"setSimpleMarkerStyle",value:function(t){this.options.simpleMarkerStyle=t}},{key:"drawPoint",value:function(t,e){if(t&&e&&this.isVisible()){var n=this.getSimpleMarkerStyle();if(n!==UI.SMSNULL){var i=this.getSize(),r=this.getAngle(),o=this.getOffsetX(),s=this.getOffsetY();e.x+=o,e.y+=s;var a=!1;switch(n){case UI.SMSDashCircle:XI.drawDashCircle(t,e,i);break;case UI.SMSCircle:XI.drawArc(t,e,i);break;case UI.SMSCross:XI.drawCross(t,e,i,r),a=!0;break;case UI.SMSEclipse:XI.drawEclipse(t,e,i);break;case UI.SMSDiamond:XI.drawDiamond(t,e,i,r);break;case UI.SMSSquare:XI.drawSquare(t,e,i,r);break;case UI.SMSStar:XI.drawStar(t,e,i,r);break;case UI.SMSTriangle:XI.drawTriangle(t,e,i,r);break;case UI.SMSX:XI.drawX(t,e,i,r),a=!0;break;case UI.SMSGT:XI.drawGT(t,e,i,r),a=!0}var u=this.getHalo();u&&u.hasHalo()&&this._drawHalo(t);var l=this.getColor().getStrColor();t.strokeStyle=l,t.fillStyle=l,t.lineWidth=1,a?t.stroke():t.fill("evenodd"),this.hasOutline()&&!a&&(t.lineWidth=this.getOutlineWidth(),t.strokeStyle=this.getOutlineColor().getStrColor(),t.stroke())}}}}]),KI);function KI(t){h(this,KI);var e=_(this,(KI.__proto__||Object.getPrototypeOf(KI)).call(this));return e.mergeOptions(JI,t),e.class=Q_,e.options.outlineColor||(e.options.outlineColor=_m.createRandom()),e}var ZI={width:1},QI=(y($I,bm),c($I,[{key:"readJson",value:function(t){d($I.prototype.__proto__||Object.getPrototypeOf($I.prototype),"readJson",this).call(this,t),this.options.width=bt.poundToPixel(t.width)}},{key:"toJson",value:function(t){t&&(d($I.prototype.__proto__||Object.getPrototypeOf($I.prototype),"toJson",this).call(this,t),t.width=bt.pixelToPound(this.options.width))}},{key:"getWidth",value:function(){return this.options.width}},{key:"setWidth",value:function(t){this.options.width=t}},{key:"draw",value:function(u,t){var l=this;u&&t&&t.length&&this.isVisible()&&t.forEach(function(t){if(t){var e=t.points,n=t.polyCount,i=t.subCount;if(e&&e.length&&n&&i&&n.length===i)for(var r=0,o=0;o<i;o++){var s=n[o],a=e.slice(r,r+s);r+=s,l.drawLine(u,a)}}})}},{key:"drawLine",value:function(){}}]),$I);function $I(t){h(this,$I);var e=_(this,($I.__proto__||Object.getPrototypeOf($I)).call(this));return e.mergeOptions(ZI,t),e.type=gm.LINE_SYMBOL,e}var tL={locked:!1,visible:!0},eL=(y(nL,QI),c(nL,[{key:"readJson",value:function(t){d(nL.prototype.__proto__||Object.getPrototypeOf(nL.prototype),"readJson",this).call(this,t),this.options.locked=t.color_locked,this.options.visible=t.visible}},{key:"toJson",value:function(t){t&&(d(nL.prototype.__proto__||Object.getPrototypeOf(nL.prototype),"toJson",this).call(this,t),t.color_locked=this.options.locked,t.visible=this.options.visible)}},{key:"isLocked",value:function(){return this.options.locked}},{key:"setLocked",value:function(t){this.options.locked=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}}]),nL);function nL(t){h(this,nL);var e=_(this,(nL.__proto__||Object.getPrototypeOf(nL)).call(this));return e.mergeOptions(tL,t),e}var iL="null",rL="dashed",oL="dotted",sL="dashed_dot",aL="dashed_dot_dot",uL={linePenStyle:"solid"},lL=(y(hL,eL),c(hL,[{key:"readJson",value:function(t){d(hL.prototype.__proto__||Object.getPrototypeOf(hL.prototype),"readJson",this).call(this,t),this.options.linePenStyle=t.simple_line_symbol_type}},{key:"toJson",value:function(t){t&&(d(hL.prototype.__proto__||Object.getPrototypeOf(hL.prototype),"toJson",this).call(this,t),t.simple_line_symbol_type=this.options.linePenStyle)}},{key:"getLinePenStyle",value:function(){return this.options.linePenStyle}},{key:"setLinePenStyle",value:function(t){this.options.linePenStyle=t}},{key:"draw",value:function(u,t){if(u&&t&&t.length&&this.isVisible()&&this.getLinePenStyle()!==iL){u.beginPath(),t.forEach(function(t){if(t){var e=t.points,n=t.polyCount,i=t.subCount;if(e&&e.length&&n&&i&&n.length===i)for(var r=0,o=0;o<i;o++){var s=n[o],a=e.slice(r,r+s);r+=s,XI.drawPath(u,a,!1)}}}),u.save(),u.lineJoin="round",u.lineCap="round",u.strokeStyle=this.getColor().getStrColor(),u.lineWidth=this.getWidth();var e=this._createDashArray();e&&0<e.length&&u.setLineDash(e),u.stroke(),u.restore()}}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()&&this.getLinePenStyle()!==iL){XI.drawPath(t,e,!0),t.strokeStyle=this.getColor().getStrColor(),t.lineWidth=this.getWidth();var n=this._createDashArray();n&&0<n.length&&t.setLineDash(n),t.stroke()}}},{key:"_createDashArray",value:function(){var t=null;switch(this.getLinePenStyle()){case rL:t=[5,10];break;case oL:t=[1,5];break;case sL:t=[1,5,5,5];break;case aL:t=[1,5,1,5,5,5]}return t}}]),hL);function hL(t){h(this,hL);var e=_(this,(hL.__proto__||Object.getPrototypeOf(hL)).call(this));return e.mergeOptions(uL,t),e.class=im,e}var cL={enable:!1,shadowAngle:90,shadowHeight:10,shadowColor:null,shadowLineColor:null},pL=(c(fL,[{key:"readJson",value:function(t){this.options.enable=t.enable,this.options.shadowAngle=t.shadow_angle,this.options.shadowHeight=bt.poundToPixel(t.shadow_height),this.options.shadowColor=_m.createFromArray(t.shadow_color),this.options.shadowLineColor=_m.createFromArray(t.shadow_line_color)}},{key:"toJson",value:function(t){t&&(t.enable=this.options.enable,t.shadow_angle=this.options.shadowAngle,t.shadow_height=bt.pixelToPound(this.options.shadowHeight),this.options.shadowColor?t.shadow_color=this.options.shadowColor.toArray():t.shadow_color=null,this.options.shadowLineColor?t.shadow_line_color=this.options.shadowLineColor.toArray():t.shadow_line_color=null)}},{key:"enable",value:function(){return this.options.enable}},{key:"setEnable",value:function(t){this.options.enable=t}},{key:"setShadowAngle",value:function(t){this.options.shadowAngle=t}},{key:"getShadowAngle",value:function(){return this.options.shadowAngle}},{key:"setShadowHeight",value:function(t){this.options.shadowHeight=t}},{key:"getShadowHeight",value:function(){return this.options.shadowHeight}},{key:"getShadowColor",value:function(){return this.options.shadowColor}},{key:"setShadowColor",value:function(t){this.options.shadowColor=t}},{key:"getShadowLineColor",value:function(){return this.options.shadowLineColor}},{key:"setShadowLineColor",value:function(t){this.options.shadowLineColor=t}}]),fL);function fL(t){h(this,fL),this.options=bt.extend({},cL,t),this.options.shadowColor||(this.options.shadowColor=new _m(180,180,180)),this.options.shadowLineColor||(this.options.shadowLineColor=new _m(165,165,165))}var dL={hasOutline:!1,outlineSymbol:null,shadow:null},gL=(y(yL,bm),c(yL,[{key:"readJson",value:function(t){d(yL.prototype.__proto__||Object.getPrototypeOf(yL.prototype),"readJson",this).call(this,t),this.options.hasOutline=t.has_outline,t.outline_symbol&&(this.options.outlineSymbol=bm.readFromJson(t.outline_symbol)),t.shadow&&(this.options.shadow=new pL,this.options.shadow.readJson(t.shadow))}},{key:"toJson",value:function(t){if(t){if(d(yL.prototype.__proto__||Object.getPrototypeOf(yL.prototype),"toJson",this).call(this,t),t.has_outline=this.options.hasOutline,this.options.outlineSymbol){var e={};this.options.outlineSymbol.toJson(e),t.outline_symbol=e}else t.outline_symbol=null;if(this.options.shadow){var n={};this.options.shadow.toJson(n),t.shadow=n}else t.shadow=null}}},{key:"hasOutline",value:function(){return this.options.hasOutline}},{key:"setHasOutline",value:function(t){this.options.hasOutline=t}},{key:"getOutlineSymbol",value:function(){return this.options.outlineSymbol}},{key:"setOutlineSymbol",value:function(t){this.options.outlineSymbol=t}},{key:"getShadow",value:function(){return this.options.shadow}},{key:"setShadow",value:function(t){this.options.shadow=t}},{key:"setOutlineColor",value:function(t){this.options.outlineSymbol&&this.options.outlineSymbol.setColor(t)}},{key:"getOutlineColor",value:function(){return this.options.outlineSymbol?this.options.outlineSymbol.getColor():this.getColor()}},{key:"setOutlineWidth",value:function(t){this.options.outlineSymbol&&this.options.outlineSymbol.setWidth(t)}},{key:"getOutlineWidth",value:function(){return this.options.outlineSymbol?this.options.outlineSymbol.getWidth():0}},{key:"draw",value:function(e,t){var n=this;e&&t&&t.length&&this.isVisible()&&t.forEach(function(t){t&&n._drawGeometry(e,t)})}},{key:"drawPolygon",value:function(t,e){if(t&&e&&!(e.length<3)&&this.isVisible()){var n=new It({points:e,polyCount:[e.length],subCount:1});this._drawGeometry(t,n)}}},{key:"_drawGeometry",value:function(){}},{key:"setTranspercent",value:function(t){var e=this.getColor();e.alpha=t,this.setColor(e);var n=this.getOutlineColor();n.alpha=t,this.setOutlineColor(n)}}]),yL);function yL(t){h(this,yL);var e=_(this,(yL.__proto__||Object.getPrototypeOf(yL)).call(this));return e.mergeOptions(dL,t),e.type=gm.FILL_SYMBOL,e}var _L={locked:!1,visible:!0},mL=(y(vL,gL),c(vL,[{key:"readJson",value:function(t){d(vL.prototype.__proto__||Object.getPrototypeOf(vL.prototype),"readJson",this).call(this,t),this.options.locked=t.color_locked,this.options.visible=t.visible}},{key:"toJson",value:function(t){t&&(d(vL.prototype.__proto__||Object.getPrototypeOf(vL.prototype),"toJson",this).call(this,t),t.color_locked=this.options.locked,t.visible=this.options.visible)}},{key:"isLocked",value:function(){return this.options.locked}},{key:"setLocked",value:function(t){this.options.locked=t}},{key:"isVisible",value:function(){return this.options.visible}},{key:"setVisible",value:function(t){this.options.visible=t}}]),vL);function vL(t){h(this,vL);var e=_(this,(vL.__proto__||Object.getPrototypeOf(vL)).call(this));return e.mergeOptions(_L,t),e}var bL={},xL=(y(EL,mL),c(EL,[{key:"readJson",value:function(t){d(EL.prototype.__proto__||Object.getPrototypeOf(EL.prototype),"readJson",this).call(this,t)}},{key:"toJson",value:function(t){t&&d(EL.prototype.__proto__||Object.getPrototypeOf(EL.prototype),"toJson",this).call(this,t)}},{key:"_drawGeometry",value:function(t,e){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=0;t.beginPath();for(var s=0;s<i;s++){var a=r[s],u=n.slice(o,o+a);XI.drawPath(t,u),o+=a}t.fillStyle=this.getColor().getStrColor(),t.fill("evenodd");var l=this.getOutlineSymbol();this.hasOutline()&&l&&l.draw(t,[e])}}}]),EL);function EL(t){h(this,EL);var e=_(this,(EL.__proto__||Object.getPrototypeOf(EL)).call(this));return e.mergeOptions(bL,t),e.class=um,e}var IL,LL=B.Layer.extend({options:{pane:Cb,zIndex:0},initialize:function(t){B.setOptions(this,t),this.renderer=this._createRenderer(),this._features=null,this._symbol=null},_createRenderer:function(){var t=this.options.pane||Cb;return new T({pane:t,zIndex:this.options.zIndex})},onAdd:function(t){t.addLayer(this.renderer)},onRemove:function(){this._map&&this._map.removeLayer(this.renderer)},setSymbol:function(t){this._symbol=t},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t)},getEvents:function(){return{moveend:this.draw,viewreset:this.draw}},addFeature:function(t){this._features||(this._features=[]),this._features.push(t)},getFeatures:function(){return this._features},setFeatures:function(t){this._features=t},addGeoJSON:function(t){var e=B.Util.isArray(t)?t:t.features,n=void 0,i=void 0,r=null;if(e)for(n=0,i=e.length;n<i;n++)((r=e[n]).geometries||r.geometry||r.features||r.coordinates)&&this.addGeoJSON(r);(r=P_.createFeatureFromGeoJSON(t))&&this.addFeature(r)},clearRenderer:function(){this.renderer.clear()},clear:function(){this._features=null,this.clearRenderer()},draw:function(){var i=this;if(this.clearRenderer(),this._map&&this._features&&0!==this._features.length){var r=this.renderer.ctx;this._features.forEach(function(t){if(t){var n=i._symbol;if(n=(n=n||t.getSymbol())||i.getDefaultSymbol(t.getType()),t.getType()===M_.MULTIPOLYGON){t.getPolygons().forEach(function(t){var e=t.toPixelGeometry(i._map,!0);n.draw(r,[e])})}else{var e=t.toPixelGeometry(i._map,!0);n.draw(r,[e])}}})}},getDefaultSymbol:function(t){var e=null;switch(t){case M_.POINT:case M_.MULTIPOINT:e=new WI({color:new _m(0,0,255,255)});break;case M_.LINE:case M_.MULTILINE:e=new lL({width:1,color:new _m(0,0,0,255)});break;case M_.POLYGON:case M_.MULTIPOLYGON:e=new xL({color:new _m(203,220,245,255),hasOutline:!0,outlineSymbol:new lL})}return e}}),wL=vI.extend({options:{bSnap:!1,strokeColor:new _m(0,0,0,255),fillColor:new _m(203,220,245,100)},initialize:function(t,e){vI.prototype.initialize.call(this,t,e),this._enabled=!1,this._drawType="",this._pointArray=null,this._pixelArray=null,this._feature=null,this._drawLayer=null},enable:function(t){this.disable(),t&&(this._enabled=!0,this._drawType=t,this._drawLayer=new LL,this._drawLayer.addTo(this._map),this.setMapDragging(!1),this.setMouseStyle(t),this._map.on("mousedown",this._onClick,this),this._map.on("dblclick",this._onDblClick,this),this._map.on("mousemove",this._onMouseMove,this))},disable:function(){this._enabled&&(this._enabled=!1,this._drawType="",this._clearData(),this._drawLayer&&(this._drawLayer.clear(),this._drawLayer.remove(),this._drawLayer=null),this.setMapDragging(!0),this.setMouseStyle(),this._map.off("mousedown",this._onClick,this),this._map.off("dblclick",this._onDblClick,this),this._map.off("mousemove",this._onMouseMove,this))},_clearData:function(){this._pointArray=null,this._pixelArray=null,this._feature=null,this._drawLayer&&this._drawLayer.clear()},_finish:function(){this._clearData()},_draw:function(){this._drawLayer&&(this._drawLayer.clear(),this._feature&&(this._drawLayer.addFeature(this._feature.clone()),this._drawLayer.draw()))},_onClick:function(t){var e=t.latlng,n=new B.Point(e.lng,e.lat),i=t.layerPoint;switch(this._pixelArray||(this._pixelArray=[]),this._pointArray||(this._pointArray=[]),this._drawType){case yI.ADD_RING:case yI.CLIP_POLYGON:case yI.CREATE_POLYLINE:case yI.CREATE_POLYGON:case yI.CREATE_CIRCLE:case yI.CREATE_FILL_CIRCLE:if(0<this._pixelArray.length)if(this._pixelArray[this._pixelArray.length-1].equals(i))return}var r=null;if(this.options.bSnap){var o=this._map.seManager.getEditManager().getSnapHandler().getSnapResult();if(o){var s=o.layerId,a=this._map.seManager.getLayerById(s);if(a&&a.getDataset()){var u=a.getDataset().id,l=this._map.findDatasetById(u);if(l&&o.point){var h=l.getProjInfo().unproject(o.point);r=new B.Point(h.lng,h.lat)}}}}r?this._pointArray.push(r):this._pointArray.push(n),this._pixelArray.push(i),this._clickHandler()},_requestGeo:function(t,e){return new Promise(function(o,s){ft({data:{dataset_list:[{dataset_id:t.getID(),dataset_ver:t.getVersion(),feature_id_list:[e],query_geo:!0}]},success:function(t){if(t.status!==st.SUCCESS)s();else{var e=t.result.dataset_list;if(!e||0===e.length)return void s();var n=e[0];if(!n.geo_list||0===n.geo_list.length)return void s();var i=n.geo_list[0],r=P_.createFeatureFromGeoJSON(i);o(r)}},error:function(){s()}})})},_clickHandler:function(){switch(this._drawType){case yI.CREATE_POINT:this._feature=new N_({mapPoints:this._pointArray.slice(0),polyCount:[1],subCount:1}),this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish();break;case yI.CREATE_POLYLINE:case yI.CLIP_POLYGON:var t=this._pointArray.slice(0);this._feature?(this._feature.setMapPoints(t),this._feature.setPolyCount([t.length])):(this._feature=new O_({mapPoints:t,polyCount:[t.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.LINE))),this._draw();break;case yI.CREATE_POLYGON:var e=this._pointArray.slice(0);2<e.length&&e.push(e[0]),this._feature?(this._feature.setMapPoints(e),this._feature.setPolyCount([e.length])):(this._feature=new T_({mapPoints:e,polyCount:[e.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.POLYGON))),this._draw();break;case yI.CREATE_HAND_LINE:var n=this._pointArray.slice(0);if(console.log(n),this._feature){var i=this.getCurvePoints(this._feature),r=new O_({mapPoints:i,polyCount:[i.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:r.clone()}),this._finish()}else this._feature=new O_({mapPoints:n,polyCount:[n.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.LINE));break;case yI.CREATE_HAND_POLYGON:var o=this._pointArray.slice(0);if(this._feature){var s=this.getCurvePoints(this._feature,!0);s.push(s[0]);var a=new T_({mapPoints:s,polyCount:[s.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:a.clone()}),this._finish()}else this._feature=new O_({mapPoints:o,polyCount:[o.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.LINE));break;case yI.CREATE_RECT:case yI.CREATE_FILL_RECT:var u=this._pointArray.slice(0),l=this._pixelArray.slice(0),h=!1;3===u.length&&(u=this.getRectPoints(l),h=!0),this._feature?(this._feature.setMapPoints(u),this._feature.setPolyCount([u.length])):this._drawType===yI.CREATE_RECT?(this._feature=new O_({mapPoints:u,polyCount:[u.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.LINE))):(this._feature=new T_({mapPoints:u,polyCount:[u.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.POLYGON))),this._draw(),h&&(this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish());break;case yI.CREATE_CIRCLE:case yI.CREATE_FILL_CIRCLE:var c=this._pointArray.slice(0);this._pixelArray.slice(0);this._feature?(c=this.getCirclePoints(c),this._feature.setMapPoints(c),this._feature.setPolyCount([c.length]),this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish()):this._drawType===yI.CREATE_CIRCLE?(this._feature=new O_({mapPoints:c,polyCount:[c.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.LINE))):(this._feature=new T_({mapPoints:c,polyCount:[c.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.POLYGON)));break;case yI.CREATE_ELLIPSE:case yI.CREATE_FILL_ELLIPSE:var p=this._pointArray.slice(0),f=this._pixelArray.slice(0),d=!1;if(3===p.length){var g=this.getEllipsePoints(f);g&&0<g.length&&(p=g),d=!0}else if(2===p.length){p=[new B.Point(2*p[0].x-p[1].x,2*p[0].y-p[1].y),p[1]]}this._feature?(this._feature.setMapPoints(p),this._feature.setPolyCount([p.length])):this._drawType===yI.CREATE_ELLIPSE?(this._feature=new O_({mapPoints:p,polyCount:[p.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.LINE))):(this._feature=new T_({mapPoints:p,polyCount:[p.length],subCount:1}),this._feature.setSymbol(this.getDefaultSymbol(M_.POLYGON))),this._draw(),d&&(this.fire("end",{drawType:this._drawType,feature:this._feature.clone()}),this._finish())}},_onDblClick:function(){if(this._pointArray&&0!==this._pointArray.length){var t=this._pointArray.slice(0);switch(this._drawType){case yI.CREATE_POLYLINE:case yI.CLIP_POLYGON:if(t.length<=1)break;var e=new O_({mapPoints:t,polyCount:[t.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:e}),this._finish();break;case yI.ADD_RING:case yI.CREATE_POLYGON:if(t.length<=2)break;t.push(t[0].clone());var n=new T_({mapPoints:t,polyCount:[t.length],subCount:1});this.fire("end",{drawType:this._drawType,feature:n}),this._finish()}}},_onMouseMove:function(t){if(this._pointArray&&0!==this._pointArray.length&&this._feature){this.autoPanMap(t);var e=t.latlng,n=new B.Point(e.lng,e.lat),i=t.layerPoint,r=this.adjust(i);if(r){var o=this._map.layerPointToLatLng(r);n=new B.Point(o.lng,o.lat),i=r.clone()}if(this.options.bSnap){var s=this._map.seManager.getEditManager().getSnapHandler();if(s&&n){var a=s._getSnapResult(new B.LatLng(n.y,n.x));s.setSnapResult(a)}}switch(this._drawType){case yI.CREATE_POLYLINE:case yI.CLIP_POLYGON:var u=this._pointArray.slice(0);u.push(n),this._feature.setMapPoints(u),this._feature.setPolyCount([u.length]),this._draw();break;case yI.ADD_RING:case yI.CREATE_POLYGON:var l=this._pointArray.slice(0);l.push(n),2<=this._pointArray.length&&l.push(this._pointArray[0]),this._feature.setMapPoints(l),this._feature.setPolyCount([l.length]),this._draw();break;case yI.CREATE_HAND_LINE:case yI.CREATE_HAND_POLYGON:var h=this._pointArray.slice(0);h.push(n);var c=this._pixelArray[this._pixelArray.length-1];5<Math.sqrt(Math.pow(c.x-i.x,2)+Math.pow(c.y-i.y,2))&&(this._pixelArray.push(i),this._pointArray.push(n)),this._feature.setMapPoints(h),this._feature.setPolyCount([h.length]),this._draw();break;case yI.CREATE_RECT:case yI.CREATE_FILL_RECT:var p=this._pointArray.slice(0);p.push(n);var f=this._pixelArray.slice(0);f.push(i),3===p.length&&(p=this.getRectPoints(f)),this._feature.setMapPoints(p),this._feature.setPolyCount([p.length]),this._draw();break;case yI.CREATE_CIRCLE:case yI.CREATE_FILL_CIRCLE:var d=this._pointArray.slice(0);if(d.push(n),this._pixelArray.slice(0).push(i),d.length<2)break;d=this.getCirclePoints(d),this._feature.setMapPoints(d),this._feature.setPolyCount([d.length]),this._draw();break;case yI.CREATE_ELLIPSE:case yI.CREATE_FILL_ELLIPSE:var g=this._pointArray.slice(0);g.push(n);var y=this._pixelArray.slice(0);if(y.push(i),g.length<2)break;if(3===g.length){var _=this.getEllipsePoints(y);if(_&&0<_.length)g=_;else g=[new B.Point(2*g[0].x-g[1].x,2*g[0].y-g[1].y),g[1]]}else if(2===g.length){g=[new B.Point(2*g[0].x-g[1].x,2*g[0].y-g[1].y),g[1]]}this._feature.setMapPoints(g),this._feature.setPolyCount([g.length]),this._draw()}}},getDefaultSymbol:function(t){var e=null;switch(t){case M_.POINT:e=new WI({color:this.options.fillColor});break;case M_.LINE:e=new lL({width:1,color:this.options.strokeColor});break;case M_.POLYGON:case M_.MULTIPOLYGON:e=new xL({color:this.options.fillColor,hasOutline:!0,outlineSymbol:new lL({color:this.options.strokeColor})})}return e},getCurvePoints:function(t,e){var n=t.toGeoJSON().geometry.coordinates,i=null;if(1<n.length){if(e){var r=n[0];n.push([r[0],r[1]])}var o=E_.lineString(n),s=E_.bezierSpline(o);i=P_.createFeatureFromGeoJSON(s).getMapPoints()}else i=t.getMapPoints();return i},getRectPoints:function(t){if(!t||3!==t.length)return null;var e=[],n=t[0],i=t[1],r=t[2];if(n.x===i.x||n.y===i.y){var o=n.x<r.x?n.x:r.x,s=n.x>r.x?n.x:r.x,a=n.y<r.y?n.y:r.y,u=n.y>r.y?n.y:r.y,l=this._map.layerPointToLatLng(new B.Point(o,a)),h=this._map.layerPointToLatLng(new B.Point(o,u)),c=this._map.layerPointToLatLng(new B.Point(s,u)),p=this._map.layerPointToLatLng(new B.Point(s,a));return e.push(new B.Point(l.lng,l.lat),new B.Point(h.lng,h.lat),new B.Point(c.lng,c.lat),new B.Point(p.lng,p.lat),new B.Point(l.lng,l.lat)),e}var f=(i.y-n.y)/(i.x-n.x),d=n.y-f*n.x,g=(r.y+r.x/f-d)/(f+1/f),y=f*g+d,_=n.x+(r.x-g),m=r.y+(n.y-y),v=this._map.layerPointToLatLng(n),b=this._map.layerPointToLatLng(new B.Point(g,y)),x=this._map.layerPointToLatLng(r),E=this._map.layerPointToLatLng(new B.Point(_,m));return e.push(new B.Point(v.lng,v.lat),new B.Point(b.lng,b.lat),new B.Point(x.lng,x.lat),new B.Point(E.lng,E.lat),new B.Point(v.lng,v.lat)),e},getCirclePoints:function(t){if(!t||t.length<2)return null;var e=[],n=t[0],i=t[1],r=Math.sqrt(Math.pow(i.x-n.x,2)+Math.pow(i.y-n.y,2)),o=r;return S_.convArc2PLine(e,n,r,o,0,0,2*Math.PI),e},getEllipsePoints:function(t){if(!t||3!==t.length)return null;var e=[],n=t[0],i=t[1],r=t[2];if(n.x===i.x||n.y===i.y){var o,s;o=Math.abs(r.x-n.x),s=Math.abs(r.y-n.y),S_.convArc2PLine(e,n,o,s,0,0,2*Math.PI)}else{var a=(i.y-n.y)/(i.x-n.x),u=n.y-a*n.x,l=(r.y+r.x/a-u)/(a+1/a),h=a*l+u,c=new B.Point(l,h),p=Math.sqrt(Math.pow(n.x-c.x,2)+Math.pow(n.y-c.y,2)),f=Math.sqrt(Math.pow(r.x-c.x,2)+Math.pow(r.y-c.y,2)),d=Math.atan((n.y-i.y)/(n.x-i.x));(d=180*d/Math.PI)<0&&(d+=180),d=d*Math.PI/180,S_.convArc2PLine(e,n,p,f,d,0,2*Math.PI)}for(var g=[],y=0;y<e.length;y++){var _=this._map.layerPointToLatLng(e[y]);g.push(new B.Point(_.lng,_.lat))}return g}}),SL=vI.extend({options:{bSnap:!0,strokeColor:new _m(255,0,255,255),fillColor:new _m(255,0,255,50)},initialize:function(t,e){vI.prototype.initialize.call(this,t,e),this._enabled=!1,this._editType="",this._pointArray=null,this._pixelArray=null,this._drawLayer=null},enable:function(t){if(this.disable(),t){if(this._enabled=!0,this._editType=t,this._drawLayer=new LL,this._drawLayer.addTo(this._map),this.setMapDragging(!1),this.setMouseStyle(t),this._map.on("mousedown",this._onMouseDown,this),this._map.on("mousemove",this._onMouseMove,this),this._map.on("mouseup",this._onMouseUp,this),this._editType===yI.ADD_NODE||this._editType===yI.EDIT_NODE||this._editType===yI.DELETE_NODE)this._map.seManager.getEditManager().draw();if(this._editType==yI.VIEW_NODE)this._map.seManager.getEditManager().draw()}},disable:function(){this._enabled&&(this._enabled=!1,this._editType="",this._clearData(),this._drawLayer&&(this._drawLayer.clear(),this._drawLayer.remove(),this._drawLayer=null),this.setMapDragging(!0),this.setMouseStyle(),this._map.off("mousedown",this._onMouseDown,this),this._map.off("mousemove",this._onMouseMove,this),this._map.off("mouseup",this._onMouseUp,this),this._map.seManager.getEditManager().draw())},_clearData:function(){this._pointArray=null,this._pixelArray=null,this._editNodeResult=null;var t=this._map.seManager.getEditManager();t&&(t.tempEditNodeFeature=null),this._drawLayer&&this._drawLayer.clear()},_finish:function(){this._clearData()},_getEditFeatures:function(){var t=this._map.seManager.getEditManager().getCurrentEditFeatures();if(!t||0===t.length)return null;var e=[];return t.forEach(function(t){e.push(t.clone())}),e},_getSelectionLayerId:function(){var t=this._map.getSelection(),e=null;return t&&0<t.length&&(e=t[0]),e?e.getLayerId():null},_getSeletionsFeature:function(){var t=this._map.getSelection(),e=null;t&&0<t.length&&(e=t[0]);var n=this._map.getLayerById(e.getLayerId());if(n&&e&&1==e.getCount()){var i=n.getDataset(),r=i&&i.getID(),o=this._map.findDatasetById(r);if(o){var s=o.getFeatureById(e.getIds()[0]);return s&&s.clone()}}return null},_draw:function(t){if(t&&0!==t.length&&this._drawLayer){var e=this.getDefaultSymbol(t[0].getType());this._drawLayer.clear(),this._drawLayer.setFeatures(t),this._drawLayer.setSymbol(e),this._drawLayer.draw()}},_onMouseDown:function(t){if(this._enabled){var e=this._map.seManager.getEditManager();if(e.hasEditFeature()){var n=e.getSnapHandler(),i=t.latlng,r=t.layerPoint;switch(this._pointArray||(this._pointArray=[]),this._pixelArray||(this._pixelArray=[]),this._editNodeResult=null,this._editType){case yI.MOVE:e.bClickOnEditFeatures(i)&&this._pointArray.push(i);break;case yI.ROTATE:this._pointArray.push(i),this._pixelArray.push(r);break;case yI.EDIT_NODE:var o=this._getEditFeatures();if(!o||1!==o.length)break;var s=o[0],a=n.getSnapNode(s,i,null,8);a&&a.snapPoint&&(this._editNodeResult=a,this._pointArray.push(i))}}}},_onMouseMove:function(t){if(this._enabled){if(this._editType!=yI.VIEW_NODE){if(!this._pointArray||0===this._pointArray.length)return;this.autoPanMap(t)}var e=t.latlng,n=null,i=t.layerPoint,r=this.adjust(i);if(r)n=this._map.layerPointToLatLng(r).clone();else n=e.clone();if(this.options.bSnap&&this._editType!=yI.VIEW_NODE){var o=this._map.seManager.getEditManager().getSnapHandler();if(o&&n){var s=o._getSnapResult(n);o.setSnapResult(s)}}var a=this._map.seManager.getEditManager();switch(this._editType){case yI.MOVE:var u=this._pointArray.slice(0);u.push(n);var l=this._getMoveFeatures(u);l&&0<l.length&&this._draw(l);break;case yI.ROTATE:var h=this._pointArray.slice(0);h.push(n),this._pixelArray.slice(0).push(i);var c=this._getRotateFeatures(h);c&&0<c.length&&this._draw(c);break;case yI.EDIT_NODE:if(!this._editNodeResult)break;var p=this._getEditFeatures();if(!p||1!==p.length)break;var f=p[0],d=f.getProjInfo().project(n),g=f.clone();g.editNode(this._editNodeResult,d),a.tempEditNodeFeature=g?g.clone():null,g&&a.drawEditNodes(g);break;case yI.VIEW_NODE:var y=this._getSeletionsFeature();if(!y)break;var _=a.getSnapHandler(),m=_.getSnapNode(y,n,null,8);m&&m.snapPoint&&this._getSelectionLayerId()&&(m.layerId=this._getSelectionLayerId()),_.setSnapResult(m),this._map.fire("view-node-coord",{data:m,latlng:n})}}},_onMouseUp:function(t){if(this._enabled){var e=this._map.seManager.getEditManager(),n=e.getSnapHandler(),i=t.latlng,r=t.layerPoint;switch(this._editType){case yI.MOVE:if(!this._pointArray||0===this._pointArray.length)break;var o=this._pointArray.slice(0);o.push(i);var s=this._getMoveFeatures(o);this.fire("end",{editType:this._editType,features:s}),this._finish();break;case yI.ROTATE:if(!this._pointArray||0===this._pointArray.length)break;var a=this._pointArray.slice(0);a.push(i),this._pixelArray.slice(0).push(r);var u=this._getRotateFeatures(a);this.fire("end",{editType:this._editType,features:u}),this._finish();break;case yI.ADD_NODE:var l=this._getEditFeatures();if(!l||1!==l.length)break;var h=l[0],c=n.getSnapMapPoint(h,i);if(!c||!c.snapPoint){e.fire("editTip",{tip:DI});break}var p=h?h.clone():null;p&&p.addNode(c),p&&this.fire("end",{editType:this._editType,features:[p]}),this._finish();break;case yI.DELETE_NODE:var f=this._getEditFeatures();if(!f||1!==f.length)break;var d=f[0],g=n.getSnapNode(d,i,null,8);if(!g||!g.snapPoint){e.fire("editTip",{tip:AI});break}var y=d?d.clone():null;y&&y.deleteNode(g),y&&this.fire("end",{editType:this._editType,features:[y]}),this._finish();break;case yI.CLIP_LINE:var _=this._getEditFeatures();if(!_||1!==_.length)break;var m=_[0],v=n.getSnapMapPoint(m,i);if(!v||!v.snapPoint){e.fire("editTip",{tip:kI});break}var b=m.clone().clipLine(v);b&&this.fire("end",{editType:this._editType,data:b}),e.center=null,this._finish();break;case yI.EDIT_NODE:if(!this._editNodeResult)break;var x=this._getEditFeatures();if(!x||1!==x.length)break;var E=n.getSnapResult(),I=x[0],L=null;if(E&&E.point)L=E.point;else L=I.getProjInfo().project(i);if(L){var w=I.clone();w.editNode(this._editNodeResult,L),w&&this.fire("end",{editType:this._editType,features:[w]})}this._finish()}}},_getSnapGeoHandler:function(t,i){var r=this,o=this._map.seManager.getEditManager().getSnapHandler(),e=t.layerId,n=t.featureId,s=this._map.seManager.getLayerById(e);if(s&&s.getDataset()){var a=s.getDataset();this._requestGeo(a,n).then(function(t){var e=o.getSnapMapPoint(t,i,a.getProjInfo());if(e&&e.snapPoint){var n=a.getProjInfo().unproject(e.snapPoint);r._snapMouseUp(n)}else r._snapMouseUp(i)}).catch(function(){r._snapMouseUp(i)})}else this._snapMouseUp(i)},_snapMouseUp:function(t){switch(this._editType){case yI.EDIT_NODE:if(!this._editNodeResult)break;var e=this._getEditFeatures();if(!e||1!==e.length)break;var n=e[0],i=n.getProjInfo().project(t),r=this._editNode(n,this._editNodeResult,i);r&&this.fire("end",{editType:this._editType,features:[r]}),this._finish()}},_requestGeo:function(t,e){return new Promise(function(o,s){ft({data:{dataset_list:[{dataset_id:t.getID(),dataset_ver:t.getVersion(),feature_id_list:[e],query_geo:!0}]},success:function(t){if(t.status!==st.SUCCESS)s();else{var e=t.result.dataset_list;if(!e||0===e.length)return void s();var n=e[0];if(!n.geo_list||0===n.geo_list.length)return void s();var i=n.geo_list[0],r=P_.createFeatureFromGeoJSON(i);o(r)}},error:function(){s()}})})},getDefaultSymbol:function(t){var e=null,n=this.options.strokeColor,i=this.options.fillColor;switch(t){case M_.POINT:e=new WI({color:i,hasOutline:!0,outlineColor:n,size:12});break;case M_.LINE:e=new lL({width:2,color:n});break;case M_.POLYGON:case M_.MULTIPOLYGON:e=new xL({color:i,hasOutline:!0,outlineSymbol:new lL({color:n,width:2})})}return e},_getMoveFeatures:function(t){if(!t||2!==t.length)return null;var e=t[0],n=t[1],i=this._getEditFeatures();if(!i||0===i.length)return null;var r=this._map.seManager.getEditManager().getEditLayer().getDataset().getProjInfo(),o=r.project(e),s=r.project(n),a=s.x-o.x,u=s.y-o.y;return i.forEach(function(t){t&&t.move(a,u)}),i},_getMovePoints:function(t,e,n){t&&0!==t.length&&t.forEach(function(t){t.x+=e,t.y+=n})},_getRotateFeatures:function(t){var e=this;if(!t||2!==t.length)return null;var n=t[0],i=t[1],r=this._getEditFeatures();if(!r||0===r.length)return null;var o=this._map.seManager.getEditManager(),s=o.getEditLayer().getDataset().getProjInfo(),a=s.project(n),u=s.project(i),l=o.getCenterByFeatures(r),h=Math.atan2(a.y-l.y,a.x-l.x),c=Math.atan2(u.y-l.y,u.x-l.x)-h;return r.forEach(function(t){t&&t.romate(l,c,e._map)}),r},_getRotateFeatures2:function(t){if(!t||2!==t.length)return null;var e=t[0],n=t[1],i=this._getEditFeatures();if(!i||0===i.length)return null;var r=this._map.seManager.getEditManager(),o=r.getEditLayer().getDataset().getProjInfo(),s=r.getCenterByFeatures(i),a=o.unproject(s),u=this._map.latLngToLayerPoint(a),l=Math.atan2(u.y-e.y,e.x-u.x),h=Math.atan2(u.y-n.y,n.x-u.x)-l;return i.forEach(function(t){t&&t.romate(s,h)}),i},_getRotatePoints:function(t,e,n){t&&0!==t.length&&t.forEach(function(t){S_.rotatePoint(t,e,n)})},_addNode:function(t,e){var n=e.pointIndex,i=e.subIndex,r=e.points,o=e.snapPoint;if(!o||!r||0===r.length)return null;var s=t.clone(),a=s;if(s.getType()===M_.MULTIPOLYGON){var u=s.getPolygons();if(!u)return null;var l=e.geoIndex;if(u.length<=l)return null;a=u[l]}var h=a.getMapPoints(),c=a.getPolyCount();return h.length<=n+1?null:c.length<=i?null:(h.splice(n+1,0,o),c[i]++,s)},_clipLine:function(t,e){var n=e.pointIndex,i=e.snapPoint;if(!i)return null;for(var r=t.clone(),o=r.getMapPoints(),s=r.getPolyCount(),a=r.getSubCount(),u=[],l=0,h=0;h<a;h++){var c=s[h];if(n<l+c){(u=o.slice(n+1,l+c)).unshift(i);var p=l+c-(n+1);o.splice(n+1,p,i),s[h]=c-p+1;break}l+=c}return[r,new O_({mapPoints:u,polyCount:[u.length],subCount:1})]},_editNode:function(t,e,n){var i=e.pointIndex,r=t.clone(),o=r;if(r.getType()===M_.MULTIPOLYGON){var s=r.getPolygons();if(!s)return null;var a=e.geoIndex;if(s.length<=a)return null;o=s[a]}var u=o.getMapPoints();return u.length<=i?null:(u[i].x=n.x,u[i].y=n.y,r)}}),ML=B.Evented.extend({options:{},initialize:function(t,e){B.setOptions(this,e),this._map=t,this._action=yI.PAN,this._selectTool=new bI(t),this._selectTool.on("end",this._selectEnd,this),this._seDrawTool=new wL(t,{bSnap:!0}),this._seDrawTool.on("end",this._drawEnd,this),this._seEditTool=new SL(t),this._seEditTool.on("end",this._editEnd,this),this._measurePathTool=new F(this._map),this._measureAreaTool=new A(this._map),this._selectAction=new EI(this._map)},getAction:function(){return this._action},clearMeasure:function(){this._measurePathTool.clear(),this._measureAreaTool.clear()},_selectEnd:function(t){if(t&&t.points&&t.points.length){var e=t.selectType,n=t.points;this._selectAction.select(e,n,t.isMultySelect)}},_drawEnd:function(t){if(t&&t.feature)if(t.drawType===yI.CLIP_POLYGON){var e=this._map.seManager.getEditManager();e.clipPolygon(t.feature),e.center=null}else{var n=this._map.getEditLayer(),i=n&&n.getDataset(),r=null;if(i){var o=i.id;r=this._map.findDatasetById(o).createEmptyProperties()}if(r){var s=t.feature;s.setProperties(r),this._map.fire("add_features",{features:[s],drawType:t.drawType})}else console.log("sdk draw error")}},_editEnd:function(t){var e=this._map.seManager.getEditManager();if(t.editType===yI.CLIP_LINE)e.clipLine(t.data),e.center=null;else{if(t.editType===yI.MOVE&&(e.center=null),!t||!t.features||0===t.features.length)return;var n=this._map.getEditLayer().getDataset().getID();this._map.findDatasetById(n);this._map.fire("modify_features",{features:t.features})}},setAction:function(t,e){e=e||{};var n=this._map.seManager.getEditManager();n.snapDisable();var i,r=n.getEditLayer(),o=null;switch(r&&(o=r.getDataset()),t){case yI.PAN:this._action=t,this._initTool();break;case yI.IDENTIFY:case yI.IDENTIFY_EXT:case yI.SELECT_BY_POINT:case yI.SELECT_BY_RECT:case yI.SELECT_BY_CIRCLE:case yI.SELECT_BY_POLYGON:this._action=t,this._initTool(),this._selectTool.enable(t);break;case yI.MEASURE_DISTANCE:this._action=t,this._initTool(),this._measurePathTool.enable();break;case yI.MEASURE_AREA:this._action=t,this._initTool(),this._measureAreaTool.enable();break;case yI.CREATE_POINT:!r||!o||o.getType()!==Sm.POINT&&o.getType()!==Mm.POINT?n.fire("editTip",{tip:II}):(this._action=t,this._initTool(),n.snapEnable(),this._seDrawTool.enable(t));break;case yI.CREATE_POLYLINE:case yI.CREATE_HAND_LINE:case yI.CREATE_RECT:case yI.CREATE_CIRCLE:case yI.CREATE_ELLIPSE:!r||!o||o.getType()!==Sm.LINE&&o.getType()!==Mm.LINE?n.fire("editTip",{tip:II}):(this._action=t,this._initTool(),n.snapEnable(),this._seDrawTool.enable(t));break;case yI.CREATE_POLYGON:case yI.CREATE_HAND_POLYGON:case yI.CREATE_FILL_RECT:case yI.CREATE_FILL_CIRCLE:case yI.CREATE_FILL_ELLIPSE:case yI.ADD_RING:!r||!o||o.getType()!==Sm.POLYGON&&o.getType()!==Mm.POLYGON?n.fire("editTip",{tip:II}):(this._action=t,this._initTool(),n.snapEnable(),this._seDrawTool.enable(t));break;case yI.MOVE:case yI.ROTATE:if(!n.hasEditFeature()){n.fire("editTip",{tip:wI});break}if(n.isOutMaxCount()){n.fire("editTip",{tip:LI});break}this._action=t,this._initTool(),n.snapEnable(),this._seEditTool.enable(t);break;case yI.ADD_NODE:case yI.EDIT_NODE:case yI.DELETE_NODE:case yI.CLIP_LINE:if(!n.hasEditFeature()){n.fire("editTip",{tip:wI});break}if(1<n.getEditCount()){n.fire("editTip",{tip:SI});break}this._action=t,this._initTool(),n.snapEnable(),this._seEditTool.enable(t);break;case yI.VIEW_NODE:var s=this._map.getSelection(),a=null;s&&0<s.length&&(a=s[0]),a&&1==a.getCount()?(this._action=t,this._initTool(),n.snapEnable(),this._seEditTool.enable(t)):n.fire("editTip",{tip:GI});break;case yI.CLIP_POLYGON:if(!r||!o||o.getType()!==Sm.POLYGON&&o.getType()!==Mm.POLYGON){n.fire("editTip",{tip:II});break}if(!n.hasEditFeature()){n.fire("editTip",{tip:wI});break}if(1<n.getEditCount()){n.fire("editTip",{tip:MI});break}this._action=t,this._initTool(),n.snapEnable(),this._seDrawTool.enable(t);break;default:e.error&&e.error(i)}this._map&&this._map.fire("action-change"),e.success&&e.success()},_initTool:function(){this._selectTool.disable(),this._seDrawTool.disable(),this._seEditTool.disable(),this._measurePathTool.disable(),this._measureAreaTool.disable()}}),CL=B.Layer.extend({options:{},initialize:function(t){B.setOptions(this,t),this.id=S_.stamp(),this.sId=-1,this.name="",this.label="",this.visible=!0,this.selected=!0,this.type=dI.SEGROUPLAYER,this._layers=null,this.renderStyle=new Om,this.minScale=0,this.maxScale=0,this._parentLayerId=-1},clone:function(){var t=new CL(this.options);if(t.id=this.id,t.sId=this.sId,t.name=this.name,t.label=this.label,t.visible=this.visible,t.selected=this.selected,t.type=this.type,t.renderStyle=this.renderStyle?this.renderStyle.clone():null,t.minScale=this.minScale,t.maxScale=this.maxScale,t._parentLayerId=this._parentLayerId,this._layers&&0<this._layers.length){var e=[];this._layers.forEach(function(t){e.push(t.clone())}),t._layers=e}return t},getType:function(){return this.type},getParentLayerId:function(){return this._parentLayerId},setParentLayerId:function(t){this._parentLayerId=t},getID:function(){return this.id},getName:function(){return this.name},setName:function(t){this.name=t,this.label=t},isVisible:function(){return this.visible},setVisible:function(t){this.visible=t},isSelected:function(){return this.selected},setSelected:function(t){this.selected=t},getRenderStyle:function(){return this.renderStyle},setRenderStyle:function(t){this.renderStyle=t},getMinScale:function(){return this.minScale},setMinScale:function(t){this.minScale=t},getMaxScale:function(){return this.maxScale},setMaxScale:function(t){this.maxScale=t},getLayers:function(t){if(!t)return this._layers;var e=[];return this._mapGroupLayer(this._layers,e),e},setLayers:function(t){this._layers=t},_mapGroupLayer:function(t,e){var n=this;t&&0!==t.length&&t.forEach(function(t){t&&(t.getType()===dI.SEGROUPLAYER?n._mapGroupLayer(t.getLayers(),e):e.push(t))})},addLayer:function(t,e){t&&(this._layers||(this._layers=[]),t.setParentLayerId(this.getID()),e?this._layers.unshift(t):this._layers.push(t))},addLayers:function(t){if(t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];n&&this.addLayer(n)}},removeLayer:function(t){if(t&&this._layers&&this._layers.length){var e=this._layers.indexOf(t);0<=e&&this._layers.splice(e,1)}},hasLayer:function(t){return!!(t&&this._layers&&this._layers.length)&&0<=this._layers.indexOf(t)},getRequestObj:function(t,e){return this._getRequestObj(this,t,e)},_getRequestObj:function(t,e,n){if(t){var i=t.getLayers();if(i&&0!==i.length&&t.visible)if(t.isQuery(n))for(var r=i.length,o=0;o<r;o++){var s=i[o];s&&(s.getType()===dI.SEGROUPLAYER?this._getRequestObj(s,e,n):s.dataset&&s.getRequestObj(e,n))}}},isQuery:function(t){if(0<=t){if(t=1/t,0===this.maxScale&&0===this.minScale)return!0;if(0===this.maxScale&&0<this.minScale&&t>=1/this.minScale)return!0;if(0<this.maxScale&&0===this.minScale&&t<=1/this.maxScale)return!0;if(0<this.maxScale&&0<this.minScale&&t<=1/this.maxScale&&t>=1/this.minScale)return!0}return!1},clearData:function(){this._layers&&0!==this._layers.length&&this._layers.forEach(function(t){t&&t.clearData()})},readJson:function(t,e){if(t){if(this.expand=!!t.expand,this.sId=void 0!==t.id?t.id:-1,this.name=t.name?t.name:"",this.label=t.label?t.label:"",this.visible=!!t.visible,this.minScale=t.min_scale?t.min_scale:0,this.maxScale=t.max_scale?t.max_scale:0,t.legend_group){this.renderStyle=new Om;var n=new W_;n.readJson(t.legend_group),this.renderStyle.setLegendGroup(n)}if(t.sub_layer_list&&0<t.sub_layer_list.length)for(var i=t.sub_layer_list,r=i.length,o=0;o<r;o++){var s=i[o];if(s){var a=null;(a=s.class===dI.SEGROUPLAYER?new CL:new gI)&&(a.readJson(s,e),this.addLayer(a))}}}},toJson:function(){var t={};this.renderStyle&&this.renderStyle.getLegendGroup()&&this.renderStyle.getLegendGroup().toJson(t);var e=[];return this._layers&&0<this._layers.length&&this._layers.forEach(function(t){t&&e.push(t.toJson())}),{class:this.getType(),expand:this.expand,id:this.id,name:this.name,label:this.label,visible:this.visible,min_scale:this.minScale,max_scale:this.maxScale,legend_group:t,sub_layer_list:e}},draw:function(t,e){if(this.visible&&this.renderStyle&&this._layers&&this._layers.length)if(this.renderStyle.bDrawByLegendGroup())this._drawByMerged(t,e);else for(var n=this._layers.length-1;0<=n;n--){var i=this._layers[n];i&&i.draw(t,e)}},_drawByMerged:function(n,h){var t=this.getLayers(!0),c={};t.forEach(function(t){if(t){var e=t.getGroupFeatures(n);e&&S_.extend(c,e)}});var e=this.renderStyle.getLegendGroup(),i=e.getLegendClasses(),r=e.getLayerIndexList();r&&0!==r.length&&r.forEach(function(l){i.forEach(function(t){var e=t.getLayerIndexList();if(e){var n=e.indexOf(l);if(-1!==n){var i=t.getRenderItemId(),r=c[i];if(r){var o=r.renderItem,s=r.geometrys,a=o.getSymbol();if(!(a.getSymbolLayerCount()<=n)){var u=a.getSymbolLayer(n);u&&u.draw(h,s)}}}}})})}}),PL=B.Layer.extend({options:{pane:Sb,zIndex:0},initialize:function(t){B.setOptions(this,t),this.renderer=this._createRenderer(),this._seSelections=null},_createRenderer:function(){var t=this.options.pane||Sb;return new T({pane:t,zIndex:this.options.zIndex})},onAdd:function(t){t.addLayer(this.renderer)},onRemove:function(){this._map&&this._map.removeLayer(this.renderer)},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t)},addSelection:function(t){t&&(this._seSelections||(this._seSelections=[]),this._seSelections.push(t))},findSelectionIndexByLayerID:function(t){if(void 0===t||null==t)return-1;for(var e=this._seSelections?this._seSelections.length:0,n=0;n<e;n++)if(this._seSelections[n].getLayerId()===t)return n;return-1},removeSelectionByLayerID:function(t){var e=this.findSelectionIndexByLayerID(t);return 0<=e&&(this._seSelections.splice(e,1),!0)},getSelectionByLayerID:function(t){var e=this.findSelectionIndexByLayerID(t);return 0<=e?this._seSelections[e]:null},getSelections:function(){return this._seSelections},clearRenderer:function(){this.renderer.clear()},clear:function(){var t=this.getEditFeatureIds();t&&0<t.length&&this._map.seManager.getEditManager().clear();this._seSelections=null,this.clearRenderer()},getEditFeatureIds:function(){var t=this._map.seManager.getEditManager().getEditLayer();if(!t)return null;if(!this._seSelections||0===this._seSelections.length)return null;for(var e=0;e<this._seSelections.length;e++){var n=this._seSelections[e];if(n){var i=n.getIds();if(i&&0!==i.length&&n.getLayerId()===t.getID())return i}}return null},draw:function(){var h=this,t=this.getEditFeatureIds(),e=this._map.seManager.getEditManager();if(e&&(t&&0<t.length?e.setGeoIds(t):e.draw()),this.clearRenderer(),this._seSelections&&0!==this._seSelections.length)for(var c=this.renderer.ctx,p=this._map.seManager,f=this._seSelections,n=function(t){var e=f[t];if(!e||e.isNull())return"continue";var n=e.getLayerId(),i=p.getLayerById(n);if(!i||!i.dataset)return"continue";var r=i.dataset,o=i.getFeatures(),s=h._map.findDatasetById(r.id);if(!o||0==o.length||!s)return"continue";var a=h._getSymbol(s.getType()),u=e.getIds(),l=o.length;u.forEach(function(t){for(var e=0;e<l;e++)if(o[e].id==t){var n=s.getFeatureByIndex(o[e].sIndex);if(n){if(n.getType()==M_.MULTIPOLYGON){var i=n.getPolygons();i&&i.forEach(function(t){var e=t.toPixelGeometry(h._map,!0);a.draw(c,[e])});break}var r=n.toPixelGeometry(h._map,!0);a.draw(c,[r]);break}}})},i=f.length-1;0<=i;i--)n(i)},_getSymbol:function(t){var e=this._map.seManager.getSelectSetting().color,n=null;switch(t){case Mm.POINT:case Sm.POINT:n=new WI({color:e,size:12});break;case Mm.LINE:case Sm.LINE:case Mm.POLYGON:case Sm.POLYGON:n=new lL({width:3,color:e})}return n}}),NL=j(function(t,e){function b(t,e){this.x=t||0,this.y=e||0}function n(t,e){return t==e}function g(t,e){this.UpperLeftCorner=t||new b,this.LowerRightCorner=e||new b}function u(t,e){return t*e}function I(t,e){return t<<e}function i(t,e){this.data_=null,this.pixel_bits_=8,this.bounds_=null,this.stride_=-1,this.Init(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,g.prototype={getWidth:function(){return this.LowerRightCorner&&this.UpperLeftCorner?Math.abs(this.LowerRightCorner.x-this.UpperLeftCorner.x):0},getHeight:function(){return this.LowerRightCorner&&this.UpperLeftCorner?Math.abs(this.LowerRightCorner.y-this.UpperLeftCorner.y):0},Width:function(){var t=this.getWidth();return t<0&&(t=-t),t},Height:function(){var t=this.getHeight();return t<0&&(t=-t),t},NormalizeRect:function(){this.UpperLeftCorner.x>this.LowerRightCorner.x&&this.SwapLeftRight(),this.UpperLeftCorner.y>this.LowerRightCorner.y&&this.SwapTopBottom()},NormalizeGeoRect:function(){this.UpperLeftCorner.x>this.LowerRightCorner.x&&this.SwapLeftRight(),this.UpperLeftCorner.y<this.LowerRightCorner.y&&this.SwapTopBottom()},SwapLeftRight:function(){var t=this.UpperLeftCorner.x;this.UpperLeftCorner.x=this.LowerRightCorner.x,this.LowerRightCorner.x=t},SwapTopBottom:function(){var t=this.UpperLeftCorner.y;this.UpperLeftCorner.y=this.LowerRightCorner.y,this.LowerRightCorner.y=t},IntersectRect:function(t,e){return t.IsIntersect(e)?(this.UpperLeftCorner.x=Math.max(t.UpperLeftCorner.x,e.UpperLeftCorner.x),this.LowerRightCorner.x=Math.min(t.LowerRightCorner.x,e.LowerRightCorner.x),this.UpperLeftCorner.y=Math.max(t.UpperLeftCorner.y,e.UpperLeftCorner.y),this.LowerRightCorner.y=Math.min(t.LowerRightCorner.y,e.LowerRightCorner.y),!0):(this.SetNULL(),!1)},SetNULL:function(){this.UpperLeftCorner.x=this.UpperLeftCorner.y=0,this.LowerRightCorner.x=this.LowerRightCorner.y=0},IsIntersect:function(t){var e;return t.UpperLeftCorner.y>=t.LowerRightCorner.y&&this.UpperLeftCorner.y>=this.LowerRightCorner.y?(this.LowerRightCorner.x>=t.UpperLeftCorner.x||n(this.LowerRightCorner.x-t.UpperLeftCorner.x))&&(this.UpperLeftCorner.x<=t.LowerRightCorner.x||n(this.UpperLeftCorner.x-t.LowerRightCorner.x))&&(this.LowerRightCorner.y<=t.UpperLeftCorner.y||n(this.LowerRightCorner.y-t.UpperLeftCorner.y))&&(this.UpperLeftCorner.y>=t.LowerRightCorner.y||n(this.UpperLeftCorner.y-t.LowerRightCorner.y)):t.UpperLeftCorner.y<=t.LowerRightCorner.y&&this.UpperLeftCorner.y<=this.LowerRightCorner.y?(this.LowerRightCorner.x>=t.UpperLeftCorner.x||n(this.LowerRightCorner.x-t.UpperLeftCorner.x))&&(this.UpperLeftCorner.x<=t.LowerRightCorner.x||n(this.UpperLeftCorner.x-t.LowerRightCorner.x))&&(this.LowerRightCorner.y>=t.UpperLeftCorner.y||n(this.LowerRightCorner.y-t.UpperLeftCorner.y))&&(this.UpperLeftCorner.y<=t.LowerRightCorner.y||n(this.UpperLeftCorner.y-t.LowerRightCorner.y)):(this.UpperLeftCorner.y<=this.LowerRightCorner.y?(e=t).NormalizeRect():(e=t).NormalizeGeoRect(),this.IsIntersect(e))}},i.prototype={Release:function(){return this.data_&&(this.data_=null),!0},Copy:function(t){this.data_&&(this.data_=null),this.bounds_=t.bounds_,this.pixel_bits_=t.pixel_bits_,this.stride_=t.stride_;this.bounds_.Width(),this.bounds_.Height();var e=this.ComputeAllocSize(this.pixel_bits_,this.bounds_);this.data_=new Int8Array(e);for(var n=t.data_.byteLength<e?t.data_.byteLength:e,i=0;i<n;i++)this.data_[i]=t.data_[i]},Init:function(t,e){var n=new g(new b(0,0),new b(t,e));if(n.NormalizeRect(),this.data_){if(this.bounds_==n)return Reset(),!0;this.data_=null}this.bounds_=n;var i=this.ComputeAllocSize(this.pixel_bits_,this.bounds_);return this.data_=new Int8Array(i),!0},Reset:function(){if(this.data_){var t=this.ComputeAllocSize(this.pixel_bits_,this.bounds_);this.data_=new Int8Array(t)}},IsValid:function(){return!!this.data_},ComputeAllocSize:function(t,e){return this.GetWidthBytes(t,e)*e.Height()},GetWidthBytes:function(t,e){var n=e.Width(),i=e.Height();if(n<=0||i<=0)return 0;var r=0;switch(t){case 1:case 2:break;case 3:case 4:break;case 5:case 6:case 7:case 8:r=n+1}return r},GetValue:function(t,e,n){if(!this.IsValid())return-3;if(t<this.bounds_.UpperLeftCorner.x||t>=this.bounds_.LowerRightCorner.x||e<this.bounds_.UpperLeftCorner.y||e>=this.bounds_.LowerRightCorner.y)return n.avoid_edge?-3:0;this.stride_<=0&&(this.stride_=this.GetWidthBytes(this.pixel_bits_,this.bounds_));var i=n.test_mask;switch(this.pixel_bits_){case 1:case 2:break;case 3:case 4:break;case 5:case 6:case 7:case 8:var r=u(e,this.stride_)+t;return this.data_[r]&i}return-3},SetValue:function(t,e,n){if(!this.IsValid())return!1;if(t<this.bounds_.UpperLeftCorner.x||t>=this.bounds_.LowerRightCorner.x||e<this.bounds_.UpperLeftCorner.y||e>=this.bounds_.LowerRightCorner.y)return!1;this.stride_<=0&&(this.stride_=this.GetWidthBytes(this.pixel_bits_,this.bounds_));var i=n.set_mask,r=i&n.set_value,o=!1;switch(this.pixel_bits_){case 1:case 2:break;case 3:case 4:break;case 5:case 6:case 7:case 8:var s=u(e,this.stride_)+t,a=this.data_[s];this.data_[s]=a&~i|r,o=!0}return o},PlaceRect:function(t,e,n,i,r){var o=new g(new b(t,e),new b(n,i));o.NormalizeRect();var s=new g;if(s.NormalizeRect(),!s.IntersectRect(this.bounds_,o))return!1;for(var a=s.UpperLeftCorner.y;a<=s.LowerRightCorner.y;a++)this.PlaceLinesect(s.UpperLeftCorner.x-this.bounds_.UpperLeftCorner.x,a-this.bounds_.UpperLeftCorner.y,s.LowerRightCorner.x-this.bounds_.UpperLeftCorner.x,a-this.bounds_.UpperLeftCorner.y,r);return!0},PlaceLine:function(t,e,n){for(var i=0;i<e-1;i++)this.PlaceLinesect(t[i].x,t[i].y,t[i+1].x,t[i+1].y,n)},PlaceMultiLine:function(t,e,n,i){if(t&&e&&0<n)for(var r=0,o=0;o<n;o++){var s=t.slice(r,r+e[o]);this.PlaceLine(s,e[o],i),r+=e[o]}return!1},Sign:function(t){return t<0?-1:0<t?1:t},PlaceLinesect:function(t,e,n,i,r){if(t!=n||e!=i)if(e==i)for(var o=Math.min(t,n),s=Math.max(t,n),a=o;a<=s;a++)this.SetValue(a,e,r);else if(t==n)for(var u=Math.min(e,i),l=Math.max(e,i),h=u;h<=l;h++)this.SetValue(t,h,r);else{var c,p,f,d,g,y;if(a=t,h=e,c=Math.abs(n-t),p=Math.abs(i-e),d=this.Sign(n-t),g=this.Sign(i-e),c<p){var _=c;c=p,p=_,y=1}else y=0;var m=I(p,1),v=I(c,1);f=m-c;for(var b=1;b<=c;b++){for(this.SetValue(a,h,r);0<f;)1==y?a+=d:h+=g,f-=v;1==y?h+=g:a+=d,f+=m}}else this.SetValue(t,e,r)},CanPlaceLinesect:function(t,e,n,i,r){return r.entire_visble?!!this.IsLinesectAllFreeness(t,e,n,i,r):!this.IsLinesectAllForce(t,e,n,i,r)},PlacePolygon:function(t,e,n){if(!(t&&2<e))return!1;function i(){this.ymax=0,this.x=0,this.dx=0,this.pNext=null}var r=0,o=0,s=0,a=0,u=0,l=null,h=null;for((l=new i).pNext=null,a=u=t[0].y,r=1;r<e;r++)t[r].y<a?a=t[r].y:t[r].y>u&&(u=t[r].y);if(u<=a)return l=l&&null,!1;for(h=new Array(u-a+1),r=0;r<=u-a;r++)h[r]=new i,h[r].pNext=null;for(r=0;r<e;r++)if(o=(r+1)%e,t[r].y!=t[o].y){var c,p;for(c=new i,s=t[r].y>t[o].y?r:o,c.ymax=t[s].y,s=s==o?r:o,c.x=t[s].x,t[r].y!=t[o].y&&(c.dx=(t[r].x-t[o].x)/(t[r].y-t[o].y)),c.pNext=null,p=h[t[s].y-a];p.pNext;)p=p.pNext;p.pNext=c}for(r=a;r<=u;r++)if(!(r<this.bounds_.UpperLeftCorner.x||r>this.bounds_.LowerRightCorner.y)){var f=h[r-a].pNext,d=h[r-a];if(f){for(;d.pNext;)d=d.pNext;d.pNext=l.pNext,l.pNext=f}for(f=l;f.pNext;){for(var g=f,y=(d=f,null);d.pNext;)d.pNext.x>g.pNext.x&&(g=d),d=d.pNext;y=g.pNext,g.pNext=y.pNext,y.pNext=l.pNext,l.pNext=y,f==l&&(f=y)}for(f=l;f.pNext&&f.pNext.pNext;){var _=new b,m=new b;_.x=Math.floor(f.pNext.x),_.y=r,_.x<this.bounds_.UpperLeftCorner.x&&(_.x=this.bounds_.UpperLeftCorner.x),_.x>this.bounds_.LowerRightCorner.x&&(_.x=this.bounds_.LowerRightCorner.x),m.x=Math.floor(f.pNext.pNext.x),m.y=r,m.x<this.bounds_.UpperLeftCorner.x&&(m.x=this.bounds_.UpperLeftCorner.x),m.x>this.bounds_.LowerRightCorner.x&&(m.x=this.bounds_.LowerRightCorner.x),this.bounds_.LowerRightCorner.y<this.bounds_.UpperLeftCorner.y?_.y<=this.bounds_.UpperLeftCorner.y&&_.y>=this.bounds_.LowerRightCorner.y&&this.PlaceLinesect(_.x,_.y,m.x,m.y,n):_.y>=this.bounds_.UpperLeftCorner.y&&_.y<=this.bounds_.LowerRightCorner.y&&this.PlaceLinesect(_.x,_.y,m.x,m.y,n),f=f.pNext.pNext}for(f=l;f.pNext;)f.pNext.ymax<r+2?(d=f.pNext,f.pNext=f.pNext.pNext,d=null):(f.pNext.x+=f.pNext.dx,f=f.pNext)}for(r=0;r<=u-a;r++)h[r]&&(h[r]=null);return l=l&&null,h=h&&null,!0},CanPlacePolygon:function(t,e,n){if(!(t&&2<e))return!1;function i(){this.ymax=0,this.x=0,this.dx=0,this.pNext=null}var r=0,o=0,s=0,a=0,u=0,l=null,h=null;for((l=new i).pNext=null,a=u=t[0].y,r=1;r<e;r++)t[r].y<a?a=t[r].y:t[r].y>u&&(u=t[r].y);if((a<this.bounds_.UpperLeftCorner.y||u>this.bounds_.LowerRightCorner.y)&&n.entire_visble)return!1;if(u<=a)return l=l&&null,!1;try{h=new Array(u-a+1)}catch(t){return!1}for(r=0;r<=u-a;r++)h[r]=new i,h[r].pNext=null;for(r=0;r<e;r++)if(o=(r+1)%e,t[r].y!=t[o].y){var c,p;for(c=new i,s=t[r].y>t[o].y?r:o,c.ymax=t[s].y,s=s==o?r:o,c.x=t[s].x,t[r].y!=t[o].y&&(c.dx=(t[r].x-t[o].x)/(t[r].y-t[o].y)),c.pNext=null,p=h[t[s].y-a];p.pNext;)p=p.pNext;p.pNext=c}for(r=a;r<=u;r++){var f=h[r-a].pNext,d=h[r-a];if(f){for(;d.pNext;)d=d.pNext;d.pNext=l.pNext,l.pNext=f}for(f=l;f.pNext;){for(var g=f,y=(d=f,null);d.pNext;)d.pNext.x>g.pNext.x&&(g=d),d=d.pNext;y=g.pNext,g.pNext=y.pNext,y.pNext=l.pNext,l.pNext=y,f==l&&(f=y)}for(f=l;f.pNext&&f.pNext.pNext;){var _=new b,m=new b;if(_.x=Math.floor(f.pNext.x),_.y=r,_.x<this.bounds_.UpperLeftCorner.x){if(n.entire_visble)return!1;_.x=this.bounds_.UpperLeftCorner.x}if(_.x>this.bounds_.LowerRightCorner.x){if(n.entire_visble)return!1;_.x=this.bounds_.LowerRightCorner.x}if(m.x=Math.floor(f.pNext.pNext.x),m.y=r,m.x<this.bounds_.UpperLeftCorner.x){if(n.entire_visble)return!1;m.x=this.bounds_.UpperLeftCorner.x}if(m.x>this.bounds_.LowerRightCorner.x){if(n.entire_visble)return!1;m.x=this.bounds_.LowerRightCorner.x}if(this.bounds_.LowerRightCorner.y<this.bounds_.UpperLeftCorner.y){if(_.y<=this.bounds_.UpperLeftCorner.y&&_.y>=this.bounds_.LowerRightCorner.y){var v=this.CanPlaceLinesect(_.x,_.y,m.x,m.y,n);if(n.entire_visble){if(!v)return!1}else if(v)return!0}}else if(_.y>=this.bounds_.UpperLeftCorner.y&&_.y<=this.bounds_.LowerRightCorner.y){v=this.CanPlaceLinesect(_.x,_.y,m.x,m.y,n);if(n.entire_visble){if(!v)return!1}else if(v)return!0}f=f.pNext.pNext}for(f=l;f.pNext;)f.pNext.ymax<r+2?(d=f.pNext,f.pNext=f.pNext.pNext,d=null):(f.pNext.x+=f.pNext.dx,f=f.pNext)}for(r=0;r<=u-a;r++)h[r]&&(h[r]=null);return l=l&&null,h=h&&null,!!n.entire_visble},IsLinesectAllForce:function(t,e,n,i,r){var o=0;if(t==n&&e==i)return 0<(o=this.GetValue(t,e,r));var s=!1;if(r.avoid_edge&&(s=!0),e==i)for(var a=Math.min(t,n),u=Math.max(t,n),l=a;l<=u;l++)if(o=this.GetValue(l,e,r),r.avoid_edge){if(o<=0)return!1}else{if(0==o)return!1;0<o&&(s=!0)}else if(t==n)for(var h=Math.min(e,i),c=Math.max(e,i),p=h;p<=c;p++)if(o=this.GetValue(t,p,r),r.avoid_edge){if(o<=0)return!1}else{if(0==o)return!1;0<o&&(s=!0)}else{var f,d,g,y,_,m;if(l=t,p=e,f=Math.abs(n-t),d=Math.abs(i-e),y=this.Sign(n-t),_=this.Sign(i-e),f<d){var v=f;f=d,d=v,m=1}else m=0;var b=I(d,1),x=I(f,1);g=b-f;for(var E=1;E<=f;E++){if(o=this.GetValue(l,p,r),r.avoid_edge){if(o<=0)return!1}else{if(0==o)return!1;0<o&&(s=!0)}for(;0<g;)1==m?l+=y:p+=_,g-=x;1==m?p+=_:l+=y,g+=b}}return s},IsLinesectAllFreeness:function(t,e,n,i,r){if(t==n&&e==i)return 0==this.GetValue(t,e,r);var o=!1;r.avoid_edge&&(o=!0);var s=0;if(e==i)for(var a=Math.min(t,n),u=Math.max(t,n),l=a;l<=u;l++)if(s=this.GetValue(l,e,r),r.avoid_edge){if(0!=s)return!1}else{if(0<s)return!1;0==s&&(o=!0)}else if(t==n)for(var h=Math.min(e,i),c=Math.max(e,i),p=h;p<=c;p++)if(s=this.GetValue(t,p,r),r.avoid_edge){if(0!=s)return!1}else{if(0<s)return!1;0==s&&(o=!0)}else{var f,d,g,y,_,m;if(l=t,p=e,f=Math.abs(n-t),d=Math.abs(i-e),y=this.Sign(n-t),_=this.Sign(i-e),f<d){var v=f;f=d,d=v,m=1}else m=0;var b=I(d,1),x=I(f,1);g=b-f;for(var E=1;E<=f;E++){if(s=this.GetValue(l,p,r),r.avoid_edge){if(0!=s)return!1}else{if(0<s)return!1;0==s&&(o=!0)}for(;0<g;)1==m?l+=y:p+=_,g-=x;1==m?p+=_:l+=y,g+=b}}return o},CanPlaceRect:function(t,e,n,i,r){var o=new g(new b(t,e),new b(n,i));if(o.NormalizeRect(),!this.bounds_.IsIntersect(o))return!1;for(var s=o,a=Math.min(this.bounds_.UpperLeftCorner.x,this.bounds_.LowerRightCorner.x),u=Math.min(this.bounds_.UpperLeftCorner.y,this.bounds_.LowerRightCorner.y),l=Math.min(s.UpperLeftCorner.x,s.LowerRightCorner.x),h=Math.max(s.UpperLeftCorner.x,s.LowerRightCorner.x),c=Math.min(s.UpperLeftCorner.y,s.LowerRightCorner.y),p=Math.max(s.UpperLeftCorner.y,s.LowerRightCorner.y),f=c;f<=p;f++){var d=this.CanPlaceLinesect(l-a,f-u,h-a,f-u,r);if(r.entire_visble){if(!d)return!1}else if(d)return!0}return!!r.entire_visble},CanPlaceLine:function(t,e,n){for(var i=0;i<e-1;i++){var r=t[i],o=t[i+1],s=this.CanPlaceLinesect(r.x,r.y,o.x,o.y,n);if(n.entire_visble){if(!s)return!1}else if(s)return!0}return!!n.entire_visble},CanPlaceMultiLine:function(t,e,n,i){if(t&&e&&0<n)for(var r=0,o=0;o<n;o++){var s=t.slice(r,r+e[o]),a=CanPlaceLine(s,e[o],i);if(i.entire_visble){if(!a)return!1}else if(a)return!0;r+=e[o]}return!!i.entire_visble}};var r=i;e.default=r}),OL=(IL=NL)&&IL.__esModule&&Object.prototype.hasOwnProperty.call(IL,"default")?IL.default:IL,TL=(c(kL,[{key:"getModel",value:function(){return this.m_pModel||(this.m_pModel=new OL(this.m_nViewWidth,this.m_nViewHeight)),this.m_pModel}},{key:"releaseAllModel",value:function(){this.m_pModel&&(this.m_pModel=null)}},{key:"releaseModel",value:function(){}},{key:"canPlacePoint",value:function(t,e,n){var i=Math.round(e.x>>1),r=Math.round(e.y>>1);return this.getModel().CanPlaceRect(t.x-i,t.y-r,t.x+i,t.y+r,n)}},{key:"placePoint",value:function(t,e,n){var i=Math.round(e.x>>1),r=Math.round(e.y>>1);return this.getModel().PlaceRect(t.x-i,t.y-r,t.x+i,t.y+r,n),!0}},{key:"canPlaceRect",value:function(t,e,n){return this.getModel().CanPlaceRect(t.x,t.y,e.x,e.y,n)}},{key:"placeRect",value:function(t,e,n){return this.getModel().PlaceRect(t.x,t.y,e.x,e.y,n),!0}},{key:"canPlacePolygon",value:function(t,e){if(!t||0===t.length)return!1;var n=t.length;return this.getModel().CanPlacePolygon(t,n,e)}},{key:"placePolygon",value:function(t,e){var n=t.length;return this.getModel().PlacePolygon(t,n,e),!0}},{key:"placeLine",value:function(t,e,n,i){return this.getModel().PlaceMultiLine(t,e,n,i),!0}}]),kL);function kL(t,e){h(this,kL),this.m_pModel=null,this.m_nViewWidth=t,this.m_nViewHeight=e}var RL=(c(DL,[{key:"getWidth",value:function(){return this._bottomRight.x-this._topLeft.x}},{key:"getHeight",value:function(){return this._bottomRight.y-this._topLeft.y}},{key:"getMaxX",value:function(){return this._bottomRight.x}},{key:"setRect",value:function(t,e,n,i){this._topLeft.x=t,this._topLeft.y=e,this._bottomRight.x=n,this._bottomRight.y=i}}]),DL);function DL(t,e){h(this,DL),this._topLeft=t||new B.Point(0,0),this._bottomRight=e||new B.Point(0,0)}var AL=(c(FL,[{key:"getTextWidth",value:function(t){return this._ctx.measureText(t).width}}]),FL);function FL(t){h(this,FL),this._ctx=document.createElement("canvas").getContext("2d");var e=t.getFontStr();this._ctx.font=e}function BL(t,e,n,i,r){if(void 0===i&&(i=!0),!t)return!1;for(var o=0,s=0,a=n.getFontInfo().getSize(),u=t.length,l=0;l<u;l++){var h=t[l],c=!(" "!==h),p=r.getTextWidth(h);i?(o+=p+n.getInterval(),s=a,c&&(o+=n.getWordInterval())):(s+=(o=a)+n.getInterval(),c&&(s+=n.getWordInterval()))}return e.setRect(0,0,o,s),!0}function GL(t,e,n,i,r,o){if(r.isWrap()){var s=function(t,e,n,i){var r=!1;/^[\u3220-\uFA29]+$/.test(t)&&(r=!0);var o=t+e,s=[];if(!!e)for(var a=new RegExp(e),u=o.indexOf(e);-1!==u;)s.push(u),u=(o=o.replace(a)).indexOf(e);else{if(!r)return[t];for(var l=0;l<o.length;l++)(l+1)%n==0&&s.push(l+1);s.push(o.length)}var h=[],c=o.length;if(s.length<=i){for(var p=0,f=0;f<s.length;f++){var d=o.substr(p,s[f]-p);p=s[f],d&&h.push(d)}return h}var g=0;g=n*i<c?c/i:n;for(var y=0,_=0;_<s.length;_++){if(h.length===i-1){var m=o.substr(y);m&&h.push(m);break}if(s[_]===c){if(g<c-y){var v=s[0<_?_-1:0],b=o.substr(y,v-y);b&&h.push(b);var x=o.substr(v,s[_]-v);x&&h.push(x)}else{var E=o.substr(y,s[_]-y);E&&h.push(E)}break}if(s[_]-y>g){var I=o.substr(y,s[0<_?_-1:0]-y);I&&h.push(I),y=s[0<_?_-1:0]}else if(s[_]-y===g){var L=o.substr(y,s[_]-y);L&&h.push(L),y=s[_]}}return h}(t,r.getWrapChar(),r.getWordCountPerLine(),r.getMaxLineCount());s&&0<s.length&&s.forEach(function(t){e.push(t)})}else{var a=t,u=r.getWrapChar();if(u){var l=new RegExp(u,"g");a=a.replace(l,"")}e.push(a)}for(var h=e.length,c=0,p=0,f=h-1,d=0;d<h;d++){var g=new RL;BL(e[d],g,r,!0,o),i.push(g),c=c>g.getMaxX()?c:g.getWidth(),p+=g.getHeight(),0<f&&(p+=d===f?r.getLineSpacing():0)}return n.setRect(0,0,c,p),!0}function UL(t){if(!t||t.length<2)return 0;for(var e=0,n=0;n<t.length-1;n++){var i=t[n],r=t[n+1];e+=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))}return e}function jL(t,e,n){var i,r,o=(n=n||{}).dPos||0,s=n.pos||0,a=n.di||0;if(!a||o+a<e)for(var u=s;u<t.length-1;u++){var l=t[u],h=t[u+1];if(i=l,r=h,e<o+(a=Math.sqrt(Math.pow(i.x-r.x,2)+Math.pow(i.y-r.y,2))))break;s++,o+=a}var c=void 0,p=void 0,f=e-o;s>=t.length-1&&(s=t.length-2);var d=t[s],g=t[s+1];p=f?(c=d.x+(g.x-d.x)*f/a,d.y+(g.y-d.y)*f/a):(c=d.x,d.y);var y=Math.atan2(g.y-d.y,g.x-d.x);return n.dPos=o,n.pos=s,n.di=a,{x:c,y:p,angle:y}}function qL(t){var e=UL(t);return 0===e?null:jL(t,e/2)}var zL={ptAnchor:null,ptPoints:null,ptCount:null,nCount:0,angle:0,rotatePoint:null,xStep:0,yStep:0,bHori:!0,wText:"",wordInterval:0},VL=(c(YL,[{key:"getAnchor",value:function(){return this.options.ptAnchor}},{key:"getPoints",value:function(){return this.options.ptPoints}},{key:"getAngle",value:function(){return this.options.angle}},{key:"getStepX",value:function(){return this.options.xStep}},{key:"getStepY",value:function(){return this.options.yStep}},{key:"isHori",value:function(){return this.options.bHori}},{key:"getText",value:function(){return this.options.wText}},{key:"getWordInterval",value:function(){return this.options.wordInterval}},{key:"getRotatePoint",value:function(){return this.options.rotatePoint}}]),YL);function YL(t){h(this,YL),this.options=S_.extend({},zL,t)}var HL=(c(XL,[{key:"addPointLabel",value:function(t){var e=!1,n=this.position.getPositionType();switch(n){case hv.AROUND_POINT:e=this.handlerAroundPoint(t);break;case hv.ON_POINT_TOP:e=this.handlerOnPointTop(t);break;case hv.ANGLE_FIELD:case hv.SPECIFIED_ANGLE:var i=0;if(n===hv.ANGLE_FIELD){var r=t.properties,o=this.position.getAngleField().toLowerCase();r&&o&&r[o]&&(i=parseFloat(r[o]))}else n===hv.SPECIFIED_ANGLE&&(i=this.position.getSpecifiedAngle()||0);e=this.handlerAnglePoint(i,t)}return e}},{key:"_addPosition",value:function(t){for(var e=t.vText,n=t.vBox,i=t.ptText,r=t.ptPoints,o=t.pALabelPositions,s=t.rotatePoint,a=t.angle,u=this.symbol.getTextInfo(),l=e.length,h=i.x,c=i.y-u.getLineSpacing()*(l-1)-n[0].getHeight()*l,p=0;p<l;p++){c+=n[p].getHeight(),0<p&&(c+=u.getLineSpacing());var f={ptAnchor:new B.Point(h,c),xStep:u.getInterval(),bHori:!0,wText:e[p],wordInterval:u.getWordInterval(),rotatePoint:s,angle:a};0===p&&r&&(f.ptPoints=r);var d=new VL(f);o.addPosition(d,this.symbol)}}},{key:"handlerAroundPoint",value:function(t){var e=t.text,n=t.avoidHandler,i=t.coverCondition,r=t.pALabelPositions,o=t.pPoint,s=t.size+4,a=this.symbol.getTextInfo(),u=o.x,l=o.y,h=!1,c=s/2,p=[],f=new RL,d=[];GL(e,p,f,d,a,this._measureTextTool);var g=c;g+=this.position.getAroundOffset();var y=f.getWidth(),_=f.getHeight(),m=this.symbol.validFillSymbol();m&&(y+=a.getLeftMargin()+a.getRightMargin(),_+=a.getTopMargin()+a.getBottomMargin());for(var v=u-g+a.getOffsetX(),b=l-g+a.getOffsetY(),x=u+g+a.getOffsetX(),E=l+g+a.getOffsetY(),I=.5*(v+x),L=.5*(b+E),w=this.position.getLabelPosList(),S=new B.Point(0,0),M=new B.Point(0,0),C=0;C<w.length;C++){switch(w[C]){case pv:S.x=I-.5*y,S.y=b-_;break;case yv:S.x=I-.5*y,S.y=E;break;case dv:S.x=x,S.y=L-.5*_;break;case mv:S.x=v-y,S.y=L-.5*_;break;case gv:S.x=x,S.y=E;break;case cv:S.x=x,S.y=b-_;break;case fv:S.x=v-y,S.y=b-_;break;case _v:S.x=v-y,S.y=E}if(M.x=S.x+y,M.y=S.y+_,h=n.canPlaceRect(S,M,i)){n.placeRect(S,M,i);break}}if(h){var P=null,N=null;N=m?(P=[new B.Point(S.x,S.y),new B.Point(S.x,M.y),new B.Point(M.x,M.y),new B.Point(M.x,S.y),new B.Point(S.x,S.y)],new B.Point(S.x+a.getLeftMargin(),M.y-a.getBottomMargin())):new B.Point(S.x,M.y),this._addPosition({vText:p,vBox:d,ptText:N,ptPoints:P,pALabelPositions:r,rotatePoint:null,angle:0})}return h}},{key:"handlerOnPointTop",value:function(t){var e=t.text,n=t.avoidHandler,i=t.coverCondition,r=t.pALabelPositions,o=t.pPoint,s=this.symbol.getTextInfo(),a=o.x,u=o.y;a+=s.getOffsetX(),u+=s.getOffsetY();var l,h=[],c=new RL,p=[];GL(e,h,c,p,s,this._measureTextTool);var f=c.getWidth(),d=c.getHeight(),g=this.symbol.validFillSymbol();g&&(f+=s.getLeftMargin()+s.getRightMargin(),d+=s.getTopMargin()+s.getBottomMargin());var y=new B.Point(a-f/2,u-d/2),_=new B.Point(a+f/2,u+d/2);if(l=n.canPlaceRect(y,_,i)){n.placeRect(y,_,i);var m=null,v=null;v=g?(m=[new B.Point(y.x,y.y),new B.Point(y.x,_.y),new B.Point(_.x,_.y),new B.Point(_.x,y.y),new B.Point(y.x,y.y)],new B.Point(y.x+s.getLeftMargin(),_.y-s.getBottomMargin())):new B.Point(y.x,_.y),this._addPosition({vText:h,vBox:p,ptText:v,ptPoints:m,pALabelPositions:r,rotatePoint:null,angle:0})}return l}},{key:"handlerAnglePoint",value:function(e,t){var n=t.text,i=t.avoidHandler,r=t.coverCondition,o=t.pALabelPositions,s=t.size+4,a=t.pPoint,u=this.symbol.getTextInfo(),l=a.x,h=a.y;l+=u.getOffsetX(),h+=u.getOffsetY();var c,p=[],f=new RL,d=[];GL(n,p,f,d,u,this._measureTextTool);var g=f.getWidth(),y=f.getHeight(),_=this.symbol.validFillSymbol();_&&(g+=u.getLeftMargin()+u.getRightMargin(),y+=u.getTopMargin()+u.getBottomMargin());var m=l+s/2,v=m+g,b=h-y/2,x=h+y/2,E=[new B.Point(m,b),new B.Point(m,x),new B.Point(v,x),new B.Point(v,b),new B.Point(m,b)],I=new B.Point(l,h);if(0!==e&&E.forEach(function(t){S_.rotatePoint(t,I,e*Math.PI/180)}),c=i.canPlacePolygon(E,r)){i.placePolygon(E,r);var L=null;L=_?new B.Point(m+u.getLeftMargin(),x-u.getBottomMargin()):new B.Point(m,x),this._addPosition({vText:p,vBox:d,ptText:L,ptPoints:_?E:null,pALabelPositions:o,rotatePoint:I,angle:e})}return c}}]),XL);function XL(t,e){h(this,XL),this.symbol=t,this.position=e,this._measureTextTool=new AL(this.symbol.getTextInfo().getFontInfo())}var JL=(c(WL,[{key:"addPolygonLabel",value:function(t){var e=!1;if(this.position.getDuplicateLabels()===rv&&t.hasTextList&&-1!==t.hasTextList.indexOf(t.text))return!1;switch(this.position.getPositionType()){case Mv:e=this._horiLabelHandler(t)}return e}},{key:"_addPosition",value:function(t){for(var e=t.vText,n=t.vBox,i=t.ptText,r=t.ptPoints,o=t.pALabelPositions,s=t.rotatePoint,a=t.angle,u=this.symbol.getTextInfo(),l=e.length,h=i.x,c=i.y-u.getLineSpacing()*(l-1)-n[0].getHeight()*l,p=0;p<l;p++){c+=n[p].getHeight(),0<p&&(c+=u.getLineSpacing());var f={ptAnchor:new B.Point(h,c),xStep:u.getInterval(),bHori:!0,wText:e[p],wordInterval:u.getWordInterval(),rotatePoint:s,angle:a};0===p&&r&&(f.ptPoints=r);var d=new VL(f);o.addPosition(d,this.symbol)}}},{key:"_horiLabelHandler",value:function(t){var e=!1,n=t.geoList,i=(this.toGeoJSON(n),t.text),r=t.avoidHandler,o=t.coverCondition,s=t.pALabelPositions,a=this.symbol.getTextInfo(),u=[],l=new RL,h=[];GL(i,u,l,h,a,this._measureTextTool);try{var c=this.getCenter(n[0]);if(!c)return!1;var p=c.geometry.coordinates,f=p[0],d=p[1];f+=a.getOffsetX(),d+=a.getOffsetY();var g=l.getWidth(),y=l.getHeight(),_=this.symbol.validFillSymbol();_&&(g+=a.getLeftMargin()+a.getRightMargin(),y+=a.getTopMargin()+a.getBottomMargin());var m=new B.Point(f-g/2,d-y/2),v=new B.Point(f+g/2,d+y/2),b=[new B.Point(m.x,m.y),new B.Point(m.x,v.y),new B.Point(v.x,v.y),new B.Point(v.x,m.y),new B.Point(m.x,m.y)];if(this.position.isOnlyInPolygon()){var x=this.toGeoJSON([{pPoints:b,polyCount:[b.length],subCount:1}]);if(!this.isInside(n,x))return!1}if(e=r.canPlaceRect(m,v,o)){r.placeRect(m,v,o);var E=null;E=_?new B.Point(m.x+a.getLeftMargin(),v.y-a.getBottomMargin()):new B.Point(m.x,v.y),this._addPosition({vText:u,vBox:h,ptText:E,ptPoints:b,pALabelPositions:s,rotatePoint:null,angle:0}),this.position.getDuplicateLabels()===rv&&t.hasTextList.push(i)}}catch(t){console.log(t)}return e}},{key:"isInside",value:function(t,e){for(var n=0;n<t.length;n++){var i=this.toGeoJSON([t[n]]);if(E_.booleanContains(i,e))return!0}return!1}},{key:"toGeoJSON",value:function(t){if(!t||0===t.length)return null;for(var e=1!==t.length,n={type:e?"MultiPolygon":"Polygon"},i=[],r=0;r<t.length;r++){var o=t[r];if(o){var s=o.pPoints,a=o.polyCount,u=o.subCount;if(s&&!(s.length<2)&&a&&0!==a.length&&0!==u){for(var l=0,h=[],c=0;c<u;c++){for(var p=[],f=a[c],d=0;d<f;d++){var g=s[l+d];p.push([g.x,g.y])}h.push(p),l+=f}i.push(h)}}}return n.coordinates=e?i:i[0],{type:"Feature",geometry:n}}},{key:"getCenter",value:function(t){if(!t)return null;var e=null;if(1<t.subCount){var n=t.polyCount[0];e={pPoints:t.pPoints.slice(0,n),polyCount:[n],subCount:1}}else e=t;var i=this.toGeoJSON([e]);return i?E_.pointOnFeature(i):null}}]),WL);function WL(t,e){h(this,WL),this.symbol=t,this.position=e,this._measureTextTool=new AL(this.symbol.getTextInfo().getFontInfo())}var KL=(c(ZL,[{key:"addLineLabel",value:function(t){var e=!1;if(this.position.getDuplicateLabels()===rv&&t.hasTextList&&-1!==t.hasTextList.indexOf(t.text))return!1;switch(this.position.getPositionType()){case vv:e=this._horiLineHandler(t);break;case bv:e=this._parallelHandler(t);break;case xv:e=this._verticalHandler(t);break;case Ev:e=this._alongHandler(t);break;case Iv:e=this._dispersionHandler(t)}return e}},{key:"_horiLineHandler",value:function(t){var e=!1,n=t.text,i=t.avoidHandler,r=t.coverCondition,o=t.pALabelPositions,s=t.ptPoints,a=t.polyCount,u=t.subCount,l=this.symbol.getTextInfo(),h=new RL;BL(n,h,l,!0,this._measureTextTool);for(var c=0,p=0;p<u;p++){var f=a[p],d=s.slice(c,c+f);if(c+=f,!(UL(d)<h.getWidth())){var g=qL(d);if(g){var y=g.x,_=g.y,m=h.getWidth(),v=h.getHeight(),b=this.symbol.validFillSymbol();b&&(m+=l.getLeftMargin()+l.getRightMargin(),v+=l.getTopMargin()+l.getBottomMargin());var x=new B.Point(y-m/2,_-v/2),E=new B.Point(y+m/2,_+v/2);if(e=i.canPlaceRect(x,E,r)){i.placeRect(x,E,r);var I=null,L=null;b?(I=new B.Point(x.x+l.getLeftMargin(),E.y-l.getBottomMargin()),L=[new B.Point(x.x,x.y),new B.Point(x.x,E.y),new B.Point(E.x,E.y),new B.Point(E.x,x.y),new B.Point(x.x,x.y)]):I=new B.Point(x.x,E.y);var w={ptAnchor:I,ptPoints:L,xStep:l.getInterval(),bHori:!0,wText:n,wordInterval:l.getWordInterval()},S=new VL(w);if(o.addPosition(S,this.symbol),this.position.getDuplicateLabels()===rv)t.hasTextList.push(n);else if(this.position.getDuplicateLabels()===ov)break}}}}return e}},{key:"_verticalHandler",value:function(E){var I=this,L=!1,w=E.text,S=E.avoidHandler,M=E.coverCondition,C=E.pALabelPositions,P=E.ptPoints,N=E.polyCount,t=E.subCount,O=this.symbol.getTextInfo(),T=new RL;function e(t){var e=N[t],n=P.slice(k,k+e);if(k+=e,UL(n)<T.getWidth())return"continue";var i=qL(n);if(!i)return"continue";var r=i.angle;n[0].y>i.y?r+=Math.PI/2:r+=Math.PI/2*3;var o=T.getWidth(),s=T.getHeight(),a=I.symbol.validFillSymbol();a&&(o+=O.getLeftMargin()+O.getRightMargin(),s+=O.getTopMargin()+O.getBottomMargin());for(var u=null,l=null,h=null,c=null,p=I.position.getVertPosList(),f=0;f<p.length;f++){var d=p[f],g=O.getOffsetX();d===wv?g-=o/2:d===Sv&&(g+=o/2);var y=I._getTranslatePoint(i,g,0,r),_=y.x,m=y.y;if(u=new B.Point(_-o/2,m-s/2),l=new B.Point(_+o/2,m+s/2),h=[new B.Point(u.x,u.y),new B.Point(u.x,l.y),new B.Point(l.x,l.y),new B.Point(l.x,u.y),new B.Point(u.x,u.y)],c=new B.Point(_,m),0!==r&&h.forEach(function(t){S_.rotatePoint(t,c,r)}),L=S.canPlacePolygon(h,M))break}if(L){S.placePolygon(h,M);var v=null;a?v=new B.Point(u.x+O.getLeftMargin(),l.y-O.getBottomMargin()):(v=new B.Point(u.x,l.y),h=null);var b={ptAnchor:v,ptPoints:h,xStep:O.getInterval(),bHori:!0,angle:r/Math.PI*180,rotatePoint:c,wText:w,wordInterval:O.getWordInterval()},x=new VL(b);if(C.addPosition(x,I.symbol),I.position.getDuplicateLabels()===rv)E.hasTextList.push(w);else if(I.position.getDuplicateLabels()===ov)return"break"}}BL(w,T,O,!0,this._measureTextTool);var k=0;t:for(var n=0;n<t;n++)switch(e(n)){case"continue":continue;case"break":break t}return L}},{key:"_getTranslatePoint",value:function(t,e,n,i){return{x:t.x+e*Math.cos(i)+n*Math.sin(i),y:t.y+e*Math.sin(i)-n*Math.cos(i)}}},{key:"_parallelHandler",value:function(L){var w=this,S=!1,M=L.text,C=L.avoidHandler,P=L.coverCondition,N=L.pALabelPositions,O=L.ptPoints,T=L.polyCount,t=L.subCount,k=this.symbol.getTextInfo(),e=new RL;BL(M,e,k,!0,this._measureTextTool);var R=e.getWidth(),D=e.getHeight(),A=this.symbol.validFillSymbol();function n(t){var e=T[t],n=O.slice(F,F+e);F+=e;var i=UL(n);if(i<R)return"continue";var r={dPos:0,pos:0,di:0},o=(i-R)/2,s=jL(n,o,r),a=jL(n,o+R,r),u=0,l={x:(s.x+a.x)/2,y:(s.y+a.y)/2};(u=Math.atan2(a.y-s.y,a.x-s.x))<0&&(u+=2*Math.PI),u>=Math.PI/2&&u<Math.PI/2*3&&(u-=Math.PI);for(var h=null,c=null,p=null,f=null,d=w.position.getVertPosList(),g=0;g<d.length;g++){var y=d[g],_=k.getOffsetY();y===wv?_+=D/2:y===Sv&&(_-=D/2);var m=w._getTranslatePoint(l,0,_,u),v=m.x,b=m.y;if(h=new B.Point(v-R/2,b-D/2),c=new B.Point(v+R/2,b+D/2),p=[new B.Point(h.x,h.y),new B.Point(h.x,c.y),new B.Point(c.x,c.y),new B.Point(c.x,h.y),new B.Point(h.x,h.y)],f=new B.Point(v,b),0!==u&&p.forEach(function(t){S_.rotatePoint(t,f,u)}),S=C.canPlacePolygon(p,P))break}if(S){C.placePolygon(p,P);var x=null;A?x=new B.Point(h.x+k.getLeftMargin(),c.y-k.getBottomMargin()):(x=new B.Point(h.x,c.y),p=null);var E={ptAnchor:x,ptPoints:p,xStep:k.getInterval(),bHori:!0,angle:u/Math.PI*180,rotatePoint:f,wText:M,wordInterval:k.getWordInterval()},I=new VL(E);if(N.addPosition(I,w.symbol),w.position.getDuplicateLabels()===rv)L.hasTextList.push(M);else if(w.position.getDuplicateLabels()===ov)return"break"}}A&&(R+=k.getLeftMargin()+k.getRightMargin(),D+=k.getTopMargin()+k.getBottomMargin());var F=0;t:for(var i=0;i<t;i++)switch(n(i)){case"continue":continue;case"break":break t}return S}},{key:"_alongHandler",value:function(u){var m=this,l=!1,v=u.text,b=u.avoidHandler,x=u.coverCondition,E=u.pALabelPositions,I=u.ptPoints,L=u.polyCount,t=u.subCount,w=this.symbol.getTextInfo(),e=new RL;function n(t){var e=L[t],n=I.slice(C,C+e);if(C+=e,UL(n)<S)return"continue";var h=m.getAlongLetterList(v,n,S);if(!h||0===h.length)return"continue";for(var c=null,p=null,f=null,d=null,g=[],i=m.position.getVertPosList(),r=0;r<i.length;r++){var o=i[r],y=w.getOffsetY();o===wv?y+=M/2:o===Sv&&(y-=M/2);for(var _=!0,s=function(t){var e=h[t],n=e.letter,i=e.p,r=i.angle,o=e.letterW,s=m._getTranslatePoint(i,0,y,r),a=s.x,u=s.y;if(c=new B.Point(a-o/2,u-M/2),p=new B.Point(a+o/2,u+M/2),f=[new B.Point(c.x,c.y),new B.Point(c.x,p.y),new B.Point(p.x,p.y),new B.Point(p.x,c.y),new B.Point(c.x,c.y)],d=new B.Point(a,u),0!==r&&f.forEach(function(t){S_.rotatePoint(t,d,r)}),!b.canPlacePolygon(f,x))return _=!1,"break";var l=new B.Point(c.x,p.y);g.push({ptAnchor:l,angle:r/Math.PI*180,rotatePoint:d,wText:n,boundPoints:f})},a=0;a<h.length&&"break"!==s(a);a++);if(_){l=!0;break}}if(l&&0<g.length)if(g.forEach(function(t){b.placePolygon(t.boundPoints,x),delete t.boundPoints;var e=new VL(t);E.addPosition(e,m.symbol)}),m.position.getDuplicateLabels()===rv)u.hasTextList.push(v);else if(m.position.getDuplicateLabels()===ov)return"break"}BL(v,e,w,!0,this._measureTextTool);var S=e.getWidth(),M=e.getHeight(),C=0;t:for(var i=0;i<t;i++)switch(n(i)){case"continue":continue;case"break":break t}return l}},{key:"_dispersionHandler",value:function(u){var m=this,l=!1,v=u.text,b=u.avoidHandler,x=u.coverCondition,E=u.pALabelPositions,I=u.ptPoints,L=u.polyCount,t=u.subCount,w=this.symbol.getTextInfo(),e=new RL;function n(t){var e=L[t],n=I.slice(C,C+e);if(C+=e,UL(n)<S)return"continue";var h=m.getDispersionLetterList(v,n,S);if(!h||0===h.length)return"continue";for(var c=null,p=null,f=null,d=null,g=[],i=m.position.getVertPosList(),r=0;r<i.length;r++){var o=i[r],y=w.getOffsetY();o===wv?y+=M/2:o===Sv&&(y-=M/2);for(var _=!0,s=function(t){var e=h[t],n=e.letter,i=e.p,r=i.angle,o=e.letterW,s=m._getTranslatePoint(i,0,y,r),a=s.x,u=s.y;if(c=new B.Point(a-o/2,u-M/2),p=new B.Point(a+o/2,u+M/2),f=[new B.Point(c.x,c.y),new B.Point(c.x,p.y),new B.Point(p.x,p.y),new B.Point(p.x,c.y),new B.Point(c.x,c.y)],d=new B.Point(a,u),0!==r&&f.forEach(function(t){S_.rotatePoint(t,d,r)}),!b.canPlacePolygon(f,x))return _=!1,"break";var l=new B.Point(c.x,p.y);g.push({ptAnchor:l,angle:r/Math.PI*180,rotatePoint:d,wText:n,boundPoints:f})},a=0;a<h.length&&"break"!==s(a);a++);if(_){l=!0;break}}if(l&&0<g.length)if(g.forEach(function(t){b.placePolygon(t.boundPoints,x),delete t.boundPoints;var e=new VL(t);E.addPosition(e,m.symbol)}),m.position.getDuplicateLabels()===rv)u.hasTextList.push(v);else if(m.position.getDuplicateLabels()===ov)return"break"}BL(v,e,w,!0,this._measureTextTool);var S=e.getWidth(),M=e.getHeight(),C=0;t:for(var i=0;i<t;i++)switch(n(i)){case"continue":continue;case"break":break t}return l}},{key:"getAlongLetterList",value:function(t,e,n){var i=this.symbol.getTextInfo(),r=UL(e);if(r<n)return null;for(var o=(t=this._reverseText(t,e)).length,s=(r-n)/2,a={dPos:0,pos:0,di:0},u=[],l=20/180*Math.PI,h=i.getInterval(),c=i.getWordInterval(),p=0;p<o;p++){var f=t[p],d=this._measureTextTool.getTextWidth(f),g=jL(e,s+d/2,a);if(g.angle<0&&(g.angle+=2*Math.PI),g.angle>=Math.PI/2&&g.angle<Math.PI/2*3&&(g.angle-=Math.PI),0<u.length){var y=u[u.length-1].p.angle;if(Math.abs(g.angle-y)>l)return null}s+=d+h," "===f&&(s+=c),u.push({letter:f,p:g,letterW:d})}return u}},{key:"getDispersionLetterList",value:function(t,e,n){var i=UL(e);if(i<n)return null;for(var r=(t=this._reverseText(t,e)).length,o=(i-n)/(r+1),s=o,a={dPos:0,pos:0,di:0},u=[],l=20/180*Math.PI,h=0;h<r;h++){var c=t[h],p=this._measureTextTool.getTextWidth(c),f=jL(e,s+p/2,a);if(f.angle<0&&(f.angle+=2*Math.PI),f.angle>=Math.PI/2&&f.angle<Math.PI/2*3&&(f.angle-=Math.PI),0<u.length){var d=u[u.length-1].p.angle;if(Math.abs(f.angle-d)>l)return null}s+=p+o,u.push({letter:c,p:f,letterW:p})}return u}},{key:"_reverseText",value:function(t,e){var n=e.length,i=Math.atan2(e[n-1].y-e[0].y,e[n-1].x-e[0].x);return i<0&&(i+=2*Math.PI),i>=Math.PI/2&&i<Math.PI/2*3&&(t=t.split("").reverse().join("")),t}}]),ZL);function ZL(t,e){h(this,ZL),this.symbol=t,this.position=e,this._measureTextTool=new AL(this.symbol.getTextInfo().getFontInfo())}var QL={},$L=(y(tw,qI),c(tw,[{key:"readJson",value:function(t){var n=this;d(tw.prototype.__proto__||Object.getPrototypeOf(tw.prototype),"readJson",this).call(this,t),t.symbol_layer_list&&0<t.symbol_layer_list.length&&t.symbol_layer_list.forEach(function(t){var e=bm.readFromJson(t);e&&(n.symbols||(n.symbols=[]),n.symbols.push(e))})}},{key:"toJson",value:function(t){if(t)if(d(tw.prototype.__proto__||Object.getPrototypeOf(tw.prototype),"toJson",this).call(this,t),this.symbols&&0<this.symbols.length){var n=[];this.symbols.forEach(function(t){if(t){var e={};t.toJson(e),n.push(e)}}),t.symbol_layer_list=n}else t.symbol_layer_list=null}},{key:"getSize",value:function(){if(!this.symbols||0===this.symbols.length)return 0;var n=0;return this.symbols.forEach(function(t){var e=t.getSize();n<e&&(n=e)}),n}},{key:"setSize",value:function(t){if(this.symbols&&0!==this.symbols.length&&!(t<=0)){var e=this.getSize();if(0!==e){var n=t/e;this.symbols.forEach(function(t){t.setSize(t.getSize()*n),t.setOffsetX(t.getOffsetX()*n),t.setOffsetY(t.getOffsetY()*n)})}}}},{key:"setAngle",value:function(t){var e=this;if(this.symbols&&0!==this.symbols.length){var n=t-this.getAngle();this.symbols.forEach(function(t){t.setAngle(e.getAngle()+n)}),this.options.angle=t}}},{key:"setColor",value:function(e){this.symbols&&0!==this.symbols.length&&(this.symbols.forEach(function(t){t&&!t.isLocked()&&t.setColor(e)}),d(tw.prototype.__proto__||Object.getPrototypeOf(tw.prototype),"setColor",this).call(this,e))}},{key:"getColor",value:function(){if(!this.symbols||0===this.symbols.length)return d(tw.prototype.__proto__||Object.getPrototypeOf(tw.prototype),"getColor",this).call(this);for(var t=0;t<this.symbols.length;t++){var e=this.symbols[t];if(e&&!e.isLocked())return e.getColor()}return d(tw.prototype.__proto__||Object.getPrototypeOf(tw.prototype),"getColor",this).call(this)}},{key:"isLocked",value:function(){if(!this.symbols||0===this.symbols.length)return!1;for(var t=0;t<this.symbols.length;t++)if(!this.symbols[t].isLocked())return!1;return!0}},{key:"isVisible",value:function(){if(!this.symbols||0===this.symbols.length)return!1;for(var t=0;t<this.symbols.length;t++)if(this.symbols[t].isVisible())return!0;return!1}},{key:"getSymbols",value:function(){return this.symbols}},{key:"setSymbols",value:function(t){this.symbols=t}},{key:"getSymbolLayer",value:function(t){return t<0||!this.symbols||this.symbols.length<=t?null:this.symbols[t]}},{key:"getSymbolLayerCount",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols.length:0}},{key:"draw",value:function(e,n){e&&n&&n.length&&this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.draw(e,n)})}},{key:"drawPoint",value:function(e,n){e&&n&&this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.drawPoint(e,n)})}}]),tw);function tw(t){h(this,tw);var e=_(this,(tw.__proto__||Object.getPrototypeOf(tw)).call(this));return e.mergeOptions(QL,t),e.class=nm,e.isMultiLayer=!0,e.symbols=null,e}var ew={},nw=(y(iw,gL),c(iw,[{key:"readJson",value:function(t){var n=this;d(iw.prototype.__proto__||Object.getPrototypeOf(iw.prototype),"readJson",this).call(this,t),t.symbol_layer_list&&0<t.symbol_layer_list.length&&t.symbol_layer_list.forEach(function(t){var e=bm.readFromJson(t);e&&(n.symbols||(n.symbols=[]),n.symbols.push(e))})}},{key:"toJson",value:function(t){if(t)if(d(iw.prototype.__proto__||Object.getPrototypeOf(iw.prototype),"toJson",this).call(this,t),this.symbols&&0<this.symbols.length){var n=[];this.symbols.forEach(function(t){if(t){var e={};t.toJson(e),n.push(e)}}),t.symbol_layer_list=n}else t.symbol_layer_list=null}},{key:"setColor",value:function(e){this.symbols&&0!==this.symbols.length&&(this.symbols.forEach(function(t){t&&!t.isLocked()&&t.setColor(e)}),d(iw.prototype.__proto__||Object.getPrototypeOf(iw.prototype),"setColor",this).call(this,e))}},{key:"getColor",value:function(){if(!this.symbols||0===this.symbols.length)return d(iw.prototype.__proto__||Object.getPrototypeOf(iw.prototype),"getColor",this).call(this);for(var t=0;t<this.symbols.length;t++){var e=this.symbols[t];if(e&&!e.isLocked())return e.getColor()}return d(iw.prototype.__proto__||Object.getPrototypeOf(iw.prototype),"getColor",this).call(this)}},{key:"isLocked",value:function(){if(!this.symbols||0===this.symbols.length)return!1;for(var t=0;t<this.symbols.length;t++)if(!this.symbols[t].isLocked())return!1;return!0}},{key:"isVisible",value:function(){if(!this.symbols||0===this.symbols.length)return!1;for(var t=0;t<this.symbols.length;t++)if(this.symbols[t].isVisible())return!0;return!1}},{key:"setOutlineWidth",value:function(t){this.symbols&&0!==this.symbols.length&&(this.symbols[this.symbols.length-1].setOutlineWidth(t),d(iw.prototype.__proto__||Object.getPrototypeOf(iw.prototype),"setOutlineWidth",this).call(this,t))}},{key:"getOutlineWidth",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols[this.symbols.length-1].getOutlineWidth():null}},{key:"setOutlineColor",value:function(t){this.symbols&&0!==this.symbols.length&&(this.symbols[this.symbols.length-1].setOutlineColor(t),d(iw.prototype.__proto__||Object.getPrototypeOf(iw.prototype),"setOutlineColor",this).call(this,t))}},{key:"getOutlineColor",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols[this.symbols.length-1].getOutlineColor():null}},{key:"getSymbols",value:function(){return this.symbols}},{key:"getSymbolLayer",value:function(t){return t<0||!this.symbols||this.symbols.length<=t?null:this.symbols[t]}},{key:"getSymbolLayerCount",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols.length:0}},{key:"draw",value:function(e,n){e&&n&&n.length&&this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.draw(e,n)})}},{key:"drawPolygon",value:function(e,n){!e||!n||n.length<3||this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.drawPolygon(e,n)})}}]),iw);function iw(t){h(this,iw);var e=_(this,(iw.__proto__||Object.getPrototypeOf(iw)).call(this));return e.mergeOptions(ew,t),e.class=fm,e.symbols=null,e}var rw="round",ow="linear",sw="square",aw={colorList:[new _m(255,0,0),new _m(0,255,0),new _m(0,0,255),new _m(255,255,0)],angle:0,interval:5,percent:1,colorBandIndex:-1,fillStyle:ow},uw=(y(lw,mL),c(lw,[{key:"readJson",value:function(t){if(d(lw.prototype.__proto__||Object.getPrototypeOf(lw.prototype),"readJson",this).call(this,t),this.options.angle=t.angle,this.options.interval=t.interval,this.options.percent=t.percent,this.options.fillStyle=t.style,t.tape_style){var e=t.tape_style;this.options.colorBandIndex=e.color_band_index;var n=e.color,i=[];n&&n.length&&n.forEach(function(t){i.push(_m.createFromArray(t))}),this.options.colorList=i}}},{key:"toJson",value:function(t){if(t){d(lw.prototype.__proto__||Object.getPrototypeOf(lw.prototype),"toJson",this).call(this,t),t.angle=this.options.angle,t.interval=this.options.interval,t.percent=this.options.percent,t.style=this.options.fillStyle;var e={};if(e.color_band_index=this.options.colorBandIndex,this.options.colorList&&this.options.colorList.length){var n=[];this.options.colorList.forEach(function(t){n.push(t.toArray())}),e.color=n}else e.color=null;t.tape_style=e}}},{key:"getColorList",value:function(){return this.options.colorList}},{key:"setColorList",value:function(t){this.options.colorList=t}},{key:"getAngle",value:function(){return this.options.angle}},{key:"setAngle",value:function(t){this.options.angle=t}},{key:"getInterval",value:function(){return this.options.interval}},{key:"setInterval",value:function(t){this.options.interval=t}},{key:"getPercent",value:function(){return this.options.percent}},{key:"setPercent",value:function(t){this.options.percent=t}},{key:"getColorBandIndex",value:function(){return this.options.colorBandIndex}},{key:"setColorBandIndex",value:function(t){this.options.colorBandIndex=t}},{key:"getFillStyle",value:function(){return this.options.fillStyle}},{key:"setFillStyle",value:function(t){this.options.fillStyle=t}},{key:"_drawGeometry",value:function(t,e){if(t&&e&&this.isVisible()){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){for(var o=0,s=this.getFillStyle(),a=0;a<i;a++){t.save(),t.beginPath();var u=r[a],l=n.slice(o,o+u);o+=u,XI.drawPath(t,l),t.clip(),s===rw?this._drawRoundGradient(t,l):s===ow?this._drawLinearGradient(t,l):s===sw&&this._drawSquareGradient(t,l),t.restore()}this._fill(t);var h=this.getOutlineSymbol();this.hasOutline()&&h&&h.draw(t,[e])}}}},{key:"_drawRoundGradient",value:function(t,e){var n=this.getPercent();(!n||n<=0||1<n)&&(n=1);var i=this.getColorList();if(i&&0!==i.length){var r=i.length,o=bt.getPolygonBox(e);if(o&&4===o.length)for(var s=o[2]-o[0],a=o[3]-o[1],u={x:(o[0]+o[2])/2,y:(o[1]+o[3])/2},l=Math.sqrt(s*s+a*a),h=l*n/r*.5,c=0;c<r;c++){t.beginPath();var p=i[c];t.fillStyle=p;var f=.5*l-h*c;t.arc(u.x,u.y,f,0,2*Math.PI),t.fill()}}}},{key:"_drawLinearGradient",value:function(t,e){var n=this.getPercent();(!n||n<=0||1<n)&&(n=1);var i=-1*this.angle,r=this.getColorList();if(r&&0!==r.length){var o=r.length,s=bt.getPolygonBox(e);if(s&&4===s.length)for(var a=s[2]-s[0],u=s[3]-s[1],l={x:(s[0]+s[2])/2,y:(s[1]+s[3])/2},h=Math.abs(u*Math.cos(i/180*Math.PI))+Math.abs(a*Math.sin(i/180*Math.PI)),c=Math.abs(u*Math.sin(i/180*Math.PI))+Math.abs(a*Math.cos(i/180*Math.PI)),p=c*n/o,f=0;f<o;f++){t.save(),t.beginPath();var d=r[f];t.fillStyle=d,t.translate(l.x,l.y),t.rotate(i/180*Math.PI);var g=c-p*f,y=h;t.fillRect(c/2*-1,h/2*-1,g,y),t.restore()}}}},{key:"_drawSquareGradient",value:function(t,e){var n=this.getPercent();(!n||n<=0||1<n)&&(n=1);var i=-1*this.angle,r=this.getColorList();if(r&&0!==r.length){var o=r.length,s=bt.getPolygonBox(e);if(s&&4===s.length)for(var a=s[2]-s[0],u=s[3]-s[1],l={x:(s[0]+s[2])/2,y:(s[1]+s[3])/2},h=Math.abs(u*Math.cos(i/180*Math.PI))+Math.abs(a*Math.sin(i/180*Math.PI)),c=Math.abs(u*Math.sin(i/180*Math.PI))+Math.abs(a*Math.cos(i/180*Math.PI)),p=c*n/o*.5,f=h*n/o*.5,d=0;d<o;d++){t.save(),t.beginPath();var g=r[d];t.fillStyle=g,t.translate(l.x,l.y),t.rotate(i/180*Math.PI);var y=c-p*d*2,_=h-f*d*2;t.fillRect(y/2*-1,_/2*-1,y,_),t.restore()}}}}]),lw);function lw(t){h(this,lw);var e=_(this,(lw.__proto__||Object.getPrototypeOf(lw)).call(this));return e.mergeOptions(aw,t),e.class=lm,e}var hw={arrowWidth:10,arrowLength:20},cw=(y(pw,YI),c(pw,[{key:"readJson",value:function(t){d(pw.prototype.__proto__||Object.getPrototypeOf(pw.prototype),"readJson",this).call(this,t),this.options.arrowWidth=bt.poundToPixel(t.width),this.options.arrowLength=bt.poundToPixel(t.length)}},{key:"toJson",value:function(t){t&&(d(pw.prototype.__proto__||Object.getPrototypeOf(pw.prototype),"toJson",this).call(this,t),t.width=bt.pixelToPound(this.options.arrowWidth),t.length=bt.pixelToPound(this.options.arrowLength))}},{key:"getSize",value:function(){return Math.max(this.options.arrowWidth,this.options.arrowLength)}},{key:"getArrowWidth",value:function(){return this.options.arrowWidth}},{key:"setArrowWidth",value:function(t){this.options.arrowWidth=t}},{key:"getArrowLength",value:function(){return this.options.arrowLength}},{key:"setArrowLength",value:function(t){this.options.arrowLength=t}},{key:"setSize",value:function(t){var e=0;0!==this.options.arrowLength&&(e=this.options.arrowWidth/this.options.arrowLength),this.options.arrowWidth>this.options.arrowLength?(this.options.arrowWidth=t,e||(this.options.arrowLength=this.options.arrowWidth/e)):(this.options.arrowLength=t,this.options.arrowWidth=this.options.arrowLength*e)}},{key:"drawPoint",value:function(t,e){if(t&&e&&this.isVisible()){var n=this.getSize(),i=this.getAngle(),r=this.getOffsetX(),o=this.getOffsetY(),s=this.getArrowLength(),a=this.getArrowWidth();e.x+=r,e.y+=o,XI.drawArrow(t,e,n,i,s,a);var u=this.getHalo();u&&u.hasHalo()&&this._drawHalo(t),t.fillStyle=this.getColor().getStrColor(),t.fill()}}}]),pw);function pw(t){h(this,pw);var e=_(this,(pw.__proto__||Object.getPrototypeOf(pw)).call(this));return e.mergeOptions(hw,t),e.class=em,e}var fw="flip_start",dw="flip_end",gw="flip_both",yw="mid",_w="no_flip",mw={markerSymbol:null,symbolCount:0,isFixedRotation:!1,flipStyle:_w,isFirstRotation:!1,isAllRotation:!1},vw=(c(bw,[{key:"readJson",value:function(t){this.options.symbolCount=t.symbol_count,this.options.isFixedRotation=t.fixed_rotation,this.options.flipStyle=t.flip_style,this.options.isFirstRotation=t.is_first_rotation,this.options.isAllRotation=t.is_all_rotation,t.symbol&&(this.options.markerSymbol=bm.readFromJson(t.symbol))}},{key:"toJson",value:function(t){if(t)if(t.symbol_count=this.options.symbolCount,t.fixed_rotation=this.options.isFixedRotation,t.flip_style=this.options.flipStyle,t.is_first_rotation=this.options.isFirstRotation,t.is_all_rotation=this.options.isAllRotation,this.options.markerSymbol){var e={};this.options.markerSymbol.toJson(e),t.symbol=e}else t.symbol=null}},{key:"getMarkerSymbol",value:function(){return this.options.markerSymbol}},{key:"setMarkerSymbol",value:function(t){this.options.markerSymbol=t}},{key:"getFlipStyle",value:function(){return this.options.flipStyle}},{key:"setFlipStyle",value:function(t){this.options.flipStyle=t}},{key:"isFirstRotation",value:function(){return this.options.isFirstRotation}},{key:"setIsFirstRotation",value:function(t){this.options.isFirstRotation=t}},{key:"isAllRotation",value:function(){return this.options.isAllRotation}},{key:"setIsAllRotation",value:function(t){this.options.isAllRotation=t}},{key:"enable",value:function(){return!(this.options.flipStyle===_w||!this.options.markerSymbol)}}]),bw);function bw(t){h(this,bw),this.options=bt.extend({},mw,t)}function xw(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}function Ew(t,e){if(t&&!(t.length<1))for(var n=1,i=t.length;n<i;n++)e(t[n-1],t[n])}function Iw(t,e){if(t.x===e.x)return t.y===e.y?null:{x:t.x};var n=(e.y-t.y)/(e.x-t.x);return{a:n,b:t.y-n*t.x}}function Lw(t,e,n){return{x:t.x+e*Math.cos(n),y:t.y+e*Math.sin(n)}}var ww={offsetPointLine:function(t,i){var r=[];return Ew(t,xw(function(t,e){if(t.x!==e.x||t.y!==e.y){var n=Math.atan2(t.y-e.y,t.x-e.x)-Math.PI/2;r.push({offsetAngle:n,original:[t,e],offset:[Lw(t,i,n),Lw(e,i,n)]})}},this)),r},offsetPoints:function(t,e){var n=this.offsetPointLine(t,e);return this.joinLineSegments(n,e)},joinSegments:function(t,e,n){return this.circularArc(t,e,n).filter(function(t){return t})},joinLineSegments:function(t,n){var i=[],e=t[0],r=t[t.length-1];return e&&r&&(i.push(e.offset[0]),Ew(t,xw(function(t,e){i=i.concat(this.joinSegments(t,e,n))},this)),i.push(r.offset[1])),i},segmentAsVector:function(t){return{x:t[1].x-t[0].x,y:t[1].y-t[0].y}},getSignedAngle:function(t,e){var n=this.segmentAsVector(t),i=this.segmentAsVector(e);return Math.atan2(n.x*i.y-n.y*i.x,n.x*i.x+n.y*i.y)},circularArc:function(t,e,n){if(t.offsetAngle===e.offsetAngle)return[t.offset[1]];var i=this.getSignedAngle(t.offset,e.offset);if(0<i*n&&0<i*this.getSignedAngle(t.offset,[t.offset[0],e.offset[1]]))return[function(t,e,n,i){var r=Iw(t,e),o=Iw(n,i);if(null===r||null===o)return null;if(r.hasOwnProperty("x"))return o.hasOwnProperty("x")?null:{x:r.x,y:o.a*r.x+o.b};if(o.hasOwnProperty("x"))return{x:o.x,y:r.a*o.x+r.b};if(r.a===o.a)return null;var s=(o.b-r.b)/(r.a-o.a);return{x:s,y:r.a*s+r.b}}(t.offset[0],t.offset[1],e.offset[0],e.offset[1])];var r=[],o=t.original[1],s=0<n,a=s?e.offsetAngle:t.offsetAngle,u=s?t.offsetAngle:e.offsetAngle;u<a&&(u+=2*Math.PI);for(var l=Math.PI/8,h=a;h<u;h+=l)r.push(Lw(o,n,h));return r.push(Lw(o,n,u)),s?r.reverse():r}},Sw={lineCap:"butt",lineJoin:"round",dashArray:null,interval:1,indent:6,lineDecoration:null,offset:0},Mw=(y(Cw,eL),c(Cw,[{key:"readJson",value:function(t){d(Cw.prototype.__proto__||Object.getPrototypeOf(Cw.prototype),"readJson",this).call(this,t),this.options.lineCap=t.cartoline_cap,this.options.lineJoin=t.cartoline_join,this.options.dashArray=t.carto_array,this.options.interval=t.interval,this.options.indent=bt.poundToPixel(t.indent),this.options.offset=bt.poundToPixel(t.offset),t.decoration&&(this.options.lineDecoration=new vw,this.options.lineDecoration.readJson(t.decoration))}},{key:"toJson",value:function(t){if(t)if(d(Cw.prototype.__proto__||Object.getPrototypeOf(Cw.prototype),"toJson",this).call(this,t),t.cartoline_cap=this.options.lineCap,t.cartoline_join=this.options.lineJoin,t.carto_array=this.options.dashArray,t.interval=this.options.interval,t.indent=bt.pixelToPound(this.options.indent),t.offset=bt.pixelToPound(this.options.offset),this.options.lineDecoration){var e={};this.options.lineDecoration.toJson(e),t.decoration=e}else t.decoration=null}},{key:"getLineCap",value:function(){return this.options.lineCap}},{key:"setLineCap",value:function(t){this.options.lineCap=t}},{key:"getLineJoin",value:function(){return this.options.lineJoin}},{key:"setLineJoin",value:function(t){this.options.lineJoin=t}},{key:"getDashArray",value:function(){return this.options.dashArray}},{key:"setDashArray",value:function(t){this.options.dashArray=t}},{key:"getInterval",value:function(){return this.options.interval}},{key:"setInterval",value:function(t){this.options.interval=t}},{key:"getIndent",value:function(){return this.options.indent}},{key:"setIndent",value:function(t){this.options.indent=t}},{key:"getLineDecoration",value:function(){return this.options.lineDecoration}},{key:"setLineDecoration",value:function(t){this.options.lineDecoration=t}},{key:"getOffset",value:function(){return this.options.offset}},{key:"setOffset",value:function(t){this.options.offset=t}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()){var n=this.getOffset();n&&(e=ww.offsetPoints(e,-1*n)),XI.drawPath(t,e,!0),t.save();var i=this.getInterval(),r=this.getIndent()||0,o=this.getDashArray();if(o&&0<o.length){if(1!==(i=(i=Math.round(i))&&1<i?i:1)){var s=[];o.forEach(function(t){s.push(t*i)}),o=s}t.setLineDash(o),t.lineDashOffset=r}t.strokeStyle=this.getColor().getStrColor(),t.lineWidth=this.getWidth(),t.lineCap=this.getLineCap(),t.lineJoin=this.getLineJoin(),t.stroke(),t.restore(),this._drawLineDecoration(t,e)}}},{key:"_drawLineDecoration",value:function(t,e){var n=this.getLineDecoration();if(n&&n.enable()){this._decorationMarkerPattern||(this._decorationMarkerPattern=this._getMarkerPattern(n.getMarkerSymbol()));var i=this._decorationMarkerPattern;if(i){var r=null,o=null,s=null;switch(n.getFlipStyle()){case gw:var a=e[0].x,u=e[0].y,l=e[1].x,h=e[1].y;r={p:0,x:a,y:u,a:Math.atan2(h-u,l-a)};var c=e.length;a=e[c-2].x,u=e[c-2].y,s={p:2,x:l=e[c-1].x,y:h=e[c-1].y,a:Math.atan2(h-u,l-a)};break;case dw:var p=e.length,f=e[p-2].x,d=e[p-2].y,g=e[p-1].x,y=e[p-1].y;s={p:2,x:g,y:y,a:Math.atan2(y-d,g-f)};break;case yw:o={p:1,x:0,y:0,a:0},bt.getPolylineMidPoint(e,e.length,o,0),o.a=o.a*Math.PI/180,o.p=1;break;case fw:var _=e[0].x,m=e[0].y,v=e[1].x,b=e[1].y;r={p:0,x:_,y:m,a:Math.atan2(b-m,v-_)}}o&&(n.isAllRotation()&&(o.a+=Math.PI),this._drawDecorationFlip(t,o,i)),r&&this._drawDecorationFlip(t,r,i),s&&this._drawDecorationFlip(t,s,i)}}}},{key:"_drawDecorationFlip",value:function(t,e,n){var i=this.getLineDecoration(),r=i.isFirstRotation(),o=i.isAllRotation();r&&0===e.p&&(e.a+=Math.PI),o&&1!==e.p&&(e.a+=Math.PI);var s=bt.rad2Deg(e.a),a={x:e.x,y:e.y},u=n.width>n.height?n.width:n.height;XI.drawImage(t,a,u,s,n)}},{key:"_getMarkerPattern",value:function(t){if(!t)return null;var e=t.getSize();if(!(e+=4))return null;var n=document.createElement("canvas");n.width=e,n.height=e;var i=n.getContext("2d"),r={x:e/2,y:e/2};return t.drawPoint(i,r),n}}]),Cw);function Cw(t){h(this,Cw);var e=_(this,(Cw.__proto__||Object.getPrototypeOf(Cw)).call(this));return e.mergeOptions(Sw,t),e.class=rm,e.options.dashArray||(e.options.dashArray=[1,0]),e}var Pw={lineSymbol:null,lineAngle:90},Nw=(y(Ow,Mw),c(Ow,[{key:"readJson",value:function(t){d(Ow.prototype.__proto__||Object.getPrototypeOf(Ow.prototype),"readJson",this).call(this,t),this.options.lineAngle=t.angle,t.line_symbol&&(this.options.lineSymbol=bm.readFromJson(t.line_symbol))}},{key:"toJson",value:function(t){if(t)if(d(Ow.prototype.__proto__||Object.getPrototypeOf(Ow.prototype),"toJson",this).call(this,t),t.angle=this.options.lineAngle,this.options.lineSymbol){var e={};this.options.lineSymbol.toJson(e),t.line_symbol=e}else t.line_symbol=null}},{key:"getLineSymbol",value:function(){return this.options.lineSymbol}},{key:"setLineSymbol",value:function(t){this.options.lineSymbol=t}},{key:"getLineAngle",value:function(){return this.options.lineAngle}},{key:"setLineAngle",value:function(t){this.options.lineAngle=t}},{key:"setColor",value:function(t){d(Ow.prototype.__proto__||Object.getPrototypeOf(Ow.prototype),"setColor",this).call(this,t),this.options.lineSymbol&&this.options.lineSymbol.setColor(t)}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()){var n=this.getOffset();n&&(e=ww.offsetPoints(e,-1*n));var i=[],r=this.getInterval(),o=this.getIndent()||0,s=this.getDashArray();if(s&&0<s.length&&1!==(r=(r=Math.round(r))&&1<r?r:1)){var a=[];s.forEach(function(t){a.push(t*r)}),s=a}bt.getPolylineDecroPoints(i,e,e.length,s,o),0<i.length&&(this._drawLineMarkers(t,i),this._drawLineDecoration(t,e))}}},{key:"_drawLineMarkers",value:function(t,e){if(e&&0!==e.length){var n=this.getLineSymbol();if(n){this._linePattern||(this._linePattern=this._getLinePattern(n));var i=this._linePattern;if(i)for(var r=this.getLineAngle()||0,o=e.length,s=0;s<o;s++){var a=e[s],u=a.a;u+=r;var l={x:a.x,y:a.y},h=i.width>i.height?i.width:i.height;XI.drawImage(t,l,h,u,i)}}}}},{key:"_getLinePattern",value:function(t){if(!t)return null;var e=t.getWidth(),n=this.getWidth(),i=n<e?e:n,r=document.createElement("canvas");r.width=i,r.height=i;var o=r.getContext("2d"),s={x:0,y:i/2},a={x:n,y:i/2};return t.drawLine(o,[s,a]),r}}]),Ow);function Ow(t){h(this,Ow);var e=_(this,(Ow.__proto__||Object.getPrototypeOf(Ow)).call(this));return e.mergeOptions(Pw,t),e.class=sm,e}var Tw={imageUrl:""},kw=(y(Rw,YI),c(Rw,[{key:"readJson",value:function(t){d(Rw.prototype.__proto__||Object.getPrototypeOf(Rw.prototype),"readJson",this).call(this,t),this.options.imageUrl=t.image_url}},{key:"toJson",value:function(t){t&&(d(Rw.prototype.__proto__||Object.getPrototypeOf(Rw.prototype),"toJson",this).call(this,t),t.image_url=this.options.imageUrl)}},{key:"getImageUrl",value:function(){return this.options.imageUrl}},{key:"setImageUrl",value:function(t){this.options.imageUrl=t}},{key:"drawPoint",value:function(t,e){var n=this;if(t&&e&&this.isVisible())if(this._bitmap){var i=this.getSize(),r=this.getAngle(),o=this.getOffsetX(),s=this.getOffsetY();e.x+=o,e.y+=s;var a=this.getHalo();a&&a.hasHalo()&&(XI.drawSquare(t,e,i,r),this._drawHalo(t,e,i,r)),XI.drawImage(t,e,i,r,this._bitmap)}else this._tempData||(this._tempData=[]),this._tempData.push({ctx:t,p:e}),this._loading||this._loadImg().then(function(){n._tempData&&0<n._tempData.length&&n._tempData.forEach(function(t){n.drawPoint(t.ctx,t.p)})}).catch(function(){n._tempData=null})}},{key:"needLoadResource",value:function(){return!this._bitmap}},{key:"loadResources",value:function(){return this._loadImg()}},{key:"_loadImg",value:function(){var r=this;return this._loading=!0,new Promise(function(t,e){var n=r.getImageUrl();n||e();var i=new Image;i.onload=function(){r._bitmap=i,r._loading=!1,t()},i.onerror=function(){e()},i.src=n})}}]),Rw);function Rw(t){h(this,Rw);var e=_(this,(Rw.__proto__||Object.getPrototypeOf(Rw)).call(this));return e.mergeOptions(Tw,t),e.class=tm,e._bitmap=null,e}var Dw="normal",Aw="interval",Fw="random",Bw="centroid",Gw={xOffset:0,yOffset:0,xInterval:20,yInterval:20,markFillType:Dw,markerSymbol:null},Uw=(y(jw,mL),c(jw,[{key:"readJson",value:function(t){d(jw.prototype.__proto__||Object.getPrototypeOf(jw.prototype),"readJson",this).call(this,t),this.options.xOffset=bt.poundToPixel(t.offset_x),this.options.yOffset=bt.poundToPixel(t.offset_y),this.options.xInterval=bt.poundToPixel(t.interval_x),this.options.yInterval=bt.poundToPixel(t.interval_y),this.options.markFillType=t.arrange,t.marker_symbol&&(this.options.markerSymbol=bm.readFromJson(t.marker_symbol))}},{key:"toJson",value:function(t){if(t)if(d(jw.prototype.__proto__||Object.getPrototypeOf(jw.prototype),"toJson",this).call(this,t),t.offset_x=bt.pixelToPound(this.options.xOffset),t.offset_y=bt.pixelToPound(this.options.yOffset),t.interval_x=bt.pixelToPound(this.options.xInterval),t.interval_y=bt.pixelToPound(this.options.yInterval),t.arrange=this.options.markFillType,this.options.markerSymbol){var e={};this.options.markerSymbol.toJson(e),t.marker_symbol=e}else t.marker_symbol=null}},{key:"getOffsetX",value:function(){return this.options.xOffset}},{key:"setOffsetX",value:function(t){this.options.xOffset=t}},{key:"getOffsetY",value:function(){return this.options.yOffset}},{key:"setOffsetY",value:function(t){this.options.yOffset=t}},{key:"getIntervalX",value:function(){return this.options.xInterval}},{key:"setIntervalX",value:function(t){this.options.xInterval=t}},{key:"getIntervalY",value:function(){return this.options.yInterval}},{key:"setIntervalY",value:function(t){this.options.yInterval=t}},{key:"getMarkFillType",value:function(){return this.options.markFillType}},{key:"setMarkFillType",value:function(t){this.options.markFillType=t}},{key:"getMarkerSymbol",value:function(){return this.options.markerSymbol}},{key:"setMarkerSymbol",value:function(t){this.options.markerSymbol=t}},{key:"setColor",value:function(t){d(jw.prototype.__proto__||Object.getPrototypeOf(jw.prototype),"setColor",this).call(this,t),this.options.markerSymbol&&this.options.markerSymbol.setColor(t)}},{key:"_drawGeometry",value:function(t,e){if(t&&e&&this.isVisible()){this.getMarkFillType()===Bw?this._drawCentroid(t,e):this._drawNormal(t,e);var n=this.getOutlineSymbol();this.hasOutline()&&n&&n.draw(t,[e])}}},{key:"_drawCentroid",value:function(t,e){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=this.getMarkerSymbol();if(o)for(var s=0,a=0;a<i;a++){var u=r[a],l=n.slice(s,s+u),h=bt.getCenter(l);s+=u,o.drawPoint(t,h)}}}},{key:"_drawNormal",value:function(t,e){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=0;t.beginPath();for(var s=null,a=0;a<i;a++){var u=r[a],l=n.slice(o,o+u);XI.drawPath(t,l),o+=u,s=s||l[0]}this._fillNormal(t,s)}}},{key:"_fillNormal",value:function(t,e){var n=this.getOffsetX(),i=this.getOffsetY(),r=null,o=this.getMarkFillType();o===Dw?r=this._getNormalFillPattern():o===Aw?r=this._getIntervalFillPattern():o===Fw&&(r=this._getRandomFillPattern()),r&&(t.save(),r=t.createPattern(r,"repeat"),t.fillStyle=r,t.translate(e.x-n,e.y-i),t.fill("evenodd"),t.setTransform(1,0,0,1,0,0),t.restore())}},{key:"_getNormalFillPattern",value:function(){if(this._fillPattern)return this._fillPattern;var t=this.getMarkerSymbol();if(!t)return null;var e=t.getSize(),n=this.getIntervalX(),i=this.getIntervalY(),r=document.createElement("canvas"),o=n,s=i;r.width=o,r.height=s;var a=r.getContext("2d"),u={x:e/2,y:e/2};return t.drawPoint(a,u),this._fillPattern=r}},{key:"_getIntervalFillPattern",value:function(){if(this._fillPattern)return this._fillPattern;var t=this.getMarkerSymbol();if(!t)return null;var e=t.getSize(),n=this.getIntervalX(),i=this.getIntervalY(),r=document.createElement("canvas"),o=2*e+2*n,s=2*e+2*i;r.width=o,r.height=s;var a=r.getContext("2d"),u={x:e/2,y:e/2},l={x:u.x+e+n/2,y:u.y+e+i},h=new It({points:[u,{x:u.x+e+n,y:u.y},l,{x:l.x+e+n,y:l.y}],polyCount:[1,1,1,1],subCount:4});return t.draw(a,[h]),this._fillPattern=r}},{key:"_getRandomFillPattern",value:function(){var t=this.getMarkerSymbol();if(!t)return null;var e=t.getSize(),n=this.getIntervalX(),i=this.getIntervalY(),r=document.createElement("canvas"),o=2*e+2*n,s=2*e+2*i;function a(t,e){return Math.floor(Math.random()*(e-t+1)+t)}r.width=o,r.height=s;var u=r.getContext("2d"),l={x:a(e/2,o/2-e/2),y:a(e/2,s/2-e/2)},h={x:a(o/2+e/2,o-e/2),y:a(e/2,s/2-e/2)},c={x:a(e/2,o/2-e/2),y:a(s/2+e/2,s-e/2)},p={x:a(o/2+e/2,o-e/2),y:a(s/2+e/2,s-e/2)},f=new It({points:[l,h,c,p],polyCount:[1,1,1,1],subCount:4});return t.draw(u,[f]),r}}]),jw);function jw(t){h(this,jw);var e=_(this,(jw.__proto__||Object.getPrototypeOf(jw)).call(this));return e.mergeOptions(Gw,t),e.class=hm,e}var qw={markerSymbol:null},zw=(y(Vw,Mw),c(Vw,[{key:"readJson",value:function(t){d(Vw.prototype.__proto__||Object.getPrototypeOf(Vw.prototype),"readJson",this).call(this,t),t.marker_symbol&&(this.options.markerSymbol=bm.readFromJson(t.marker_symbol))}},{key:"toJson",value:function(t){if(t)if(d(Vw.prototype.__proto__||Object.getPrototypeOf(Vw.prototype),"toJson",this).call(this,t),this.options.markerSymbol){var e={};this.options.markerSymbol.toJson(e),t.marker_symbol=e}else t.marker_symbol=null}},{key:"getMarkerSymbol",value:function(){return this.options.markerSymbol}},{key:"setMarkerSymbol",value:function(t){this.options.markerSymbol=t}},{key:"setColor",value:function(t){d(Vw.prototype.__proto__||Object.getPrototypeOf(Vw.prototype),"setColor",this).call(this,t),this.options.markerSymbol&&this.options.markerSymbol.setColor(t)}},{key:"setWidth",value:function(t){d(Vw.prototype.__proto__||Object.getPrototypeOf(Vw.prototype),"setWidth",this).call(this,t),this.options.markerSymbol&&this.options.markerSymbol.setSize(t)}},{key:"drawLine",value:function(t,e){if(t&&e&&!(e.length<2)&&this.isVisible()){var n=this.getOffset();n&&(e=ww.offsetPoints(e,-1*n));var i=[],r=this.getInterval(),o=this.getIndent()||0,s=this.getDashArray();if(s&&0<s.length&&1!==(r=(r=Math.round(r))&&1<r?r:1)){var a=[];s.forEach(function(t){a.push(t*r)}),s=a}bt.getPolylineDecroPoints(i,e,e.length,s,o),0<i.length&&(this._drawMarkers(t,i),this._drawLineDecoration(t,e))}}},{key:"_drawMarkers",value:function(t,e){if(e&&0!==e.length){var n=this.getMarkerSymbol();if(n){this._markerPattern||(this._markerPattern=this._getMarkerPattern(n));var i=this._markerPattern;if(i)for(var r=e.length,o=0;o<r;o++){var s=e[o],a=s.a,u={x:s.x,y:s.y},l=i.width>i.height?i.width:i.height;XI.drawImage(t,u,l,a,i)}}}}}]),Vw);function Vw(t){h(this,Vw);var e=_(this,(Vw.__proto__||Object.getPrototypeOf(Vw)).call(this));return e.mergeOptions(qw,t),e.class=om,e}var Yw={},Hw=(y(Xw,YI),c(Xw,[{key:"readJson",value:function(t){d(Xw.prototype.__proto__||Object.getPrototypeOf(Xw.prototype),"readJson",this).call(this,t)}},{key:"toJson",value:function(t){t&&d(Xw.prototype.__proto__||Object.getPrototypeOf(Xw.prototype),"toJson",this).call(this,t)}}]),Xw);function Xw(t){h(this,Xw);var e=_(this,(Xw.__proto__||Object.getPrototypeOf(Xw)).call(this));return e.mergeOptions(Yw,t),e}var Jw=j(function(t,e){t.exports=function o(s,a,u){function l(n,t){if(!a[n]){if(!s[n]){var e=U;if(!t&&e)return e(n,!0);if(h)return h(n,!0);var i=new Error("Cannot find module '"+n+"'");throw i.code="MODULE_NOT_FOUND",i}var r=a[n]={exports:{}};s[n][0].call(r.exports,function(t){var e=s[n][1][t];return l(e||t)},r,r.exports,o,s,a,u)}return a[n].exports}for(var h=U,t=0;t<u.length;t++)l(u[t]);return l}({1:[function(t,e,n){var u=0,o=-3;function i(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function s(t,e){this.source=t,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new i,this.dtree=new i}var a=new i,l=new i,h=new Uint8Array(30),c=new Uint16Array(30),p=new Uint8Array(30),f=new Uint16Array(30),d=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g=new i,y=new Uint8Array(320);function r(t,e,n,i){var r,o;for(r=0;r<n;++r)t[r]=0;for(r=0;r<30-n;++r)t[r+n]=r/n|0;for(o=i,r=0;r<30;++r)e[r]=o,o+=1<<t[r]}var _=new Uint16Array(16);function m(t,e,n,i){var r,o;for(r=0;r<16;++r)t.table[r]=0;for(r=0;r<i;++r)t.table[e[n+r]]++;for(t.table[0]=0,r=o=0;r<16;++r)_[r]=o,o+=t.table[r];for(r=0;r<i;++r)e[n+r]&&(t.trans[_[e[n+r]]++]=r)}function v(t){t.bitcount--||(t.tag=t.source[t.sourceIndex++],t.bitcount=7);var e=1&t.tag;return t.tag>>>=1,e}function b(t,e,n){if(!e)return n;for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;var i=t.tag&65535>>>16-e;return t.tag>>>=e,t.bitcount-=e,i+n}function x(t,e){for(;t.bitcount<24;)t.tag|=t.source[t.sourceIndex++]<<t.bitcount,t.bitcount+=8;for(var n=0,i=0,r=0,o=t.tag;i=2*i+(1&o),o>>>=1,++r,n+=e.table[r],0<=(i-=e.table[r]););return t.tag=o,t.bitcount-=r,e.trans[n+i]}function E(t,e,n){var i,r,o,s,a,u;for(i=b(t,5,257),r=b(t,5,1),o=b(t,4,4),s=0;s<19;++s)y[s]=0;for(s=0;s<o;++s){var l=b(t,3,0);y[d[s]]=l}for(m(g,y,0,19),a=0;a<i+r;){var h=x(t,g);switch(h){case 16:var c=y[a-1];for(u=b(t,2,3);u;--u)y[a++]=c;break;case 17:for(u=b(t,3,3);u;--u)y[a++]=0;break;case 18:for(u=b(t,7,11);u;--u)y[a++]=0;break;default:y[a++]=h}}m(e,y,0,i),m(n,y,i,r)}function I(t,e,n){for(;;){var i,r,o,s,a=x(t,e);if(256===a)return u;if(a<256)t.dest[t.destLen++]=a;else for(i=b(t,h[a-=257],c[a]),r=x(t,n),o=t.destLen-b(t,p[r],f[r]),s=o;s<o+i;++s)t.dest[t.destLen++]=t.dest[s]}}function L(t){for(var e,n,i;8<t.bitcount;)t.sourceIndex--,t.bitcount-=8;if(e=256*(e=t.source[t.sourceIndex+1])+t.source[t.sourceIndex],n=256*(n=t.source[t.sourceIndex+3])+t.source[t.sourceIndex+2],e!==(65535&~n))return o;for(t.sourceIndex+=4,i=e;i;--i)t.dest[t.destLen++]=t.source[t.sourceIndex++];return t.bitcount=0,u}!function(t,e){var n;for(n=0;n<7;++n)t.table[n]=0;for(t.table[7]=24,t.table[8]=152,t.table[9]=112,n=0;n<24;++n)t.trans[n]=256+n;for(n=0;n<144;++n)t.trans[24+n]=n;for(n=0;n<8;++n)t.trans[168+n]=280+n;for(n=0;n<112;++n)t.trans[176+n]=144+n;for(n=0;n<5;++n)e.table[n]=0;for(e.table[5]=32,n=0;n<32;++n)e.trans[n]=n}(a,l),r(h,c,4,3),r(p,f,2,1),h[28]=0,c[28]=258,e.exports=function(t,e){var n,i,r=new s(t,e);do{switch(n=v(r),b(r,2,0)){case 0:i=L(r);break;case 1:i=I(r,a,l);break;case 2:E(r,r.ltree,r.dtree),i=I(r,r.ltree,r.dtree);break;default:i=o}if(i!==u)throw new Error("Data error")}while(!n);if(r.destLen<r.dest.length)return"function"==typeof r.dest.slice?r.dest.slice(0,r.destLen):r.dest.subarray(0,r.destLen);return r.dest}},{}],2:[function(t,e,n){n.fail=function(t){throw new Error(t)},n.argument=function(t,e){t||n.fail(e)},n.assert=n.argument},{}],3:[function(t,e,n){n.line=function(t,e,n,i,r){t.beginPath(),t.moveTo(e,n),t.lineTo(i,r),t.stroke()}},{}],4:[function(t,e,n){function i(t){this.font=t}function r(t){this.cmap=t}function o(t,e){this.encoding=t,this.charset=e}function s(t){var e;switch(t.version){case 1:this.names=n.standardNames.slice();break;case 2:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)t.glyphNameIndex[e]<n.standardNames.length?this.names[e]=n.standardNames[t.glyphNameIndex[e]]:this.names[e]=t.names[t.glyphNameIndex[e]-n.standardNames.length];break;case 2.5:for(this.names=new Array(t.numberOfGlyphs),e=0;e<t.numberOfGlyphs;e++)this.names[e]=n.standardNames[e+t.glyphNameIndex[e]];break;case 3:this.names=[]}}i.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),n=this.font.glyphs;if(!n)return null;for(var i=0;i<n.length;i+=1)for(var r=n.get(i),o=0;o<r.unicodes.length;o+=1)if(r.unicodes[o]===e)return i},r.prototype.charToGlyphIndex=function(t){return this.cmap.glyphIndexMap[t.charCodeAt(0)]||0},o.prototype.charToGlyphIndex=function(t){var e=t.charCodeAt(0),n=this.encoding[e];return this.charset.indexOf(n)},s.prototype.nameToGlyphIndex=function(t){return this.names.indexOf(t)},s.prototype.glyphIndexToName=function(t){return this.names[t]},n.cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],n.cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],n.cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],n.standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"],n.DefaultEncoding=i,n.CmapEncoding=r,n.CffEncoding=o,n.GlyphNames=s,n.addGlyphNames=function(t){for(var e,n=t.tables.cmap.glyphIndexMap,i=Object.keys(n),r=0;r<i.length;r+=1){var o=i[r],s=n[o];(e=t.glyphs.get(s)).addUnicode(parseInt(o))}for(r=0;r<t.glyphs.length;r+=1)e=t.glyphs.get(r),t.cffEncoding?e.name=t.cffEncoding.charset[r]:t.glyphNames.names&&(e.name=t.glyphNames.glyphIndexToName(r))}},{}],5:[function(s,t,e){var a=s("./path"),n=s("./tables/sfnt"),i=s("./encoding"),r=s("./glyphset"),o=s("./substitution"),u=s("./util");function l(t){(t=t||{}).empty||(u.checkArgument(t.familyName,"When creating a new Font object, familyName is required."),u.checkArgument(t.styleName,"When creating a new Font object, styleName is required."),u.checkArgument(t.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),u.checkArgument(t.ascender,"When creating a new Font object, ascender is required."),u.checkArgument(t.descender,"When creating a new Font object, descender is required."),u.checkArgument(t.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:t.familyName||" "},fontSubfamily:{en:t.styleName||" "},fullName:{en:t.fullName||t.familyName+" "+t.styleName},postScriptName:{en:t.postScriptName||t.familyName+t.styleName},designer:{en:t.designer||" "},designerURL:{en:t.designerURL||" "},manufacturer:{en:t.manufacturer||" "},manufacturerURL:{en:t.manufacturerURL||" "},license:{en:t.license||" "},licenseURL:{en:t.licenseURL||" "},version:{en:t.version||"Version 0.1"},description:{en:t.description||" "},copyright:{en:t.copyright||" "},trademark:{en:t.trademark||" "}},this.unitsPerEm=t.unitsPerEm||1e3,this.ascender=t.ascender,this.descender=t.descender,this.createdTimestamp=t.createdTimestamp,this.tables={os2:{usWeightClass:t.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:t.widthClass||this.usWidthClasses.MEDIUM,fsSelection:t.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new r.GlyphSet(this,t.glyphs||[]),this.encoding=new i.DefaultEncoding(this),this.substitution=new o(this),this.tables=this.tables||{}}l.prototype.hasChar=function(t){return null!==this.encoding.charToGlyphIndex(t)},l.prototype.charToGlyphIndex=function(t){return this.encoding.charToGlyphIndex(t)},l.prototype.charToGlyph=function(t){var e=this.charToGlyphIndex(t),n=this.glyphs.get(e);return n=n||this.glyphs.get(0)},l.prototype.stringToGlyphs=function(t){for(var e=[],n=0;n<t.length;n+=1){var i=t[n];e.push(this.charToGlyph(i))}return e},l.prototype.nameToGlyphIndex=function(t){return this.glyphNames.nameToGlyphIndex(t)},l.prototype.nameToGlyph=function(t){var e=this.nametoGlyphIndex(t),n=this.glyphs.get(e);return n=n||this.glyphs.get(0)},l.prototype.glyphIndexToName=function(t){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(t):""},l.prototype.getKerningValue=function(t,e){t=t.index||t,e=e.index||e;var n=this.getGposKerningValue;return n?n(t,e):this.kerningPairs[t+","+e]||0},l.prototype.forEachGlyph=function(t,e,n,i,r,o){e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:72;for(var s=void 0===(r=r||{}).kerning||r.kerning,a=1/this.unitsPerEm*i,u=this.stringToGlyphs(t),l=0;l<u.length;l+=1){var h=u[l];if(o(h,e,n,i,r),h.advanceWidth&&(e+=h.advanceWidth*a),s&&l<u.length-1){var c=this.getKerningValue(h,u[l+1]);e+=c*a}}},l.prototype.getPath=function(t,e,n,i,r){var o=new a.Path;return this.forEachGlyph(t,e,n,i,r,function(t,e,n,i){var r=t.getPath(e,n,i);o.extend(r)}),o},l.prototype.getPaths=function(t,e,n,i,r){var o=[];return this.forEachGlyph(t,e,n,i,r,function(t,e,n,i){var r=t.getPath(e,n,i);o.push(r)}),o},l.prototype.draw=function(t,e,n,i,r,o){this.getPath(e,n,i,r,o).draw(t)},l.prototype.drawPoints=function(r,t,e,n,i,o){this.forEachGlyph(t,e,n,i,o,function(t,e,n,i){t.drawPoints(r,e,n,i)})},l.prototype.drawMetrics=function(r,t,e,n,i,o){this.forEachGlyph(t,e,n,i,o,function(t,e,n,i){t.drawMetrics(r,e,n,i)})},l.prototype.getEnglishName=function(t){var e=this.names[t];if(e)return e.en},l.prototype.validate=function(){var n=this;function t(t){var e=n.getEnglishName(t);e&&e.trim().length}t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),this.unitsPerEm},l.prototype.toTables=function(){return n.fontToTable(this)},l.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},l.prototype.toArrayBuffer=function(){for(var t=this.toTables(),e=t.encode(),n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=e[r];return n},l.prototype.download=function(){var t=this.getEnglishName("fontFamily"),e=this.getEnglishName("fontSubfamily"),n=t.replace(/\s/g,"")+"-"+e+".otf",r=this.toArrayBuffer();if(u.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,r.byteLength,function(t){t.root.getFile(n,{create:!0},function(i){i.createWriter(function(t){var e=new DataView(r),n=new Blob([e],{type:"font/opentype"});t.write(n),t.addEventListener("writeend",function(){location.href=i.toURL()},!1)})})},function(t){throw new Error(t.name+": "+t.message)});else{var i=s("fs"),o=u.arrayBufferToNodeBuffer(r);i.writeFileSync(n,o)}},l.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},l.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},l.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},e.Font=l},{"./encoding":4,"./glyphset":7,"./path":11,"./substitution":12,"./tables/sfnt":31,"./util":33,fs:void 0}],6:[function(t,e,n){var r=t("./check"),h=t("./draw"),c=t("./path");function i(t){this.bindConstructorValues(t)}i.prototype.bindConstructorValues=function(t){this.index=t.index||0,this.name=t.name||null,this.unicode=t.unicode||void 0,this.unicodes=t.unicodes||void 0!==t.unicode?[t.unicode]:[],t.xMin&&(this.xMin=t.xMin),t.yMin&&(this.yMin=t.yMin),t.xMax&&(this.xMax=t.xMax),t.yMax&&(this.yMax=t.yMax),t.advanceWidth&&(this.advanceWidth=t.advanceWidth),Object.defineProperty(this,"path",function(t){var e=t||{commands:[]};return{configurable:!0,get:function(){return"function"==typeof e&&(e=e()),e},set:function(t){e=t}}}(t.path))},i.prototype.addUnicode=function(t){0===this.unicodes.length&&(this.unicode=t),this.unicodes.push(t)},i.prototype.getPath=function(t,e,n,i){t=void 0!==t?t:0,e=void 0!==e?e:0,i=void 0!==i?i:{xScale:1,yScale:1},n=void 0!==n?n:72;for(var r=1/this.path.unitsPerEm*n,o=i.xScale*r,s=i.yScale*r,a=new c.Path,u=this.path.commands,l=0;l<u.length;l+=1){var h=u[l];"M"===h.type?a.moveTo(t+h.x*o,e+-h.y*s):"L"===h.type?a.lineTo(t+h.x*o,e+-h.y*s):"Q"===h.type?a.quadraticCurveTo(t+h.x1*o,e+-h.y1*s,t+h.x*o,e+-h.y*s):"C"===h.type?a.curveTo(t+h.x1*o,e+-h.y1*s,t+h.x2*o,e+-h.y2*s,t+h.x*o,e+-h.y*s):"Z"===h.type&&a.closePath()}return a},i.prototype.getContours=function(){if(void 0===this.points)return[];for(var t=[],e=[],n=0;n<this.points.length;n+=1){var i=this.points[n];e.push(i),i.lastPointOfContour&&(t.push(e),e=[])}return r.argument(0===e.length,"There are still points left in the current contour."),t},i.prototype.getMetrics=function(){for(var t=this.path.commands,e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];"Z"!==r.type&&(e.push(r.x),n.push(r.y)),"Q"!==r.type&&"C"!==r.type||(e.push(r.x1),n.push(r.y1)),"C"===r.type&&(e.push(r.x2),n.push(r.y2))}var o={xMin:Math.min.apply(null,e),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,e),yMax:Math.max.apply(null,n),leftSideBearing:this.leftSideBearing};return isFinite(o.xMin)||(o.xMin=0),isFinite(o.xMax)||(o.xMax=this.advanceWidth),isFinite(o.yMin)||(o.yMin=0),isFinite(o.yMax)||(o.yMax=0),o.rightSideBearing=this.advanceWidth-o.leftSideBearing-(o.xMax-o.xMin),o},i.prototype.draw=function(t,e,n,i,r){this.getPath(e,n,i,r).draw(t)},i.prototype.drawPoints=function(s,t,e,n){function i(t,e,n,i){var r=2*Math.PI;s.beginPath();for(var o=0;o<t.length;o+=1)s.moveTo(e+t[o].x*i,n+t[o].y*i),s.arc(e+t[o].x*i,n+t[o].y*i,2,0,r,!1);s.closePath(),s.fill()}t=void 0!==t?t:0,e=void 0!==e?e:0,n=void 0!==n?n:24;for(var r=1/this.path.unitsPerEm*n,o=[],a=[],u=this.path,l=0;l<u.commands.length;l+=1){var h=u.commands[l];void 0!==h.x&&o.push({x:h.x,y:-h.y}),void 0!==h.x1&&a.push({x:h.x1,y:-h.y1}),void 0!==h.x2&&a.push({x:h.x2,y:-h.y2})}s.fillStyle="blue",i(o,t,e,r),s.fillStyle="red",i(a,t,e,r)},i.prototype.drawMetrics=function(t,e,n,i){var r;e=void 0!==e?e:0,n=void 0!==n?n:0,i=void 0!==i?i:24,r=1/this.path.unitsPerEm*i,t.lineWidth=1,t.strokeStyle="black",h.line(t,e,-1e4,e,1e4),h.line(t,-1e4,n,1e4,n);var o=this.xMin||0,s=this.yMin||0,a=this.xMax||0,u=this.yMax||0,l=this.advanceWidth||0;t.strokeStyle="blue",h.line(t,e+o*r,-1e4,e+o*r,1e4),h.line(t,e+a*r,-1e4,e+a*r,1e4),h.line(t,-1e4,n+-s*r,1e4,n+-s*r),h.line(t,-1e4,n+-u*r,1e4,n+-u*r),t.strokeStyle="green",h.line(t,e+l*r,-1e4,e+l*r,1e4)},n.Glyph=i},{"./check":2,"./draw":3,"./path":11}],7:[function(t,e,n){var a=t("./glyph");function u(e,t,n){Object.defineProperty(e,t,{get:function(){return e.path,e[n]},set:function(t){e[n]=t},enumerable:!0,configurable:!0})}function i(t,e){if(this.font=t,this.glyphs={},Array.isArray(e))for(var n=0;n<e.length;n++)this.glyphs[n]=e[n];this.length=e&&e.length||0}i.prototype.get=function(t){return"function"==typeof this.glyphs[t]&&(this.glyphs[t]=this.glyphs[t]()),this.glyphs[t]},i.prototype.push=function(t,e){this.glyphs[t]=e,this.length++},n.GlyphSet=i,n.glyphLoader=function(t,e){return new a.Glyph({index:e,font:t})},n.ttfGlyphLoader=function(n,t,i,r,o,s){return function(){var e=new a.Glyph({index:t,font:n});return e.path=function(){i(e,r,o);var t=s(n.glyphs,e);return t.unitsPerEm=n.unitsPerEm,t},u(e,"xMin","_xMin"),u(e,"xMax","_xMax"),u(e,"yMin","_yMin"),u(e,"yMax","_yMax"),e}},n.cffGlyphLoader=function(n,t,i,r){return function(){var e=new a.Glyph({index:t,font:n});return e.path=function(){var t=i(n,e,r);return t.unitsPerEm=n.unitsPerEm,t},e}}},{"./glyph":6}],8:[function(t,e,n){var h=t("./check");function s(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+i>>>1,o=t[r].tag;if(o===e)return r;o<e?n=1+r:i=r-1}return-n-1}var i={searchTag:s,binSearch:function(t,e){var n=0,i=t.length-1;for(;n<=i;){var r=n+i>>>1,o=t[r];if(o===e)return r;o<e?n=1+r:i=r-1}return-n-1},getScriptNames:function(){var t=this.getGsubTable();return t?t.scripts.map(function(t){return t.tag}):[]},getScriptTable:function(t,e){var n=this.getGsubTable(e);if(n){var i=n.scripts,r=s(n.scripts,t);if(0<=r)return i[r].script;var o={tag:t,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return i.splice(-1-r,0,o.script),o}},getLangSysTable:function(t,e,n){var i=this.getScriptTable(t,n);if(i){if("DFLT"===e)return i.defaultLangSys;var r=s(i.langSysRecords,e);if(0<=r)return i.langSysRecords[r].langSys;if(n){var o={tag:e,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return i.langSysRecords.splice(-1-r,0,o),o.langSys}}},getFeatureTable:function(t,e,n,i){var r=this.getLangSysTable(t,e,i);if(r){for(var o,s=r.featureIndexes,a=this.font.tables.gsub.features,u=0;u<s.length;u++)if((o=a[s[u]]).tag===n)return o.feature;if(i){var l=a.length;return h.assert(0===l||n>=a[l-1].tag,"Features must be added in alphabetical order."),o={tag:n,feature:{params:0,lookupListIndexes:[]}},a.push(o),s.push(l),o.feature}}},getLookupTable:function(t,e,n,i,r){var o=this.getFeatureTable(t,e,n,r);if(o){for(var s,a=o.lookupListIndexes,u=this.font.tables.gsub.lookups,l=0;l<a.length;l++)if((s=u[a[l]]).lookupType===i)return s;if(r){s={lookupType:i,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=u.length;return u.push(s),a.push(h),s}}},expandCoverage:function(t){if(1===t.format)return t.glyphs;for(var e=[],n=t.ranges,i=0;i<n;i++)for(var r=n[i],o=r.start,s=r.end,a=o;a<=s;a++)e.push(a);return e}};e.exports=i},{"./check":2}],9:[function(i,t,e){var o=i("tiny-inflate"),R=i("./encoding"),D=i("./font"),n=i("./glyph"),A=i("./parse"),r=i("./path"),s=i("./util"),F=i("./tables/cmap"),B=i("./tables/cff"),G=i("./tables/fvar"),U=i("./tables/glyf"),j=i("./tables/gpos"),q=i("./tables/gsub"),z=i("./tables/head"),V=i("./tables/hhea"),Y=i("./tables/hmtx"),H=i("./tables/kern"),X=i("./tables/ltag"),J=i("./tables/loca"),W=i("./tables/maxp"),K=i("./tables/name"),Z=i("./tables/os2"),Q=i("./tables/post"),$=i("./tables/meta");function a(t,n){var e=i("fs");e.readFile(t,function(t,e){if(t)return n(t.message);n(null,s.nodeBufferToArrayBuffer(e))})}function u(t,e){var n=new XMLHttpRequest;n.open("get",t,!0),n.responseType="arraybuffer",n.onload=function(){return 200!==n.status?e("Font could not be loaded: "+n.statusText):e(null,n.response)},n.send()}function tt(t,e){for(var n=[],i=12,r=0;r<e;r+=1){var o=A.getTag(t,i),s=A.getULong(t,i+4),a=A.getULong(t,i+8),u=A.getULong(t,i+12);n.push({tag:o,checksum:s,offset:a,length:u,compression:!1}),i+=16}return n}function et(t,e){if("WOFF"!==e.compression)return{data:t,offset:e.offset};var n=new Uint8Array(t.buffer,e.offset+2,e.compressedLength-2),i=new Uint8Array(e.originalLength);if(o(n,i),i.byteLength!==e.originalLength)throw new Error("Decompression error: "+e.tag+" decompressed length doesn't match recorded length");var r=new DataView(i.buffer,0);return{data:r,offset:0}}function l(t){var e,n,i,r,o,s,a,u,l,h,c,p,f,d=new D.Font({empty:!0}),g=new DataView(t,0),y=[],_=A.getTag(g,0);if(_===String.fromCharCode(0,1,0,0))d.outlinesFormat="truetype",i=A.getUShort(g,4),y=tt(g,i);else if("OTTO"===_)d.outlinesFormat="cff",i=A.getUShort(g,4),y=tt(g,i);else{if("wOFF"!==_)throw new Error("Unsupported OpenType signature "+_);var m=A.getTag(g,4);if(m===String.fromCharCode(0,1,0,0))d.outlinesFormat="truetype";else{if("OTTO"!==m)throw new Error("Unsupported OpenType flavor "+_);d.outlinesFormat="cff"}i=A.getUShort(g,12),y=function(t,e){for(var n=[],i=44,r=0;r<e;r+=1){var o,s=A.getTag(t,i),a=A.getULong(t,i+4),u=A.getULong(t,i+8),l=A.getULong(t,i+12);o=u<l&&"WOFF",n.push({tag:s,offset:a,compression:o,compressedLength:u,originalLength:l}),i+=20}return n}(g,i)}for(var v=0;v<i;v+=1){var b,x=y[v];switch(x.tag){case"cmap":b=et(g,x),d.tables.cmap=F.parse(b.data,b.offset),d.encoding=new R.CmapEncoding(d.tables.cmap);break;case"fvar":o=x;break;case"head":b=et(g,x),d.tables.head=z.parse(b.data,b.offset),d.unitsPerEm=d.tables.head.unitsPerEm,e=d.tables.head.indexToLocFormat;break;case"hhea":b=et(g,x),d.tables.hhea=V.parse(b.data,b.offset),d.ascender=d.tables.hhea.ascender,d.descender=d.tables.hhea.descender,d.numberOfHMetrics=d.tables.hhea.numberOfHMetrics;break;case"hmtx":l=x;break;case"ltag":b=et(g,x),n=X.parse(b.data,b.offset);break;case"maxp":b=et(g,x),d.tables.maxp=W.parse(b.data,b.offset),d.numGlyphs=d.tables.maxp.numGlyphs;break;case"name":p=x;break;case"OS/2":b=et(g,x),d.tables.os2=Z.parse(b.data,b.offset);break;case"post":b=et(g,x),d.tables.post=Q.parse(b.data,b.offset),d.glyphNames=new R.GlyphNames(d.tables.post);break;case"glyf":s=x;break;case"loca":c=x;break;case"CFF ":r=x;break;case"kern":h=x;break;case"GPOS":a=x;break;case"GSUB":u=x;break;case"meta":f=x}}var E=et(g,p);if(d.tables.name=K.parse(E.data,E.offset,n),d.names=d.tables.name,s&&c){var I=0===e,L=et(g,c),w=J.parse(L.data,L.offset,d.numGlyphs,I),S=et(g,s);d.glyphs=U.parse(S.data,S.offset,w,d)}else{if(!r)throw new Error("Font doesn't contain TrueType or CFF outlines.");var M=et(g,r);B.parse(M.data,M.offset,d)}var C=et(g,l);if(Y.parse(C.data,C.offset,d.numberOfHMetrics,d.numGlyphs,d.glyphs),R.addGlyphNames(d),h){var P=et(g,h);d.kerningPairs=H.parse(P.data,P.offset)}else d.kerningPairs={};if(a){var N=et(g,a);j.parse(N.data,N.offset,d)}if(u){var O=et(g,u);d.tables.gsub=q.parse(O.data,O.offset)}if(o){var T=et(g,o);d.tables.fvar=G.parse(T.data,T.offset,d.names)}if(f){var k=et(g,f);d.tables.meta=$.parse(k.data,k.offset),d.metas=d.tables.meta}return d}e._parse=A,e.Font=D.Font,e.Glyph=n.Glyph,e.Path=r.Path,e.parse=l,e.load=function(t,i){("undefined"==typeof window?a:u)(t,function(t,e){if(t)return i(t);var n;try{n=l(e)}catch(t){return i(t,null)}return i(null,n)})},e.loadSync=function(t){var e=i("fs").readFileSync(t);return l(s.nodeBufferToArrayBuffer(e))}},{"./encoding":4,"./font":5,"./glyph":6,"./parse":10,"./path":11,"./tables/cff":14,"./tables/cmap":15,"./tables/fvar":16,"./tables/glyf":17,"./tables/gpos":18,"./tables/gsub":19,"./tables/head":20,"./tables/hhea":21,"./tables/hmtx":22,"./tables/kern":23,"./tables/loca":24,"./tables/ltag":25,"./tables/maxp":26,"./tables/meta":27,"./tables/name":28,"./tables/os2":29,"./tables/post":30,"./util":33,fs:void 0,"tiny-inflate":1}],10:[function(t,e,n){var o=t("./check");function i(t,e){return t.getUint16(e,!1)}n.getByte=function(t,e){return t.getUint8(e)},n.getCard8=n.getByte,n.getUShort=n.getCard16=i,n.getShort=function(t,e){return t.getInt16(e,!1)},n.getULong=function(t,e){return t.getUint32(e,!1)},n.getFixed=function(t,e){var n=t.getInt16(e,!1),i=t.getUint16(e+2,!1);return n+i/65535},n.getTag=function(t,e){for(var n="",i=e;i<e+4;i+=1)n+=String.fromCharCode(t.getInt8(i));return n},n.getOffset=function(t,e,n){for(var i=0,r=0;r<n;r+=1)i<<=8,i+=t.getUint8(e+r);return i},n.getBytes=function(t,e,n){for(var i=[],r=e;r<n;r+=1)i.push(t.getUint8(r));return i},n.bytesToString=function(t){for(var e="",n=0;n<t.length;n+=1)e+=String.fromCharCode(t[n]);return e};var r={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function s(t,e){this.data=t,this.offset=e,this.relativeOffset=0}s.prototype.parseByte=function(){var t=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},s.prototype.parseChar=function(){var t=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,t},s.prototype.parseCard8=s.prototype.parseByte,s.prototype.parseCard16=s.prototype.parseUShort=function(){var t=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},s.prototype.parseSID=s.prototype.parseUShort,s.prototype.parseOffset16=s.prototype.parseUShort,s.prototype.parseShort=function(){var t=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,t},s.prototype.parseF2Dot14=function(){var t=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,t},s.prototype.parseULong=function(){var t=n.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},s.prototype.parseFixed=function(){var t=n.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,t},s.prototype.parseString=function(t){var e=this.data,n=this.offset+this.relativeOffset,i="";this.relativeOffset+=t;for(var r=0;r<t;r++)i+=String.fromCharCode(e.getUint8(n+r));return i},s.prototype.parseTag=function(){return this.parseString(4)},s.prototype.parseLongDateTime=function(){var t=n.getULong(this.data,this.offset+this.relativeOffset+4);return t-=2082844800,this.relativeOffset+=8,t},s.prototype.parseVersion=function(){var t=i(this.data,this.offset+this.relativeOffset),e=i(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+e/4096/10},s.prototype.skip=function(t,e){void 0===e&&(e=1),this.relativeOffset+=r[t]*e},s.prototype.parseOffset16List=s.prototype.parseUShortList=function(t){void 0===t&&(t=this.parseUShort());for(var e=new Array(t),n=this.data,i=this.offset+this.relativeOffset,r=0;r<t;r++)e[r]=n.getUint16(i),i+=2;return this.relativeOffset+=2*t,e},s.prototype.parseList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),i=0;i<t;i++)n[i]=e.call(this);return n},s.prototype.parseRecordList=function(t,e){e||(e=t,t=this.parseUShort());for(var n=new Array(t),i=Object.keys(e),r=0;r<t;r++){for(var o={},s=0;s<i.length;s++){var a=i[s],u=e[a];o[a]=u.call(this)}n[r]=o}return n},s.prototype.parseStruct=function(t){if("function"==typeof t)return t.call(this);for(var e=Object.keys(t),n={},i=0;i<e.length;i++){var r=e[i],o=t[r];n[r]=o.call(this)}return n},s.prototype.parsePointer=function(t){var e=this.parseOffset16();if(0<e)return new s(this.data,this.offset+e).parseStruct(t)},s.prototype.parseListOfLists=function(t){for(var e=this.parseOffset16List(),n=e.length,i=this.relativeOffset,r=new Array(n),o=0;o<n;o++){var s=e[o];if(0!==s)if(this.relativeOffset=s,t){for(var a=this.parseOffset16List(),u=new Array(a.length),l=0;l<a.length;l++)this.relativeOffset=s+a[l],u[l]=t.call(this);r[o]=u}else r[o]=this.parseUShortList();else r[o]=void 0}return this.relativeOffset=i,r},s.prototype.parseCoverage=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort(),n=this.parseUShort();if(1===e)return{format:1,glyphs:this.parseUShortList(n)};if(2===e){for(var i=new Array(n),r=0;r<n;r++)i[r]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:i}}o.assert(!1,"0x"+t.toString(16)+": Coverage format must be 1 or 2.")},s.prototype.parseClassDef=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===e?{format:2,ranges:this.parseRecordList({start:s.uShort,end:s.uShort,classId:s.uShort})}:void o.assert(!1,"0x"+t.toString(16)+": ClassDef format must be 1 or 2.")},s.list=function(t,e){return function(){return this.parseList(t,e)}},s.recordList=function(t,e){return function(){return this.parseRecordList(t,e)}},s.pointer=function(t){return function(){return this.parsePointer(t)}},s.tag=s.prototype.parseTag,s.byte=s.prototype.parseByte,s.uShort=s.offset16=s.prototype.parseUShort,s.uShortList=s.prototype.parseUShortList,s.struct=s.prototype.parseStruct,s.coverage=s.prototype.parseCoverage,s.classDef=s.prototype.parseClassDef;var a={reserved:s.uShort,reqFeatureIndex:s.uShort,featureIndexes:s.uShortList};s.prototype.parseScriptList=function(){return this.parsePointer(s.recordList({tag:s.tag,script:s.pointer({defaultLangSys:s.pointer(a),langSysRecords:s.recordList({tag:s.tag,langSys:s.pointer(a)})})}))},s.prototype.parseFeatureList=function(){return this.parsePointer(s.recordList({tag:s.tag,feature:s.pointer({featureParams:s.offset16,lookupListIndexes:s.uShortList})}))},s.prototype.parseLookupList=function(i){return this.parsePointer(s.list(s.pointer(function(){var t=this.parseUShort();o.argument(1<=t&&t<=8,"GSUB lookup type "+t+" unknown.");var e=this.parseUShort(),n=16&e;return{lookupType:t,lookupFlag:e,subtables:this.parseList(s.pointer(i[t])),markFilteringSet:n?this.parseUShort():void 0}})))},n.Parser=s},{"./check":2}],11:[function(t,e,n){function i(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}i.prototype.moveTo=function(t,e){this.commands.push({type:"M",x:t,y:e})},i.prototype.lineTo=function(t,e){this.commands.push({type:"L",x:t,y:e})},i.prototype.curveTo=i.prototype.bezierCurveTo=function(t,e,n,i,r,o){this.commands.push({type:"C",x1:t,y1:e,x2:n,y2:i,x:r,y:o})},i.prototype.quadTo=i.prototype.quadraticCurveTo=function(t,e,n,i){this.commands.push({type:"Q",x1:t,y1:e,x:n,y:i})},i.prototype.close=i.prototype.closePath=function(){this.commands.push({type:"Z"})},i.prototype.extend=function(t){t.commands&&(t=t.commands),Array.prototype.push.apply(this.commands,t)},i.prototype.draw=function(t){t.beginPath();for(var e=0;e<this.commands.length;e+=1){var n=this.commands[e];"M"===n.type?t.moveTo(n.x,n.y):"L"===n.type?t.lineTo(n.x,n.y):"C"===n.type?t.bezierCurveTo(n.x1,n.y1,n.x2,n.y2,n.x,n.y):"Q"===n.type?t.quadraticCurveTo(n.x1,n.y1,n.x,n.y):"Z"===n.type&&t.closePath()}this.fill&&(t.fillStyle=this.fill,t.fill()),this.stroke&&(t.strokeStyle=this.stroke,t.lineWidth=this.strokeWidth,t.stroke())},i.prototype.toPathData=function(e){function i(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function t(){for(var t="",e=0;e<arguments.length;e+=1){var n=arguments[e];0<=n&&0<e&&(t+=" "),t+=i(n)}return t}e=void 0!==e?e:2;for(var n="",r=0;r<this.commands.length;r+=1){var o=this.commands[r];"M"===o.type?n+="M"+t(o.x,o.y):"L"===o.type?n+="L"+t(o.x,o.y):"C"===o.type?n+="C"+t(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?n+="Q"+t(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(n+="Z")}return n},i.prototype.toSVG=function(t){var e='<path d="';return e+=this.toPathData(t),e+='"',this.fill&&"black"!==this.fill&&(null===this.fill?e+=' fill="none"':e+=' fill="'+this.fill+'"'),this.stroke&&(e+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),e+="/>"},n.Path=i},{}],12:[function(t,e,n){var p=t("./check"),i=t("./layout"),r=function(t){this.font=t};function f(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}function u(t,e,n){for(var i=t.subtables,r=0;r<i.length;r++){var o=i[r];if(o.substFormat===e)return o}if(n)return i.push(n),n}(r.prototype=i).getGsubTable=function(t){var e=this.font.tables.gsub;return!e&&t&&(this.font.tables.gsub=e={version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}),e},r.prototype.getSingle=function(t,e,n){var i=[],r=this.getLookupTable(e,n,t,1);if(!r)return i;for(var o=r.subtables,s=0;s<o.length;s++){var a,u=o[s],l=this.expandCoverage(u.coverage);if(1===u.substFormat){var h=u.deltaGlyphId;for(a=0;a<l.length;a++){var c=l[a];i.push({sub:c,by:c+h})}}else{var p=u.substitute;for(a=0;a<l.length;a++)i.push({sub:l[a],by:p[a]})}}return i},r.prototype.getAlternates=function(t,e,n){var i=[],r=this.getLookupTable(e,n,t,3);if(!r)return i;for(var o=r.subtables,s=0;s<o.length;s++)for(var a=o[s],u=this.expandCoverage(a.coverage),l=a.alternateSets,h=0;h<u.length;h++)i.push({sub:u[h],by:l[h]});return i},r.prototype.getLigatures=function(t,e,n){var i=[],r=this.getLookupTable(e,n,t,4);if(!r)return[];for(var o=r.subtables,s=0;s<o.length;s++)for(var a=o[s],u=this.expandCoverage(a.coverage),l=a.ligatureSets,h=0;h<u.length;h++)for(var c=u[h],p=l[h],f=0;f<p.length;f++){var d=p[f];i.push({sub:[c].concat(d.components),by:d.ligGlyph})}return i},r.prototype.addSingle=function(t,e,n,i){var r=this.getLookupTable(n,i,t,1,!0),o=u(r,2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});p.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.substitute.splice(a,0,0)),o.substitute[a]=e.by},r.prototype.addAlternate=function(t,e,n,i){var r=this.getLookupTable(n,i,t,3,!0),o=u(r,1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});p.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub,a=this.binSearch(o.coverage.glyphs,s);a<0&&(a=-1-a,o.coverage.glyphs.splice(a,0,s),o.alternateSets.splice(a,0,0)),o.alternateSets[a]=e.by},r.prototype.addLigature=function(t,e,n,i){n=n||"DFLT",i=i||"DFLT";var r=this.getLookupTable(n,i,t,4,!0),o=r.subtables[0];o||(o={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},r.subtables[0]=o),p.assert(1===o.coverage.format,"Ligature: unable to modify coverage table format "+o.coverage.format);var s=e.sub[0],a=e.sub.slice(1),u={ligGlyph:e.by,components:a},l=this.binSearch(o.coverage.glyphs,s);if(0<=l){for(var h=o.ligatureSets[l],c=0;c<h.length;c++)if(f(h[c].components,a))return;h.push(u)}else l=-1-l,o.coverage.glyphs.splice(l,0,s),o.ligatureSets.splice(l,0,[u])},r.prototype.getFeature=function(t,e,n){if(e=e||"DFLT",n=n||"DFLT",/ss\d\d/.test(t))return this.getSingle(t,e,n);switch(t){case"aalt":case"salt":return this.getSingle(t,e,n).concat(this.getAlternates(t,e,n));case"dlig":case"liga":case"rlig":return this.getLigatures(t,e,n)}},r.prototype.add=function(t,e,n,i){if(n=n||"DFLT",i=i||"DFLT",/ss\d\d/.test(t))return this.addSingle(t,e,n,i);switch(t){case"aalt":case"salt":return"number"==typeof e.by?this.addSingle(t,e,n,i):this.addAlternate(t,e,n,i);case"dlig":case"liga":case"rlig":return this.addLigature(t,e,n,i)}},e.exports=r},{"./check":2,"./layout":8}],13:[function(t,e,n){var r=t("./check"),i=t("./types").encode,o=t("./types").sizeOf;function s(t,e,n){var i;for(i=0;i<e.length;i+=1){var r=e[i];this[r.name]=r.value}if(this.tableName=t,this.fields=e,n){var o=Object.keys(n);for(i=0;i<o.length;i+=1){var s=o[i],a=n[s];void 0!==this[s]&&(this[s]=a)}}}function a(t,e,n){void 0===n&&(n=e.length);var i=new Array(e.length+1);i[0]={name:t+"Count",type:"USHORT",value:n};for(var r=0;r<e.length;r++)i[r+1]={name:t+r,type:"USHORT",value:e[r]};return i}function u(t,e,n){var i=e.length,r=new Array(i+1);r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r[o+1]={name:t+o,type:"TABLE",value:n(e[o],o)};return r}function l(t,e,n){var i=e.length,r=[];r[0]={name:t+"Count",type:"USHORT",value:i};for(var o=0;o<i;o++)r=r.concat(n(e[o],o));return r}function h(t){1===t.format?s.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(a("glyph",t.glyphs))):r.assert(!1,"Can't create coverage table format 2 yet.")}function c(t){s.call(this,"scriptListTable",l("scriptRecord",t,function(t,e){var n=t.script,i=n.defaultLangSys;return r.assert(!!i,"Unable to write GSUB: script "+t.tag+" has no default language system."),[{name:"scriptTag"+e,type:"TAG",value:t.tag},{name:"script"+e,type:"TABLE",value:new s("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new s("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:i.reqFeatureIndex}].concat(a("featureIndex",i.featureIndexes)))}].concat(l("langSys",n.langSysRecords,function(t,e){var n=t.langSys;return[{name:"langSysTag"+e,type:"TAG",value:t.tag},{name:"langSys"+e,type:"TABLE",value:new s("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(a("featureIndex",n.featureIndexes)))}]})))}]}))}function p(t){s.call(this,"featureListTable",l("featureRecord",t,function(t,e){var n=t.feature;return[{name:"featureTag"+e,type:"TAG",value:t.tag},{name:"feature"+e,type:"TABLE",value:new s("featureTable",[{name:"featureParams",type:"USHORT",value:n.featureParams}].concat(a("lookupListIndex",n.lookupListIndexes)))}]}))}function f(t,n){s.call(this,"lookupListTable",u("lookup",t,function(t){var e=n[t.lookupType];return r.assert(!!e,"Unable to write GSUB lookup type "+t.lookupType+" tables."),new s("lookupTable",[{name:"lookupType",type:"USHORT",value:t.lookupType},{name:"lookupFlag",type:"USHORT",value:t.lookupFlag}].concat(u("subtable",t.subtables,e)))}))}s.prototype.encode=function(){return i.TABLE(this)},s.prototype.sizeOf=function(){return o.TABLE(this)},(h.prototype=Object.create(s.prototype)).constructor=h,(c.prototype=Object.create(s.prototype)).constructor=c,(p.prototype=Object.create(s.prototype)).constructor=p,(f.prototype=Object.create(s.prototype)).constructor=f,n.Record=n.Table=s,n.Coverage=h,n.ScriptList=c,n.FeatureList=p,n.LookupList=f,n.ushortList=a,n.tableList=u,n.recordList=l},{"./check":2,"./types":32}],14:[function(t,e,n){var S=t("../encoding"),M=t("../glyphset"),C=t("../parse"),i=t("../path"),g=t("../table");function a(t,e){if(t===e)return!0;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n+=1)if(!a(t[n],e[n]))return!1;return!0}return!1}function P(t,e,n){var i,r,o,s=[],a=[],u=C.getCard16(t,e);if(0!==u){var l=C.getByte(t,e+2);r=e+(u+1)*l+2;var h=e+3;for(i=0;i<u+1;i+=1)s.push(C.getOffset(t,h,l)),h+=l;o=r+s[u]}else o=e+2;for(i=0;i<s.length-1;i+=1){var c=C.getBytes(t,r+s[i],r+s[i+1]);n&&(c=n(c)),a.push(c)}return{objects:a,startOffset:e,endOffset:o}}function u(t,e){var n,i,r,o;if(28===e)return n=t.parseByte(),i=t.parseByte(),n<<8|i;if(29===e)return n=t.parseByte(),i=t.parseByte(),r=t.parseByte(),o=t.parseByte(),n<<24|i<<16|r<<8|o;if(30===e)return function(t){var e="",n=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];for(;;){var i=t.parseByte(),r=i>>4,o=15&i;if(15==r)break;if(e+=n[r],15==o)break;e+=n[o]}return parseFloat(e)}(t);if(32<=e&&e<=246)return e-139;if(247<=e&&e<=250)return n=t.parseByte(),256*(e-247)+n+108;if(251<=e&&e<=254)return n=t.parseByte(),256*-(e-251)-n-108;throw new Error("Invalid b0 "+e)}function N(t,e,n){e=void 0!==e?e:0;var i=new C.Parser(t,e),r=[],o=[];for(n=void 0!==n?n:t.length;i.relativeOffset<n;){var s=i.parseByte();s<=21?(12===s&&(s=1200+i.parseByte()),r.push([s,o]),o=[]):o.push(u(i,s))}return function(t){for(var e={},n=0;n<t.length;n+=1){var i,r=t[n][0],o=t[n][1];if(i=1===o.length?o[0]:o,e.hasOwnProperty(r))throw new Error("Object "+e+" already has key "+r);e[r]=i}return e}(r)}function h(t,e){return e=e<=390?S.cffStandardStrings[e]:t[e-391]}function O(t,e,n){for(var i={},r=0;r<e.length;r+=1){var o=e[r],s=t[o.op];void 0===s&&(s=void 0!==o.value?o.value:null),"SID"===o.type&&(s=h(n,s)),i[o.name]=s}return i}var T=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],k=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function R(t,e,n,i){var r,o,s,a=new C.Parser(t,e);--n;var u=[".notdef"],l=a.parseCard8();if(0===l)for(r=0;r<n;r+=1)o=a.parseSID(),u.push(h(i,o));else if(1===l)for(;u.length<=n;)for(o=a.parseSID(),s=a.parseCard8(),r=0;r<=s;r+=1)u.push(h(i,o)),o+=1;else{if(2!==l)throw new Error("Unknown charset format "+l);for(;u.length<=n;)for(o=a.parseSID(),s=a.parseCard16(),r=0;r<=s;r+=1)u.push(h(i,o)),o+=1}return u}function D(t,e,n){var i,r,o={},s=new C.Parser(t,e),a=s.parseCard8();if(0===a){var u=s.parseCard8();for(i=0;i<u;i+=1)r=s.parseCard8(),o[r]=i}else{if(1!==a)throw new Error("Unknown encoding format "+a);var l=s.parseCard8();for(r=1,i=0;i<l;i+=1)for(var h=s.parseCard8(),c=s.parseCard8(),p=h;p<=h+c;p+=1)o[p]=r,r+=1}return new S.CffEncoding(o,n)}function A(y,_,t){var m,v,b,x,E=new i.Path,I=[],L=0,w=!1,S=y.defaultWidthX,M=!1,C=0,P=0;function N(t,e){M&&E.closePath(),E.moveTo(t,e),M=!0}function O(){I.length%2==0||w||(S=I.shift()+y.nominalWidthX),L+=I.length>>1,I.length=0,w=!0}return function t(e){var n;var i;var r;var o;var s;var a;var u;var l;var h;var c;var p;var f;var d=0;for(;d<e.length;){var g=e[d];switch(d+=1,g){case 1:case 3:O();break;case 4:1<I.length&&!w&&(S=I.shift()+y.nominalWidthX,w=!0),P+=I.pop(),N(C,P);break;case 5:for(;0<I.length;)C+=I.shift(),P+=I.shift(),E.lineTo(C,P);break;case 6:for(;0<I.length&&(C+=I.shift(),E.lineTo(C,P),0!==I.length);)P+=I.shift(),E.lineTo(C,P);break;case 7:for(;0<I.length&&(P+=I.shift(),E.lineTo(C,P),0!==I.length);)C+=I.shift(),E.lineTo(C,P);break;case 8:for(;0<I.length;)m=C+I.shift(),v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),C=b+I.shift(),P=x+I.shift(),E.curveTo(m,v,b,x,C,P);break;case 10:s=I.pop()+y.subrsBias,(a=y.subrs[s])&&t(a);break;case 11:return;case 12:switch(g=e[d],d+=1,g){case 35:m=C+I.shift(),v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),u=b+I.shift(),l=x+I.shift(),h=u+I.shift(),c=l+I.shift(),p=h+I.shift(),f=c+I.shift(),C=p+I.shift(),P=f+I.shift(),I.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;case 34:m=C+I.shift(),v=P,b=m+I.shift(),x=v+I.shift(),u=b+I.shift(),l=x,h=u+I.shift(),c=x,p=h+I.shift(),f=P,C=p+I.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;case 36:m=C+I.shift(),v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),u=b+I.shift(),l=x,h=u+I.shift(),c=x,p=h+I.shift(),f=c+I.shift(),C=p+I.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;case 37:m=C+I.shift(),v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),u=b+I.shift(),l=x+I.shift(),h=u+I.shift(),c=l+I.shift(),p=h+I.shift(),f=c+I.shift(),Math.abs(p-C)>Math.abs(f-P)?C=p+I.shift():P=f+I.shift(),E.curveTo(m,v,b,x,u,l),E.curveTo(h,c,p,f,C,P);break;default:console.log("Glyph "+_.index+": unknown operator 1200"+g),I.length=0}break;case 14:0<I.length&&!w&&(S=I.shift()+y.nominalWidthX,w=!0),M&&(E.closePath(),M=!1);break;case 18:O();break;case 19:case 20:O(),d+=L+7>>3;break;case 21:2<I.length&&!w&&(S=I.shift()+y.nominalWidthX,w=!0),P+=I.pop(),N(C+=I.pop(),P);break;case 22:1<I.length&&!w&&(S=I.shift()+y.nominalWidthX,w=!0),N(C+=I.pop(),P);break;case 23:O();break;case 24:for(;2<I.length;)m=C+I.shift(),v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),C=b+I.shift(),P=x+I.shift(),E.curveTo(m,v,b,x,C,P);C+=I.shift(),P+=I.shift(),E.lineTo(C,P);break;case 25:for(;6<I.length;)C+=I.shift(),P+=I.shift(),E.lineTo(C,P);m=C+I.shift(),v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),C=b+I.shift(),P=x+I.shift(),E.curveTo(m,v,b,x,C,P);break;case 26:for(I.length%2&&(C+=I.shift());0<I.length;)m=C,v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),C=b,P=x+I.shift(),E.curveTo(m,v,b,x,C,P);break;case 27:for(I.length%2&&(P+=I.shift());0<I.length;)m=C+I.shift(),v=P,b=m+I.shift(),x=v+I.shift(),C=b+I.shift(),P=x,E.curveTo(m,v,b,x,C,P);break;case 28:n=e[d],i=e[d+1],I.push((n<<24|i<<16)>>16),d+=2;break;case 29:s=I.pop()+y.gsubrsBias,(a=y.gsubrs[s])&&t(a);break;case 30:for(;0<I.length&&(m=C,v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),C=b+I.shift(),P=x+(1===I.length?I.shift():0),E.curveTo(m,v,b,x,C,P),0!==I.length);)m=C+I.shift(),v=P,b=m+I.shift(),x=v+I.shift(),P=x+I.shift(),C=b+(1===I.length?I.shift():0),E.curveTo(m,v,b,x,C,P);break;case 31:for(;0<I.length&&(m=C+I.shift(),v=P,b=m+I.shift(),x=v+I.shift(),P=x+I.shift(),C=b+(1===I.length?I.shift():0),E.curveTo(m,v,b,x,C,P),0!==I.length);)m=C,v=P+I.shift(),b=m+I.shift(),x=v+I.shift(),C=b+I.shift(),P=x+(1===I.length?I.shift():0),E.curveTo(m,v,b,x,C,P);break;default:g<32?console.log("Glyph "+_.index+": unknown operator "+g):g<247?I.push(g-139):g<251?(n=e[d],d+=1,I.push(256*(g-247)+n+108)):g<255?(n=e[d],d+=1,I.push(256*-(g-251)-n-108)):(n=e[d],i=e[d+1],r=e[d+2],o=e[d+3],d+=4,I.push((n<<24|i<<16|r<<8|o)/65536))}}}(t),_.advanceWidth=S,E}function F(t){return t.length<1240?107:t.length<33900?1131:32768}function l(t,e){var n,i=S.cffStandardStrings.indexOf(t);return 0<=i&&(n=i),0<=(i=e.indexOf(t))?n=i+S.cffStandardStrings.length:(n=S.cffStandardStrings.length+e.length,e.push(t)),n}function y(t){var e=new g.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);e.names=[];for(var n=0;n<t.length;n+=1)e.names.push({name:"name_"+n,type:"NAME",value:t[n]});return e}function _(t,e,n){for(var i={},r=0;r<t.length;r+=1){var o=t[r],s=e[o.name];void 0===s||a(s,o.value)||("SID"===o.type&&(s=l(s,n)),i[o.op]={name:o.name,type:o.type,value:s})}return i}function m(t,e){var n=new g.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return n.dict=_(T,t,e),n}function v(t){var e=new g.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return e.topDicts=[{name:"topDict_0",type:"TABLE",value:t}],e}function b(t){var e=new g.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);e.strings=[];for(var n=0;n<t.length;n+=1)e.strings.push({name:"string_"+n,type:"STRING",value:t[n]});return e}function x(t,e){for(var n=new g.Record("Charsets",[{name:"format",type:"Card8",value:0}]),i=0;i<t.length;i+=1){var r=t[i],o=l(r,e);n.fields.push({name:"glyph_"+i,type:"SID",value:o})}return n}function o(t){var e=[],n=t.path;e.push({name:"width",type:"NUMBER",value:t.advanceWidth});for(var i=0,r=0,o=0;o<n.commands.length;o+=1){var s,a,u=n.commands[o];if("Q"===u.type){u={type:"C",x:u.x,y:u.y,x1:1/3*i+2/3*u.x1,y1:1/3*r+2/3*u.y1,x2:1/3*u.x+2/3*u.x1,y2:1/3*u.y+2/3*u.y1}}if("M"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rmoveto",type:"OP",value:21}),i=Math.round(u.x),r=Math.round(u.y);else if("L"===u.type)s=Math.round(u.x-i),a=Math.round(u.y-r),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rlineto",type:"OP",value:5}),i=Math.round(u.x),r=Math.round(u.y);else if("C"===u.type){var l=Math.round(u.x1-i),h=Math.round(u.y1-r),c=Math.round(u.x2-u.x1),p=Math.round(u.y2-u.y1);s=Math.round(u.x-u.x2),a=Math.round(u.y-u.y2),e.push({name:"dx1",type:"NUMBER",value:l}),e.push({name:"dy1",type:"NUMBER",value:h}),e.push({name:"dx2",type:"NUMBER",value:c}),e.push({name:"dy2",type:"NUMBER",value:p}),e.push({name:"dx",type:"NUMBER",value:s}),e.push({name:"dy",type:"NUMBER",value:a}),e.push({name:"rrcurveto",type:"OP",value:8}),i=Math.round(u.x),r=Math.round(u.y)}}return e.push({name:"endchar",type:"OP",value:14}),e}function E(t){for(var e=new g.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),n=0;n<t.length;n+=1){var i=t.get(n),r=o(i);e.charStrings.push({name:i.name,type:"CHARSTRING",value:r})}return e}n.parse=function(t,e,n){n.tables.cff={};var i=(u=t,l=e,h={},h.formatMajor=C.getCard8(u,l),h.formatMinor=C.getCard8(u,l+1),h.size=C.getCard8(u,l+2),h.offsetSize=C.getCard8(u,l+3),h.startOffset=l,h.endOffset=l+4,h),r=P(t,i.endOffset,C.bytesToString),o=P(t,r.endOffset),s=P(t,o.endOffset,C.bytesToString),a=P(t,s.endOffset);var u,l,h;n.gsubrs=a.objects,n.gsubrsBias=F(n.gsubrs);var c=(p=new DataView(new Uint8Array(o.objects[0]).buffer),f=s.objects,O(N(p,0,p.byteLength),T,f));var p,f;n.tables.cff.topDict=c;var d=e+c.private[1],g=(y=t,_=d,m=c.private[0],v=s.objects,O(N(y,_,m),k,v));var y,_,m,v;if(n.defaultWidthX=g.defaultWidthX,n.nominalWidthX=g.nominalWidthX,0!==g.subrs){var b=d+g.subrs,x=P(t,b);n.subrs=x.objects,n.subrsBias=F(n.subrs)}else n.subrs=[],n.subrsBias=0;var E=P(t,e+c.charStrings);n.nGlyphs=E.objects.length;var I=R(t,e+c.charset,n.nGlyphs,s.objects);0===c.encoding?n.cffEncoding=new S.CffEncoding(S.cffStandardEncoding,I):1===c.encoding?n.cffEncoding=new S.CffEncoding(S.cffExpertEncoding,I):n.cffEncoding=D(t,e+c.encoding,I);n.encoding=n.encoding||n.cffEncoding,n.glyphs=new M.GlyphSet(n);for(var L=0;L<n.nGlyphs;L+=1){var w=E.objects[L];n.glyphs.push(L,M.cffGlyphLoader(n,L,A,w))}},n.make=function(t,e){for(var n,i=new g.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),r=1/e.unitsPerEm,o={version:e.version,fullName:e.fullName,familyName:e.familyName,weight:e.weightName,fontBBox:e.fontBBox||[0,0,0,0],fontMatrix:[r,0,0,r,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},s={},a=[],u=1;u<t.length;u+=1)n=t.get(u),a.push(n.name);var l=[];i.header=new g.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),i.nameIndex=y([e.postScriptName]);var h=m(o,l);i.topDictIndex=v(h),i.globalSubrIndex=new g.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),i.charsets=x(a,l),i.charStringsIndex=E(t),i.privateDict=(c=s,p=l,f=new g.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]),f.dict=_(k,c,p),f),i.stringIndex=b(l);var c,p,f;var d=i.header.sizeOf()+i.nameIndex.sizeOf()+i.topDictIndex.sizeOf()+i.stringIndex.sizeOf()+i.globalSubrIndex.sizeOf();return o.charset=d,o.encoding=0,o.charStrings=o.charset+i.charsets.sizeOf(),o.private[1]=o.charStrings+i.charStringsIndex.sizeOf(),h=m(o,l),i.topDictIndex=v(h),i}},{"../encoding":4,"../glyphset":7,"../parse":10,"../path":11,"../table":13}],15:[function(t,e,n){var u=t("../check"),m=t("../parse"),y=t("../table");function l(t,e){var n,i;for(e.parseUShort(),t.length=e.parseULong(),t.language=e.parseULong(),t.groupCount=i=e.parseULong(),t.glyphIndexMap={},n=0;n<i;n+=1)for(var r=e.parseULong(),o=e.parseULong(),s=e.parseULong(),a=r;a<=o;a+=1)t.glyphIndexMap[a]=s,s++}function h(t,e,n,i,r){var o,s;t.length=e.parseUShort(),t.language=e.parseUShort(),t.segCount=s=e.parseUShort()>>1,e.skip("uShort",3),t.glyphIndexMap={};var a=new m.Parser(n,i+r+14),u=new m.Parser(n,i+r+16+2*s),l=new m.Parser(n,i+r+16+4*s),h=new m.Parser(n,i+r+16+6*s),c=i+r+16+8*s;for(o=0;o<s-1;o+=1)for(var p,f=a.parseUShort(),d=u.parseUShort(),g=l.parseShort(),y=h.parseUShort(),_=d;_<=f;_+=1)0!==y?(c=h.offset+h.relativeOffset-2,c+=y,c+=2*(_-d),0!==(p=m.getUShort(n,c))&&(p=p+g&65535)):p=_+g&65535,t.glyphIndexMap[_]=p}n.parse=function(t,e){var n,i={};i.version=m.getUShort(t,e),u.argument(0===i.version,"cmap table version should be 0."),i.numTables=m.getUShort(t,e+2);var r=-1;for(n=i.numTables-1;0<=n;--n){var o=m.getUShort(t,e+4+8*n),s=m.getUShort(t,e+4+8*n+2);if(3===o&&(0===s||1===s||10===s)){r=m.getULong(t,e+4+8*n+4);break}}if(-1===r)return null;var a=new m.Parser(t,e+r);if(i.format=a.parseUShort(),12===i.format)l(i,a);else{if(4!==i.format)throw new Error("Only format 4 and 12 cmap tables are supported.");h(i,a,t,e,r)}return i},n.make=function(t){var e,n,i=new y.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(i.segments=[],e=0;e<t.length;e+=1){for(var r=t.get(e),o=0;o<r.unicodes.length;o+=1)s=i,a=r.unicodes[o],u=e,s.segments.push({end:a,start:a,delta:-(a-u),offset:0});i.segments=i.segments.sort(function(t,e){return t.start-e.start})}var s,a,u;l=i,l.segments.push({end:65535,start:65535,delta:1,offset:0}),n=i.segments.length,i.segCountX2=2*n,i.searchRange=2*Math.pow(2,Math.floor(Math.log(n)/Math.log(2))),i.entrySelector=Math.log(i.searchRange/2)/Math.log(2),i.rangeShift=i.segCountX2-i.searchRange;var l;var h=[],c=[],p=[],f=[],d=[];for(e=0;e<n;e+=1){var g=i.segments[e];h=h.concat({name:"end_"+e,type:"USHORT",value:g.end}),c=c.concat({name:"start_"+e,type:"USHORT",value:g.start}),p=p.concat({name:"idDelta_"+e,type:"SHORT",value:g.delta}),f=f.concat({name:"idRangeOffset_"+e,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(d=d.concat({name:"glyph_"+e,type:"USHORT",value:g.glyphId}))}return i.fields=i.fields.concat(h),i.fields.push({name:"reservedPad",type:"USHORT",value:0}),i.fields=i.fields.concat(c),i.fields=i.fields.concat(p),i.fields=i.fields.concat(f),i.fields=i.fields.concat(d),i.length=14+2*h.length+2+2*c.length+2*p.length+2*f.length+2*d.length,i}},{"../check":2,"../parse":10,"../table":13}],16:[function(t,e,n){var g=t("../check"),y=t("../parse"),l=t("../table");function h(t,e){var n=JSON.stringify(t),i=256;for(var r in e){var o=parseInt(r);if(o&&!(o<256)){if(JSON.stringify(e[r])===n)return o;i<=o&&(i=o+1)}}return e[i]=t,i}function _(t,e,n){var i={},r=new y.Parser(t,e);return i.tag=r.parseTag(),i.minValue=r.parseFixed(),i.defaultValue=r.parseFixed(),i.maxValue=r.parseFixed(),r.skip("uShort",1),i.name=n[r.parseUShort()]||{},i}function c(t,e,n,i){for(var r=h(e.name,i),o=[{name:"nameID_"+t,type:"USHORT",value:r},{name:"flags_"+t,type:"USHORT",value:0}],s=0;s<n.length;++s){var a=n[s].tag;o.push({name:"axis_"+t+" "+a,type:"FIXED",value:e.coordinates[a]<<16})}return o}function m(t,e,n,i){var r={},o=new y.Parser(t,e);r.name=i[o.parseUShort()]||{},o.skip("uShort",1),r.coordinates={};for(var s=0;s<n.length;++s)r.coordinates[n[s].tag]=o.parseFixed();return r}n.make=function(t,e){var n=new l.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:t.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:t.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*t.axes.length}]);n.offsetToData=n.sizeOf();for(var i=0;i<t.axes.length;i++)n.fields=n.fields.concat((r=i,o=t.axes[i],s=e,a=h(o.name,s),[{name:"tag_"+r,type:"TAG",value:o.tag},{name:"minValue_"+r,type:"FIXED",value:o.minValue<<16},{name:"defaultValue_"+r,type:"FIXED",value:o.defaultValue<<16},{name:"maxValue_"+r,type:"FIXED",value:o.maxValue<<16},{name:"flags_"+r,type:"USHORT",value:0},{name:"nameID_"+r,type:"USHORT",value:a}]));var r,o,s,a;for(var u=0;u<t.instances.length;u++)n.fields=n.fields.concat(c(u,t.instances[u],t.axes,e));return n},n.parse=function(t,e,n){var i=new y.Parser(t,e),r=i.parseULong();g.argument(65536===r,"Unsupported fvar table version.");var o=i.parseOffset16();i.skip("uShort",1);for(var s=i.parseUShort(),a=i.parseUShort(),u=i.parseUShort(),l=i.parseUShort(),h=[],c=0;c<s;c++)h.push(_(t,e+o+c*a,n));for(var p=[],f=e+o+s*a,d=0;d<u;d++)p.push(m(t,f+d*l,h,n));return{axes:h,instances:p}}},{"../check":2,"../parse":10,"../table":13}],17:[function(t,e,n){var _=t("../check"),u=t("../glyphset"),m=t("../parse"),f=t("../path");function v(t,e,n,i,r){var o;return o=0<(e&i)?(o=t.parseByte(),0==(e&r)&&(o=-o),n+o):0<(e&r)?n:n+t.parseShort()}function l(t,e,n){var i,r,o=new m.Parser(e,n);if(t.numberOfContours=o.parseShort(),t._xMin=o.parseShort(),t._yMin=o.parseShort(),t._xMax=o.parseShort(),t._yMax=o.parseShort(),0<t.numberOfContours){var s,a=t.endPointIndices=[];for(s=0;s<t.numberOfContours;s+=1)a.push(o.parseUShort());for(t.instructionLength=o.parseUShort(),t.instructions=[],s=0;s<t.instructionLength;s+=1)t.instructions.push(o.parseByte());var u=a[a.length-1]+1;for(i=[],s=0;s<u;s+=1)if(r=o.parseByte(),i.push(r),0<(8&r))for(var l=o.parseByte(),h=0;h<l;h+=1)i.push(r),s+=1;if(_.argument(i.length===u,"Bad flags."),0<a.length){var c,p=[];if(0<u){for(s=0;s<u;s+=1)r=i[s],(c={}).onCurve=!!(1&r),c.lastPointOfContour=0<=a.indexOf(s),p.push(c);var f=0;for(s=0;s<u;s+=1)r=i[s],(c=p[s]).x=v(o,r,f,2,16),f=c.x;var d=0;for(s=0;s<u;s+=1)r=i[s],(c=p[s]).y=v(o,r,d,4,32),d=c.y}t.points=p}else t.points=[]}else if(0===t.numberOfContours)t.points=[];else{t.isComposite=!0,t.points=[],t.components=[];for(var g=!0;g;){i=o.parseUShort();var y={glyphIndex:o.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&i)?0<(2&i)?(y.dx=o.parseShort(),y.dy=o.parseShort()):y.matchedPoints=[o.parseUShort(),o.parseUShort()]:0<(2&i)?(y.dx=o.parseChar(),y.dy=o.parseChar()):y.matchedPoints=[o.parseByte(),o.parseByte()],0<(8&i)?y.xScale=y.yScale=o.parseF2Dot14():0<(64&i)?(y.xScale=o.parseF2Dot14(),y.yScale=o.parseF2Dot14()):0<(128&i)&&(y.xScale=o.parseF2Dot14(),y.scale01=o.parseF2Dot14(),y.scale10=o.parseF2Dot14(),y.yScale=o.parseF2Dot14()),t.components.push(y),g=!!(32&i)}}}function h(t,e){for(var n=[],i=0;i<t.length;i+=1){var r=t[i],o={x:e.xScale*r.x+e.scale01*r.y+e.dx,y:e.scale10*r.x+e.yScale*r.y+e.dy,onCurve:r.onCurve,lastPointOfContour:r.lastPointOfContour};n.push(o)}return n}function c(t){var e=new f.Path;if(!t)return e;for(var n=function(t){for(var e=[],n=[],i=0;i<t.length;i+=1){var r=t[i];n.push(r),r.lastPointOfContour&&(e.push(n),n=[])}return _.argument(0===n.length,"There are still points left in the current contour."),e}(t),i=0;i<n.length;i+=1){var r,o,s=n[i],a=s[0],u=s[s.length-1];o=a.onCurve?!(r=null):(a=u.onCurve?u:{x:(a.x+u.x)/2,y:(a.y+u.y)/2},r=a,!1),e.moveTo(a.x,a.y);for(var l=o?1:0;l<s.length;l+=1){var h=s[l],c=0===l?a:s[l-1];if(c.onCurve&&h.onCurve)e.lineTo(h.x,h.y);else if(c.onCurve&&!h.onCurve)r=h;else if(c.onCurve||h.onCurve){if(c.onCurve||!h.onCurve)throw new Error("Invalid state.");e.quadraticCurveTo(r.x,r.y,h.x,h.y),r=null}else{var p={x:(c.x+h.x)/2,y:(c.y+h.y)/2};e.quadraticCurveTo(c.x,c.y,p.x,p.y),r=h}}a!==u&&(r?e.quadraticCurveTo(r.x,r.y,a.x,a.y):e.lineTo(a.x,a.y))}return e.closePath(),e}function p(t,e){if(e.isComposite)for(var n=0;n<e.components.length;n+=1){var i=e.components[n],r=t.get(i.glyphIndex);if(r.getPath(),r.points){var o;if(void 0===i.matchedPoints)o=h(r.points,i);else{if(i.matchedPoints[0]>e.points.length-1||i.matchedPoints[1]>r.points.length-1)throw Error("Matched points out of range in "+e.name);var s=e.points[i.matchedPoints[0]],a=r.points[i.matchedPoints[1]],u={xScale:i.xScale,scale01:i.scale01,scale10:i.scale10,yScale:i.yScale,dx:0,dy:0};a=h([a],u)[0],u.dx=s.x-a.x,u.dy=s.y-a.y,o=h(r.points,u)}e.points=e.points.concat(o)}}return c(e.points)}n.parse=function(t,e,n,i){var r,o=new u.GlyphSet(i);for(r=0;r<n.length-1;r+=1){var s=n[r],a=n[r+1];s!==a?o.push(r,u.ttfGlyphLoader(i,r,l,t,e+s,p)):o.push(r,u.glyphLoader(i,r))}return o}},{"../check":2,"../glyphset":7,"../parse":10,"../path":11}],18:[function(t,e,n){var c=t("../check"),P=t("../parse");function p(t,e){for(var n=new P.Parser(t,e),i=n.parseUShort(),r=[],o=0;o<i;o++)r[n.parseTag()]={offset:n.parseUShort()};return r}function N(t,e){var n=new P.Parser(t,e),i=n.parseUShort();if(1===i){var r=n.parseUShort(),o=n.parseUShort(),s=n.parseUShortList(o);return function(t){return s[t-r]||0}}if(2===i){for(var a=n.parseUShort(),u=[],l=[],h=[],c=0;c<a;c++)u[c]=n.parseUShort(),l[c]=n.parseUShort(),h[c]=n.parseUShort();return function(t){for(var e=0,n=u.length-1;e<n;){var i=e+n+1>>1;t<u[i]?n=i-1:e=i}return u[e]<=t&&t<=l[e]&&h[e]||0}}}function f(t,e){var n,i=new P.Parser(t,e),r=i.parseUShort(),o=i.parseUShort(),s=function(t,e){var n=new P.Parser(t,e),i=n.parseUShort(),r=n.parseUShort();{if(1===i)return n.parseUShortList(r);if(2===i){for(var o=[];r--;)for(var s=n.parseUShort(),a=n.parseUShort(),u=n.parseUShort(),l=s;l<=a;l++)o[u++]=l;return o}}}(t,e+o),a=i.parseUShort(),u=i.parseUShort();if(4===a&&0===u){var l={};if(1===r){for(var h=i.parseUShort(),c=[],p=i.parseOffset16List(h),f=0;f<h;f++){var d=p[f],g=l[d];if(!g){g={},i.relativeOffset=d;for(var y=i.parseUShort();y--;){var _=i.parseUShort();a&&(n=i.parseShort()),u&&i.parseShort(),g[_]=n}}c[s[f]]=g}return function(t,e){var n=c[t];if(n)return n[e]}}if(2===r){for(var m=i.parseUShort(),v=i.parseUShort(),b=i.parseUShort(),x=i.parseUShort(),E=N(t,e+m),I=N(t,e+v),L=[],w=0;w<b;w++)for(var S=L[w]=[],M=0;M<x;M++)a&&(n=i.parseShort()),u&&i.parseShort(),S[M]=n;var C={};for(w=0;w<s.length;w++)C[s[w]]=1;return function(t,e){if(C[t]){var n=E(t),i=I(e),r=L[n];return r?r[i]:void 0}}}}}function d(t,e){var n=new P.Parser(t,e),i=n.parseUShort(),r=n.parseUShort(),o=16&r,s=n.parseUShort(),a=n.parseOffset16List(s),u={lookupType:i,lookupFlag:r,markFilteringSet:o?n.parseUShort():-1};if(2===i){for(var l=[],h=0;h<s;h++)l.push(f(t,e+a[h]));u.getKerningValue=function(t,e){for(var n=l.length;n--;){var i=l[n](t,e);if(void 0!==i)return i}return 0}}return u}n.parse=function(t,e,n){var i=new P.Parser(t,e),r=i.parseFixed();c.argument(1===r,"Unsupported GPOS table version."),p(t,e+i.parseUShort()),p(t,e+i.parseUShort());var o=i.parseUShort();i.relativeOffset=o;for(var s=i.parseUShort(),a=i.parseOffset16List(s),u=e+o,l=0;l<s;l++){var h=d(t,u+a[l]);2!==h.lookupType||n.getGposKerningValue||(n.getGposKerningValue=h.getKerningValue)}}},{"../check":2,"../parse":10}],19:[function(t,e,n){var r=t("../check"),o=t("../parse").Parser,s=new Array(9),i=t("../table");s[1]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(o.coverage),deltaGlyphId:this.parseUShort()}:2===e?{substFormat:2,coverage:this.parsePointer(o.coverage),substitute:this.parseOffset16List()}:void r.assert(!1,"0x"+t.toString(16)+": lookup type 1 format must be 1 or 2.")},s[2]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),sequences:this.parseListOfLists()}},s[3]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),alternateSets:this.parseListOfLists()}},s[4]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB ligature table identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var a={sequenceIndex:o.uShort,lookupListIndex:o.uShort};s[5]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();if(1===e)return{substFormat:e,coverage:this.parsePointer(o.coverage),ruleSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{input:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,a)}})};if(2===e)return{substFormat:e,coverage:this.parsePointer(o.coverage),classDef:this.parsePointer(o.classDef),classSets:this.parseListOfLists(function(){var t=this.parseUShort(),e=this.parseUShort();return{classes:this.parseUShortList(t-1),lookupRecords:this.parseRecordList(e,a)}})};if(3===e){var n=this.parseUShort(),i=this.parseUShort();return{substFormat:e,coverages:this.parseList(n,o.pointer(o.coverage)),lookupRecords:this.parseRecordList(i,a)}}r.assert(!1,"0x"+t.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},s[6]=function(){var t=this.offset+this.relativeOffset,e=this.parseUShort();return 1===e?{substFormat:1,coverage:this.parsePointer(o.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(a)}})}:2===e?{substFormat:2,coverage:this.parsePointer(o.coverage),backtrackClassDef:this.parsePointer(o.classDef),inputClassDef:this.parsePointer(o.classDef),lookaheadClassDef:this.parsePointer(o.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(a)}})}:3===e?{substFormat:3,backtrackCoverage:this.parseList(o.pointer(o.coverage)),inputCoverage:this.parseList(o.pointer(o.coverage)),lookaheadCoverage:this.parseList(o.pointer(o.coverage)),lookupRecords:this.parseRecordList(a)}:void r.assert(!1,"0x"+t.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},s[7]=function(){var t=this.parseUShort();r.argument(1===t,"GSUB Extension Substitution subtable identifier-format must be 1");var e=this.parseUShort(),n=new o(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:e,extension:s[e].call(n)}},s[8]=function(){var t=this.parseUShort();return r.argument(1===t,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:t,coverage:this.parsePointer(o.coverage),backtrackCoverage:this.parseList(o.pointer(o.coverage)),lookaheadCoverage:this.parseList(o.pointer(o.coverage)),substitutes:this.parseUShortList()}};var u=new Array(9);u[1]=function(t){return 1===t.substFormat?new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)},{name:"deltaGlyphID",type:"USHORT",value:t.deltaGlyphId}]):new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)}].concat(i.ushortList("substitute",t.substitute)))},u[3]=function(t){return r.assert(1===t.substFormat,"Lookup type 3 substFormat must be 1."),new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)}].concat(i.tableList("altSet",t.alternateSets,function(t){return new i.Table("alternateSetTable",i.ushortList("alternate",t))})))},u[4]=function(t){return r.assert(1===t.substFormat,"Lookup type 4 substFormat must be 1."),new i.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new i.Coverage(t.coverage)}].concat(i.tableList("ligSet",t.ligatureSets,function(t){return new i.Table("ligatureSetTable",i.tableList("ligature",t,function(t){return new i.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:t.ligGlyph}].concat(i.ushortList("component",t.components,t.components.length+1)))}))})))},n.parse=function(t,e){var n=new o(t,e=e||0),i=n.parseVersion();return r.argument(1===i,"Unsupported GSUB table version."),{version:i,scripts:n.parseScriptList(),features:n.parseFeatureList(),lookups:n.parseLookupList(s)}},n.make=function(t){return new i.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new i.ScriptList(t.scripts)},{name:"features",type:"TABLE",value:new i.FeatureList(t.features)},{name:"lookups",type:"TABLE",value:new i.LookupList(t.lookups,u)}])}},{"../check":2,"../parse":10,"../table":13}],20:[function(t,e,n){var r=t("../check"),o=t("../parse"),i=t("../table");n.parse=function(t,e){var n={},i=new o.Parser(t,e);return n.version=i.parseVersion(),n.fontRevision=Math.round(1e3*i.parseFixed())/1e3,n.checkSumAdjustment=i.parseULong(),n.magicNumber=i.parseULong(),r.argument(1594834165===n.magicNumber,"Font header has wrong magic number."),n.flags=i.parseUShort(),n.unitsPerEm=i.parseUShort(),n.created=i.parseLongDateTime(),n.modified=i.parseLongDateTime(),n.xMin=i.parseShort(),n.yMin=i.parseShort(),n.xMax=i.parseShort(),n.yMax=i.parseShort(),n.macStyle=i.parseUShort(),n.lowestRecPPEM=i.parseUShort(),n.fontDirectionHint=i.parseShort(),n.indexToLocFormat=i.parseShort(),n.glyphDataFormat=i.parseShort(),n},n.make=function(t){var e=Math.round((new Date).getTime()/1e3)+2082844800,n=e;t.createdTimestamp&&(n=t.createdTimestamp+2082844800);return new i.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:n},{name:"modified",type:"LONGDATETIME",value:e},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],t)}},{"../check":2,"../parse":10,"../table":13}],21:[function(t,e,n){var r=t("../parse"),i=t("../table");n.parse=function(t,e){var n={},i=new r.Parser(t,e);return n.version=i.parseVersion(),n.ascender=i.parseShort(),n.descender=i.parseShort(),n.lineGap=i.parseShort(),n.advanceWidthMax=i.parseUShort(),n.minLeftSideBearing=i.parseShort(),n.minRightSideBearing=i.parseShort(),n.xMaxExtent=i.parseShort(),n.caretSlopeRise=i.parseShort(),n.caretSlopeRun=i.parseShort(),n.caretOffset=i.parseShort(),i.relativeOffset+=8,n.metricDataFormat=i.parseShort(),n.numberOfHMetrics=i.parseUShort(),n},n.make=function(t){return new i.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],t)}},{"../parse":10,"../table":13}],22:[function(t,e,n){var h=t("../parse"),s=t("../table");n.parse=function(t,e,n,i,r){for(var o,s,a=new h.Parser(t,e),u=0;u<i;u+=1){u<n&&(o=a.parseUShort(),s=a.parseShort());var l=r.get(u);l.advanceWidth=o,l.leftSideBearing=s}},n.make=function(t){for(var e=new s.Table("hmtx",[]),n=0;n<t.length;n+=1){var i=t.get(n),r=i.advanceWidth||0,o=i.leftSideBearing||0;e.fields.push({name:"advanceWidth_"+n,type:"USHORT",value:r}),e.fields.push({name:"leftSideBearing_"+n,type:"SHORT",value:o})}return e}},{"../parse":10,"../table":13}],23:[function(t,e,n){var c=t("../check"),p=t("../parse");n.parse=function(t,e){var n={},i=new p.Parser(t,e),r=i.parseUShort();c.argument(0===r,"Unsupported kern table version."),i.skip("uShort",1);var o=i.parseUShort();c.argument(0===o,"Unsupported kern sub-table version."),i.skip("uShort",2);var s=i.parseUShort();i.skip("uShort",3);for(var a=0;a<s;a+=1){var u=i.parseUShort(),l=i.parseUShort(),h=i.parseShort();n[u+","+l]=h}return n}},{"../check":2,"../parse":10}],24:[function(t,e,n){var l=t("../parse");n.parse=function(t,e,n,i){for(var r=new l.Parser(t,e),o=i?r.parseUShort:r.parseULong,s=[],a=0;a<n+1;a+=1){var u=o.call(r);i&&(u*=2),s.push(u)}return s}},{"../parse":10}],25:[function(t,e,n){var c=t("../check"),p=t("../parse"),s=t("../table");n.make=function(t){for(var e=new s.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:t.length}]),n="",i=12+4*t.length,r=0;r<t.length;++r){var o=n.indexOf(t[r]);o<0&&(o=n.length,n+=t[r]),e.fields.push({name:"offset "+r,type:"USHORT",value:i+o}),e.fields.push({name:"length "+r,type:"USHORT",value:t[r].length})}return e.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),e},n.parse=function(t,e){var n=new p.Parser(t,e),i=n.parseULong();c.argument(1===i,"Unsupported ltag table version."),n.skip("uLong",1);for(var r=n.parseULong(),o=[],s=0;s<r;s++){for(var a="",u=e+n.parseUShort(),l=n.parseUShort(),h=u;h<u+l;++h)a+=String.fromCharCode(t.getInt8(h));o.push(a)}return o}},{"../check":2,"../parse":10,"../table":13}],26:[function(t,e,n){var r=t("../parse"),i=t("../table");n.parse=function(t,e){var n={},i=new r.Parser(t,e);n.version=i.parseVersion(),n.numGlyphs=i.parseUShort(),1===n.version&&(n.maxPoints=i.parseUShort(),n.maxContours=i.parseUShort(),n.maxCompositePoints=i.parseUShort(),n.maxCompositeContours=i.parseUShort(),n.maxZones=i.parseUShort(),n.maxTwilightPoints=i.parseUShort(),n.maxStorage=i.parseUShort(),n.maxFunctionDefs=i.parseUShort(),n.maxInstructionDefs=i.parseUShort(),n.maxStackElements=i.parseUShort(),n.maxSizeOfInstructions=i.parseUShort(),n.maxComponentElements=i.parseUShort(),n.maxComponentDepth=i.parseUShort());return n},n.make=function(t){return new i.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:t}])}},{"../parse":10,"../table":13}],27:[function(t,e,n){var i=t("../types"),c=i.decode,p=t("../check"),f=t("../parse"),a=t("../table");n.parse=function(t,e){var n=new f.Parser(t,e),i=n.parseULong();p.argument(1===i,"Unsupported META table version."),n.parseULong(),n.parseULong();for(var r=n.parseULong(),o={},s=0;s<r;s++){var a=n.parseTag(),u=n.parseULong(),l=n.parseULong(),h=c.UTF8(t,e+u,l);o[a]=h}return o},n.make=function(t){var e=Object.keys(t).length,n="",i=16+12*e,r=new a.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:i},{name:"numTags",type:"ULONG",value:e}]);for(var o in t){var s=n.length;n+=t[o],r.fields.push({name:"tag "+o,type:"TAG",value:o}),r.fields.push({name:"offset "+o,type:"ULONG",value:i+s}),r.fields.push({name:"length "+o,type:"ULONG",value:t[o].length})}return r.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),r}},{"../check":2,"../parse":10,"../table":13,"../types":32}],28:[function(t,e,n){var i=t("../types"),b=i.decode,M=i.encode,x=t("../parse"),C=t("../table"),P=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],N={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},O={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},T={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function E(t,e,n){switch(t){case 0:if(65535===e)return"und";if(n)return n[e];break;case 1:return N[e];case 3:return T[e]}}var I="utf-16",r={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},o={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function k(t,e,n){switch(t){case 0:return I;case 1:return o[n]||r[e];case 3:if(1===e||10===e)return I}}function R(t){var e={};for(var n in t)e[t[n]]=parseInt(n);return e}function D(t,e,n,i,r,o){return new C.Record("NameRecord",[{name:"platformID",type:"USHORT",value:t},{name:"encodingID",type:"USHORT",value:e},{name:"languageID",type:"USHORT",value:n},{name:"nameID",type:"USHORT",value:i},{name:"length",type:"USHORT",value:r},{name:"offset",type:"USHORT",value:o}])}function A(t,e){var n=function(t,e){var n=t.length,i=e.length-n+1;t:for(var r=0;r<i;r++)for(;r<i;r++){for(var o=0;o<n;o++)if(e[r+o]!==t[o])continue t;return r}return-1}(t,e);if(n<0){n=e.length;for(var i=0,r=t.length;i<r;++i)e.push(t[i])}return n}n.parse=function(t,e,n){for(var i={},r=new x.Parser(t,e),o=r.parseUShort(),s=r.parseUShort(),a=r.offset+r.parseUShort(),u=0;u<s;u++){var l,h=r.parseUShort(),c=r.parseUShort(),p=r.parseUShort(),f=r.parseUShort(),d=P[f]||f,g=r.parseUShort(),y=r.parseUShort(),_=E(h,p,n),m=k(h,c,p);if(void 0!==m&&void 0!==_)if(l=m===I?b.UTF16(t,a+y,g):b.MACSTRING(t,a+y,g,m)){var v=i[d];void 0===v&&(v=i[d]={}),v[_]=l}}1===o&&r.parseUShort();return i},n.make=function(t,e){var n,i=[],r={},o=R(P);for(var s in t){var a=o[s];if(void 0===a&&(a=s),n=parseInt(a),isNaN(n))throw new Error('Name table entry "'+s+'" does not exist, see nameTableNames for complete list.');r[n]=t[s],i.push(n)}for(var u=R(N),l=R(T),h=[],c=[],p=0;p<i.length;p++){n=i[p];var f=r[n];for(var d in f){var g=f[d],y=1,_=u[d],m=O[_],v=k(y,m,_),b=M.MACSTRING(g,v);void 0===b&&(y=0,(_=e.indexOf(d))<0&&(_=e.length,e.push(d)),m=4,b=M.UTF16(g));var x=A(b,c);h.push(D(y,m,_,n,b.length,x));var E=l[d];if(void 0!==E){var I=M.UTF16(g),L=A(I,c);h.push(D(3,1,E,n,I.length,L))}}}h.sort(function(t,e){return t.platformID-e.platformID||t.encodingID-e.encodingID||t.languageID-e.languageID||t.nameID-e.nameID});for(var w=new C.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:h.length},{name:"stringOffset",type:"USHORT",value:6+12*h.length}]),S=0;S<h.length;S++)w.fields.push({name:"record_"+S,type:"RECORD",value:h[S]});return w.fields.push({name:"strings",type:"LITERAL",value:c}),w}},{"../parse":10,"../table":13,"../types":32}],29:[function(t,e,n){var o=t("../parse"),i=t("../table"),r=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];n.unicodeRanges=r,n.getUnicodeRange=function(t){for(var e=0;e<r.length;e+=1){var n=r[e];if(t>=n.begin&&t<n.end)return e}return-1},n.parse=function(t,e){var n={},i=new o.Parser(t,e);n.version=i.parseUShort(),n.xAvgCharWidth=i.parseShort(),n.usWeightClass=i.parseUShort(),n.usWidthClass=i.parseUShort(),n.fsType=i.parseUShort(),n.ySubscriptXSize=i.parseShort(),n.ySubscriptYSize=i.parseShort(),n.ySubscriptXOffset=i.parseShort(),n.ySubscriptYOffset=i.parseShort(),n.ySuperscriptXSize=i.parseShort(),n.ySuperscriptYSize=i.parseShort(),n.ySuperscriptXOffset=i.parseShort(),n.ySuperscriptYOffset=i.parseShort(),n.yStrikeoutSize=i.parseShort(),n.yStrikeoutPosition=i.parseShort(),n.sFamilyClass=i.parseShort(),n.panose=[];for(var r=0;r<10;r++)n.panose[r]=i.parseByte();n.ulUnicodeRange1=i.parseULong(),n.ulUnicodeRange2=i.parseULong(),n.ulUnicodeRange3=i.parseULong(),n.ulUnicodeRange4=i.parseULong(),n.achVendID=String.fromCharCode(i.parseByte(),i.parseByte(),i.parseByte(),i.parseByte()),n.fsSelection=i.parseUShort(),n.usFirstCharIndex=i.parseUShort(),n.usLastCharIndex=i.parseUShort(),n.sTypoAscender=i.parseShort(),n.sTypoDescender=i.parseShort(),n.sTypoLineGap=i.parseShort(),n.usWinAscent=i.parseUShort(),n.usWinDescent=i.parseUShort(),1<=n.version&&(n.ulCodePageRange1=i.parseULong(),n.ulCodePageRange2=i.parseULong());2<=n.version&&(n.sxHeight=i.parseShort(),n.sCapHeight=i.parseShort(),n.usDefaultChar=i.parseUShort(),n.usBreakChar=i.parseUShort(),n.usMaxContent=i.parseUShort());return n},n.make=function(t){return new i.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],t)}},{"../parse":10,"../table":13}],30:[function(t,e,n){var s=t("../encoding"),a=t("../parse"),i=t("../table");n.parse=function(t,e){var n,i={},r=new a.Parser(t,e);switch(i.version=r.parseVersion(),i.italicAngle=r.parseFixed(),i.underlinePosition=r.parseShort(),i.underlineThickness=r.parseShort(),i.isFixedPitch=r.parseULong(),i.minMemType42=r.parseULong(),i.maxMemType42=r.parseULong(),i.minMemType1=r.parseULong(),i.maxMemType1=r.parseULong(),i.version){case 1:i.names=s.standardNames.slice();break;case 2:for(i.numberOfGlyphs=r.parseUShort(),i.glyphNameIndex=new Array(i.numberOfGlyphs),n=0;n<i.numberOfGlyphs;n++)i.glyphNameIndex[n]=r.parseUShort();for(i.names=[],n=0;n<i.numberOfGlyphs;n++)if(i.glyphNameIndex[n]>=s.standardNames.length){var o=r.parseChar();i.names.push(r.parseString(o))}break;case 2.5:for(i.numberOfGlyphs=r.parseUShort(),i.offset=new Array(i.numberOfGlyphs),n=0;n<i.numberOfGlyphs;n++)i.offset[n]=r.parseChar()}return i},n.make=function(){return new i.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},{"../encoding":4,"../parse":10,"../table":13}],31:[function(t,e,n){var h=t("../check"),c=t("../table"),z=t("./cmap"),V=t("./cff"),Y=t("./head"),H=t("./hhea"),X=t("./hmtx"),J=t("./ltag"),W=t("./maxp"),K=t("./name"),Z=t("./os2"),Q=t("./post"),$=t("./gsub"),tt=t("./meta");function p(t){return Math.log(t)/Math.log(2)|0}function et(t){for(;t.length%4!=0;)t.push(0);for(var e=0,n=0;n<t.length;n+=4)e+=(t[n]<<24)+(t[n+1]<<16)+(t[n+2]<<8)+t[n+3];return e%=Math.pow(2,32)}function f(t,e,n,i){return new c.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==t?t:""},{name:"checkSum",type:"ULONG",value:void 0!==e?e:0},{name:"offset",type:"ULONG",value:void 0!==n?n:0},{name:"length",type:"ULONG",value:void 0!==i?i:0}])}function nt(t){var e=new c.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);e.tables=t,e.numTables=t.length;var n=Math.pow(2,p(e.numTables));e.searchRange=16*n,e.entrySelector=p(n),e.rangeShift=16*e.numTables-e.searchRange;for(var i=[],r=[],o=e.sizeOf()+f().sizeOf()*e.numTables;o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0});for(var s=0;s<t.length;s+=1){var a=t[s];h.argument(4===a.tableName.length,"Table name"+a.tableName+" is invalid.");var u=a.sizeOf(),l=f(a.tableName,et(a.encode()),o,u);for(i.push({name:l.tag+" Table Record",type:"RECORD",value:l}),r.push({name:a.tableName+" table",type:"RECORD",value:a}),o+=u,h.argument(!isNaN(o),"Something went wrong calculating the offset.");o%4!=0;)o+=1,r.push({name:"padding",type:"BYTE",value:0})}return i.sort(function(t,e){return t.value.tag>e.value.tag?1:-1}),e.fields=e.fields.concat(i),e.fields=e.fields.concat(r),e}function it(t,e,n){for(var i=0;i<e.length;i+=1){var r=t.charToGlyphIndex(e[i]);if(0<r){var o=t.glyphs.get(r);return o.getMetrics()}}return n}function rt(t){for(var e=0,n=0;n<t.length;n+=1)e+=t[n];return e/t.length}n.computeCheckSum=et,n.make=nt,n.fontToTable=function(t){for(var e,n=[],i=[],r=[],o=[],s=[],a=[],u=[],l=0,h=0,c=0,p=0,f=0,d=0;d<t.glyphs.length;d+=1){var g=t.glyphs.get(d),y=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+d+"): advanceWidth is not a number.");(y<e||void 0===e)&&0<y&&(e=y),l<y&&(l=y);var _=Z.getUnicodeRange(y);if(_<32)h|=1<<_;else if(_<64)c|=1<<_-32;else if(_<96)p|=1<<_-64;else{if(!(_<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");f|=1<<_-96}if(".notdef"!==g.name){var m=g.getMetrics();n.push(m.xMin),i.push(m.yMin),r.push(m.xMax),o.push(m.yMax),a.push(m.leftSideBearing),u.push(m.rightSideBearing),s.push(g.advanceWidth)}}var v={xMin:Math.min.apply(null,n),yMin:Math.min.apply(null,i),xMax:Math.max.apply(null,r),yMax:Math.max.apply(null,o),advanceWidthMax:Math.max.apply(null,s),advanceWidthAvg:rt(s),minLeftSideBearing:Math.min.apply(null,a),maxLeftSideBearing:Math.max.apply(null,a),minRightSideBearing:Math.min.apply(null,u)};v.ascender=t.ascender,v.descender=t.descender;var b=Y.make({flags:3,unitsPerEm:t.unitsPerEm,xMin:v.xMin,yMin:v.yMin,xMax:v.xMax,yMax:v.yMax,lowestRecPPEM:3,createdTimestamp:t.createdTimestamp}),x=H.make({ascender:v.ascender,descender:v.descender,advanceWidthMax:v.advanceWidthMax,minLeftSideBearing:v.minLeftSideBearing,minRightSideBearing:v.minRightSideBearing,xMaxExtent:v.maxLeftSideBearing+(v.xMax-v.xMin),numberOfHMetrics:t.glyphs.length}),E=W.make(t.glyphs.length),I=Z.make({xAvgCharWidth:Math.round(v.advanceWidthAvg),usWeightClass:t.tables.os2.usWeightClass,usWidthClass:t.tables.os2.usWidthClass,usFirstCharIndex:e,usLastCharIndex:l,ulUnicodeRange1:h,ulUnicodeRange2:c,ulUnicodeRange3:p,ulUnicodeRange4:f,fsSelection:t.tables.os2.fsSelection,sTypoAscender:v.ascender,sTypoDescender:v.descender,sTypoLineGap:0,usWinAscent:v.yMax,usWinDescent:Math.abs(v.yMin),ulCodePageRange1:1,sxHeight:it(t,"xyvw",{yMax:Math.round(v.ascender/2)}).yMax,sCapHeight:it(t,"HIKLEFJMNTZBDPRAGOQSUVWXY",v).yMax,usDefaultChar:t.hasChar(" ")?32:0,usBreakChar:t.hasChar(" ")?32:0}),L=X.make(t.glyphs),w=z.make(t.glyphs),S=t.getEnglishName("fontFamily"),M=t.getEnglishName("fontSubfamily"),C=S+" "+M,P=t.getEnglishName("postScriptName");P=P||S.replace(/\s/g,"")+"-"+M;var N={};for(var O in t.names)N[O]=t.names[O];N.uniqueID||(N.uniqueID={en:t.getEnglishName("manufacturer")+":"+C});N.postScriptName||(N.postScriptName={en:P});N.preferredFamily||(N.preferredFamily=t.names.fontFamily);N.preferredSubfamily||(N.preferredSubfamily=t.names.fontSubfamily);var T=[],k=K.make(N,T),R=0<T.length?J.make(T):void 0,D=Q.make(),A=V.make(t.glyphs,{version:t.getEnglishName("version"),fullName:C,familyName:S,weightName:M,postScriptName:P,unitsPerEm:t.unitsPerEm,fontBBox:[0,v.yMin,v.ascender,v.advanceWidthMax]}),F=t.metas&&0<Object.keys(t.metas).length?tt.make(t.metas):void 0,B=[b,x,E,I,k,w,D,A,L];R&&B.push(R);t.tables.gsub&&B.push($.make(t.tables.gsub));F&&B.push(F);var G=nt(B),U=et(G.encode()),j=G.fields,q=!1;for(d=0;d<j.length;d+=1)if("head table"===j[d].name){j[d].value.checkSumAdjustment=2981146554-U,q=!0;break}if(q)return G;throw new Error("Could not find head table with checkSum to adjust.")}},{"../check":2,"../table":13,"./cff":14,"./cmap":15,"./gsub":19,"./head":20,"./hhea":21,"./hmtx":22,"./ltag":25,"./maxp":26,"./meta":27,"./name":28,"./os2":29,"./post":30}],32:[function(t,e,n){var p=t("./check"),i={},f={},a={};function r(t){return function(){return t}}f.BYTE=function(t){return p.argument(0<=t&&t<=255,"Byte value should be between 0 and 255."),[t]},a.BYTE=r(1),f.CHAR=function(t){return[t.charCodeAt(0)]},a.CHAR=r(1),f.CHARARRAY=function(t){for(var e=[],n=0;n<t.length;n+=1)e[n]=t.charCodeAt(n);return e},a.CHARARRAY=function(t){return t.length},f.USHORT=function(t){return[t>>8&255,255&t]},a.USHORT=r(2),f.SHORT=function(t){return 32768<=t&&(t=-(65536-t)),[t>>8&255,255&t]},a.SHORT=r(2),f.UINT24=function(t){return[t>>16&255,t>>8&255,255&t]},a.UINT24=r(3),f.ULONG=function(t){return[t>>24&255,t>>16&255,t>>8&255,255&t]},a.ULONG=r(4),f.LONG=function(t){return 2147483648<=t&&(t=-(4294967296-t)),[t>>24&255,t>>16&255,t>>8&255,255&t]},a.LONG=r(4),f.FIXED=f.ULONG,a.FIXED=a.ULONG,f.FWORD=f.SHORT,a.FWORD=a.SHORT,f.UFWORD=f.USHORT,a.UFWORD=a.USHORT,f.LONGDATETIME=function(t){return[0,0,0,0,t>>24&255,t>>16&255,t>>8&255,255&t]},a.LONGDATETIME=r(8),f.TAG=function(t){return p.argument(4===t.length,"Tag should be exactly 4 ASCII characters."),[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]},a.TAG=r(4),f.Card8=f.BYTE,a.Card8=a.BYTE,f.Card16=f.USHORT,a.Card16=a.USHORT,f.OffSize=f.BYTE,a.OffSize=a.BYTE,f.SID=f.USHORT,a.SID=a.USHORT,f.NUMBER=function(t){return-107<=t&&t<=107?[t+139]:108<=t&&t<=1131?[247+((t-=108)>>8),255&t]:-1131<=t&&t<=-108?[251+((t=-t-108)>>8),255&t]:-32768<=t&&t<=32767?f.NUMBER16(t):f.NUMBER32(t)},a.NUMBER=function(t){return f.NUMBER(t).length},f.NUMBER16=function(t){return[28,t>>8&255,255&t]},a.NUMBER16=r(3),f.NUMBER32=function(t){return[29,t>>24&255,t>>16&255,t>>8&255,255&t]},a.NUMBER32=r(5),f.REAL=function(t){var e=t.toString(),n=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(e);if(n){var i=parseFloat("1e"+((n[2]?+n[2]:0)+n[1].length));e=(Math.round(t*i)/i).toString()}var r,o,s="";for(r=0,o=e.length;r<o;r+=1){var a=e[r];s+="e"===a?"-"===e[++r]?"c":"b":"."===a?"a":"-"===a?"e":a}s+=1&s.length?"f":"ff";var u=[30];for(r=0,o=s.length;r<o;r+=2)u.push(parseInt(s.substr(r,2),16));return u},a.REAL=function(t){return f.REAL(t).length},f.NAME=f.CHARARRAY,a.NAME=a.CHARARRAY,f.STRING=f.CHARARRAY,a.STRING=a.CHARARRAY,i.UTF8=function(t,e,n){for(var i=[],r=n,o=0;o<r;o++,e+=1)i[o]=t.getUint8(e);return String.fromCharCode.apply(null,i)},i.UTF16=function(t,e,n){for(var i=[],r=n/2,o=0;o<r;o++,e+=2)i[o]=t.getUint16(e);return String.fromCharCode.apply(null,i)},f.UTF16=function(t){for(var e=[],n=0;n<t.length;n+=1){var i=t.charCodeAt(n);e[e.length]=i>>8&255,e[e.length]=255&i}return e},a.UTF16=function(t){return 2*t.length};var u={"x-mac-croatian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®Š™´¨≠ŽØ∞±≤≥∆µ∂∑∏š∫ªºΩžø¿¡¬√ƒ≈Ć«Č… ÀÃÕŒœĐ—“”‘’÷◊©⁄€‹›Æ»–·‚„‰ÂćÁčÈÍÎÏÌÓÔđÒÚÛÙıˆ˜¯πË˚¸Êæˇ","x-mac-cyrillic":"АБВГДЕЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ†°Ґ£§•¶І®©™Ђђ≠Ѓѓ∞±≤≥іµґЈЄєЇїЉљЊњјЅ¬√ƒ≈∆«»… ЋћЌќѕ–—“”‘’÷„ЎўЏџ№Ёёяабвгдежзийклмнопрстуфхцчшщъыьэю","x-mac-gaelic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØḂ±≤≥ḃĊċḊḋḞḟĠġṀæøṁṖṗɼƒſṠ«»… ÀÃÕŒœ–—“”‘’ṡẛÿŸṪ€‹›Ŷŷṫ·Ỳỳ⁊ÂÊÁËÈÍÎÏÌÓÔ♣ÒÚÛÙıÝýŴŵẄẅẀẁẂẃ","x-mac-greek":"Ä¹²É³ÖÜ΅àâä΄¨çéèêë£™îï•½‰ôö¦€ùûü†ΓΔΘΛΞΠß®©ΣΪ§≠°·Α±≤≥¥ΒΕΖΗΙΚΜΦΫΨΩάΝ¬ΟΡ≈Τ«»… ΥΧΆΈœ–―“”‘’÷ΉΊΌΎέήίόΏύαβψδεφγηιξκλμνοπώρστθωςχυζϊϋΐΰ­","x-mac-icelandic":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûüÝ°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€ÐðÞþý·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-inuit":"ᐃᐄᐅᐆᐊᐋᐱᐲᐳᐴᐸᐹᑉᑎᑏᑐᑑᑕᑖᑦᑭᑮᑯᑰᑲᑳᒃᒋᒌᒍᒎᒐᒑ°ᒡᒥᒦ•¶ᒧ®©™ᒨᒪᒫᒻᓂᓃᓄᓅᓇᓈᓐᓯᓰᓱᓲᓴᓵᔅᓕᓖᓗᓘᓚᓛᓪᔨᔩᔪᔫᔭ… ᔮᔾᕕᕖᕗ–—“”‘’ᕘᕙᕚᕝᕆᕇᕈᕉᕋᕌᕐᕿᖀᖁᖂᖃᖄᖅᖏᖐᖑᖒᖓᖔᖕᙱᙲᙳᙴᙵᙶᖖᖠᖡᖢᖣᖤᖥᖦᕼŁł","x-mac-ce":"ÄĀāÉĄÖÜáąČäčĆćéŹźĎíďĒēĖóėôöõúĚěü†°Ę£§•¶ß®©™ę¨≠ģĮįĪ≤≥īĶ∂∑łĻļĽľĹĺŅņŃ¬√ńŇ∆«»… ňŐÕőŌ–—“”‘’÷◊ōŔŕŘ‹›řŖŗŠ‚„šŚśÁŤťÍŽžŪÓÔūŮÚůŰűŲųÝýķŻŁżĢˇ",macintosh:"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›ﬁﬂ‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-romanian":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ĂȘ∞±≤≥¥µ∂∑∏π∫ªºΩăș¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸ⁄€‹›Țț‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙıˆ˜¯˘˙˚¸˝˛ˇ","x-mac-turkish":"ÄÅÇÉÑÖÜáàâäãåçéèêëíìîïñóòôöõúùûü†°¢£§•¶ß®©™´¨≠ÆØ∞±≤≥¥µ∂∑∏π∫ªºΩæø¿¡¬√ƒ≈∆«»… ÀÃÕŒœ–—“”‘’÷◊ÿŸĞğİıŞş‡·‚„‰ÂÊÁËÈÍÎÏÌÓÔÒÚÛÙˆ˜¯˘˙˚¸˝˛ˇ"};i.MACSTRING=function(t,e,n,i){var r=u[i];if(void 0!==r){for(var o="",s=0;s<n;s++){var a=t.getUint8(e+s);o+=a<=127?String.fromCharCode(a):r[127&a]}return o}};var l,h="function"==typeof WeakMap&&new WeakMap;f.MACSTRING=function(t,e){var n=function(t){if(!l){l={};for(var e in u){l[e]=new String(e)}}var n=l[t];if(n===undefined){return undefined}if(h){var i=h.get(n);if(i!==undefined){return i}}var r=u[t];if(r===undefined){return undefined}for(var o={},s=0;s<r.length;s++){o[r.charCodeAt(s)]=s+128}if(h){h.set(n,o)}return o}(e);if(void 0!==n){for(var i=[],r=0;r<t.length;r++){var o=t.charCodeAt(r);if(128<=o&&void 0===(o=n[o]))return;i[r]=o}return i}},a.MACSTRING=function(t,e){var n=f.MACSTRING(t,e);return void 0!==n?n.length:0},f.INDEX=function(t){var e,n=1,i=[n],r=[];for(e=0;e<t.length;e+=1){var o=f.OBJECT(t[e]);Array.prototype.push.apply(r,o),n+=o.length,i.push(n)}if(0===r.length)return[0,0];var s=[],a=1+Math.floor(Math.log(n)/Math.log(2))/8|0,u=[void 0,f.BYTE,f.USHORT,f.UINT24,f.ULONG][a];for(e=0;e<i.length;e+=1){var l=u(i[e]);Array.prototype.push.apply(s,l)}return Array.prototype.concat(f.Card16(t.length),f.OffSize(a),s,r)},a.INDEX=function(t){return f.INDEX(t).length},f.DICT=function(t){for(var e=[],n=Object.keys(t),i=n.length,r=0;r<i;r+=1){var o=parseInt(n[r],0),s=t[o];e=(e=e.concat(f.OPERAND(s.value,s.type))).concat(f.OPERATOR(o))}return e},a.DICT=function(t){return f.DICT(t).length},f.OPERATOR=function(t){return t<1200?[t]:[12,t-1200]},f.OPERAND=function(t,e){var n=[];if(Array.isArray(e))for(var i=0;i<e.length;i+=1)p.argument(t.length===e.length,"Not enough arguments given for type"+e),n=n.concat(f.OPERAND(t[i],e[i]));else if("SID"===e)n=n.concat(f.NUMBER(t));else if("offset"===e)n=n.concat(f.NUMBER32(t));else if("number"===e)n=n.concat(f.NUMBER(t));else{if("real"!==e)throw new Error("Unknown operand type "+e);n=n.concat(f.REAL(t))}return n},f.OP=f.BYTE,a.OP=a.BYTE;var s="function"==typeof WeakMap&&new WeakMap;f.CHARSTRING=function(t){if(s){var e=s.get(t);if(void 0!==e)return e}for(var n=[],i=t.length,r=0;r<i;r+=1){var o=t[r];n=n.concat(f[o.type](o.value))}return s&&s.set(t,n),n},a.CHARSTRING=function(t){return f.CHARSTRING(t).length},f.OBJECT=function(t){var e=f[t.type];return p.argument(void 0!==e,"No encoding function for type "+t.type),e(t.value)},a.OBJECT=function(t){var e=a[t.type];return p.argument(void 0!==e,"No sizeOf function for type "+t.type),e(t.value)},f.TABLE=function(t){var e,n=[],i=t.fields.length,r=[],o=[];for(e=0;e<i;e+=1){var s=t.fields[e],a=f[s.type];p.argument(void 0!==a,"No encoding function for field type "+s.type+" ("+s.name+")");var u=t[s.name];void 0===u&&(u=s.value);var l=a(u);"TABLE"===s.type?(o.push(n.length),n=n.concat([0,0]),r.push(l)):n=n.concat(l)}for(e=0;e<r.length;e+=1){var h=o[e],c=n.length;p.argument(c<65536,"Table "+t.tableName+" too big."),n[h]=c>>8,n[h+1]=255&c,n=n.concat(r[e])}return n},a.TABLE=function(t){for(var e=0,n=t.fields.length,i=0;i<n;i+=1){var r=t.fields[i],o=a[r.type];p.argument(void 0!==o,"No sizeOf function for field type "+r.type+" ("+r.name+")");var s=t[r.name];void 0===s&&(s=r.value),e+=o(s),"TABLE"===r.type&&(e+=2)}return e},f.RECORD=f.TABLE,a.RECORD=a.TABLE,f.LITERAL=function(t){return t},a.LITERAL=function(t){return t.length},n.decode=i,n.encode=f,n.sizeOf=a},{"./check":2}],33:[function(t,e,n){n.isBrowser=function(){return"undefined"!=typeof window},n.isNode=function(){return"undefined"==typeof window},n.nodeBufferToArrayBuffer=function(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;++i)n[i]=t[i];return e},n.arrayBufferToNodeBuffer=function(t){for(var e=new Buffer(t.byteLength),n=new Uint8Array(t),i=0;i<e.length;++i)e[i]=n[i];return e},n.checkArgument=function(t,e){if(!t)throw e}},{}]},{},[9])(9)}),Ww={charCode:34,familyName:"ESRI Default Marker",glyphPaths:"",faceIndex:0},Kw=(y(Zw,Hw),c(Zw,[{key:"readJson",value:function(t){d(Zw.prototype.__proto__||Object.getPrototypeOf(Zw.prototype),"readJson",this).call(this,t),this.options.charCode=t.char_code,this.options.familyName=t.font_file_name,this.options.glyphPaths=t.glyph_path,this.options.faceIndex=t.face_index}},{key:"toJson",value:function(t){t&&(d(Zw.prototype.__proto__||Object.getPrototypeOf(Zw.prototype),"toJson",this).call(this,t),t.char_code=this.options.charCode,t.font_file_name=this.options.familyName,t.glyph_path=this.options.glyphPaths,t.face_index=this.options.faceIndex)}},{key:"getCharCode",value:function(){return this.options.charCode}},{key:"setCharCode",value:function(t){this.options.charCode=t}},{key:"drawPoint",value:function(t,e){if(t&&e&&this.isVisible()&&(this._fontPath||(this._fontPath=this._decodeGlyph()),this._fontPath)){var n=this.getSize(),i=this.getAngle(),r=this.getOffsetX(),o=this.getOffsetY();e.x+=r,e.y+=o,t.save(),t.translate(e.x,e.y),t.rotate(i*Math.PI/180),t.translate(-e.x-n/2,-e.y-n/2);var s=this._getPath(this._fontPath.commands,e.x,e.y,n);this._drawPath(t,s);var a=this.getHalo();a&&a.hasHalo()&&this._drawHalo(t),t.fillStyle=this.getColor().getStrColor(),t.fill(),t.restore()}}},{key:"_decodeGlyph",value:function(){var t=null,e=this.options.glyphPaths;if(!e)return null;var n=atob(e),i=bt.char2buf(n);try{(t=new Jw.Path).unitsPerEm=256;var r=0,o=new DataView(i),s=o.getUint8(r);r++;for(var a=0;a<s;a++){var u=o.getUint8(r);r++;for(var l=0;l<u;l++){var h=o.getUint8(r);r++;var c=-1*o.getUint8(r);r++,0===l?t.moveTo(h,c):t.lineTo(h,c)}}}catch(t){throw Error(t)}return t}},{key:"_drawPath",value:function(t,e){t.beginPath();for(var n=e.commands,i=0;i<n.length;i+=1){var r=n[i];"M"===r.type?t.moveTo(r.x,r.y):"L"===r.type?t.lineTo(r.x,r.y):"C"===r.type?t.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?t.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&t.closePath()}}},{key:"_getPath",value:function(t,e,n,i,r){e=void 0!==e?e:0,n=void 0!==n?n:0;for(var o=1/256*(i=void 0!==i?i:72),s=(r=void 0!==r?r:{xScale:1,yScale:1}).xScale*o,a=r.yScale*o,u=new Jw.Path,l=0;l<t.length;l+=1){var h=t[l];"M"===h.type?u.moveTo(e+h.x*s,n+-h.y*a):"L"===h.type?u.lineTo(e+h.x*s,n+-h.y*a):"Q"===h.type?u.quadraticCurveTo(e+h.x1*s,n+-h.y1*a,e+h.x*s,n+-h.y*a):"C"===h.type?u.curveTo(e+h.x1*s,n+-h.y1*a,e+h.x2*s,n+-h.y2*a,e+h.x*s,n+-h.y*a):"Z"===h.type&&u.closePath()}return u}}]),Zw);function Zw(t){h(this,Zw);var e=_(this,(Zw.__proto__||Object.getPrototypeOf(Zw)).call(this));return e.mergeOptions(Ww,t),e.class=$_,e}var Qw={xOffset:0,yOffset:0,xInterval:0,yInterval:0,xScale:1,yScale:1,pattenAngle:0,imageUrl:""},$w=(y(tS,mL),c(tS,[{key:"readJson",value:function(t){d(tS.prototype.__proto__||Object.getPrototypeOf(tS.prototype),"readJson",this).call(this,t),this.options.xOffset=bt.poundToPixel(t.offset_x),this.options.yOffset=bt.poundToPixel(t.offset_y),this.options.xInterval=bt.poundToPixel(t.interval_x),this.options.yInterval=bt.poundToPixel(t.interval_y),this.options.xScale=t.scale_x,this.options.yScale=t.scale_y,this.options.pattenAngle=t.angle,this.options.imageUrl=t.image_url}},{key:"toJson",value:function(t){t&&(d(tS.prototype.__proto__||Object.getPrototypeOf(tS.prototype),"toJson",this).call(this,t),t.offset_x=bt.pixelToPound(this.options.xOffset),t.offset_y=bt.pixelToPound(this.options.yOffset),t.interval_x=bt.pixelToPound(this.options.xInterval),t.interval_y=bt.pixelToPound(this.options.yInterval),t.scale_x=this.options.xScale,t.scale_y=this.options.yScale,t.angle=this.options.pattenAngle,t.image_url=this.options.imageUrl)}},{key:"getOffsetX",value:function(){return this.options.xOffset}},{key:"setOffsetX",value:function(t){this.options.xOffset=t}},{key:"getOffsetY",value:function(){return this.options.yOffset}},{key:"setOffsetY",value:function(t){this.options.yOffset=t}},{key:"getIntervalX",value:function(){return this.options.xInterval}},{key:"setIntervalX",value:function(t){this.options.xInterval=t}},{key:"getIntervalY",value:function(){return this.options.yInterval}},{key:"setIntervalY",value:function(t){this.options.yInterval=t}},{key:"getScaleX",value:function(){return this.options.xScale}},{key:"setScaleX",value:function(t){this.options.xScale=t}},{key:"getScaleY",value:function(){return this.options.yScale}},{key:"setScaleY",value:function(t){this.options.yScale=t}},{key:"getPattenAngle",value:function(){return this.options.pattenAngle}},{key:"setPattenAngle",value:function(t){this.options.pattenAngle=t}},{key:"getImageUrl",value:function(){return this.options.imageUrl}},{key:"setImageUrl",value:function(t){this.options.imageUrl=t}},{key:"_drawGeometry",value:function(t,e){var n=this;if(t&&e&&this.isVisible())if(this._bitmap){var i=e.points,r=e.subCount,o=e.polyCount;if(o.length!==r)return;var s=0;t.beginPath();for(var a=null,u=0;u<r;u++){var l=o[u],h=i.slice(s,s+l);XI.drawPath(t,h),s+=l,a=a||h[0]}this._fill(t,a);var c=this.getOutlineSymbol();this.hasOutline()&&c&&c.draw(t,[e])}else this._tempData||(this._tempData=[]),this._tempData.push({ctx:t,geometry:e}),this._loading||this._loadImg().then(function(){n._tempData&&0<n._tempData.length&&n._tempData.forEach(function(t){n._drawGeometry(t.ctx,t.geometry)})}).catch(function(){n._tempData=null})}},{key:"needLoadResource",value:function(){return!this._bitmap}},{key:"loadResources",value:function(){return this._loadImg()}},{key:"_loadImg",value:function(){var r=this;return this._loading=!0,new Promise(function(t,e){var n=r.getImageUrl();n||e();var i=new Image;i.onload=function(){r._bitmap=i,r._loading=!1,t()},i.onerror=function(){e()},i.src=n})}},{key:"_fill",value:function(t,e){var n=this._getFillPattern();if(n){var i=this.getOffsetX(),r=this.getOffsetY();t.save(),n=t.createPattern(n,"repeat"),t.fillStyle=n,t.translate(e.x-i,e.y-r),t.fill("evenodd"),t.setTransform(1,0,0,1,0,0),t.restore()}}},{key:"_getFillPattern",value:function(){if(this._fillPattern)return this._fillPattern;var t=this._bitmap;if(!t)return null;var e=this.getIntervalX(),n=this.getIntervalY(),i=this.getPattenAngle(),r=this.getScaleX(),o=this.getScaleY();r=r<=0?1:r,o=o<=0?1:o;var s=t.width*r,a=t.height*o;t=this._getScaleImg(t,s,a);var u=document.createElement("canvas"),l=s+e,h=a+n;u.width=l,u.height=h;var c=u.getContext("2d");c.rect(0,0,l-e,h-n),c.translate(s/2,a/2),c.rotate(i/180*Math.PI),c.translate(s/2,a/2);var p=c.createPattern(t,"repeat");return c.fillStyle=p,c.fill("evenodd"),this._fillPattern=u}},{key:"_getScaleImg",value:function(t,e,n){var i=document.createElement("canvas");return i.width=e,i.height=n,i.getContext("2d").drawImage(t,0,0,e,n),i}}]),tS);function tS(t){h(this,tS);var e=_(this,(tS.__proto__||Object.getPrototypeOf(tS)).call(this));return e.mergeOptions(Qw,t),e.class=pm,e}var eS={lineSymbol:null,lineInterval:8,lineOffset:0,lineAngle:45},nS=(y(iS,mL),c(iS,[{key:"readJson",value:function(t){d(iS.prototype.__proto__||Object.getPrototypeOf(iS.prototype),"readJson",this).call(this,t),this.options.lineInterval=bt.poundToPixel(t.interval),this.options.lineOffset=bt.poundToPixel(t.offset),this.options.lineAngle=t.angle,t.line_symbol&&(this.options.lineSymbol=bm.readFromJson(t.line_symbol))}},{key:"toJson",value:function(t){if(t)if(d(iS.prototype.__proto__||Object.getPrototypeOf(iS.prototype),"toJson",this).call(this,t),t.interval=bt.pixelToPound(this.options.lineInterval),t.offset=bt.pixelToPound(this.options.lineOffset),t.angle=this.options.lineAngle,this.options.lineSymbol){var e={};this.options.lineSymbol.toJson(e),t.line_symbol=e}else t.line_symbol=null}},{key:"getLineSymbol",value:function(){return this.options.lineSymbol}},{key:"setLineSymbol",value:function(t){this.options.lineSymbol=t}},{key:"getLineInterval",value:function(){return this.options.lineInterval}},{key:"setLineInterval",value:function(t){this.options.lineInterval=t}},{key:"getLineOffset",value:function(){return this.options.lineOffset}},{key:"setLineOffset",value:function(t){this.options.lineOffset=t}},{key:"getLineAngle",value:function(){return this.options.lineAngle}},{key:"setLineAngle",value:function(t){this.options.lineAngle=t}},{key:"setColor",value:function(t){d(iS.prototype.__proto__||Object.getPrototypeOf(iS.prototype),"setColor",this).call(this,t),this.options.lineSymbol&&this.options.lineSymbol.setColor(t)}},{key:"_drawGeometry",value:function(t,e){if(t&&e&&this.isVisible()){var n=e.points,i=e.subCount,r=e.polyCount;if(r.length===i){var o=0;t.beginPath();for(var s=0;s<i;s++){var a=r[s],u=n.slice(o,o+a);XI.drawPath(t,u),o+=a}this._fill(t);var l=this.getOutlineSymbol();this.hasOutline()&&l&&l.draw(t,[e])}}}},{key:"_fill",value:function(t){var e=this.getLineAngle(),n=this._getFillPattern();n&&(t.save(),t.rotate(-1*e/180*Math.PI),n=t.createPattern(n,"repeat"),t.fillStyle=n,t.fill("evenodd"),t.restore())}},{key:"_getFillPattern",value:function(){var t=this.getLineSymbol();if(!t)return null;var e=t.getWidth(),n=this.options.lineInterval,i=document.createElement("canvas"),r=n,o=r;i.width=r,i.height=o;var s=i.getContext("2d"),a={x:0,y:e/2},u={x:r,y:e/2};return t.drawLine(s,[a,u]),i}}]),iS);function iS(t){h(this,iS);var e=_(this,(iS.__proto__||Object.getPrototypeOf(iS)).call(this));return e.mergeOptions(eS,t),e.class=cm,e}var rS={},oS=(y(sS,QI),c(sS,[{key:"readJson",value:function(t){var n=this;d(sS.prototype.__proto__||Object.getPrototypeOf(sS.prototype),"readJson",this).call(this,t),t.symbol_layer_list&&t.symbol_layer_list.length&&t.symbol_layer_list.forEach(function(t){var e=bm.readFromJson(t);e&&(n.symbols||(n.symbols=[]),n.symbols.push(e))})}},{key:"toJson",value:function(t){if(t)if(d(sS.prototype.__proto__||Object.getPrototypeOf(sS.prototype),"toJson",this).call(this,t),this.symbols&&0<this.symbols.length){var n=[];this.symbols.forEach(function(t){if(t){var e={};t.toJson(e),n.push(e)}}),t.symbol_layer_list=n}else t.symbol_layer_list=null}},{key:"setColor",value:function(e){this.symbols&&0!==this.symbols.length&&(this.symbols.forEach(function(t){t&&!t.isLocked()&&t.setColor(e)}),d(sS.prototype.__proto__||Object.getPrototypeOf(sS.prototype),"setColor",this).call(this,e))}},{key:"getColor",value:function(){if(!this.symbols||0===this.symbols.length)return d(sS.prototype.__proto__||Object.getPrototypeOf(sS.prototype),"getColor",this).call(this);for(var t=0;t<this.symbols.length;t++){var e=this.symbols[t];if(e&&!e.isLocked())return e.getColor()}return d(sS.prototype.__proto__||Object.getPrototypeOf(sS.prototype),"getColor",this).call(this)}},{key:"isLocked",value:function(){if(!this.symbols||0===this.symbols.length)return!1;for(var t=0;t<this.symbols.length;t++)if(!this.symbols[t].isLocked())return!1;return!0}},{key:"isVisible",value:function(){if(!this.symbols||0===this.symbols.length)return!1;for(var t=0;t<this.symbols.length;t++)if(this.symbols[t].isVisible())return!0;return!1}},{key:"setWidth",value:function(t){if(this.symbols&&0!==this.symbols.length&&0!==t){var e=this.getWidth();if(0!==e){var n=t/e;this.symbols.forEach(function(t){t.setWidth(t.getWidth()*n)}),this.options.width=t}}}},{key:"getSymbols",value:function(){return this.symbols}},{key:"getSymbolLayer",value:function(t){return t<0||!this.symbols||this.symbols.length<=t?null:this.symbols[t]}},{key:"getSymbolLayerCount",value:function(){return this.symbols&&0!==this.symbols.length?this.symbols.length:0}},{key:"draw",value:function(n,t){var i=this;n&&t&&t.length&&this.symbols&&0!==this.symbols.length&&t.forEach(function(e){i.symbols.forEach(function(t){t&&t.draw(n,[e])})})}},{key:"drawLine",value:function(e,n){!e||!n||n.length<2||this.symbols&&0!==this.symbols.length&&this.symbols.forEach(function(t){t&&t.drawLine(e,n)})}}]),sS);function sS(t){h(this,sS);var e=_(this,(sS.__proto__||Object.getPrototypeOf(sS)).call(this));return e.mergeOptions(rS,t),e.class=am,e.symbols=null,e}bm.readFromJson=function(t){if(!t||!t.class)return null;var e=null;switch(t.class){case Q_:e=new WI;break;case $_:e=new Kw;break;case tm:e=new kw;break;case em:e=new cw;break;case nm:e=new $L;break;case im:e=new lL;break;case rm:e=new Mw;break;case om:e=new zw;break;case sm:e=new Nw;break;case am:e=new oS;break;case um:e=new xL;break;case lm:e=new uw;break;case hm:e=new Uw;break;case cm:e=new nS;break;case pm:e=new $w;break;case fm:e=new nw;break;case dm:e=new Eb}return e?(e.readJson(t),e):null},bm.createDefaultSymbol=function(t){var e=null;switch(t){case gm.MARKER_SYMBOL:e=new WI;break;case gm.LINE_SYMBOL:e=new lL;break;case gm.FILL_SYMBOL:e=new xL({hasOutline:!0,outlineSymbol:new lL})}return e};var aS=Object.freeze({Symbol:bm,SimpleMarkerSymbol:WI,PictureMarkerSymbol:kw,ArrowMarkerSymbol:cw,CharMarkerSymbol:Kw,MultiLayerMarkerSymbol:$L,SimpleLineSymbol:lL,CartoLineSymbol:Mw,HashLineSymbol:Nw,MarkerLineSymbol:zw,MultiLayerLineSymbol:oS,SimpleFillSymbol:xL,PictureFillSymbol:$w,MarkerFillSymbol:Uw,LineFillSymbol:nS,GradientFillSymbol:uw,MultiLayerFillSymbol:nw,Geometry:It,SimpleMarkerStyle:UI,Halo:fb,RGBAColor:_m,TextSymbol:Eb,SymbolType:gm}),uS={},lS=(c(hS,[{key:"releaseModel",value:function(){this._pCoreModel.releaseAllModel(),this._pCoreModel=null}},{key:"canPlacePoint",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e={x:e,y:e},this._pCoreModel.canPlacePoint(t,e,n)}},{key:"placePoint",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e={x:e,y:e},this._pCoreModel.placePoint(t,e,n),!0}},{key:"canPlaceRect",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e=e.add(i).round(),this._pCoreModel.canPlaceRect(t,e,n)}},{key:"placeRect",value:function(t,e,n){var i=this._map._getMapPanePos();return t=t.add(i).round(),e=e.add(i).round(),this._pCoreModel.placeRect(t,e,n),!0}},{key:"canPlacePolygon",value:function(t,e){var n=this._map._getMapPanePos(),i=[];return t.forEach(function(t){i.push(t.add(n).round())}),this._pCoreModel.canPlacePolygon(i,e)}},{key:"placePolygon",value:function(t,e){var n=this._map._getMapPanePos(),i=[];return t.forEach(function(t){i.push(t.add(n).round())}),this._pCoreModel.placePolygon(i,e),!0}},{key:"avoid",value:function(t){var n=this;t&&0!==t.length&&(t.forEach(function(t){if(t&&t.dataset&&t.getFeatures()&&0!==t.getFeatures().length){var e=t.dataset;e.getType()!==Sm.LINE&&e.getType()!==Mm.LINE||n._lineAvoidHandler(t)}}),t.forEach(function(t){if(t&&t.dataset&&t.getFeatures()&&0!==t.getFeatures().length){var e=t.dataset;e.getType()===Sm.POINT||e.getType()===Mm.POINT?n._pointAvoidHandler(t):n._labelAvoidHandler(t)}}))}},{key:"_lineAvoidHandler",value:function(t){var s=this,e=t.dataset,n=t.getFeatures();if(n&&0!==n.length&&t.getRenderStyle()){var a=this._map.findDatasetById(e.getID());a&&t.getRenderStyle().getAvoidFlag()!==Cm.OVERLAP_ELEM_NONE&&n.forEach(function(t){var e=a.getFeatureByIndex(t.sIndex);if(e){var n=e.getPixelPoints(s._map),i=e.getPolyCount(),r=e.getSubCount(),o=new wm({test_mask:Cm.OVERLAP_ELEM_NONE,set_mask:Cm.OVERLAP_ELEM_LINE,set_value:Cm.OVERLAP_ELEM_LINE});s._pCoreModel.placeLine(n,i,r,o)}})}}},{key:"_labelAvoidHandler",value:function(t){var a=this,u=t.dataset,e=t.getFeatures();if(u&&e&&0!==e.length){var n=this._map.findDatasetById(u.getID());if(n){var i=t.getRenderTextStyle();if(i&&i.isQuery()){i.isSortByPriority()&&this._sortByPriority(i.getPriorityField(),e);var l=[],h=new wm({test_mask:i.getAvoidFlag(),set_mask:Cm.OVERLAP_ELEM_LABEL,set_value:Cm.OVERLAP_ELEM_LABEL});e.forEach(function(t){var o=n.getFeatureByIndex(t.sIndex);if(o){var s=o.getProperties();if(i.isIgnore(s))return;var e=i.getRenderItemList();if(!e||0===e.length)return;e.forEach(function(t){if(t.compareFilter(s)){var e=t.getText(s);if(""!==e&&null!==e){var n=null;if(u.getType()===Sm.LINE||u.getType()===Mm.LINE)(n=new KL(t.getTextSymbol(),t.getLabelPosition())).addLineLabel({ptPoints:o.getPixelPoints(a._map),polyCount:o.getPolyCount(),subCount:o.getSubCount(),text:e,avoidHandler:a,coverCondition:h,pALabelPositions:a._aLabelPositions,hasTextList:l});else if(u.getType()===Sm.POLYGON||u.getType()===Mm.POLYGON){n=new JL(t.getTextSymbol(),t.getLabelPosition());var i=null;o.getType()===M_.POLYGON?i=[o]:o.getType()===M_.MULTIPOLYGON&&(i=o.getPolygons());var r=[];i.forEach(function(t){r.push({pPoints:t.getPixelPoints(a._map),polyCount:t.getPolyCount(),subCount:t.getSubCount()})}),n.addPolygonLabel({geoList:r,text:e,avoidHandler:a,coverCondition:h,pALabelPositions:a._aLabelPositions,hasTextList:l})}}}})}})}}}}},{key:"_pointAvoidHandler",value:function(t){var e=t.dataset,n=t.getFeatures();if(n&&0!==n.length&&t.getRenderTextStyle()&&this._map.findDatasetById(e.getID())){var i=t.getRenderTextStyle(),r=i.isQuery(),o=i.isRelate();r&&i.isSortByPriority()&&this._sortByPriority(i.getPriorityField(),n),r&&o?this._labelRelatePointHandler(t):this._pointAvoid(t)}}},{key:"_labelRelatePointHandler",value:function(t){var r=this,e=t.dataset,n=e.features,o=t.getRenderTextStyle();if(o.isQuery()){var s=[],a=new wm({test_mask:Cm.OVERLAP_ELEM_POINT|Cm.OVERLAP_ELEM_LABEL,set_mask:Cm.OVERLAP_ELEM_POINT,set_value:Cm.OVERLAP_ELEM_POINT}),u=new wm({test_mask:Cm.OVERLAP_ELEM_POINT|Cm.OVERLAP_ELEM_LABEL|Cm.OVERLAP_ELEM_LINE,set_mask:Cm.OVERLAP_ELEM_LABEL,set_value:Cm.OVERLAP_ELEM_LABEL});n.forEach(function(t){if(t){var e=t.splitToSingle();e&&0!==e.length&&e.forEach(function(t){if(t){var e=t.getSymbol();if(e){var n=t.getSize();if(e.isVisible()&&!r.isNullSymbol(e)&&n){var i=t.getPixelPoints(r._map);i&&0!==i.length&&r.canPlacePoint(i[0],n,a)&&r._pointFeatureLabelAvoid(o,t,u)&&(r.placePoint(i[0],n,a),s.push(t))}else s.push(t)}}})}}),e.features=s}}},{key:"isNullSymbol",value:function(t){return t.getClass===Q_&&t.getSimpleMarkerStyle()===UI.SMSNULL}},{key:"_pointAvoid",value:function(o){var s=this,t=o.dataset,e=o.getFeatures(),n=o.getRenderTextStyle(),i=n&&n.isQuery();if(i){var r=this._map.findDatasetById(t.getID()),a=o.renderStyle.getAvoidFlag(),u=[];if(a!==Cm.OVERLAP_ELEM_NONE){var l=new wm({test_mask:Cm.OVERLAP_ELEM_POINT,set_mask:Cm.OVERLAP_ELEM_POINT,set_value:Cm.OVERLAP_ELEM_POINT});e.forEach(function(t){if(t){var e=r.getFeatureByIndex(t.sIndex).splitToSingle();e&&0!==e.length&&e.forEach(function(t){if(t){var e=null;o.renderStyle&&o.renderStyle.getDefaultRenderItem()&&(e=o.renderStyle.getDefaultRenderItem()),t.setRenderItem(e);var n=t.getSymbol();if(n){var i=n.getSize();if(n.isVisible()&&!s.isNullSymbol(n)&&i){var r=t.getPixelPoints(s._map);r&&0!==r.length&&s.canPlacePoint(r[0],i,l)&&(s.placePoint(r[0],i,l),u.push(t))}else u.push(t)}}})}})}if(i){var h=new wm({test_mask:n.getAvoidFlag()|Cm.OVERLAP_ELEM_LINE,set_mask:Cm.OVERLAP_ELEM_LABEL,set_value:Cm.OVERLAP_ELEM_LABEL});u.forEach(function(t){if(t){var e=t.splitToSingle();e&&0!==e.length&&e.forEach(function(t){s._pointFeatureLabelAvoid(n,t,h)})}})}}}},{key:"_pointFeatureLabelAvoid",value:function(t,i,r){var o=this,s=!1,a=i.getProperties();if(t.isIgnore(a))return s;var e=t.getRenderItemList();return!(!e||0===e.length)&&(e.forEach(function(t){if(!t.compareFilter(a))return!1;var e=t.getText(a);if(""===e||null===e)return!1;var n=new HL(t.getTextSymbol(),t.getLabelPosition());return s=n.addPointLabel({pPoint:i.getPixelPoints(o._map)[0],size:i.getSize(),properties:a,text:e,avoidHandler:o,coverCondition:r,pALabelPositions:o._aLabelPositions})}),s)}},{key:"_sortByPriority",value:function(){}}]),hS);function hS(t,e,n){h(this,hS),this.options=S_.extend({},uS,n),this._map=t,this._aLabelPositions=e,this._pCoreModel=new TL(this._map.getSize().x,this._map.getSize().y)}var cS=(c(pS,[{key:"addPosition",value:function(t,e){if(t&&e){this._aLabelPosionList||(this._aLabelPosionList={});var n=e.getID();this._aLabelPosionList[n]||(this._aLabelPosionList[n]={labels:[],labelSymbol:e}),this._aLabelPosionList[n].labels.push(t)}}},{key:"clear",value:function(){this._aLabelPosionList=null}},{key:"drawLabels",value:function(t){this._aLabelPosionList&&0!==Object.keys(this._aLabelPosionList).length&&(this._drawBackground(t),this._drawText(t))}},{key:"_drawBackground",value:function(s){function t(t){var e=a._aLabelPosionList[t];if(!e||!e.labelSymbol||!e.labels||0===e.labels.length)return"continue";var n=e.labelSymbol,i=e.labels;if(!n.validFillSymbol())return"continue";var r=n.getFillSymbol(),o=[];i.forEach(function(t){if(t){var e=t.getPoints();if(e&&0!==e.length){var n=new It({points:e,polyCount:[e.length],subCount:1});o.push(n)}}}),0<o.length&&r.draw(s,o)}var a=this;for(var e in this._aLabelPosionList)t(e)}},{key:"_drawText",value:function(g){function t(t){var e=a._aLabelPosionList[t];if(!e||!e.labelSymbol||!e.labels||0===e.labels.length)return"continue";var n=e.labelSymbol,i=n.getTextInfo(),r=i.getFontInfo(),f=r.getSize(),o=r.getFontStr(),s=i.getHalo(),d=s.hasHalo();g.fillStyle=n.getColor().getStrColor(),g.font=o,d&&(g.strokeStyle=s.getColor().getStrColor(),g.lineWidth=s.getSize()),e.labels.forEach(function(t){if(t){var e=t.getText();if(e){var n=t.getAngle(),i=t.getRotatePoint(),r=t.getAnchor();0===n&&(i={x:r.x,y:r.y});var o=t.isHori();g.save(),g.translate(i.x,i.y),g.rotate(n*Math.PI/180);for(var s=r.x-i.x,a=r.y-i.y,u=t.getStepX(),l=t.getStepY(),h=t.getWordInterval(),c=0;c<e.length;c++){var p=e[c];d&&g.strokeText(p,s,a),g.fillText(p,s,a),o?(s+=g.measureText(p).width+u," "===p&&(s+=h)):(a+=f+l," "===p&&(a+=h))}g.restore()}}})}var a=this;for(var e in this._aLabelPosionList)t(e)}}]),pS);function pS(){h(this,pS),this._aLabelPosionList=null}var fS=B.Layer.extend({options:{pane:"tilePane",zIndex:100},initialize:function(t){B.setOptions(this,t),this.debug=!1,this.renderer=this._createRenderer(),this._seSelectionLayer=new PL({zIndex:this.options.zIndex}),this._aLabelPositions=null,this.id=-1,this._name="新地图",this._bounds=null,this._projInfo=null,this._dataType=1,this._isPublic=!1,this._userId=0,this._layers=null,this.visible=!0},setVisible:function(t){this.visible=t,this.update()},getVisible:function(){return this.visible},setIsPublic:function(t){this._isPublic=t},isPublic:function(){return this._isPublic},getID:function(){return this.id},getName:function(){return this._name},setName:function(t){this._name=t},isNew:function(){return-1===this.id},getProjInfo:function(){var t=this._projInfo;t||this._layers&&0<this._layers.length&&(t=this._layers[0].getDataset().getProjInfo());return t},onAdd:function(t){t.addLayer(this.renderer),t.addLayer(this._seSelectionLayer),this.update()},onRemove:function(){this._map&&(this._map.removeLayer(this.renderer),this._map.removeLayer(this._seSelectionLayer))},_createRenderer:function(){var t=this.options.pane||wb;return new T({pane:t,zIndex:this.options.zIndex})},addDts:function(t){var i=this;t&&0!==t.length&&(this._layers||(this._layers=[]),t.forEach(function(t){var e=new gI;e.name=t.name,e.label=t.label,e.dataset=t,e.renderStyle=Om.createDefault(t.getType()),t.color&&e.renderStyle.getDefaultRenderItem().getSymbol().setColor(t.color);var n=i._getInsertIndex(t.getIntType());i._layers.splice(n,0,e)}))},addLayer:function(t,e){t&&(this._layers||(this._layers=[]),e?this._layers.unshift(t):this._layers.push(t))},removeLayer:function(t){var e=this.getLayerById(t);if(!e)return!1;var n=this.getLayerById(e.getParentLayerId());if(n)n.removeLayer(e);else{var i=this._layers.indexOf(e);this._layers.splice(i,1)}return!0},_getInsertIndex:function(t){if(!this._layers||0===this._layers.length)return 0;for(var e=this._layers.length,n=0;n<e;n++){var i=this._layers[n];if(i.getType()!==dI.SEGROUPLAYER)if(i.dataset.getIntType()>=t)return n}return e},getLayers:function(t){if(!this._layers)return null;if(!t)return this._layers;for(var e=this._layers.length,n=[],i=0;i<e;i++){var r=this._layers[i];if(r)if(r.getType()===dI.SEGROUPLAYER){var o=r.getLayers(!0);o&&o.length&&o.forEach(function(t){n.push(t)})}else n.push(r)}return n},getContainer:function(){return this.renderer._divContainer},getRenderer:function(){return this.renderer},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t),this._seSelectionLayer.setZIndex(t)},getZIndex:function(){return this.options.zIndex},getBounds:function(){var t=this._bounds;return t=t||this.getMaxBounds()},getLatLngBounds:function(){var t=this.getBounds();return t?t.toLatLngBounds(this.getProjInfo()):null},getMaxBounds:function(){var t=this.getLayers(!0);if(!t||0===t.length)return null;var n=null;return t.forEach(function(t){if(t&&t.getDataset()){var e=t.getDataset();n?n.add(e.getBounds()):n=e.getBounds()}}),n},readJson:function(t){if(t){if(t.bbox&&(this._bounds=new I_,this._bounds.readJson(t.bbox)),t.crs){var e=new Ob;e.readJson(t.crs),this._projInfo=e}if(this.id=t.data_id,this._dataType=t.data_type||1,this._name=t.name?t.name:"",this._isPublic=1===t.public,this._userId=t.user_id?t.user_id:0,t.style){var n=JSON.parse(t.style).layer_list;if(n&&n.length){this._layers=[];for(var i=n,r=i.length,o=0;o<r;o++){var s=i[o];if(s){var a=null,u=s.class;u===dI.SEGROUPLAYER?a=new CL:u===dI.SELAYER&&(a=new gI),a&&(a.readJson(s,t.dataset_list),this._layers.push(a))}}}}}},toJson:function(){var t=this._map.getBounds(),e=I_.createFromLatLngBounds(t),n={name:this.getName(),public:this.isPublic()?1:0,crsid:"EPSG:4326",bbox:e.toJson(),style:"",thumbnail:""};if(this._layers&&0<this._layers.length){var i=this.getLayers(!0),r=null,o=[];if(i.forEach(function(t){if(t&&t.dataset){var e=t.dataset;r=r||e.projInfo,-1===o.indexOf(e.id)&&o.push(e.id)}}),r){var s=I_.createFromLatLngBounds(t,r);n.bbox=s.toJson(),n.crsid=r.getCode()}var a=this._createStyleJson();n.dataset_list=o,n.style=JSON.stringify(a),n.thumbnail=this._createThumbnail()}return n},_createThumbnail:function(){var t=document.createElement("canvas");t.width=200,t.height=150;var e=t.getContext("2d"),n=this.renderer.getContainer();return e.drawImage(n,0,0,200,150),t.toDataURL()},_createStyleJson:function(){var e=[];return this._layers.forEach(function(t){t&&e.push(t.toJson())}),{layer_list:e,version:$.styleVersion}},getEvents:function(){return{moveend:this.update,viewreset:this.update}},refresh:function(t){this.update(t)},update:function(t){var e=this;if(!this.visible)return this._clearDtData(),this.clearRenderer(),void this.clearSelection();this._bLock||(this._bLock=!0,window.setTimeout(function(){e._bLock=!1,e._map&&e._map.isCloudVer()?e.requestDataForCloud(t):e.requestData()},50))},clearRenderer:function(){this.renderer.clear()},_clearDtData:function(){var t=this.getLayers(!0);t&&t.length&&t.forEach(function(t){t.clearData()})},getSelectionByLayerID:function(t){return this._seSelectionLayer&&this._seSelectionLayer.getSelectionByLayerID(t)},requestDataForCloud:function(t){var e=this;if(this.fire("requestDataEnd"),this._startT=(new Date).getTime(),this.requests&&0<this.requests.length)for(var n=0;n<this.requests.length;n++)this.requests[n].abort();if(this.requests=[],this.promiseList=[],!this._layers||0===this._layers.length)return this.clearRenderer(),this.drawSelection(),this._lastRequest=null,this._clearDtData(),void this._map.fire("view-result",{data:[]});t&&t.page&&(t.page,t.isChangePageMode);for(var i=this._map.getSize(),r=this._map.getBounds(),o=i.x/(r.getEast()-r.getWest()),s=this._layers.length,a=[],u=[],l=this._map.getScale(),h=20/o,c=r.getWest()-h,p=r.getSouth()-h,f=r.getEast()+h,d=r.getNorth()+h,g=new B.LatLngBounds(new B.LatLng(p,c),new B.LatLng(d,f)),y=this._map.getEditLayer(),_=0;_<s;_++){var m=this._layers[_];if(m&&m.dataset&&!(0<=u.indexOf(m.dataset.id))){u.push(m.dataset.id);var v=this._map.findDatasetById(m.dataset.id),b=v.getProjInfo(),x=I_.createFromLatLngBounds(g,b);if(m.getRequestObj(a,l,!0,this._map)&&a&&0<a.length){var E=null;if(y){var I=this._seSelectionLayer.getSelectionByLayerID(m.getID());I&&(E=I.getIds())}a[a.length-1].exist_ids=v.getLocalFeaturesIdsByBox(x,!0,E)}}}if(!a||0===a.length)return this._clearDtData(),this.clearRenderer(),this._lastRequest=null,this.drawSelection(),void this._map.fire("view-result",{data:[]});this._clearDtData(),this._map.fire("requestDataStart");var L=ct({data:{bounds:{min_x:c,min_y:p,max_x:f,max_y:d},srid:4326,datasets:a,limit:this._map.pageCount()},success:function(t){e._requestDataForCloudResult(t,L)},error:function(){e.requestError(L)}});this.requests.push(L),this.draw()},_requestDataForCloudResult:function(t,e){var i=this,n=this.requests.indexOf(e);if(-1<n&&this.requests.splice(n,1),t&&t.status==st.SUCCESS_CLOUD){var r=t.result?t.result:[],o=[];r&&r.forEach(function(t){var e=i._map&&i._map.findDatasetById(t.id);e&&e.updateRecordset(t.features,i.renderStyle);var n=t.total?t.total:0;o.push({dtId:t.id,count:n})}),this._map.fire("view-result",{data:o}),this.draw()}},requestData:function(){var e=this;if(this.fire("requestDataEnd"),this._startT=(new Date).getTime(),this.requests&&0<this.requests.length)for(var t=0;t<this.requests.length;t++)this.requests[t].abort();if(this._clearDtData(),this.requests=[],this.promiseList=[],!this._layers||0===this._layers.length)return this.clearRenderer(),void(this._lastRequest=null);for(var n=this._map.getSize(),i=this._map.getBounds(),r=n.x/(i.getEast()-i.getWest()),o=this._layers.length,s=[],a=this._map.getScale(),u=0;u<o;u++){var l=this._layers[u];l&&l.getRequestObj(s,a)}if(0===s.length)return this.clearRenderer(),void(this._lastRequest=null);var h=20/r,c=i.getWest()-h,p=i.getSouth()-h,f=i.getEast()+h,d=i.getNorth()+h;this._map.fire("requestDataStart");var g={query_define:{type:lt.BOUNDS,bbox:{min_x:c,min_y:p,max_x:f,max_y:d}},dataset_list:s,view_bbox:{min_x:0,min_y:0,max_x:n.x,max_y:n.y}},y=ht({data:g,success:function(t){e._firstRequestResult(t,y,g)},error:function(){e.requestError(y)}});this.requests.push(y)},_isSameRequest:function(t){var e=this._map.getZoom(),n=this._map.getCenter();if(!this._lastRequest)return!1;if(this._lastRequest.zoom!==e||!this._lastRequest.center.equals(n)||this._lastRequest.layerList.length!==t.length)return!1;for(var i=0;i<t.length;i++){var r=this._lastRequest.layerList[i],o=t[i];for(var s in r){if(r[s]!==o[s])return!1}}return!0},requestError:function(t){if(this.requests){var e=this.requests.indexOf(t);-1<e&&this.requests.splice(e,1)}},_firstRequestResult:function(t,e,n){var i=this._updateData(t,e,!0);if(i&&i.maxCount){var r=i.maxCount,o=i.packs;this._sendSubPacks(o,r,n)}else this._updateDataEnd()},_sendSubPacks:function(t,e,n){var i=this;if(t&&e){for(var r=[],o=0;o<e;o++){for(var s=t.length,a=[],u=0;u<s;u++){var l=t[u],h=l.subPacks;if(h&&!(h.length<=o)){var c={dataset_id:l.dataset_id,dataset_ver:l.dataset_ver,layer_id:l.layer_id,field_list:l.field_list,feature_id_list:h[o],sub_pack_index:o+1};a.push(c)}}n.dataset_list=a;var p=this._createRequestPromise(n);r.push(p)}var f=(new Date).getTime()+"_"+Math.random();this.promiseList||(this.promiseList=[]),this.promiseList.push(f),Promise.all(r).then(function(){i.promiseList&&-1!==i.promiseList.indexOf(f)&&i._updateDataEnd()}).catch(function(t){throw new Error(t)})}},_createRequestPromise:function(i){var r=this;return new Promise(function(e,t){var n=ht({data:i,success:function(t){r._updateData(t,n,!1),e()},error:function(){t()}});r.requests.push(n)})},_updateDataEnd:function(){var t=(new Date).getTime();this._mergeFeatures();var e=(new Date).getTime();this._avoid();var n=(new Date).getTime();this.debug&&(console.log("合并请求："+(e-t)),console.log("避让："+(n-e))),this.draw(),this.fire("requestDataEnd")},_mergeFeatures:function(){var t=this.getLayers(!0);t&&t.length&&t.forEach(function(t){t&&t.dataset&&t.dataset.mergeFeatures()})},_getRequestLayers:function(){var t=this.getLayers(!0);if(!t||!t.length)return null;var e=[];return t.forEach(function(t){t&&t.dataset&&t.visible&&t.getFeatures()&&0<t.getFeatures().length&&e.push(t)}),e},_sortByPriority:function(t){t&&0!==t.length&&t.sort(function(t,e){var n=t.renderTextStyle?t.renderTextStyle.getLabelWeight():0;return(e.renderTextStyle?e.renderTextStyle.getLabelWeight():0)-n})},_updateData:function(t,e,n){var i=(new Date).getTime(),r=this.requests.indexOf(e);if(-1<r&&this.requests.splice(r,1),t.status!==st.SUCCESS)throw new Error("render error:"+t.message);var o=t.result;if(!o||!o.dataset_list||0===o.dataset_list.length)return null;for(var s=o.dataset_list,a=s.length,u=[],l=0,h=0;h<a;h++){var c=s[h];if(c){var p=this.getLayerById(c.layer_id);if(p&&p.dataset)if(n&&p.clearData(),c.result_status){var f=this._getLayerSubPacks(c);f&&(u.push(f),l=l>=f.count?l:f.count)}else p.updateData(c)}}var d=(new Date).getTime();return this.debug&&console.log("更新数据："+(d-i)),n?{packs:u,maxCount:l}:null},_getLayerSubPacks:function(t){if(!t)return null;var e=t.feature_id_list,n=t.max_feature_count;if(!e||0===e.length||!n)return null;for(var i=e.length,r=Math.ceil(i/n),o=0,s=[],a=0;a<r;a++){var u=o+n;i<=u&&(u=i);var l=e.slice(o,u);s.push(l),o=u}return{dataset_id:t.dataset_id,dataset_ver:t.dataset_ver,layer_id:t.layer_id,field_list:t.field_list,subPacks:s,count:r}},getLayerById:function(o){function s(t){if(!t||0===t.length)return null;for(var e=t.length,n=0;n<e;n++){var i=t[n];if(i){if(i.id===o)return i;if(i.getType()===dI.SEGROUPLAYER){var r=s(i.getLayers());if(r)return r}}}return null}return s(this._layers)},_avoid:function(){this._aLabelPositions||(this._aLabelPositions=new cS),this._aLabelPositions.clear();var t=this._getRequestLayers();if(t&&0!==t.length){this._sortByPriority(t);var e=new lS(this._map,this._aLabelPositions);e.avoid(t),e.releaseModel()}},loadResources:function(){var t=this.getLayers(!0),e=[];t&&t.forEach(function(t){t.loadResources()&&e.push(t.loadResources())});return 0<e.length?Promise.all(e):Promise.resolve()},draw:function(){var t=this;this.loadResources().then(function(){t._draw()}).catch(function(){t._draw()})},_draw:function(){var t=(new Date).getTime();this.clearRenderer();var e=this.renderer.ctx,n=this._layers;if(n&&0!==n.length){for(var i=n.length-1;0<=i;i--){var r=n[i];r&&r.visible&&r.draw(this._map,e)}this._avoid(),this._drawLabels(),this.drawSelection();var o=(new Date).getTime();this.debug&&(console.log("绘制时间："+(o-t)),console.log("总时间："+(o-this._startT)))}},addSelection:function(t){this._seSelectionLayer.addSelection(t)},getSelections:function(){return this._seSelectionLayer.getSelections()},clearSelection:function(){this._seSelectionLayer.clear()},removeSelectionByLayerId:function(t){return this._seSelectionLayer&&this._seSelectionLayer.removeSelectionByLayerID(t)},drawSelection:function(){this._seSelectionLayer.draw()},_drawLabels:function(){if(this._aLabelPositions){var t=this.renderer.ctx;this._aLabelPositions.drawLabels(t)}},changeLayerOrder:function(t){var i=this;if(t&&0!==t.length){!function n(t){t&&0!==t.length&&t.forEach(function(t){if(t){var e=i.getLayerById(t.layerId);e&&(e=e.clone(),(t.layer=e).getType()===dI.SEGROUPLAYER&&e.setLayers(null)),t.subLayers&&0<t.subLayers.length&&n(t.subLayers)}})}(t),this._layers=[],t.forEach(function(t){if(t&&t.layer){var e=t.layer;i.addLayer(e),e.getType()===dI.SEGROUPLAYER&&t.subLayers&&0<t.subLayers.length&&i._createSubLayers(e,t.subLayers)}})}},_createSubLayers:function(n,t){var i=this;n&&t&&0!==t.length&&t.forEach(function(t){if(t&&t.layer){var e=t.layer;n.addLayer(e),e.getType()===dI.SEGROUPLAYER&&t.subLayers&&0<t.subLayers.length&&i._createSubLayers(e,t.subLayers)}})},createGroupLayer:function(t,e){e=e||"新建图层组";var n=new CL;if(n.setName(e),t){var i=this.getLayerById(t);if(!i)return!1;i.addLayer(n,!0)}else this.addLayer(n,!0);return n},zoomToLayer:function(t){var e=this.getLayerById(t);if(!e||!e.getDataset()||e.getType()!==dI.SELAYER)return!1;var n=e.getDataset(),i=n.getBounds().toLatLngBounds(n.getProjInfo());return i&&this._map.fitBounds(i),!0},getEditFeatureIds:function(){return this._seSelectionLayer.getEditFeatureIds()},getLayersByDtId:function(e){var t=this.getLayers(!0);if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){t&&t.getDataset()&&t.getDataset().getID()===e&&n.push(t)}),n}}),dS=B.Layer.extend({options:{pane:Cb,zIndex:10,delay:400},initialize:function(t){B.setOptions(this,t),this.renderer=this._createRenderer(),this._features=null},_createRenderer:function(){var t=this.options.pane||Cb;return new T({pane:t,zIndex:this.options.zIndex})},onAdd:function(t){t.addLayer(this.renderer)},onRemove:function(){this._map&&this._map.removeLayer(this.renderer)},setZIndex:function(t){this.options.zIndex=t,this.renderer.setZIndex(t)},setFeatures:function(t){var e=this;this._features=t,this._draw(),setTimeout(function(){e.clear()},this.options.delay)},clearRenderer:function(){this.renderer.clear()},clear:function(){this._features=null,this.clearRenderer()},_draw:function(){var i=this;if(this.clearRenderer(),this._map&&this._features&&0!==this._features.length){var r=this.renderer.ctx;this._features.forEach(function(t){if(t){var e=i._getSymbol(t.getType()),n=t.toPixelGeometry(i._map,!0);e.draw(r,[n])}})}},_getSymbol:function(t){var e=this._map.seManager.getSelectSetting().highlightColor,n=null;switch(t){case M_.POINT:n=new WI({color:e,size:12});break;case M_.LINE:n=new lL({color:e,width:4});break;case M_.POLYGON:case M_.MULTIPOLYGON:n=new xL({color:e})}return n}}),gS=B.Evented.extend({options:{tolerance:4,style:{color:"#000000",weight:2,interactive:!1}},initialize:function(t,e){B.setOptions(this,e),this._map=t,this._enable=!1,this._feature=null,this._snapResult=null},enable:function(){this.disable(),this._enable=!0,this._map.on("mousemove",this._onMouseMove,this),this._map.on("moveend viewreset",this._onZoomEnd,this)},disable:function(){this._enable=!1,this._snapResult=null,this._map.off("mousemove",this._onMouseMove,this),this._clearRenderer()},_onZoomEnd:function(){this._snapResult=null,this._clearRenderer()},getSnapResult:function(){return this._snapResult},setSnapResult:function(t){this._snapResult=t,this._drawSnap(t)},getSnapMapPoint:function(t,e,n){if(!t||!e)return null;n=n||t.getProjInfo();var i=this._getMapZone(n),r=n.project(e),o=this._getSnapResultFromFeatures(r,[t],i),s=null;if(o){var a=o.points;if(1===a.length)s=a[0].clone();else if(2===a.length){var u=a[0],l=a[1],h=S_.getPointFoot(r.x,r.y,u.x,u.y,l.x,l.y);s=new B.Point(h.x,h.y)}}return s&&(o.snapPoint=s),o},getSnapNode:function(t,e,n,i){if(!t||!e)return null;n=n||t.getProjInfo();var r=this._getMapZone(n,i),o=n.project(e),s=this._getSnapResultFromFeatures(o,[t],r,U_),a=null;if(s){var u=s.points;1===u.length&&(a=u[0].clone())}return a&&(s.snapPoint=a),s},_clearRenderer:function(){this._feature&&(this._map.removeLayer(this._feature),this._feature=null)},_onMouseMove:function(t){if(this._enable&&this._map.getAction()!=yI.VIEW_NODE){var e=t.latlng,n=this._getSnapResult(e);this._snapResult=n,this._drawSnap(n)}},_drawSnap:function(t){if(this._clearRenderer(),t&&t.points&&t.points.length){var e=t.layerId,n=this._map.seManager.getLayerById(e);if(n&&n.getDataset()){var i=n.getDataset().getProjInfo(),r=t.points,o=[];r.forEach(function(t){o.push(i.unproject(t))}),1===o.length?this._feature=this._getCrossFeature(o[0]):this._feature=this._getPolylineFeature(o),this._map.addLayer(this._feature)}}},_getCrossFeature:function(t){var e=this._map.latLngToLayerPoint(t),n=new B.Point(e.x,e.y-5),i=new B.Point(e.x,e.y+5),r=new B.Point(e.x-5,e.y),o=new B.Point(e.x+5,e.y),s=this._map.layerPointToLatLng(n),a=this._map.layerPointToLatLng(i),u=this._map.layerPointToLatLng(r),l=this._map.layerPointToLatLng(o),h=new B.Polyline([s,a],this.options.style),c=new B.Polyline([u,l],this.options.style);return new B.LayerGroup([h,c],this.options.style)},_getPolylineFeature:function(t){return new B.Polyline(t,this.options.style)},_getSnapResult:function(t,e){var n=this._map.seManager.getVectorLayers(!0);if(!n||0===n.length)return null;for(var i=null,r=0;r<n.length;r++){var o=n[r];if(o&&o.getDataset()&&(o.getFeatures()&&0!=o.getFeatures().length)){var s=o.getDataset().id,a=this._map.findDatasetById(s);if(a){var u=a.getProjInfo(),l=this._getMapZone(u),h=u.project(t),c=[],p=this._getSnapResultFromFeatures2(h,o.getFeatures(),l,e,a,c);if(p)return i={point:p,layerId:o.getID(),points:c}}}}return i},bClickOnFeatures:function(t,e,n){if(!t||!e||0===e.length||!n)return!1;var i=n.getProjInfo(),r=this._getMapZone(i),o=i.project(t);return!!this._getSnapResultFromFeatures(o,e,r)},_getSnapResultFromFeatures2:function(t,e,n,i,r,o){if(!t||!e||0===e.length||!r)return null;i=i||U_|j_;for(var s=null,a=e.length,u=new I_({left:-n,bottom:-n,right:n,top:n}),l=0;l<a;l++){var h=e[l];if(h){var c=r.getFeatureByIndex(h.sIndex);if(c){var p=c.getGeometry();if(p&&p.coordinates){var f=p.coordinates,d=null;switch(c.getType()){case M_.POINT:if(0==(i&U_))continue;if(2==f.length)S_.isPointInPoint(f[0],f[1],t.x,t.y,n)&&(s=new B.Point(f[0],f[1]),o.push(s));break;case M_.MULTIPOINT:if(0==(i&U_))continue;for(var g=f.length,y=0;y<g;y++){if(S_.isPointInPoint(f[y][0],f[y][1],t.x,t.y,n)){s=new B.Point(f[y][0],f[y][1]),o.push(s);break}}break;case M_.LINE:var _=c.getBounds();if(!_)break;(d=_.clone()).add(u),d.containsPoint(t)&&(s=this._getSnapResultFromFeature2(f,t,n,i,o));break;case M_.MULTILINE:case M_.POLYGON:var m=c.getBounds();if(!m)break;if((d=m.clone()).add(u),d.containsPoint(t))for(var v=f.length,b=0;b<v&&!(s=this._getSnapResultFromFeature2(f[b],t,n,i,o));b++);break;case M_.MULTIPOLYGON:var x=c.getBounds();if(!x)break;if((d=x.clone()).add(u),d.containsPoint(t))for(var E=f.length,I=0;I<E;I++){for(var L=f[I],w=L.length,S=0;S<w&&!(s=this._getSnapResultFromFeature2(L[S],t,n,i,o));S++);if(s)break}}if(s)break}}}}return s},_getSnapResultFromFeature2:function(t,e,n,i,r,o){if(!t||t.length<2)return null;for(var s=t.length,a=null,u=0;u<s-1;u++){var l=t[u],h=t[u+1];if(l&&h){var c=!1;if(0<(i&U_)&&((c=S_.isPointInPoint(l[0],l[1],e.x,e.y,n))&&(a=new B.Point(l[0],l[1]),r.push(a),o&&(o.points=[a],o.pointIndex=u)),c||(c=S_.isPointInPoint(h[0],h[1],e.x,e.y,n))&&(a=new B.Point(h[0],h[1]),r.push(a),o&&(o.points=[a],o.pointIndex=u+1))),c||0<(i&j_)&&(c=S_.isPointNearestOnLine(l[0],l[1],h[0],h[1],e.x,e.y,n))&&(a=S_.getPointFoot(e.x,e.y,l[0],l[1],h[0],h[1]),r.push(new B.Point(l[0],l[1])),r.push(new B.Point(h[0],h[1])),o&&(o.points=r,o.pointIndex=u,o.isInLine=!0)),c)break}}return a},_getSnapResultFromFeatures:function(t,e,n,i){if(!t||!e||0===e.length)return null;i=i||U_|j_;for(var r=e.length,o=null,s=null,a=[],u=new I_({left:-n,bottom:-n,right:n,top:n}),l=0;l<r;l++){var h=e[l];if(h){var c=null,p=h.getGeometry();if(p&&p.coordinates){var f=p.coordinates;switch(h.getType()){case M_.POINT:if(0==(i&U_))continue;if(2==f.length)S_.isPointInPoint(f[0],f[1],t.x,t.y,n)&&(s=new B.Point(f[0],f[1]),o={featureId:h.getID(),points:[s],pointIndex:0});break;case M_.MULTIPOINT:if(0==(i&U_))continue;for(var d=f.length,g=0;g<d;g++){if(S_.isPointInPoint(f[g][0],f[g][1],t.x,t.y,n)){s=new B.Point(f[0],f[1]),o={featureId:h.getID(),points:[s],pointIndex:g};break}}break;case M_.LINE:var y=h.getBounds();if(!y)break;(c=y.clone()).add(u),c.containsPoint(t)&&(o={},(s=this._getSnapResultFromFeature2(f,t,n,i,a,o))&&(o.featureId=h.getID(),o.subIndex=0));break;case M_.MULTILINE:case M_.POLYGON:var _=h.getBounds();if(!_)break;if((c=_.clone()).add(u),c.containsPoint(t))for(var m=f.length,v=0;v<m;v++)if(o={},s=this._getSnapResultFromFeature2(f[v],t,n,i,a,o)){o.subIndex=v,o.featureId=h.getID();break}break;case M_.MULTIPOLYGON:var b=h.getBounds();if(!b)break;if((c=b.clone()).add(u),b.containsPoint(t))for(var x=f.length,E=0;E<x;E++){for(var I=f[E],L=I.length,w=0;w<L;w++)if(o={},s=this._getSnapResultFromFeature2(I[w],t,n,i,a,o)){o.subIndex=w,o.featureId=h.getID(),o.geoIndex=E;break}if(s)break}}if(s)break;o=null}}}return o},_getSnapResultFromFeature:function(t,e,n,i){var r=null;if(!t.getBounds().containsPoint(e))return null;for(var o=t.getMapPoints(),s=t.getPolyCount(),a=t.getSubCount(),u=t.getID(),l=0;l<a;l++)for(var h=s[l],c=0;c<h-1;c++){var p=c+0,f=o[p],d=o[p+1];if(f&&d){if(0<(i&U_)){if(S_.isPointInPoint(f.x,f.y,e.x,e.y,n))return r={featureId:u,points:[f],pointIndex:p,subIndex:l};if(S_.isPointInPoint(d.x,d.y,e.x,e.y,n))return r={featureId:u,points:[d],pointIndex:p+1,subIndex:l}}if(0<(i&j_)&&S_.isPointNearestOnLine(f.x,f.y,d.x,d.y,e.x,e.y,n))return r={featureId:u,points:[f,d],pointIndex:p,subIndex:l}}}return r},_getMapZone:function(t,e){e=e||this.options.tolerance;var n=this._map.getCenter(),i=this._map.latLngToLayerPoint(n),r=new B.Point(i.x,i.y+this.options.tolerance),o=this._map.layerPointToLatLng(i),s=this._map.layerPointToLatLng(r);return s=t?(o=t.project(o),t.project(s)):(o=new B.Point(o.lng,o.lat),new B.Point(s.lng,s.lat)),Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2))}}),yS=B.Evented.extend({options:{maxEditCount:1e3},initialize:function(t,e){B.setOptions(this,e),this._map=t,this.renderer=this._createRenderer(),this._map.addLayer(this.renderer),this._snapHandler=new gS(this._map),this._editLayer=null,this._currentEditFeatures=null,this._geoIds=null,this._editHistorys=null,this._currentEditIndex=-1,this.tempEditNodeFeature=null,this.center=null},hasEditFeature:function(){return!(!this._geoIds||0===this._geoIds.length)},updateHistorysProperties:function(t){for(var e=this._editHistorys?this._editHistorys.length:0,n=0;n<e;n++){var i=this._editHistorys[n];if(t==i.datasetId){var r=this._map.findDatasetById(t),o=null;if(i.action==C_.EDIT_COLLECTION)for(var s=i.group,a=s?s.length:0,u=0;u<a;u++)for(var l=(o=s[u].features)?o.length:0,h=0;h<l;h++){var c=o[h].getProperties(),p=r.syncProperties(c);o[h].setProperties(p)}else for(var f=(o=i.features)?o.length:0,d=0;d<f;d++){var g=o[d].getProperties(),y=r.syncProperties(g);o[d].setProperties(y)}}}return!0},isOutMaxCount:function(){return!!(this._geoIds&&this._geoIds.length>this.options.maxEditCount)},getEditCount:function(){return this.hasEditFeature()?this._geoIds.length:0},getCurrentEditFeatures:function(){var t=this._geoIds;if(!t||0===t.length)return null;var e=this._editLayer&&this._editLayer.getDataset();if(!e)return null;var n=e.id,i=this._map.findDatasetById(n);return i?i.getFeaturesByIds(t):null},bClickOnEditFeatures:function(t){var e=this.getCurrentEditFeatures();if(!this._editLayer||!e||0===e.length)return!1;var n=this._editLayer.getDataset();return n.getType()===Sm.POLYGON||n.getType()===Mm.POLYGON?this._pointInEditPolygon(t,e):this._snapHandler.bClickOnFeatures(t,e,n)},_pointInEditPolygon:function(t,e){if(!this._editLayer||!e||0===e.length)return!1;var n=this._editLayer.getDataset();if(n.getType()!==Sm.POLYGON&&n.getType()!==Mm.POLYGON)return!1;for(var i=n.getProjInfo().project(t),r=E_.point([i.x,i.y]),o=!1,s=0;s<e.length;s++){var a=e[s];if(a.getType()==M_.MULTIPOLYGON)for(var u=a.getPolygons(),l=u?u.length:0,h=0;h<l&&!(o=E_.booleanPointInPolygon(r,u[h].getGeometry()));h++);else{var c=a.getGeometry();if(o=E_.booleanPointInPolygon(r,c))break}if(o)break}return o},_createRenderer:function(){return new T({pane:Mb})},snapEnable:function(){this._snapHandler.enable()},snapDisable:function(){this._snapHandler.disable()},getSnapHandler:function(){return this._snapHandler},clear:function(){this._currentEditFeatures=null,this.center=null,this._geoIds=null,this.clearRenderer()},setMaxEditCount:function(t){this.options.maxEditCount=t},hasEditGroup:function(){return!!(this._editHistorys&&this._editHistorys.find(function(t){return t.action==C_.EDIT_COLLECTION}))},finishEdit:function(){this.clear(),this._geoIds=null,this._editLayer=null,this.snapDisable(),this._map.seManager.setAction(yI.PAN),this._editHistorys=null,this._currentEditIndex=-1,this.center=null},clearRenderer:function(){this.renderer.clear()},setGeoIds:function(t){this.clear(),this._geoIds=t,this.draw()},unlockAll:function(){var t=this;return new Promise(function(e,n){t._editLayer&&t._editLayer.getDataset()&&ut("unlockAll",{data:{dataset_list:[t._editLayer.getDataset().getID()]},success:function(t){t.status!==st.SUCCESS?n(t.message):e()},error:function(){n()}})})},lock:function(i){var r=this;return i=i||this._geoIds,new Promise(function(e,n){if(r._editLayer&&r._editLayer.getDataset()&&i&&0!==i.length){var t=r._editLayer.getDataset();ut("lock",{data:{dataset_list:[{dataset_id:t.getID(),dataset_ver:t.getVersion(),feature_id_list:i}]},success:function(t){t.status!==st.SUCCESS?n(CI):e()},error:function(){n(CI)}})}})},requestGeos:function(t){var a=this;return new Promise(function(r,o){if(a._editLayer&&a._editLayer.getDataset()&&t&&0!==t.length){var s=a._editLayer.getDataset();ft({data:{dataset_list:[{dataset_id:s.getID(),dataset_ver:s.getVersion(),layer_id:a._editLayer.getID(),feature_id_list:t,field_list:s.getFieldNames(),query_geo:!0}]},success:function(t){if(t.status!==st.SUCCESS)o(t.message);else{var e=t.result.dataset_list;if(!e||0===e.length)return;var n=e[0],i=a._geoJsonToFeatures(n,s.getProjInfo());r(i)}},error:function(){o()}})}})},_geoJsonToFeatures:function(t,o){var s=this,e=t.feature_id_list,a=t.attr_list,u=t.field_list,l=t.geo_list,h=[];return e.forEach(function(t,e){var n=l[e],i=P_.createFeatureFromGeoJSON(n);if(i.setID(t),i.setProjInfo(o),a&&0<a.length){var r=s._getFeatureProperties(a,u,e);i.setProperties(r)}h.push(i)}),h},_getFeatureProperties:function(t,e,n){for(var i=e.length,r=n*i,o={},s=0;s<i;s++){var a=e[s],u=t[r];o[a]=u,r++}return o},_getSelectionLayer:function(){var t=this._map.getSelection(),e=null;return t&&0<t.length&&(e=t[0]),e?this._map.getLayerById(e.getLayerId()):null},_getSelectIds:function(){var t=this._map.getSelection(),e=null;return t&&0<t.length&&(e=t[0]),this._map.getLayerById(e.getLayerId())&&e?e.getIds():null},getCentroid:function(t){if(!t||0===t.length)return null;var e=this._editLayer&&this._editLayer.getDataset();if(!e)return null;var n=e.id,i=this._map.findDatasetById(n);if(!i)return null;var r=i.getFeaturesByIds(t);return r[0]&&r[0].centroid()},draw:function(){this.clearRenderer();var t=this._map.seManager.getAction();if(this._editLayer&&this._geoIds&&0<this._geoIds.length){var e=this.getCenter(this._geoIds);this.center||(this.center=e.clone()),this._drawEditCenter(this.center)}if(t===yI.ADD_NODE||t===yI.EDIT_NODE||t===yI.DELETE_NODE){if(this._editLayer&&this._geoIds&&0<this._geoIds.length){var n=this._geoIds;if(!n||0===n.length)return;var i=this._editLayer&&this._editLayer.getDataset();if(!i)return;var r=i.id,o=this._map.findDatasetById(r);if(!o)return;var s=o.getFeatureById(n[0]);this._drawNodes(s)}}else if(t===yI.VIEW_NODE){var a=this._getSelectionLayer(),u=this._getSelectIds();if(!a||!u||0==u.length)return;var l=a&&a.getDataset();if(!l)return;var h=l.id,c=this._map.findDatasetById(h);if(!c)return;var p=c.getFeatureById(u[0]);this._drawNodes(p)}this.drawEditNodes(this.tempEditNodeFeature)},getCenterExt:function(t,e){if(!e||0===e.length||!t)return null;var n=t,i=this._map.findDatasetById(n);if(!i)return null;var r=i.getFeaturesByIds(e),o=this._getEditBounds(r);return o&&o.getCenter()},getCenter:function(t){if(!t||0===t.length)return null;var e=this._editLayer&&this._editLayer.getDataset();if(!e)return null;var n=e.id,i=this._map.findDatasetById(n);if(!i)return null;var r=i.getFeaturesByIds(t),o=this._getEditBounds(r);return o&&o.getCenter()},getCenterByFeatures:function(t){if(!t||0===t.length)return null;var e=this._getEditBounds(t);return e&&e.getCenter()},_getEditBounds:function(t){if(!t||0===t.length)return null;var n=null;return t.forEach(function(t){if(t){var e=t.getBounds();n?n.add(e):n=e}}),n},_drawEditCenter:function(t){if(this._editLayer&&this._editLayer.getDataset()){var e=this._editLayer.getDataset().getProjInfo().unproject(t),n=this._map.latLngToLayerPoint(e),i=this.renderer.ctx;this._getEditCenterStyle().drawPoint(i,n)}},_drawNodes:function(t){var e=this;if(t){var r=[];if(t.getType()===M_.MULTIPOLYGON)t.getPolygons().forEach(function(t){r.push(t.getPixelPoints(e._map,!0))});else r.push(t.getPixelPoints(this._map,!0));var o=this.renderer.ctx,s=this._getNodeStyle(),a=this._getNodeStyle(!0);r.forEach(function(n,i){n&&0!==n.length&&n.forEach(function(t,e){i===r.length-1&&e===n.length-1?a.drawPoint(o,t):s.drawPoint(o,t)})})}},_drawEditFeature:function(t){var e=this;if(t){var n=this.renderer.ctx,i=this._getEditNodeLineStyle(),r=[];if(t.getType()===M_.MULTIPOLYGON)t.getPolygons().forEach(function(t){r.push(t.toPixelGeometry(e._map,!0))});else r.push(t.toPixelGeometry(this._map,!0));i.draw(n,r)}},drawEditNodes:function(t){if(t){this.clearRenderer(),this._drawEditFeature(t);var e=this.getCenterByFeatures([t]);this._drawEditCenter(e),this._drawNodes(t)}},_getEditCenterStyle:function(){return new WI({simpleMarkerStyle:UI.SMSX,color:new _m(141,141,141,255),size:14})},_getNodeStyle:function(t){var e=new _m(0,128,0,255),n=10;return t&&(e=new _m(255,0,0,255),n=14),new WI({simpleMarkerStyle:UI.SMSSquare,color:e,size:n})},_getEditNodeLineStyle:function(){return new lL({width:2,color:new _m(255,0,255,255)})},setEditLayer:function(t){this.clear();var e=this._map.seManager,n=e.getLayerById(t);if(!n)return!1;this._editLayer=n;var i=e.getVectorServiceByLayerId(n.getID());if(i){var r=i.getEditFeatureIds();r&&0<r.length&&this.setGeoIds(r)}return!0},getEditLayer:function(){return this._editLayer},undo:function(){if(this._editHistorys&&0<=this._currentEditIndex&&0<this._editHistorys.length&&this._currentEditIndex<this._editHistorys.length){var t=this._editHistorys[this._currentEditIndex],e=this._map.findDatasetById(t&&t.datasetId);this._currentEditIndex--;var n=e&&e.updateFeaturesByEditHistoryForUndo(t);t&&t.action===C_.MODIFY&&(this._editHistorys[this._currentEditIndex+1].features=n),t&&t.action===C_.EDIT_COLLECTION&&(this._editHistorys[this._currentEditIndex+1].group=n),this._currentEditIndex<0?(this._currentEditIndex=-1,this._map.fire("edit-state",{isUndo:!1,isRedo:!0})):this._map.fire("edit-state",{isUndo:!0,isRedo:!0}),this._map.clearSelection(),this.clear(),this._map.refresh()}else this._editHistorys&&0<this._editHistorys.length?(this._currentEditIndex=-1,this._map.fire("edit-state",{isUndo:!1,isRedo:!0})):(this._currentEditIndex=-1,this._map.fire("edit-state",{isUndo:!1,isRedo:!1}))},redo:function(){if(this._editHistorys&&-1<=this._currentEditIndex&&0<this._editHistorys.length&&this._currentEditIndex+1<this._editHistorys.length){this._currentEditIndex++;var t=this._editHistorys[this._currentEditIndex],e=this._map.findDatasetById(t&&t.datasetId),n=e&&e.updateFeaturesByEditHistoryForRedo(t);t&&t.action===C_.MODIFY&&(this._editHistorys[this._currentEditIndex].features=n),t&&t.action===C_.EDIT_COLLECTION&&(this._editHistorys[this._currentEditIndex].group=n),this._currentEditIndex+1>=this._editHistorys.length?(this._currentEditIndex=this._editHistorys.length-1,this._map.fire("edit-state",{isUndo:!0,isRedo:!1})):this._map.fire("edit-state",{isUndo:!0,isRedo:!0}),this._map.clearSelection(),this.clear(),this._map.refresh()}else this._editHistorys&&0<this._editHistorys.length?(this._currentEditIndex=this._editHistorys.length-1,this._map.fire("edit-state",{isUndo:!0,isRedo:!1})):(this._currentEditIndex=-1,this._map.fire("edit-state",{isUndo:!1,isRedo:!1}))},addEditHistory:function(t){if(t){this._editHistorys||(this._editHistorys=[]);var e=this.hasEditGroup(),n=!1;if(0<this._editHistorys.length&&this._currentEditIndex<this._editHistorys.length-1&&(n=!0),n&&e&&(this._editHistorys=[],this._currentEditIndex=-1),0<this._editHistorys.length)if(0<=this._currentEditIndex&&this._currentEditIndex<this._editHistorys.length){var i=this._editHistorys.length-1-this._currentEditIndex;this._editHistorys.splice(this._currentEditIndex+1,i,t),this._currentEditIndex=this._editHistorys.length-1}else this._editHistorys.push(t),this._currentEditIndex=this._editHistorys.length-1;else this._editHistorys.push(t),this._currentEditIndex=this._editHistorys.length-1;return 0<this._editHistorys.length&&this._map.fire("edit-state",{isUndo:!0,isRedo:!1}),!0}return!1},addFeatures:function(t){var n=this;if(this._map&&this._map.isCloudVer()){if(!t||0===t.length)return!1;if(!this._editLayer||!this._editLayer.getDataset())return!1;var e=this._editLayer.getDataset().id,i=this._map.findDatasetById(e);if(!i)return!1;var r=i.getProjInfo(),o=[];t.forEach(function(t){var e=t.transform(r).toGeoJSON();e.properties=t.getProperties(),o.push(e)});var s=i.addFeatures(o),a=Ab.createEditHistory(e,s,C_.ADD),u=this.addEditHistory(a);return this._map.refresh(),u}if(t&&0!==t.length&&this._editLayer&&this._editLayer.getDataset()){var l=this._editLayer.getDataset(),h=l.getProjInfo(),c=[];t.forEach(function(t){c.push(t.transform(h).toGeoJSON())}),ut("batchFeatures",{data:{dataset_list:[{dataset_id:l.getID(),dataset_ver:l.getVersion(),feature_create_list:c,feature_update_list:null,feature_delete_list:null}]},success:function(t){if(t.status===st.SUCCESS){var e=t.result;n._updateDtsInfo(e)}else n.fire("editTip",{tip:PI})},error:function(){n.fire("editTip",{tip:PI})}})}},modifyFeatures:function(t){var n=this;if(this._map&&this._map.isCloudVer()){if(!t||0===t.length)return!1;if(!this._editLayer||!this._editLayer.getDataset())return!1;var e=this._editLayer.getDataset().id,i=this._map.findDatasetById(e);if(!i)return!1;var r=i.modifyFeatures(t),o=Ab.createEditHistory(e,r,C_.MODIFY),s=this.addEditHistory(o);return this._map.refresh(),s}if(t&&0!==t.length&&this._editLayer&&this._editLayer.getDataset()){var a=this._editLayer.getDataset(),u=[];t.forEach(function(t){var e=t.toGeoJSON();e.properties||(e.properties={}),e.properties.se_id=t.getID(),u.push(e)}),ut("batchFeatures",{data:{dataset_list:[{dataset_id:a.getID(),dataset_ver:a.getVersion(),feature_create_list:null,feature_update_list:u,feature_delete_list:null}]},success:function(t){if(t.status===st.SUCCESS){var e=t.result;n._updateDtsInfo(e),n.clear()}else n.fire("editTip",{tip:OI})},error:function(){n.fire("editTip",{tip:OI})}})}},deleteFeatures:function(t){var n=this;if(this._map&&this._map.isCloudVer()){if(!t||0===t.length)return!1;if(!this._editLayer||!this._editLayer.getDataset())return!1;var e=this._editLayer.getDataset().id,i=this._map.findDatasetById(e);if(!i)return!1;var r=i.deleteFeatures(t),o=Ab.createEditHistory(e,r,C_.DELETE),s=this.addEditHistory(o);return this._map.seManager.clearSelection(),this.clear(),this._map.refresh(),s||this.fire("editTip",{tip:BI}),s}if(!this._geoIds||0===this._geoIds.length)return this.fire("editTip",{tip:wI}),!1;var a=this._editLayer.getDataset();return this.lock(this._geoIds).then(function(){ut("batchFeatures",{data:{dataset_list:[{dataset_id:a.getID(),dataset_ver:a.getVersion(),feature_create_list:null,feature_update_list:null,feature_delete_list:n._geoIds}]},success:function(t){if(t.status===st.SUCCESS){var e=t.result;n._updateDtsInfo(e),n._map.seManager.clearSelection(),n.clear()}else n.fire("editTip",{tip:NI})},error:function(){n.fire("editTip",{tip:NI})}})}).catch(function(t){n.fire("editTip",{tip:t})}),!0},clipLine:function(t){if(!t||!t.newSourceFeature||!t.newGeoJSON)return!1;if(!this._editLayer||!this._editLayer.getDataset())return!1;var e=this._editLayer.getDataset().id,n=this._map.findDatasetById(e);if(!n)return!1;var i=n.modifyFeatures([t.newSourceFeature]),r=!1;if(i&&0<i.length){var o=n.addFeatures([t.newGeoJSON]);if(o&&0<o.length){var s=[{action:C_.MODIFY,features:i},{action:C_.ADD,features:o}],a=Ab.createEditHistory(e,null,C_.EDIT_COLLECTION,s);this._editHistorys=null,this._currentEditIndex=-1,r=this.addEditHistory(a),this.clear(),this._map.refresh()}}return r},combineFeatures:function(t,e){if(!t||!e||e.length<2)return!1;try{for(var n=!1,i=e.length,r=null,o=[],s=0;s<i;s++)o.push(e[s].getID()),r=0==s?e[s]:r.union(e[s]);if(r){var a=this._map.findDatasetById(t);if(!a)return!1;var u=a.deleteFeaturesByIds(o);if(u&&0<u.length){var l=a.addFeatures([r.toGeoJSON()]);if(l&&0<l.length){var h=[{action:C_.DELETE,features:u},{action:C_.ADD,features:l}],c=Ab.createEditHistory(t,null,C_.EDIT_COLLECTION,h);this._editHistorys=null,this._currentEditIndex=-1,n=this.addEditHistory(c),this._map.clearSelection(),this.clear(),this._map.refresh()}}}return n}catch(t){return console.log("EditManager-combineFeatures error:"+t.message),!1}},clipPolygon:function(t){if(this._map&&this._map.isCloudVer()){if(!t)return!1;if(!this._editLayer||!this._editLayer.getDataset())return!1;var e=this._editLayer.getDataset().id,n=this._map.findDatasetById(e);if(!n)return!1;var i=this.getCurrentEditFeatures(),r=i&&0<i.length?i[0]:null;if(!r)return!1;var o=t.transform(r.getProjInfo());try{var s=this._turfCut(r.getGeometry(),o.toGeoJSON());if(!s||1===s.length)return void this.fire("editTip",{tip:RI});var a,u=s?s.length:0,l=null,h=null;a=r.getProperties();for(var c=0;c<u;c++)if(0==c){var p=P_.createGeoJSONFeatureFromGeoJSON(s[c]);p.setID(r.getID()),p.setProjInfo(r.getProjInfo()),p.setProperties(a),p.setVersion(r.getVersion()),(l=l||[]).push(p)}else{var f=s[c];f.properties=a,(h=h||[]).push(f)}var d=!1;if(h&&l&&0<l.length&&0<h.length){var g=n.modifyFeatures(l);if(g&&0<g.length){var y=n.addFeatures(h);if(y&&0<y.length){var _=[{action:C_.MODIFY,features:g},{action:C_.ADD,features:y}],m=Ab.createEditHistory(e,null,C_.EDIT_COLLECTION,_);this._editHistorys=null,this._currentEditIndex=-1,d=this.addEditHistory(m),this.clear(),this._map.refresh()}}}return d}catch(t){return this.fire("editTip",{tip:RI}),!1}}else{if(!t||!this._currentEditFeatures||0===this._currentEditFeatures.length)return;var v=this._currentEditFeatures[0],b=t.transform(v.getProjInfo());try{var x=this._turfCut(v.toGeoJSON(),b.toGeoJSON());if(!x||1===x.length)return void this.fire("editTip",{tip:RI});var E=[];x.forEach(function(t){var e=P_.createFeatureFromGeoJSON(t);e.setID(v.getID()),e.setProjInfo(v.getProjInfo()),E.push(e)}),this.clipFeatures(E)}catch(t){this.fire("editTip",{tip:RI})}}},_turfCut:function(t,e){var n=E_.point(e.geometry.coordinates[0]),i=E_.point(e.geometry.coordinates[e.geometry.coordinates.length-1]);if(E_.booleanPointInPolygon(n,t)||E_.booleanPointInPolygon(i,t))return null;var r=E_.buffer(e,.01,{units:"meters"}),o=E_.difference(t,r);if(!o)return null;var s=[];return"Polygon"==o.geometry.type?s.push(E_.polygon(o.geometry.coordinates)):o.geometry.coordinates.forEach(function(t){s.push(E_.polygon(t))}),s},clipFeatures:function(t){var n=this;if(t&&0!==t.length&&this._editLayer&&this._editLayer.getDataset()){var e=this._editLayer.getDataset(),i=[],r=[];t.forEach(function(t,e){var n=t.toGeoJSON();0===e?(n.properties||(n.properties={}),n.properties.se_id=t.getID(),i.push(n)):r.push(n)}),ut("batchFeatures",{data:{dataset_list:[{dataset_id:e.getID(),dataset_ver:e.getVersion(),feature_create_list:r,feature_update_list:i,feature_delete_list:null}]},success:function(t){if(t.status===st.SUCCESS){var e=t.result;n._updateDtsInfo(e),n.clear()}else n.fire("editTip",{tip:TI})},error:function(){n.fire("editTip",{tip:TI})}})}},_updateDtsInfo:function(t){var s=this;t&&t.dataset_list&&0!==t.dataset_list.length?(t.dataset_list.forEach(function(t){if(t){var e=t.dataset_id,n=t.bbox,i=t.dataset_ver,r=new I_;r.readJson(n);var o=s._map.seManager.getLayersByDtId(e);if(!o||0===o.length)return;o.forEach(function(t){if(t&&t.getDataset()){var e=t.getDataset();e.setBounds(r),e.setVersion(i)}})}else s.fire("editTip",{tip:FI})}),this._map.seManager.refresh()):this.fire("editTip",{tip:FI})}}),_S=(c(mS,[{key:"getDB",value:function(){return this._db}},{key:"getVersion",value:function(){return this._db?this._db.version:1}},{key:"open",value:function(r,o){var s=this;return new Promise(function(e,t){var n=(o=o||{}).version||1,i=window.indexedDB.open(r,n);i.onerror=function(){t()},i.onsuccess=function(t){s._db=t.target.result,e()},i.onupgradeneeded=function(t){s._db=t.target.result,o.onupgradeneeded&&o.onupgradeneeded(t)}})}},{key:"deleteDB",value:function(i){return new Promise(function(t,e){var n=window.indexedDB.deleteDatabase(i);n.onerror=function(){e()},n.onsuccess=function(){t()}})}},{key:"createStores",value:function(n){var i=this;return new Promise(function(t,e){n&&0!==n.length?i._db?(i._db.close(),i.open(i._db.name,{version:i._db.version+1,onupgradeneeded:function(){n.forEach(function(t){var e=t.name,n=t.options;i._db.objectStoreNames.contains(e)||i._db.createObjectStore(e,n)}),t()}}).catch(function(){e()})):e():t()})}},{key:"deleteStores",value:function(n){var i=this;return new Promise(function(t,e){n&&0!==n.length?i._db?(i._db.close(),i.open(i._db.name,{version:i._db.version+1,onupgradeneeded:function(){n.forEach(function(t){i._db.objectStoreNames.contains(t)&&i._db.deleteObjectStore(t)}),t()}}).catch(function(){e()})):e():t()})}},{key:"addData",value:function(t,e){if(!this._db||!t||!e||0===e.length)return null;var r=this._db.transaction(t,"readwrite").objectStore(t),n=[];return e.forEach(function(i){var t=new Promise(function(t,e){var n=r.put(i);n.onsuccess=function(){t()},n.onerror=function(){e()}});n.push(t)}),Promise.all(n)}},{key:"getData",value:function(t,e){if(!(this._db&&t&&e&&0!==e.length&&this._db.objectStoreNames.contains(t)))return Promise.reject();var r=this._db.transaction(t,"readonly").objectStore(t),n=[];return e.forEach(function(i){var t=new Promise(function(e,t){var n=r.get(i);n.onsuccess=function(t){e(t.target.result)},n.onerror=function(){t()}});n.push(t)}),Promise.all(n)}},{key:"getAllKeys",value:function(i){var r=this;return new Promise(function(e,t){if(r._db&&r._db.objectStoreNames.contains(i)){var n=r._db.transaction(i,"readonly").objectStore(i).getAllKeys();n.onsuccess=function(t){e(t.target.result)},n.onerror=function(){t()}}else t()})}}]),mS);function mS(){h(this,mS),this._db=null}var vS=(c(bS,[{key:"clone",value:function(){var t=new bS(this.name);t.rootIndex=S_.clone(this.rootIndex),t.nodeIndexList=S_.clone(this.nodeIndexList),t.prtNodeList=S_.clone(this.prtNodeList),t.dtType=this.dtType,t.minLevel=this.minLevel,t.maxLevel=this.maxLevel,t.dtBound=this.dtBound,t.dtId=this.dtId,t.seIndexDB=this.seIndexDB}},{key:"load",value:function(t){var e=new DataView(t),n=new Tb(e);return"SP02"===n.getString(4)&&(this.dtType=n.getInt32(),n.getInt32(),this.nodeIndexList||(this.nodeIndexList={}),this.rootIndex.load(n,this.nodeIndexList),n.pos<n.size()&&"PART"===n.getString(4)&&this.load_seg_idx(n),this.minLevel=parseInt(sx(this.rootIndex.bound)+9),this.maxLevel=parseInt(ox(1e8)),this.minLevel>=this.maxLevel-9&&(this.minLevel=this.maxLevel-9),this.dtBound=this.rootIndex.bound,!0)}},{key:"load_seg_idx",value:function(t){var e;for(this.prtNodeList||(this.prtNodeList={}),e=t.size();t.pos<e;){if("SP02"!==t.getString(4))return!1;var n=t.getUint32(),i=this.get_vchar(t);if(0<i){for(var r={},o=0;o<i;o++){var s=this.get_vchar(t),a=t.getInt8(),u=new Wb;u.left=t.getFloat32(),u.top=t.getFloat32(),u.right=t.getFloat32(),u.bottom=t.getFloat32();var l=new $b;l.subKey=s,l.bound=u,l.minLevel=a,r[s]=l}this.prtNodeList[n]=r}}return!0}},{key:"get_vchar",value:function(t){var e=void 0,n=t.getUint8();return n<2?0===n?e=t.getUint16():1===n&&(e=t.getUint32()):e=n-2,e}},{key:"getBits",value:function(t,e){for(var n=0,i=new Array(8*e),r=0;r<e;r++)for(var o=t.getUint8(),s=0;s<8;s++)i[n++]=!!(this.bits[s]&o);return i}},{key:"decode_data",value:function(t){for(var e=new DataView(t),n=new Tb(e),i=n.size();n.pos<i;){var r=n.getInt32(),o=n.getInt32(),s=n.pos,a=n.getString(4);if("SP02"!==a&&"SP01"!==a){console.log("decode error");break}for(;n.pos-s<o;)switch(n.getInt8()){case 0:this.decode_progress(n,r,o);break;case 1:this.decode_geo(n,r,o);break;case 32:this.decode_empty_node(n,r);break;case 48:this.deal_with_part_bits(n,r,o);break;case 49:this.deal_with_part_geo(n,r,o);break;default:n.pos=s,n.getBits(o+8)}}}},{key:"decode_geo",value:function(t,e,n){var i=t.getInt8(),r=t.getInt32();this.nodeDataList[r]||(this.nodeDataList[r]=new nx);var o=this.nodeDataList[r],s=this.nodeIndexList[r],a=0;if(i===Gb){if(0===o.nodeFeatures.length&&(a=1),-50!==o.nodeLevel&&o.nodeLevel+a!==e)return void(t.pos+=n-10);if(-50===o.nodeLevel&&s.minLevel!==e)return void(t.pos+=n-10)}else if(i===Ub){if(0===o.boundleFeatures.length&&(a=1),-50!==o.boundleLevel&&o.boundleLevel+a!==e)return void(t.pos+=n-10);if(-50===o.boundleLevel&&s.minLevel!==e)return void(t.pos+=n-10)}var u=0;t.getBool()&&(u=t.getUint32());var l=t.getInt32();if(0<l)if(this.fieldNames)t.pos+=this.fieldNamesByteLen;else{this.fieldNames=[];for(var h=t.pos,c=t.getUint8(),p=0;p<c;p++){var f=t.getUint8(),d=t.getString(f);d=d.toLowerCase(),this.fieldNames.push(d)}this.fieldNamesByteLen=t.pos-h}var g=new Wb;g.load(t);var y=sx(g),_=(t.getInt32(),ox(1e8));_<=y&&(y=_-1);for(var m=[],v=0;v<l;v++){for(var b=t.getInt32(),x=t.getUint8(),E=new Array(x),I=0;I<x;I++){var L=t.getUint8(),w=t.getString(L);E[I]=w}var S=!0;this.dtType===Xb&&(S=t.getBool());var M=[];if(v<u)for(var C=y;C<e;C++)this.decode_PoiProData(t,C+1,this.bitProg,M);else{var P=1;this.dtType!==Yb&&(P=this.get_vchar(t)),M=this.decodeGeometry(y,e,P,t,this.bitProg)}M.forEach(function(t){t.x+=g.minX(),t.y+=g.minY()});var N=Wb.pointsToSeRect(M);if(0<v&&b===m[m.length-1].id)m[m.length-1].pointList.push(M),m[m.length-1].bound.mergeRect(N);else{var O=new tx({id:b,bound:N,pointList:[M],fieldValues:E});m.push(O)}this.dtType===Xb&&(m[m.length-1].clockWise||(m[m.length-1].clockWise=[]),m[m.length-1].clockWise.push(S))}var T=null;i===Gb?(o.nodeLevel=e,o.nodeFeatures||(o.nodeFeatures=[]),T=o.nodeFeatures):i===Ub&&(o.boundleLevel=e,o.boundleFeatures||(o.boundleFeatures=[]),T=o.boundleFeatures),m.forEach(function(t){t.level=e,T.push(t)}),this.seIndexDB&&this.saveToIndexDB(i,r,o)}},{key:"decode_progress",value:function(t,e,n){var i=t.getInt8(),r=t.getInt32();this.nodeDataList[r]||(this.nodeDataList[r]=new nx);var o=this.nodeDataList[r],s=this.nodeIndexList[r];if(i===Gb){if(-50!==o.nodeLevel&&o.nodeLevel+1!==e)return void(t.pos+=n-10);if(-50===o.nodeLevel&&s.minLevel!==e)return void(t.pos+=n-10)}else if(i===Ub){if(-50!==o.boundleLevel&&o.boundleLevel+1!==e)return void(t.pos+=n-10);if(-50===o.boundleLevel&&s.minLevel!==e)return void(t.pos+=n-10)}var a=0;t.getBool()&&(a=t.getUint32());var u=t.getInt32(),l=t.pos,h=null;h=i===Gb?(o.nodeLevel=e,o.nodeFeatures):(o.boundleLevel=e,o.boundleFeatures);for(var c=0,p=0,f=[],d=0;d<h.length;d++){var g=h[d];g.level=e;var y=g.pointList;g.bound=new Wb;for(var _=0;_<y.length;_++){var m=y[_];if(++p<=a)this.decode_PoiProData(t,e,this.bitProg,m);else{if(0===f.length){var v=u-(t.pos-l);f=this.getBits(t,v)}for(var b=0;b<m.length;b++)f[c++]&&(m[b].x+=this.bitProg.getDiff(e)),f[c++]&&(m[b].y+=this.bitProg.getDiff(e))}var x=Wb.pointsToSeRect(m);g.bound.mergeRect(x)}}this.seIndexDB&&this.saveToIndexDB(i,r,o)}},{key:"decode_empty_node",value:function(t,e){var n=t.getInt8(),i=t.getInt32(),r=this.nodeIndexList[i];r&&(n===Gb?r.pv_isNull=!0:n===Ub&&(r.bpv_isNull=!0)),this.nodeDataList[i]||(this.nodeDataList[i]=new nx);var o=this.nodeDataList[i];n===Gb?o.nodeLevel=e:n===Ub&&(o.boundleLevel=e)}},{key:"deal_with_part_bits",value:function(t,e,n){var i=t.getInt8(),r=t.getUint32(),o=t.getUint32();if(!this.prtNodeList[r]||!this.prtNodeList[r][o])return console.log("decode_data error!"),void(t.pos+=n-14);var s=this.prtNodeList[r][o];s.prtFeatures||(s.prtFeatures=[]);var a=s.prtFeatures,u=this.bitProg;if(-50===s.level||s.level+1===e)if(-50!==s.level||s.minLevel===e){var l=0;t.getBool()&&(l=t.getUint32());for(var h=t.getUint32(),c=t.pos,p=0,f=0,d=[],g=a?a.length:0,y=0;y<g;y++){var _=a[y],m=_.ptArray;if(++p<=l)this.decode_PoiProData(t,e,u,m);else{if(0===d.length){var v=h-(t.pos-c);d=this.getBits(t,v)}for(var b=m?m.length:0,x=0;x<b;x++)d[f++]&&(m[x].x+=u.getDiff(e)),d[f++]&&(m[x].y+=u.getDiff(e))}_.bound=Wb.pointsToSeRect(m)}s.level=e,this.seIndexDB&&this.saveToIndexDB(i,r,s)}else t.pos+=n-14;else t.pos+=n-14}},{key:"deal_with_part_geo",value:function(t,e,n){var i=t.getInt8(),r=t.getUint32(),o=t.getUint32();if(!this.prtNodeList[r]||!this.prtNodeList[r][o])return console.log("decode_data error!"),void(t.pos+=n-14);var s=this.prtNodeList[r][o];s.prtFeatures||(s.prtFeatures=[]);var a=s.prtFeatures,u=this.bitProg,l=0;if(0===a.length&&(l=1),-50===s.level||s.level+l===e)if(-50!==s.level||s.minLevel===e){var h=0;t.getBool()&&(h=t.getUint32());var c=t.getInt32();if(0<c)if(this.fieldNames)t.pos+=this.fieldNamesByteLen;else{this.fieldNames=[];for(var p=t.pos,f=t.getUint8(),d=0;d<f;d++){var g=t.getUint8(),y=t.getString(g);y=y.toLowerCase(),this.fieldNames.push(y)}this.fieldNamesByteLen=t.pos-p}var _=new Wb;_.load(t);var m=sx(_),v=ox(1e8);30<v&&(v=30),v<=m&&(m=v-1),t.getUint32();for(var b=0;b<c;b++){for(var x=t.getUint32(),E=t.getUint8(),I=new Array(E),L=0;L<E;L++){var w=t.getUint8(),S=t.getString(w);I[L]=S}for(var M=this.get_vchar(t),C=new Array(2),P=0;P<2;P++)C[P]=t.getUint32();var N;N=t.getBool();var O=[];if(b<h)for(var T=m;T<e;T++)this.decode_PoiProData(t,T+1,u,O);else{var k=1;this.dtType!==Yb&&(k=this.get_vchar(t)),O=this.decodeGeometry(m,e,k,t,u)}O.forEach(function(t){t.x+=_.minX(),t.y+=_.minY()});var R=Wb.pointsToSeRect(O),D=new ex({geoId:x,subId:M,bClockWise:N,ptArray:O,bound:R,ptIdx:C,fieldValues:I});a.push(D)}s.level=e,this.seIndexDB&&this.saveToIndexDB(i,r,s)}else t.pos+=n-14;else t.pos+=n-14}},{key:"decode_PoiProData",value:function(t,e,n,i){var r=i.length,o=this.get_vchar(t);if(0===o)for(var s=0,a=parseInt((2*i.length+7)/8),u=this.getBits(t,a),l=0;l<i.length;l++)u[s++]&&(i[l].x+=n.getDiff(e)),u[s++]&&(i[l].y+=n.getDiff(e));else{var h=i.length+o,c=parseInt((h+7)/8),p=this.getBits(t,c);c=parseInt((2*h+7)/8);var f=this.getBits(t,c);if(0===i.length)for(var d=0;d<h;d++)i[d]=new Jb(0,0);else{for(var g=new Array(h),y=0,_=0;_<h;_++)p[_]?g[_]=i[y-1]:g[_]=i[y++];for(var m=0;m<h;m++)i[m]=new Jb(g[m].x,g[m].y)}for(var v=0,b=0;b<i.length;b++)try{f[v++]&&(i[b].x+=n.getDiff(e)),f[v++]&&(i[b].y+=n.getDiff(e))}catch(t){console.log(e,i[b],r,o)}}}},{key:"decodeGeometry",value:function(t,e,n,i,r){for(var o=parseInt((7+n*(e-t)*2)/8),s=this.getBits(i,o),a=new Array(n),u=0,l=t;l<e;l++)for(var h=0;h<a.length;h++){a[h]||(a[h]=new Jb(0,0));var c=a[h];s[u++]&&(c.x+=r.getDiff(l+1)),s[u++]&&(c.y+=r.getDiff(l+1))}return a}},{key:"decode_data_subItem",value:function(t,e){if(t){if(this.subItems||(this.subItems={}),!this.subItems[t]){var n=S_.clone(this);n.subItems=null,n.itemName=t,this.subItems[t]=n}this.subItems[t].decode_data(e)}else this.decode_data(e)}},{key:"getRequestLevel",value:function(t){var e=parseInt(ox(2*t));return e<this.minLevel&&(e=this.minLevel),e}},{key:"request",value:function(t,e,n){null==n&&(n=!0);var i=[],r=this.getRequestLevel(e);r<this.minLevel&&(r=this.minLevel),this.rootIndex.query(i,t,r);for(var o=[],s=i.length,a=0;a<s;a++){var u=i[a],l=this.nodeIndexList[u.key];if(l){if(u.type===Gb&&l.pv_isNull)continue;if(u.type===Ub&&l.bpv_isNull)continue}if(u.type===zb&&0<Object.keys(this.prtNodeList).length){var h=this.prtNodeList[u.key];if(h){for(var c in h){var p=h[c],f=null;p.bound.isIntersect(t)&&r>p.level?((f=new Bb(u.key,zb)).subKey=c,f.level=p.level,f.to=r):-50===p.level&&((f=new Bb(u.key,zb)).subKey=c,f.to=-49),f&&(-50===f.level&&(f.level=p.minLevel-1),o.push(f))}continue}}var d=this.nodeDataList[u.key];d&&(u.type===Gb?u.level=d.nodeLevel:u.type===Ub&&(u.level=d.boundleLevel),u.level>=r&&n)||(-50===u.level&&(u.level=l.minLevel-1),o.push(u))}return o}},{key:"getBounds",value:function(){return this.dtBound}},{key:"queryBySubItems",value:function(t,e){var n=this.subItems,i=[];for(var r in n)n[r].query(t,e,i);return i}},{key:"query",value:function(t,e,n){if(this.subItems&&0<Object.keys(this.subItems).length)return this.queryBySubItems(t,e);n=n||[];for(var i=this.request(t,e,!1),r=0;r<i.length;r++){var o=i[r],s=o.key,a=o.type,u=this.nodeDataList[s];if(u){var l=null;a===Gb?l=u.nodeFeatures:a===Ub&&(l=u.boundleFeatures);for(var h=l.length,c=0;c<h;c++){var p=l[c];p.bound.isIntersect(t)&&n.push(p)}}}return this.query_seg(t,e,i,n),n}},{key:"query_seg",value:function(t,e,n,i){if(n&&this.prtNodeList&&0!==Object.keys(this.prtNodeList).length)for(var r=0;r<n.length;r++){var o=n[r].key,s={},a={},u={},l=this.prtNodeList[o];for(var h in l)for(var c=l[h].prtFeatures,p=c?c.length:0,f=0;f<p;f++){var d=c[f],g=d.geoId,y=d.subId,_=d.ptIdx[0];if(s[y]=d.bClockWise,u[g]=s,a[g]||(a[g]={}),a[g][y]||(a[g][y]={}),a[g][y][_]){var m=a[g][y][_].ptIdx[1];d.ptIdx[1]>m&&(a[g][y][_]=d)}else a[g][y][_]=d}for(var v in a){v=parseInt(v);var b=new tx,x=a[b.id_=v],E=!1,I=new Wb;for(var L in x){var w=L,S=x[L];for(var M in S)S[M].bound.isIntersect(t)&&(E=!0),I.mergeRect(S[M].bound);b.clockWise.push(u[v][w]);var C=[],P=-1;for(var N in S)if(!(S[N].ptIdx[1]<P)&&0!==S[N].ptArray.length){var O=0;(O=P-S[N].ptIdx[0]+1)<0&&(O=0),P=S[N].ptIdx[1],2<=O&&(O=1),O>=S[N].ptArray.length&&(O=S[N].ptArray.length-1),C=C.concat(S[N].ptArray.slice(O))}b.pointList.push(C)}if(this.dtType===Xb){if(!I.isIntersect(t))continue}else if(this.dtType===Hb&&!E)continue;b.bound=I,i.push(b)}}}},{key:"getPackTypeString",value:function(t){switch(t){case Gb:return"pv";case Ub:return"bpv";case jb:return"fld";case qb:return"bfd";case zb:return"ppv"}return""}},{key:"getPacks",value:function(t,e){var n=this.getRequestLevel(e),i=this.request(t,e);if(!i||0===i.length)return null;for(var r=i.length,o=[],s=0;s<r;s++){var a=i[s];if(a){var u=a.key,l=a.level,h=a.type,c=a.subKey,p=n;if(n<=l){var f=-50;if(f=h===zb?this.prtNodeList[u][c].minLevel:this.nodeIndexList[u].minLevel,!(l<=f))continue;p=l+1}var d={type:this.getPackTypeString(h),key:u,from:l,to:p};h===zb&&(d.subKey=c),o.push(d)}}return o}},{key:"clearLocalData",value:function(t,e){if(this.subItems&&0<Object.keys(this.subItems).length)for(var n in this.subItems){var i=this.subItems[n];i&&i.clearLocalData(t,e)}else{if(!this.nodeDataList)return;var r=this.getRequestLevel(e);for(var o in this.nodeDataList){var s=this.nodeDataList[o];if(s){var a=this.nodeIndexList[o],u=a.bound;t.isIntersect(u)?(r<a.level+9&&delete this.nodeDataList[o],14<r&&s.boundleFeatures&&0<s.boundleFeatures.length&&(s.boundleFeatures=[],s.boundleLevel=-50)):delete this.nodeDataList[o]}}}}},{key:"saveToIndexDB",value:function(t,e,n){if(this.seIndexDB){var i="";this.itemName&&(i+="itemName_"+this.itemName+"_"),i+="nodeKey_"+e,t===zb&&(i+="_subKey_"+n.subKey);var r={key:i,packType:t,nodeKey:e,nodeData:n};this.seIndexDB.addData(this.dtId,[r]).catch(function(t){console.log(t)})}}},{key:"_getFromIndexDB",value:function(i,r){var o=this;return new Promise(function(t){if(o.seIndexDB){var e=o.request(i,r);if(e&&0!==e.length){var n=[];return e.forEach(function(t){if(t.type===zb){if(o.prtNodeList&&o.prtNodeList[t.key]&&o.prtNodeList[t.key][t.subKey])return}else if(o.nodeDataList&&o.nodeDataList[t.key])return;var e="";o.itemName&&(e+="itemName_"+o.itemName+"_"),e+="nodeKey_"+t.key,t.type===zb&&(e+="_subKey_"+t.subKey),n.push(e)}),n.length,void t()}t()}else t()})}},{key:"_translateBounds",value:function(t){t&&0!==t.length&&t.forEach(function(t){t.bound=new Wb(t.bound)})}},{key:"getFromIndexDB",value:function(t,e){if(this.subItems&&0<Object.keys(this.subItems).length){var n=[];for(var i in this.subItems){var r=this.subItems[i];r&&n.push(r._getFromIndexDB(t,e))}return Promise.all(n)}return this._getFromIndexDB(t,e)}}]),bS);function bS(t){h(this,bS),this.name=t||"",this.nodeDataList={},this.rootIndex=new Zb,this.nodeIndexList={},this.prtNodeList={},this.dtType=Vb,this.minLevel=0,this.maxLevel=0,this.dtBound=null,this.bitProg=new ix,this.bits=[];for(var e=0;e<8;e++)this.bits[e]=1<<e;this.subItems=null,this.itemName="",this.fieldNames=null,this.fieldNamesByteLen=0,this.layerIds=[],this.dtId=-1,this.seIndexDB=null}var xS={useIndexDB:!1},ES=(c(IS,[{key:"initIndexDB",value:function(){var e=this;this.seIndexDB=new _S;var t=$.serviceUrl+"/fileDataDB";this.seIndexDB.deleteDB(t).then(function(){e.seIndexDB.open(t)}).catch(function(t){e.seIndexDB=null,console.log(t)})}},{key:"getFileDatasetByName",value:function(t){if(!this.fileDataList||0===this.fileDataList.length)return null;for(var e=0;e<this.fileDataList.length;e++)if(this.fileDataList[e].name===t)return this.fileDataList[e];return null}},{key:"getFileDatasetByLayerId",value:function(t){if(!this.fileDataList||0===this.fileDataList.length)return null;for(var e=0;e<this.fileDataList.length;e++){var n=this.fileDataList[e];if(n.layerIds&&-1!==n.layerIds.indexOf(t))return n}return null}},{key:"getDtPVInfo",value:function(t){return new Promise(function(e,n){ut("getDtPVInfo",{data:{name:t},success:function(t){t.status!==st.SUCCESS&&n(t.message),e(t.result)},error:function(){n()}})})}},{key:"getDtsPVInfo",value:function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.getDtPVInfo(t))}),Promise.all(n)}},{key:"addLayers",value:function(c){var p=this;return new Promise(function(h,e){if(c&&0!==c.length){var r=[],o=[];c.forEach(function(t){var e=t.dataset_id,n=e;t.itemFilter&&(n+="_"+t.layer_id);var i=p.getFileDatasetByName(n);i?i.layerIds.push(t.layer_id):(t.bRequest=!0,-1===o.indexOf(e)&&(r.push({dataset_id:e,dataset_ver:t.pvVersion}),o.push(e)))}),0===r.length?h():p.requestDtsIndex(r).then(function(t){for(var e=new DataView(t),n=new Tb(e),i=e.byteLength,r=[];n.pos<i;){var o=n.getInt8(),s=n.getString(o),a=n.getInt8(),u=parseInt(n.getString(a)),l=n.getBits(u);p._createFileDt(c,s,l),r.push({name:s,options:{keyPath:"key"}})}p.seIndexDB&&0<r.length?p.seIndexDB.createStores(r).then(function(){h()}):h()}).catch(function(t){console.log(t),e()})}else h()})}},{key:"_createFileDt",value:function(t,n,e){var i=this,r=new vS(n);r.seIndexDB=this.seIndexDB,r.dtId=n,r.load(e);var o=!1;this.fileDataList||(this.fileDataList=[]),t.forEach(function(t){if(t.bRequest&&t.dataset_id===n)if(t.itemFilter){var e=r.clone();e.name=n+"_"+t.layer_id,e.layerIds=[t.layer_id],i.fileDataList.push(e)}else r.layerIds.push(t.layer_id),o||(i.fileDataList.push(r),o=!0)})}},{key:"requestDtsIndex",value:function(n){return new Promise(function(e,t){ut("queryPV",{data:{cmd:"getindex",dataset_list:n},dataType:"arraybuffer",success:function(t){e(t)},error:function(){t()}})})}},{key:"requestFileData",value:function(s,a,t){var u=this;return new Promise(function(n,e){if(t&&0!==t.length){var i=[],r=[];t.forEach(function(t){var e=t.dataset_id;t.itemFilter&&(e+="_"+t.layer_id),-1===i.indexOf(e)&&(t.name=e,r.push(t),i.push(e))});var o=(new Date).getTime();u._getFromIndexDB(s,a,r).then(function(){var t=(new Date).getTime();console.log("getFromIndexDB："+(t-o));var e=u._getRequestParam(s,a,r);u.requestDtsShapes(e).then(function(){n()})}).catch(function(t){e(t)})}else n()})}},{key:"_getFromIndexDB",value:function(i,r,t){var o=this;if(!t||0===t.length)return Promise.resolve();var s=[];return t.forEach(function(t){var e=t.name,n=o.getFileDatasetByName(e);n&&s.push(n.getFromIndexDB(i,r))}),Promise.all(s)}},{key:"_getRequestParam",value:function(l,h,t){var c=this,p=[];return t.forEach(function(t){var e=t.name,n=c.getFileDatasetByName(e);if(n)if(n.subItems&&0<Object.keys(n.subItems).length){var i=n.subItems;for(var r in i){var o=i[r].getPacks(l,h),s={dataset_id:t.dataset_id,dataset_ver:t.pvVersion,item:r,filter:t.itemFilter,layer_id:t.layer_id,data_list:o};s.data_list&&0<s.data_list.length&&p.push(s)}}else{var a=n.getPacks(l,h),u={dataset_id:t.dataset_id,dataset_ver:t.pvVersion,item:"",filter:t.itemFilter,layer_id:t.layer_id,data_list:a};u.data_list&&0<u.data_list.length&&p.push(u)}}),p}},{key:"requestDtsShapes",value:function(e){var f=this;return new Promise(function(p,t){e&&0!==e.length?ut("queryPV",{data:{cmd:"getshapes",dataset_list:e},dataType:"arraybuffer",success:function(t){for(var e=new DataView(t),n=new Tb(e),i=n.getInt32(),r=0;r<i;r++){var o=n.getInt8(),s=(n.getString(o),n.getInt32()),a=n.getInt8(),u=n.getString(a),l=n.getInt32(),h=n.getBits(l),c=f.getFileDatasetByLayerId(s);c&&c.decode_data_subItem(u,h)}p()},error:function(){t()}}):p()})}},{key:"clearLocalData",value:function(e,n){!this.fileDataList&&0===this.fileDataList.length||this.fileDataList.forEach(function(t){t&&t.clearLocalData(e,n)})}},{key:"deleteFileDataByDtId",value:function(i){var r=this;return new Promise(function(t){if(i&&0!==i.length&&r.fileDataList&&0!==r.fileDataList.length){for(var e=r.fileDataList.length-1;0<=e;e--){var n=r.fileDataList[e].dtId;-1!==i.indexOf(n)&&r.fileDataList.splice(e,1)}r.seIndexDB?r.seIndexDB.deleteStores(i).then(function(){t()}):t()}else t()})}}]),IS);function IS(t){h(this,IS),this.options=S_.extend({},xS,t),this.seIndexDB=null,this.options.useIndexDB&&this.initIndexDB(),this.fileDataList=[]}var LS=fS.extend({initialize:function(t){fS.prototype.initialize.call(this,t),this._hasRequestIndex=!1},onAdd:function(t){t.addLayer(this.renderer),t.addLayer(this._seSelectionLayer);var e=this.getLayers(!0);this.addToFileData(e)},onRemove:function(){fS.prototype.onRemove.call(this)},addToFileData:function(t){var e=this;if(t&&0!==t.length){for(var n=t.length,i=[],r=0;r<n;r++){var o=t[r];if(o&&o.getDataset()){var s=o.getDataset(),a={dataset_id:s.getID(),dataset_ver:s.getVersion(),pvVersion:s.getPvVersion(),layer_id:o.getID(),itemFilter:o.getItemFilter()};i.push(a)}}this._map.seManager.getFileDataManager().addLayers(i).then(function(){e._hasRequestIndex=!0,e.update()}).catch(function(t){console.log(t)})}},requestData:function(){var r=this;if(this._hasRequestIndex)if(this._clearDtData(),this._layers&&0!==this._layers.length){for(var t=this._map.getSize(),e=this._map.getBounds(),o=t.x/(e.getEast()-e.getWest()),n=this._layers.length,s=[],i=this._map.getScale(),a=0;a<n;a++){var u=this._layers[a];u&&u.getRequestObj(s,i)}if(0!==s.length){var l=new Wb({left:e.getWest(),right:e.getEast(),bottom:e.getSouth(),top:e.getNorth()}),h=this._map.seManager.getFileDataManager(),c=(new Date).getTime();h.requestFileData(l,o,s).then(function(){var t=(new Date).getTime();r._updateData(l,o,s);var e=(new Date).getTime();r._avoid();var n=(new Date).getTime();r.draw();var i=(new Date).getTime();h.clearLocalData(l,o),console.log("请求解析数据："+(t-c)),console.log("同步数据："+(e-t)),console.log("避让："+(n-e)),console.log("绘制："+(i-n)),console.log("总时间："+(i-c))}).catch(function(t){console.log(t)})}else this.clearRenderer()}else this.clearRenderer()},_updateData:function(s,a,t){var u=this;if(t&&0!==t.length){var l=this._map.seManager.getFileDataManager(),h={};t.forEach(function(t){var e=t.dataset_id;t.itemFilter&&(e+="_"+t.layer_id),h[e]||(h[e]=[]),h[e].push(t.layer_id)});var e=function(t){var e=l.getFileDatasetByName(t);if(!e)return"continue";var n=h[t],i=u.getLayerById(n[0]).getDataset(),r=e.query(s,a),o=u._fileDataToFeatures(r,e.dtType,e.fieldNames,i);if(!o||0===o.length)return{v:void 0};n.forEach(function(t,e){var n=!0;0===e&&(n=!1),u.getLayerById(t).updateFileData(o,n)})};for(var n in h){var i=e(n);switch(i){case"continue":continue;default:if("object"===(void 0===i?"undefined":g(i)))return i.v}}}},_fileDataToFeatures:function(t,n,i,r){var o=this;if(!t||0===t.length)return null;var s=[];return t.forEach(function(t){var e=o._featureObjToFeature(t,n,i);e&&(e.setProjInfo(r.getProjInfo()),s.push(e))}),s},_featureObjToFeature:function(t,n,e){var i=null,r=t.fieldValues,o={};if(e&&0<e.length&&r&&e.length===r.length)for(var s=r.length,a=0;a<s;a++){var u=e[a],l=r[a];o[u]=l}var h=t.pointList,c=t.clockWise,p=t.id,f=[],d=null;switch(h.forEach(function(t,e){(!d||n===Xb&&c[e])&&(d={mapPoints:[],polyCount:[],subCount:0,id:p,properties:o},f.push(d)),d.polyCount.push(t.length),d.subCount++,t.forEach(function(t){d.mapPoints.push(t)})}),n){case Yb:i=new N_(f[0]);break;case Hb:i=new O_(f[0]);break;case Xb:if(1===f.length)i=new T_(f[0]);else{var g=[];f.forEach(function(t){g.push(new T_(t))}),(i=new k_({id:p,properties:o})).setPolygons(g)}}return i},refresh:function(){var e=this,t=this.getLayers(!0);if(t&&0!==t.length){var s={},i=[];t.forEach(function(t){if(t&&t.getDataset()){var e=t.getDataset(),n=e.getID();s[n]?s[n].layers.push(t):(s[n]={layers:[t],pvVersion:e.getPvVersion()},i.push(n))}});var n=this._map.seManager,a=n.getFileDataManager();n.getDtInfos(i,{success:function(t){if(t&&0!==t.length){var r=[],o=[];t.forEach(function(t){var e=t.data_id,n=t.pv_info.pv_version,i=s[e];i.pvVersion!==n&&(o.push(e),i.layers.forEach(function(t){t.getDataset().setPvVersion(n),r.push(t)}))}),0<o.length?a.deleteFileDataByDtId(o).then(function(){e.addToFileData(r)}).catch(function(t){console.log(t)}):e.update()}}})}else this.update()}}),wS=B.Evented.extend({options:{serviceUrl:"",token:"",firstDataZoom:10,selectSetting:{tolerance:6,color:new _m(0,255,255,255),bQueryAll:!1,highlightColor:new _m(0,128,0,255)}},initialize:function(t,e){if(B.setOptions(this,e),!t)throw new Error("init SeManager error");this._map=t,tt({serviceUrl:(this._map.seManager=this).options.serviceUrl,token:this.options.token}),this.config=$,this._initPanes(),this._actionManager=new ML(this._map),this._vectorServices=null,this._activeVectorService=null,this._editManager=new yS(this._map),this._identifyHighlightLayer=new dS,this._map.addLayer(this._identifyHighlightLayer),this._fileDataManager=new ES,this.datasets=[]},_initPanes:function(){var t=this._map.createPane(Lb);this._map.createPane(wb,t),this._map.createPane(Sb,t),this._map.createPane(Mb,t),this._map.createPane(Cb,t)},setSelectSetting:function(t){if(t)for(var e in t)this.options.selectSetting[e]=t[e]},getSelectSetting:function(){return this.options.selectSetting},setActiveVectorService:function(t){this._activeVectorService=t},getActiveVectorService:function(){var t=this._activeVectorService;if(!t){var e=this.getVectorServiceList();e&&0<e.length?t=e[0]:(t=new fS,this._map.addLayer(t),this._vectorServices=[t])}return t},hasVectorService:function(t){return!!this.getVectorServiceById(t)},addVectorService:function(i,r){var o=this;r=r||{};function e(t){r.error&&r.error(t)}var s=null;this.getVectorServiceById(i)?e("服务已存在"):new Promise(function(t,e){o._requestMapContent(i,{success:t,error:e})}).then(function(t){var n=t.dataset_list;return s=t,new Promise(function(t,e){o.getDtInfos(n,{success:t,error:e})})}).then(function(t){if(t&&!o.getVectorServiceById(i)){s.dataset_list=t;var e=null;if((e=r.isPV?new LS:new fS).readJson(s),o._map.addLayer(e),o._vectorServices||(o._vectorServices=[]),o._vectorServices.unshift(e),r.bfitBounds){var n=e.getLatLngBounds();n&&o._map.fitBounds(n)}r.success&&r.success(e)}}).catch(function(t){e(t)})},_requestMapContent:function(t,e){t&&(e=e||{},ut("getMap",{data:{id:t},success:function(t){t.status!==st.SUCCESS?e.error&&e.error("getMapContent error"):e.success&&e.success(t.result)},error:function(){e.error&&e.error("getMapContent error")}}))},getDtInfos:function(t,e){t&&0!==t.length?ut("datasetInfo",{data:{dataset_ids:t},success:function(t){t.status!==st.SUCCESS?e.error&&e.error("getDtInfos error"):e.success&&e.success(t.result.item)},error:function(){e.error&&e.error("getDtInfos error")}}):e.success&&e.success([])},getVectorServiceById:function(t){if(!this._vectorServices||0===this._vectorServices.length)return null;for(var e=this._vectorServices.length,n=0;n<e;n++){var i=this._vectorServices[n];if(i&&i.id===t)return i}return null},getVectorServiceByLayerId:function(t){if(!this._vectorServices||0===this._vectorServices.length)return null;for(var e=this._vectorServices.length,n=0;n<e;n++){var i=this._vectorServices[n];if(i)if(i.getLayerById(t))return i}return null},removeVectorService:function(t){var e=this.getVectorServiceById(t);if(e){var n=this._vectorServices.indexOf(e);-1!==n&&(this._map.removeLayer(e),this._vectorServices.splice(n,1))}},removeAllVectorService:function(){var e=this;this._vectorServices&&0!==this._vectorServices.length&&(this._vectorServices.forEach(function(t){e._map.removeLayer(t)}),this._vectorServices=null)},getVectorServiceList:function(){if(!this._vectorServices||0===this._vectorServices.length)return null;var t=this._vectorServices.slice(0);return 2<=t.length&&t.sort(function(t,e){return e.getZIndex()-t.getZIndex()}),t},addDtData:function(n,r){var u=this;return!(!n||0===n.length)&&(r=r||{},new Promise(function(t,e){u.getDtInfos(n,{success:t,error:e})}).then(function(t){if(t&&t.length){var o=!1,e=u.getActiveVectorService();e.getLayers()&&0!==e.getLayers().length||(o=!0);var s=null,a=[];if(t.forEach(function(t){var e=new Db;e.readJson(t),a.push(e);var n=e.getBounds();if(o&&n.isValid()){var i=n.toLatLngBounds(e.getProjInfo()),r=I_.createFromLatLngBounds(i);s?s.add(r):s=r}}),e.addDts(a),o&&s){var n=s.toLatLngBounds();if(n){var i=n.getCenter();u._map.setView(i,u.options.firstDataZoom)}}e.update(),r.success&&r.success()}}).catch(function(t){r.error&&r.error(t)}),!0)},saveVectorService:function(e,n){if(!e)return!1;var i=(n=n||{}).data||{},t=!1;(e.isNew()||i.bAsNewService)&&(t=!0);var r=e.toJson(),o="";return o=t?"saveMap":(r.id=e.id,"updateMap"),i&&(i.name&&(r.name=i.name),void 0!==i.bPublic&&(r.public=i.bPublic?1:0)),ut(o,{data:r,success:function(t){t.status===st.SUCCESS?(e.id=t.result.data_id,i&&(i.name&&e.setName(i.name),void 0!==i.bPublic&&e.setIsPublic(i.bPublic)),n.success&&n.success("saveVectorService success")):n.error&&n.error("saveVectorService error")},error:function(){n.error&&n.error("saveVectorService error")}}),!0},clearSelection:function(){this._vectorServices&&0!==this._vectorServices.length&&this._vectorServices.forEach(function(t){t&&t.clearSelection()})},clearMeasure:function(){this._actionManager.clearMeasure()},refresh:function(){this._map.setView(this._map.getCenter(),this._map.getZoom())},getLayerById:function(t){if(!this._vectorServices||0===this._vectorServices.length)return null;for(var e=this._vectorServices.length,n=0;n<e;n++){var i=this._vectorServices[n];if(i){var r=i.getLayerById(t);if(r)return r}}return null},getVectorLayers:function(n){var t=this.getVectorServiceList();if(!t||0===t.length)return null;var i=[];return t.forEach(function(t){if(t){var e=t.getLayers(n);e&&0<e.length&&(i=i.concat(e))}}),i},drawSelection:function(){this._vectorServices&&0!==this._vectorServices.length&&this._vectorServices.forEach(function(t){t.drawSelection()})},getSelections:function(){var t=this.getVectorServiceList();if(!t||0===t.length)return null;var n=[];return t.forEach(function(t){if(t){var e=t.getSelections();e&&0<e.length&&(n=n.concat(e))}}),n},removeSelectionByLayerId:function(e){var t=this.getVectorServiceList();if(!t||0===t.length)return null;var n=0;return t.forEach(function(t){t&&t.removeSelectionByLayerId(e)&&n++}),!!n},setAction:function(t,e){this._actionManager.setAction(t,e)},getAction:function(){return this._actionManager.getAction()},showIdentifyFeatures:function(t){t&&0!==t.length&&this._identifyHighlightLayer.setFeatures(t)},removeLayer:function(t){var e=this.getVectorServiceByLayerId(t);return!!e&&e.removeLayer(t)},getEditManager:function(){return this._editManager},setEditLayer:function(t){return this._editManager.setEditLayer(t)},getEditLayer:function(){return this._editManager.getEditLayer()},getLayersByDtId:function(n){var t=this._vectorServices;if(!t||0===t.length)return null;var i=[];return t.forEach(function(t){if(t){var e=t.getLayersByDtId(n);e&&0<e.length&&(i=i.concat(e))}}),i},getFileDataManager:function(){return this._fileDataManager}});wS.include({addDtDataForCloudExt:function(c,r){var p=this;r=r||{};var n=[];c&&c.forEach(function(t){n.push(t.id)}),new Promise(function(t,e){p.getDtInfosForCloud(n,{success:t,error:e})}).then(function(t){if(t&&t.length){var a=!1,e=p.getActiveVectorService();e.getLayers()&&0!==e.getLayers().length||(a=!0);var u=null,l=[],h=c?c.length:0;if(t.forEach(function(t){var e=new fI;e.readJson(t);var n=e.clone();p._map&&p._map.addDataset(n);for(var i=0;i<h;i++)if(c[i].id==e.getID()){e.color=c[i].color;break}l.push(e);var r=e.getBounds();if(a&&r.isValid()){var o=r.toLatLngBounds(e.getProjInfo()),s=I_.createFromLatLngBounds(o);u?u.add(s):u=s}}),e.addDts(l),a&&u){var n=u.toLatLngBounds();if(n){var i=n.getCenter();p._map.setView(i,p.options.firstDataZoom)}}e.update(),r.success&&r.success()}}).catch(function(t){r.error&&r.error(t)})},addDtDataForCloud:function(n,i){var l=this;i=i||{},new Promise(function(t,e){l.getDtInfosForCloud(n,{success:t,error:e})}).then(function(t){if(t&&t.length){var s=!1,e=l.getActiveVectorService();e.getLayers()&&0!==e.getLayers().length||(s=!0);var a=null,u=[];if(t.forEach(function(t){var e=new fI;e.readJson(t),u.push(e);var n=e.clone();l._map&&l._map.addDataset(n);var i=e.getBounds();if(s&&i.isValid()){var r=i.toLatLngBounds(e.getProjInfo()),o=I_.createFromLatLngBounds(r);a?a.add(o):a=o}}),e.addDts(u),s&&a){var n=a.toLatLngBounds();if(n){n.getCenter();l._map.fitBounds(n)}}e.update(),i.success&&i.success()}}).catch(function(t){i.error&&i.error(t)})},getDtInfosForCloud:function(t,n){t&&0!==t.length?ut("datasetList",{isCloudVer:this._map.options.isCloudVer,data:{method:"select",data:t},success:function(t){if(t.status!==st.SUCCESS_CLOUD)n.error&&n.error("getDtInfosForCloud error");else if(n.success){var e=t.result?t.result:[];n.success(e)}},error:function(){n.error&&n.error("getDtInfosForCloud error")}}):n.success&&n.success([])},changePage:function(t){var e=this.getActiveVectorService();(null==t||null==t||t<=0)&&(t=1),e&&e.refresh({page:t,isChangePageMode:!0})}});var SS=Object.freeze({createBuffer:function(t,e,n){return E_.buffer(t,e,n)}}),MS=1,CS=2,PS=3,NS=4,OS=5,TS=6,kS=7,RS=8,DS=9,AS=10,FS=11,BS=12,GS=13,US=14,jS=15,qS=16,zS=17,VS=B.Control.extend({options:{position:"topright",className:"",tipsCallBack:null,editInfoClick:null,finishEditClick:null,barList:[{name:MS,title:"绘制点",fontClass:"icon-drawPoint",showTypes:[Mm.POINT],isVisible:!0},{name:CS,title:"绘制线",fontClass:"icon-drawLine",showTypes:[Mm.LINE],isVisible:!0},{name:PS,title:"绘制面",fontClass:"icon-drawPolygon",showTypes:[Mm.POLYGON],isVisible:!0},{name:NS,title:"手绘线",fontClass:"icon-handDraw",showTypes:[Mm.LINE],isVisible:!1},{name:OS,title:"手绘面",fontClass:"icon-handDraw",showTypes:[Mm.POLYGON],isVisible:!1},{name:TS,title:"绘制矩形",fontClass:"icon-drawRect",showTypes:[Mm.LINE,Mm.POLYGON],isVisible:!1},{name:kS,title:"绘制圆",fontClass:"icon-drawCricle",showTypes:[Mm.LINE,Mm.POLYGON],isVisible:!1},{name:RS,title:"绘制椭圆",fontClass:"icon-drawEllipse",showTypes:[Mm.LINE,Mm.POLYGON],isVisible:!1},{name:DS,title:"移动图元",fontClass:"icon-move",showTypes:[Mm.POINT,Mm.LINE,Mm.POLYGON],isVisible:!0},{name:AS,title:"旋转图元",fontClass:"icon-rotate",showTypes:[Mm.LINE,Mm.POLYGON],isVisible:!0},{name:FS,title:"增加节点",fontClass:"icon-addGraphic",showTypes:[Mm.LINE,Mm.POLYGON],isVisible:!0},{name:BS,title:"修改节点",fontClass:"icon-editGraphic",showTypes:[Mm.LINE,Mm.POLYGON],isVisible:!0},{name:GS,title:"分割线",fontClass:"clipLine",showTypes:[Mm.LINE],isVisible:!0},{name:US,title:"分割面",fontClass:"clipPolygon",showTypes:[Mm.POLYGON],isVisible:!0},{name:jS,title:"删除图元",fontClass:"icon-deleteGraphic",showTypes:[Mm.POINT,Mm.LINE,Mm.POLYGON],isVisible:!0},{name:qS,title:"修改属性",fontClass:"icon-editInfo",showTypes:[Mm.POINT,Mm.LINE,Mm.POLYGON],isVisible:!0},{name:zS,title:"结束编辑",fontClass:"icon-finishEdit",showTypes:[Mm.POINT,Mm.LINE,Mm.POLYGON],isVisible:!0}]},onAdd:function(){var t="seEditControl "+this.options.className,e=B.DomUtil.create("div","leaflet-bar "+t);return this._container=e,this._container.style.display="none",this._map.seManager.getEditManager().on("editTip",this.tipsCallBack,this),e},onRemove:function(){this._map.seManager.getEditManager().off("editTip",this.tipsCallBack,this),B.Control.prototype.onRemove.call(this)},tipsCallBack:function(t){var e=t.tip;this.options.tipsCallBack&&this.options.tipsCallBack(e)},setEditLayer:function(t){if(!t||!this._map)return!1;var e=this._map.seManager.setEditLayer(t);return e&&this.show(),e},show:function(){var i=this;if(this._map){this._container.innerHTML="";var t=this._map.seManager.getEditManager().getEditLayer();if(t&&t.getDataset()){this._container.style.display="block";var r=t.getDataset().getType();this.options.barList.forEach(function(e){var t=e.showTypes;if(t&&-1!==t.indexOf(r)&&e.isVisible){var n=document.createElement("span");n.id="se-bar-"+e.name,n.className=e.fontClass+" se-bar-foot",n.title=e.title,B.DomEvent.on(n,"mousedown dblclick",B.DomEvent.stopPropagation).on(n,"click",B.DomEvent.stopPropagation).on(n,"click",B.DomEvent.stop).on(n,"click",function(t){i.barClick(t,e)}),i._container.appendChild(n)}})}else this.tipsCallBack(II)}},hide:function(){this._container.innerHTML="",this._container.style.display="none"},barClick:function(t,e){var n=this._map.seManager,i=n.getEditManager(),r=i.getEditLayer();if(r&&r.getDataset()){var o=r.getDataset();switch(e.name){case MS:n.setAction(yI.CREATE_POINT);break;case CS:n.setAction(yI.CREATE_POLYLINE);break;case NS:n.setAction(yI.CREATE_HAND_LINE);break;case PS:n.setAction(yI.CREATE_POLYGON);break;case OS:n.setAction(yI.CREATE_HAND_POLYGON);break;case TS:o.getType()===Sm.LINE||o.getType()===Mm.LINE?n.setAction(yI.CREATE_RECT):o.getType()!==Sm.POLYGON&&o.getType()!==Mm.POLYGON||n.setAction(yI.CREATE_FILL_RECT);break;case kS:o.getType()===Sm.LINE||o.getType()===Mm.LINE?n.setAction(yI.CREATE_CIRCLE):o.getType()!==Sm.POLYGON&&o.getType()!==Mm.POLYGON||n.setAction(yI.CREATE_FILL_CIRCLE);break;case RS:o.getType()===Sm.LINE||o.getType()===Mm.LINE?n.setAction(yI.CREATE_ELLIPSE):o.getType()!==Sm.POLYGON&&o.getType()!==Mm.POLYGON||n.setAction(yI.CREATE_FILL_ELLIPSE);break;case jS:var s=i.getCurrentEditFeatures();this._map.fire("delete_features",{features:s});break;case FS:n.setAction(yI.ADD_NODE);break;case BS:n.setAction(yI.EDIT_NODE);break;case GS:n.setAction(yI.CLIP_LINE);break;case US:n.setAction(yI.CLIP_POLYGON);break;case AS:n.setAction(yI.ROTATE);break;case DS:n.setAction(yI.MOVE);break;case qS:this.options.editInfoClick&&this.options.editInfoClick();break;case zS:i.finishEdit(),this.hide(),this.options.finishEditClick&&this.options.finishEditClick()}}}}),YS=1,HS=2,XS=3,JS=4,WS=5,KS=6,ZS=7,QS=8,$S=9,tM=10,eM=B.Control.extend({options:{position:"topleft",className:"",identifyEnd:null,barList:[{name:YS,title:"平移",fontClass:"icon-translation"},{name:HS,title:"点选",fontClass:"icon-point"},{name:XS,title:"框选",fontClass:"icon-rectangle"},{name:JS,title:"圈选",fontClass:"icon-circle"},{name:WS,title:"多边形选",fontClass:"icon-polygon"},{name:tM,title:"图元识别",fontClass:"icon-property"},{name:KS,title:"测距",fontClass:"icon-measureDistance"},{name:ZS,title:"测面积",fontClass:"icon-measureSurface"},{name:QS,title:"全幅显示",fontClass:"icon-full"},{name:$S,title:"清除",fontClass:"icon-clear"}]},onAdd:function(){var n=this,t="seToolControl "+this.options.className,e=B.DomUtil.create("div","leaflet-bar "+t);return this._container=e,this.options.barList.forEach(function(e){var t=document.createElement("span");t.id="se-toolbar-"+e.name,t.className=e.fontClass+" se-bar-foot",t.title=e.title,B.DomEvent.on(t,"mousedown dblclick",B.DomEvent.stopPropagation).on(t,"click",B.DomEvent.stopPropagation).on(t,"click",B.DomEvent.stop).on(t,"click",function(t){n.barClick(t,e)}),n._container.appendChild(t)}),this._map.seManager.on("identify_end",this.identifyEnd,this),e},onRemove:function(){this._map&&this._map.seManager.off("identify_end",this.identifyEnd,this);B.Control.prototype.onRemove.call(this)},identifyEnd:function(t){this.options.identifyEnd&&this.options.identifyEnd(t.data)},barClick:function(t,e){var n=this._map.seManager;switch(e.name){case YS:n.setAction(yI.PAN);break;case HS:n.setAction(yI.SELECT_BY_POINT);break;case XS:n.setAction(yI.SELECT_BY_RECT);break;case JS:n.setAction(yI.SELECT_BY_CIRCLE);break;case WS:n.setAction(yI.SELECT_BY_POLYGON);break;case tM:n.setAction(yI.IDENTIFY);break;case KS:n.setAction(yI.MEASURE_DISTANCE);break;case ZS:n.setAction(yI.MEASURE_AREA);break;case QS:var i=n.getActiveVectorService();if(i&&i.getMaxBounds()){var r=i.getMaxBounds().toLatLngBounds(i.getProjInfo());this._map.fitBounds(r)}break;case $S:n.clearSelection(),n.clearMeasure()}}}),nM=B.Control.extend({options:{position:"bottomright",mousePosShow:!0,zoomShow:!0,scaleShow:!0},getEvents:function(){return{moveend:this._change,viewreset:this._change,mousemove:this._onMouseMove}},onAdd:function(t){this._container=B.DomUtil.create("div","leaflet-control-infoControl"),B.DomEvent&&B.DomEvent.disableClickPropagation(this._container);var e=this.getEvents();return t.on(e,this),this._mousePosPane=B.DomUtil.create("span"),this._zoomInfoPane=B.DomUtil.create("span"),this._scaleInfoPane=B.DomUtil.create("span"),this.options.mousePosShow||(this._mousePosPane.style.display="none"),this.options.zoomShow||(this._zoomInfoPane.style.display="none"),this.options.scaleShow||(this._scaleInfoPane.style.display="none"),this._container.appendChild(this._mousePosPane),this._container.appendChild(this._zoomInfoPane),this._container.appendChild(this._scaleInfoPane),this._change(),this._container},onRemove:function(){if(B.Control.prototype.onRemove.call(this),this._map){var t=this.getEvents();this._map.off(t,this)}},_change:function(){var t=this._map.getZoom();this._zoomInfoPane.innerHTML="Level："+t;var e=this._map.getScale();this._scaleInfoPane.innerHTML="Scale：1:"+e},_onMouseMove:function(t){var e=t.latlng,n=e.lng.toFixed(4),i=e.lat.toFixed(4);this._mousePosPane.innerHTML="X："+n+"&nbsp;&nbsp;&nbsp;Y："+i}});B.Map.mergeOptions({infoControl:!1}),B.Map.addInitHook(function(){this.options.infoControl&&(new nM).addTo(this)});var iM={Ajax:vt,QGIS:Object.freeze({SeAction:yI,SeManager:wS,LayerType:dI,DatasetType:Sm,QueryType:lt,DataType:Pb,FeatureType:M_,RenderStyleType:km,EditAction:C_,UtilTool:S_,SeFeature:P_,SeSelection:xI,SeAnalysis:SS,SeEditControl:VS,SeTempLayer:LL,VectorService:fS,SePointFeature:N_,SePolylineFeature:O_,SePolygonFeature:T_,SeMultiPolygonFeature:k_,MouseStyle:_I,COverlapModel:TL,simple_state_value:Cm,RenderTextStyle:nv,MarkerLabelPos:hv,SeToolControl:eM,SeDataset:Db,SeFieldInfo:Nb,InfoControl:nM,CloudDatasetType:Mm,SeCloudDataset:fI,SeBounds:I_}),SymbolLib:aS};window.L=B.extend({},B,Q,iM)});
