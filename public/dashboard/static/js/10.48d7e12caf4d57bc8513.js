webpackJsonp([10],{"7MXk":function(t,e){},"AX/y":function(t,e){},CvP7:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("4YfN"),a=s.n(i),n=s("RuWt"),r=(s("tIHl"),s("spot")),l=s("deIM"),o=s("TPXC"),c=s("bYIx"),f=s("T452"),u=s("Izdj"),h={components:{Dialog:l.a,CsPage:o.a},mixins:[u.a],data:function(){return{tableHeight:0,visible:!1,map:null,title:"数据预览",bSwitchMap:!0,columns:[],pageSize:5*n.y,total:0,current:1,list:[],fields:[],dtId:null}},computed:{},watch:{totalHeight:function(t){this.tableHeight=t>0?t-113:0}},methods:{clear:function(){this.dtId=null,this.title="数据预览",this.bSwitchMap=!0,this.columns=[],this.total=0,this.current=1,this.list=[],this.fields=[]},handleClose:function(){this.clear(),this.tableHeight=0,this.map&&this.map.remove(),this.map=null,this.offResize&&this.offResize(),this.visible=!1,this.$emit("vtp-close")},show:function(t){var e=this;this.clear(),this.onResize&&this.onResize(),this.dtId=t;var s={id:t,success:function(s){var i=s||{},a=i.bounds,n=void 0===a?null:a,r=i.srs,l=void 0===r?null:r,o=(i.type,i.name),u=void 0===o?null:o;e.title=u?"【"+u+"】数据预览":"数据预览";e.map=new zcloud.Map({container:"map",attributionControl:!0,zoom:5,maxZoom:20,minZoom:0,center:[116.5007,39.8545],style:{version:8,id:"vt-pre",name:"vt-pre",sources:{},layers:[{id:"background",type:"background",layout:{},paint:{"background-color":"rgb(0,0,0)"}}]},hash:!1}),e.map.showTileBoundaries=!1;var h=new zcloud.NavigationControl({showCompass:!0,showZoom:!0,visualizePitch:!0});e.map.addControl(h,"top-right"),e.map.on("load",function(){var s=Object(f.a)("rasters/"+t+"/tile/{z}/{x}/{y}.jpg",!0),i={id:u,type:"raster",source:{type:"raster",tiles:[s],maxzoom:20,minzoom:0,tileSize:256}};if(n){var a=null,r=l||{},o=r.srid,h=void 0===o?4326:o,p=r.wkt;if(4326!=h)a=[Object(c.a)(p).inverse([n.min_x,n.min_y]),Object(c.a)(p).inverse([n.max_x,n.max_y])];else a=[[n.min_x,n.min_y],[n.max_x,n.max_y]];e.map.fitBounds(a)}e.map.addLayer(i)})}};this.$http.getRasterDetailByID(s),this.visible=!0},handlePageSizeChange:function(t){this.current=1,this.pageSize=t,this.queryAttributes(this.dtId,this.fields,this.pageSize,this.current)},handleChangePage:function(t){this.current=t,this.queryAttributes(this.dtId,this.fields,this.pageSize,this.current)},queryAttributes:function(t,e,s,i){var a=this,n={params:{id:t,query:{fields:e||[]},page:i,page_size:s},success:function(t){var e=t=t||{},s=(e.fields,e.rows),i=void 0===s?[]:s,n=e.total,r=void 0===n?0:n;a.list=i,a.total=r}};this.$http.getAttributesByDtID(n)}}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{staticClass:"cus-view",attrs:{isShowBottomBtn:!1,fullscreen:!0,title:t.title,visible:t.visible,showStep:!1},on:{cus_cancel:t.handleClose}},[s("div",{staticClass:"v-t-d-containter"},[s("div",{style:{zIndex:t.bSwitchMap?10:0},attrs:{id:"map"}}),t._v(" "),s("div",{staticClass:"attrs-containter",style:{zIndex:t.bSwitchMap?0:10}},[s("Table",{staticClass:"cus-view",attrs:{border:"",columns:t.columns,data:t.list,height:t.tableHeight}}),t._v(" "),s("Row",{staticClass:"cus-view",staticStyle:{"padding-top":"16px"},attrs:{type:"flex",justify:"end",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("CsPage",{attrs:{current:t.current,"page-size":t.pageSize,total:t.total},on:{"on-page-size-change":t.handlePageSizeChange,"on-change":t.handleChangePage}})],1)],1)],1),t._v(" "),s("div",{staticClass:"r-t-containter",style:{right:t.bSwitchMap?"20px":"0px",bottom:t.bSwitchMap?"20px":"0px"}},[s("span",{class:[t.bSwitchMap?"":"view-select"],on:{click:function(e){t.bSwitchMap=!1}}},[s("i",{staticClass:"iconfont iconbiaoge"})]),t._v(" "),s("span",{class:[t.bSwitchMap?"view-select":""],on:{click:function(e){t.bSwitchMap=!0}}},[s("i",{staticClass:"iconfont icongonggongditu"})])])])])},staticRenderFns:[]};var d=s("C7Lr")(h,p,!1,function(t){s("AX/y")},"data-v-0bcfeb31",null).exports,m=s("oFuF"),g=s("h72K"),v=s("bSIt"),y={components:{ImportDialog:r.a,CsPage:o.a,RasterPreview:d},mixins:[g.a],data:function(){return{isNoData:!1,noDataImg:n.t,columns:[{title:"名称",key:"name",slot:"name",className:"table-header-text-default"},{title:"文件大小MB",key:"file_size",slot:"file_size",width:150,className:"table-header-text-default"},{title:"坐标系",key:"srid",slot:"srid",width:120,className:"table-header-text-default"},{title:"金字塔",key:"levels",slot:"levels",width:120,className:"table-header-text-default"},{title:"创建日期",key:"create_time",width:200,className:"table-header-text-default"},{title:"操作",slot:"action",align:"left",width:200,className:"table-header-text-default"}],list:[],key:"",current:1,pageSize:5*n.y,total:0,orderBy:n.x.DESC,fieldOrder:n.i.CREATE_TIME}},computed:a()({isDesc:function(){return this.orderBy==n.x.DESC}},Object(v.b)(["host"])),mounted:function(){this.clear(),this.queryDatasets(this.key,this.pageSize,this.current)},methods:{getFileSize:m.a.getFileSize,getDatasetTypeLabel:m.a.getDatasetTypeLabel,clear:function(){this.list=[],this.key="",this.current=1,this.pageSize=5*n.y,this.total=0},handleOrderByClick:function(){this.orderBy==n.x.DESC?this.orderBy=n.x.ASC:this.orderBy=n.x.DESC,this.queryDatasets(this.key,this.pageSize,this.current)},handleSearch:function(){this.current=1,this.queryDatasets(this.key,this.pageSize,this.current)},handleImport:function(){this.$refs.importDialog&&this.$refs.importDialog.show()},handlePageSizeChange:function(t){this.pageSize=t,this.current=1,this.queryDatasets(this.key,this.pageSize,this.current)},handleChangePage:function(t){this.current=t,this.queryDatasets(this.key,this.pageSize,this.current)},queryDatasets:function(t,e,s){var i=this,a={params:{key:t,page_size:e,page:s,sortby:this.fieldOrder,order:this.orderBy},success:function(t){t=t||{},i.total=t.total?t.total:0,i.total=t.total?t.total:0;var e=t.rows?t.rows:[];i.list=e}};this.$http.searchRasterDatasetsByKey(a)},handleEditClick:function(t){window.open(this.host+"/apps/edit/vector?id="+t.id)},handleDeleteClick:function(t){var e=this,s=m.a.getDeleteContent(t.name);this.$Modal.confirm({title:"提示",content:s,width:400,onOk:function(){var s={id:t.id,success:function(t){t&&(e.current=e.computPageNum(e.total,e.pageSize,e.current,1),e.$bus.$emit(n.k.RASTER_STATISTICS),e.queryDatasets(e.key,e.pageSize,e.current))}};e.$http.deleteRasterByID(s)}})},handlePreviewClick:function(t){this.offResize&&this.offResize(),this.$refs.rtPreview.show(t.id)},handleVtpClose:function(){this.onResize&&this.onResize()},handleRefrsh:function(){this.queryDatasets(this.key,this.pageSize,this.current)}}},S={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{width:"100%",height:"100%"}},[s("div",{staticClass:"right-body"},[s("Row",{staticClass:"cus-view-search right-subject-item",attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"20"}},[s("Input",{staticStyle:{width:"250px"},attrs:{search:"",placeholder:"搜索",suffix:"ios-search"},on:{"on-enter":t.handleSearch,"on-search":t.handleSearch},model:{value:t.key,callback:function(e){t.key="string"==typeof e?e.trim():e},expression:"key"}}),t._v(" "),s("span",{staticClass:"content-text-default span-split",staticStyle:{"font-size":"14px","margin-left":"10px"},on:{click:function(e){return e.stopPropagation(),t.handleOrderByClick.apply(null,arguments)}}},[s("Icon",{staticStyle:{"font-size":"16px"},attrs:{type:t.isDesc?"md-arrow-round-down":"md-arrow-round-up"}}),t._v("时间\n        ")],1)],1),t._v(" "),s("Col",{staticStyle:{"text-align":"right"},attrs:{span:"4"}},[s("div",{staticClass:"upload_btn",on:{click:t.handleImport}},[t._v("上传数据")])])],1),t._v(" "),s("div",{staticClass:"cus-view"},[s("Table",{attrs:{columns:t.columns,data:t.list,"max-height":t.tableHeight},scopedSlots:t._u([{key:"name",fn:function(e){var i=e.row;return[s("div",{staticClass:"label-ellipsis",attrs:{title:i.name}},[t._v(t._s(i.name))])]}},{key:"file_size",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(t.getFileSize(i.file_size)))])]}},{key:"levels",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(i.levels))])]}},{key:"srid",fn:function(e){var i=e.row;return[s("div",[t._v(t._s("EPSG:"+i.srid))])]}},{key:"action",fn:function(e){var i=e.row;return[s("span",{staticClass:"content-text-default span-split",on:{click:function(e){return t.handlePreviewClick(i)}}},[s("i",{staticClass:"iconfont iconliulan-"}),t._v("\n            预览\n          ")]),t._v(" "),s("span",{staticClass:"content-text-default span-split",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleEditClick(i)}}},[s("i",{staticClass:"iconfont iconbianji- content-text-default"}),t._v("\n            编辑\n          ")]),t._v(" "),s("span",{staticClass:"content-text-default span-split",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleDeleteClick(i)}}},[s("i",{staticClass:"iconfont iconshanchu- content-text-default"}),t._v("\n            删除\n          ")])]}}])}),t._v(" "),s("Row",{staticClass:"right-subject-item",attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("CsPage",{attrs:{current:t.current,"page-size":t.pageSize,total:t.total},on:{"on-page-size-change":t.handlePageSizeChange,"on-change":t.handleChangePage}})],1)],1)],1)],1),t._v(" "),s("ImportDialog",{ref:"importDialog",on:{refrsh:t.handleRefrsh}}),t._v(" "),s("RasterPreview",{ref:"rtPreview",on:{"vtp-close":t.handleVtpClose}})],1)},staticRenderFns:[]};var C=s("C7Lr")(y,S,!1,function(t){s("xW1+")},"data-v-d03deb1c",null);e.default=C.exports},L392:function(t,e){},ZVF2:function(t,e){},iHSd:function(t,e){},"o/cc":function(t,e){},rL40:function(t,e){},spot:function(t,e,s){"use strict";var i=s("deIM"),a=s("tIHl"),n={data:function(){return{accept:"image/tiff",format:["tif"],file:null,maxSize:1024e3,showUpload:!0,percent:0}},methods:{handleBeforeUpload:function(t){return this.file=null,/\.(tif|TIF)$/.test(t.name)?t.size>1024*this.maxSize?(Object(a.a)(this.$t("message.fileSize500MError")),this.$refs.upload.clearFiles(),!1):(this.file=t,this.uploadFile(),!1):(Object(a.a)(this.$t("message.fileFormatError")),this.$refs.upload.clearFiles(),!1)},clearProgress:function(){this.progress=0},clear:function(){this.percent=0,this.file=null,this.showUpload=!0},uploadFile:function(){var t=this;if(!this.file)return Object(a.a)(this.$t("message.fileNullError")),!1;if(!/\.(tif|TIF)$/.test(this.file.name))return Object(a.a)(this.$t("message.fileFormatError")),!1;var e=new FormData;e.append("files",this.file);var s={params:e,uploadProgress:function(e){t.percent=e.loaded/e.total*100|0},success:function(e){if(!e||0==e.length)return Object(a.b)("没有影像,请重新选择."),t.showUpload=!0,t.clearProgress(),!1;t.goNext(e)},error:function(e){e?Object(a.a)(e):Object(a.a)("未知错误"),t.showUpload=!0,t.clearProgress()}};this.showUpload=!1,this.clearProgress(),this.$http.updateRasterFiles(s)},goNext:function(t){this.$emit("next",{step:1,layers:t}),this.showUpload=!0,this.clearProgress(),this.file=null}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showUpload,expression:"showUpload"}],staticClass:"upload_layout"},[s("span",{staticStyle:{color:"#707482","font-size":"14px","margin-bottom":"10px"}},[t._v("选择要上传的文件")]),t._v(" "),s("Upload",{ref:"upload",staticStyle:{width:"100%",padding:"0 20px"},attrs:{accept:t.accept,format:t.format,type:"drag","max-size":t.maxSize,action:"","before-upload":t.handleBeforeUpload}},[s("div",{staticClass:"upload-sub-layout"},[s("p",{staticStyle:{color:"#10243C","font-size":"12px",display:"flex","flex-direction":"row","align-items":"center"}},[s("i",{staticClass:"iconfont iconshangchuan-1 i-upload"}),t._v("\n          将文件拖至此处 或\n          "),s("span",{staticStyle:{color:"#44AAF6","margin-left":"5px"}},[t._v("点击上传")]),t._v("，文件大小不能超过1G\n        ")])])]),t._v(" "),s("span",{staticStyle:{color:"red","font-size":"12px","margin-top":"5px"}},[t._v("支持的文件格式包括：目前只支持TIF影像数据")])],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showUpload,expression:"!showUpload"}],staticClass:"upload_layout"},[s("Progress",{attrs:{"stroke-width":20,percent:t.percent}})],1)])},staticRenderFns:[]};var l=s("C7Lr")(n,r,!1,function(t){s("L392")},"data-v-7d92f254",null).exports,o=s("IHPB"),c=s.n(o),f=s("4YfN"),u=s.n(f),h=s("oFuF"),p=s("RuWt"),d=s("E4LH"),m=s("mqoy"),g={components:{Dialog:i.a,SrsDialog:m.a},data:function(){return{visible:!1,blockSizes:p.b,selfLayerConfig:{}}},computed:{hasGT:function(){return!!(this.selfLayerConfig&&this.selfLayerConfig.meta&&this.selfLayerConfig.meta.has_gt)&&this.selfLayerConfig.meta.has_gt},bandBlockSize:function(){if(this.selfLayerConfig&&this.selfLayerConfig.meta&&this.selfLayerConfig.meta.band_blocksize){var t=this.selfLayerConfig.meta.band_blocksize;return t.x+" * "+t.y}return"无"},size:{get:function(){return this.selfLayerConfig&&this.selfLayerConfig.meta?this.selfLayerConfig.meta.width+" * "+this.selfLayerConfig.meta.height:"无"}},num_bands:function(){return this.selfLayerConfig&&this.selfLayerConfig.meta?""+this.selfLayerConfig.meta.num_bands:"无"},name:{get:function(){return this.selfLayerConfig&&this.selfLayerConfig.name||""},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.name=t}},srs:{get:function(){return this.selfLayerConfig&&this.selfLayerConfig.meta&&this.selfLayerConfig.meta.srs?this.selfLayerConfig.meta.srs:{}},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta=this.selfLayerConfig.meta||{},this.selfLayerConfig.meta.srs=t}},blockSize:{get:function(){return this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig&&this.selfLayerConfig.blockSize?this.selfLayerConfig.blockSize:p.g},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.blockSize=t}},srsName:function(){var t=null;return this.selfLayerConfig&&this.selfLayerConfig.meta&&this.selfLayerConfig.meta.srs&&(t=this.selfLayerConfig.meta.srs),t&&t.name?t.name:"无"},isSrs:function(){var t=null;return this.selfLayerConfig&&this.selfLayerConfig.meta&&this.selfLayerConfig.meta.srs&&(t=this.selfLayerConfig.meta.srs),!(!t||!t.srid)},upperLeftX:{get:function(){return this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta&&null!=this.selfLayerConfig.meta.upper_left_x?this.selfLayerConfig.meta.upper_left_x:0},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta=this.selfLayerConfig.meta||{},this.selfLayerConfig.meta.upper_left_x=t}},upperLeftY:{get:function(){return this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta&&null!=this.selfLayerConfig.meta.upper_left_y?this.selfLayerConfig.meta.upper_left_y:0},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta=this.selfLayerConfig.meta||{},this.selfLayerConfig.meta.upper_left_y=t}},scaleX:{get:function(){return this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta&&null!=this.selfLayerConfig.meta.scale_x?this.selfLayerConfig.meta.scale_x:0},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta=this.selfLayerConfig.meta||{},this.selfLayerConfig.meta.scale_x=t}},scaleY:{get:function(){return this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta&&null!=this.selfLayerConfig.meta.scale_y?this.selfLayerConfig.meta.scale_y:0},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta=this.selfLayerConfig.meta||{},this.selfLayerConfig.meta.scale_y=t}},skewX:{get:function(){return this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta&&null!=this.selfLayerConfig.meta.skew_x?this.selfLayerConfig.meta.skew_x:0},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta=this.selfLayerConfig.meta||{},this.selfLayerConfig.meta.skew_x=t}},skewY:{get:function(){return this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta&&null!=this.selfLayerConfig.meta.skew_y?this.selfLayerConfig.meta.skew_y:0},set:function(t){this.selfLayerConfig=this.selfLayerConfig||{},this.selfLayerConfig.meta=this.selfLayerConfig.meta||{},this.selfLayerConfig.meta.skew_y=t}}},methods:{showSrsDialog:function(t){this.$refs.srsDialog.show()},handleSrsSelect:function(t){this.srs=u()({},t)},clear:function(){this.selfLayerConfig={}},show:function(t){if(this.clear(),!t)return Object(a.a)("无图层"),!1;0==(t=t||{}).state?this.queryLayerMetaData(t):this.selfLayerConfig=u()({},t),this.visible=!0},handleClose:function(){this.clear(),this.visible=!1},handleOk:function(){return Object(d.a)(this.name)?(Object(a.a)("图层名称不能为空"),!1):this.srs&&this.isSrs?(this.selfLayerConfig.state=1,this.$emit("layer-change",u()({},this.selfLayerConfig)),void this.handleClose()):(Object(a.a)("源坐标系未设置"),!1)},queryLayerMetaData:function(t){var e=this,s={id:t.id,params:{file_name:t.file_name,path:t.path},success:function(s){e.selfLayerConfig=u()({blockSize:p.g},t,{meta:u()({},s||{})})}};this.$http.getRasterLayerMetaData(s)}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Dialog",{attrs:{title:"图层导入设置",visible:t.visible,showStep:!1,styles:{top:"15vh",width:"700px"}},on:{cus_cancel:t.handleClose}},[s("div",[s("div",{staticClass:"i-s-item"},[s("div",{staticClass:"left-pannel"},[s("span",[t._v("*")]),t._v("图层名称\n        ")]),t._v(" "),s("div",{staticClass:"right-pannel"},[s("span",[t._v("*")]),t._v("原始坐标系\n        ")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{placeholder:"请输入名称"},model:{value:t.name,callback:function(e){t.name="string"==typeof e?e.trim():e},expression:"name"}})],1),t._v(" "),s("Col",{attrs:{span:"12"}},[t.isSrs?s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{disabled:""},model:{value:t.srsName,callback:function(e){t.srsName=e},expression:"srsName"}})],1)],1):s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"21"}},[s("Input",{staticClass:"label-ellipsis",attrs:{disabled:""},model:{value:t.srsName,callback:function(e){t.srsName=e},expression:"srsName"}})],1),t._v(" "),s("Col",{staticStyle:{"text-align":"right"},attrs:{span:"3"}},[s("span",{staticClass:"content-text-default span-split",on:{click:function(e){return e.stopPropagation(),t.showSrsDialog(1)}}},[t._v("选择")])])],1)],1)],1),t._v(" "),s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[s("span",[t._v("*")]),t._v("分块大小\n        ")]),t._v(" "),s("div",{staticClass:"right-pannel"},[t._v("原分块大小")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Select",{model:{value:t.blockSize,callback:function(e){t.blockSize="string"==typeof e?e.trim():e},expression:"blockSize"}},t._l(t.blockSizes,function(e,i){return s("Option",{key:i,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{disabled:""},model:{value:t.bandBlockSize,callback:function(e){t.bandBlockSize=e},expression:"bandBlockSize"}})],1)],1),t._v(" "),s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[t._v("宽度和高度")]),t._v(" "),s("div",{staticClass:"right-pannel"},[t._v("波段数")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{disabled:""},model:{value:t.size,callback:function(e){t.size=e},expression:"size"}})],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Input",{attrs:{disabled:""},model:{value:t.num_bands,callback:function(e){t.num_bands=e},expression:"num_bands"}})],1)],1),t._v(" "),t.hasGT?s("div",[s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[t._v("左上角横坐标")]),t._v(" "),s("div",{staticClass:"right-pannel"},[t._v("左上角纵坐标")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number",disabled:""},model:{value:t.upperLeftX,callback:function(e){t.upperLeftX=t._n(e)},expression:"upperLeftX"}})],1)],1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number",disabled:""},model:{value:t.upperLeftY,callback:function(e){t.upperLeftY=t._n(e)},expression:"upperLeftY"}})],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[t._v("水平空间分辨率")]),t._v(" "),s("div",{staticClass:"right-pannel"},[t._v("垂直空间分辨率")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number",disabled:""},model:{value:t.scaleX,callback:function(e){t.scaleX=t._n(e)},expression:"scaleX"}})],1)],1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number",disabled:""},model:{value:t.scaleY,callback:function(e){t.scaleY=t._n(e)},expression:"scaleY"}})],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[t._v("上北旋转")]),t._v(" "),s("div",{staticClass:"right-pannel"},[t._v("下南旋转")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number",disabled:""},model:{value:t.skewX,callback:function(e){t.skewX=t._n(e)},expression:"skewX"}})],1)],1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number",disabled:""},model:{value:t.skewY,callback:function(e){t.skewY=t._n(e)},expression:"skewY"}})],1)],1)],1)],1)],1):s("div",[s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[s("span",[t._v("*")]),t._v("左上角横坐标\n          ")]),t._v(" "),s("div",{staticClass:"right-pannel"},[s("span",[t._v("*")]),t._v("左上角纵坐标\n          ")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number"},model:{value:t.upperLeftX,callback:function(e){t.upperLeftX=t._n(e)},expression:"upperLeftX"}})],1)],1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number"},model:{value:t.upperLeftY,callback:function(e){t.upperLeftY=t._n(e)},expression:"upperLeftY"}})],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[s("span",[t._v("*")]),t._v("水平空间分辨率\n          ")]),t._v(" "),s("div",{staticClass:"right-pannel"},[s("span",[t._v("*")]),t._v("垂直空间分辨率\n          ")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number"},model:{value:t.scaleX,callback:function(e){t.scaleX=t._n(e)},expression:"scaleX"}})],1)],1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number"},model:{value:t.scaleY,callback:function(e){t.scaleY=t._n(e)},expression:"scaleY"}})],1)],1)],1)],1),t._v(" "),s("div",{staticClass:"i-s-item row-item-split"},[s("div",{staticClass:"left-pannel"},[s("span",[t._v("*")]),t._v("上北旋转\n          ")]),t._v(" "),s("div",{staticClass:"right-pannel"},[s("span",[t._v("*")]),t._v("下南旋转\n          ")])]),t._v(" "),s("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number"},model:{value:t.skewX,callback:function(e){t.skewX=t._n(e)},expression:"skewX"}})],1)],1)],1),t._v(" "),s("Col",{attrs:{span:"12"}},[s("Row",{attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"24"}},[s("Input",{attrs:{type:"number"},model:{value:t.skewY,callback:function(e){t.skewY=t._n(e)},expression:"skewY"}})],1)],1)],1)],1)],1),t._v(" "),s("Row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"end"}},[s("Col",{staticStyle:{"text-align":"right"},attrs:{span:"24"}},[s("Button",{staticStyle:{"margin-right":"20px",width:"60px"},on:{click:function(e){return e.stopPropagation(),t.handleClose.apply(null,arguments)}}},[t._v("取消")]),t._v(" "),s("Button",{staticStyle:{width:"60px"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.handleOk.apply(null,arguments)}}},[t._v("确定")])],1)],1)],1)]),t._v(" "),s("SrsDialog",{ref:"srsDialog",on:{"on-select":t.handleSrsSelect}})],1)},staticRenderFns:[]};var y=s("C7Lr")(g,v,!1,function(t){s("ZVF2")},"data-v-3ed864d9",null).exports,S={components:{Dialog:i.a,SrsDialog:m.a},data:function(){return{current:0,blockSize:p.g,selfSourceSrs:null,selfTargetSrs:null,blockSizes:p.b,title:"全局设置",visible:!1}},computed:{sourceSrsName:function(){return this.selfSourceSrs&&this.selfSourceSrs.name?this.selfSourceSrs.name:"无"},targetSrsName:function(){return this.selfTargetSrs&&this.selfTargetSrs.name?this.selfTargetSrs.name:"无"}},watch:{sourceSrid:function(t){this.querySrsById(t)}},methods:{handleClose:function(){this.clear(),this.visible=!1},clear:function(){this.blockSize=p.g,this.selfTargetSrs=null,this.selfSourceSrs=null,this.current=0},show:function(t){this.clear();var e=t=t||{},s=e.sourceSrs,i=void 0===s?null:s,a=e.targetSrs,n=void 0===a?null:a,r=e.blockSize,l=void 0===r?p.g:r;this.blockSize=l,this.selfSourceSrs=i,this.selfTargetSrs=n,this.visible=!0},showSrsDialog:function(t){this.current=t,this.$refs.srsDialog.show()},handleSrsSelect:function(t){1==this.current?this.selfSourceSrs=u()({},t):this.selfTargetSrs=u()({},t)},handleOK:function(){var t={blockSize:this.blockSize,sourceSrs:null,targetSrs:null};this.selfSourceSrs&&(t.sourceSrs=u()({},this.selfSourceSrs)),this.selfTargetSrs&&(t.targetSrs=u()({},this.selfTargetSrs)),this.$emit("global-setting",t),this.handleClose()}}},C={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Dialog",{attrs:{isShowBottomBtn:!1,title:t.title,visible:t.visible,showStep:!1,styles:{top:"20vh",width:"500px"}},on:{cus_cancel:t.handleClose}},[s("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"4"}},[t._v("分块大小")]),t._v(" "),s("Col",{attrs:{span:"20"}},[s("Select",{attrs:{transfer:!0},model:{value:t.blockSize,callback:function(e){t.blockSize=e},expression:"blockSize"}},t._l(t.blockSizes,function(e){return s("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1)],1),t._v(" "),s("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[s("Col",{attrs:{span:"4"}},[t._v("原始坐标系")]),t._v(" "),s("Col",{attrs:{span:"18"}},[s("Input",{attrs:{disabled:""},model:{value:t.sourceSrsName,callback:function(e){t.sourceSrsName=e},expression:"sourceSrsName"}})],1),t._v(" "),s("Col",{staticStyle:{"text-align":"right"},attrs:{span:"2"}},[s("span",{staticClass:"content-text-default span-split",on:{click:function(e){return e.stopPropagation(),t.showSrsDialog(1)}}},[t._v("选择")])])],1),t._v(" "),s("Row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"end"}},[s("Col",{staticStyle:{"text-align":"right"},attrs:{span:"24"}},[s("Button",{staticStyle:{"margin-right":"20px",width:"60px"},on:{click:function(e){return e.stopPropagation(),t.handleClose.apply(null,arguments)}}},[t._v("取消")]),t._v(" "),s("Button",{staticStyle:{width:"60px"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.handleOK.apply(null,arguments)}}},[t._v("确定")])],1)],1)],1),t._v(" "),s("SrsDialog",{ref:"srsDialog",on:{"on-select":t.handleSrsSelect}})],1)},staticRenderFns:[]};var _={components:{LayerImportSetting:y,GlobalSettingDialog:s("C7Lr")(S,C,!1,function(t){s("o/cc")},"data-v-df2925d2",null).exports},data:function(){return{blockSize:p.g,sourceSrs:null,targetSrs:null,columns:[{title:"编号",key:"id",slot:"id",width:60,className:"table-header-text-default"},{title:"图层名称",key:"name",slot:"name",className:"table-header-text-default"},{title:"文件大小MB",key:"file_size",slot:"file_size",width:150,className:"table-header-text-default"},{title:"状态",key:"state",slot:"state",width:80,className:"table-header-text-default"},{title:this.$t("common.table.action")||"操作",slot:"action",align:"left",width:80,className:"table-header-text-default"}],list:[]}},methods:{getFileSize:h.a.getFileSize,getDatasetTypeLabel:h.a.getDatasetTypeLabel,handleGlobalSetting:function(){this.$refs.globalSettingDialog.show({blockSize:this.blockSize,sourceSrs:this.sourceSrs,targetSrs:this.targetSrs})},clear:function(){this.blockSize=p.g,this.sourceSrs=null,this.targetSrs=null,this.list=[]},handleGlobalSettingReturn:function(t){this.blockSize=t.blockSize,this.sourceSrs=u()({},t.sourceSrs),this.targetSrs=u()({},t.targetSrs)},show:function(t){var e=this;t=t||[],this.clear(),t.forEach(function(t){e.list.push(u()({},t,{state:0}))})},getStateLabel:function(t){return 0==t?"未设置":"已设置"},reUpload:function(){this.$emit("previous",{step:2})},goNext:function(){this.$emit("next",{step:2,layers:[].concat(c()(this.list)),globalConfig:{blockSize:this.blockSize,sourceSrs:this.sourceSrs}})},handleSettingClick:function(t){this.$refs.importSetting&&this.$refs.importSetting.show(t)},handleLayerChange:function(t){t=t||{};var e=this.findIndexByID(t.id);this.list.splice(e,1,t)},findLayerByID:function(t){return this.list.find(function(e){return e.id==t})},findIndexByID:function(t){return this.list.findIndex(function(e){return e.id==t})}}},b={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Table",{staticClass:"cus-view",attrs:{border:"",columns:t.columns,data:t.list,height:280},scopedSlots:t._u([{key:"id",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(i.id))])]}},{key:"name",fn:function(e){var i=e.row;return[s("div",{staticClass:"label-ellipsis",attrs:{title:i.name}},[t._v(t._s(i.name))])]}},{key:"file_size",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(t.getFileSize(i.file_size)))])]}},{key:"state",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(t.getStateLabel(i.state)))])]}},{key:"action",fn:function(e){var i=e.row;return[s("span",{staticClass:"content-text-default span-split",on:{click:function(e){return t.handleSettingClick(i)}}},[s("i",{staticClass:"iconfont iconguanli-"}),t._v("\n        "+t._s(t.$t("common.button.setting")||"设置")+"\n      ")])]}}])}),t._v(" "),s("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"flex-end",width:"100%","margin-top":"16px"}},[s("Button",{staticStyle:{float:"right","margin-right":"16px"},on:{click:t.handleGlobalSetting}},[t._v("全局设置")]),t._v(" "),s("Button",{staticStyle:{float:"right","margin-right":"16px"},on:{click:t.reUpload}},[t._v("重新上传")]),t._v(" "),s("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.goNext}},[t._v("下 一 步")])],1),t._v(" "),s("GlobalSettingDialog",{ref:"globalSettingDialog",on:{"global-setting":t.handleGlobalSettingReturn}}),t._v(" "),s("LayerImportSetting",{ref:"importSetting",on:{"layer-change":t.handleLayerChange}})],1)},staticRenderFns:[]};var w=s("C7Lr")(_,b,!1,function(t){s("7MXk")},"data-v-089a6646",null).exports,x={components:{LayerImportSetting:y},data:function(){return{columns:[{title:"编号",key:"id",width:60,className:"table-header-text-default"},{title:"图层名",key:"name",slot:"name",className:"table-header-text-default"},{title:"日志",key:"err",slot:"err",className:"table-header-text-default"},{title:"状态",key:"state",slot:"state",width:80,className:"table-header-text-default"},{title:this.$t("common.table.action")||"操作",slot:"action",width:100,className:"table-header-text-default"}],isCreateTaskIng:!1,totalImportProcess:0,totalImport:0,importSuccess:0,importFail:0,failLayers:[],totalLayers:[],selfGlobalConfig:null,tastIds:[]}},methods:{goNext:function(){this.$emit("next",{step:3,ids:this.tastIds})},handleSettingClick:function(t){this.$refs.layerImportSetting&&this.$refs.layerImportSetting.show(t)},handleLayerChange:function(t){t=t||{};var e=this.findIndexByID(t.id);this.failLayers.splice(e,1,t)},findIndexByID:function(t){return this.failLayers.findIndex(function(e){return e.id==t})},clear:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isCreateTaskIng=!1,this.totalImportProcess=0,this.totalImport=0,this.importSuccess=0,this.importFail=0,this.failLayers=[],this.totalLayers=[],this.selfGlobalConfig=null,t&&(this.tastIds=[])},show:function(t,e){this.clear(),t=t||[],e=e||{},this.totalLayers=[].concat(c()(t)),this.selfGlobalConfig=u()({},e),this.totalLayers.length>0?this.createAllTask(this.totalLayers):Object(a.a)("无导入图层"),this.visible=!0},handleReImport:function(){if(this.isCreateTaskIng)return Object(a.a)(this.$t("message.createImportError")),!1;if(!this.failLayers||0==this.failLayers.length)return!1;var t=[].concat(c()(this.failLayers));this.clear(!1),t&&t.length>0&&this.createAllTask(t)},createAllTask:function(t){var e=this;if(this.isCreateTaskIng)return!1;if(this.isCreateTaskIng=!0,!t||0==t.length)return!1;var s=0,i=t.length;this.totalImport=i;var a=function a(r){e.$bus.$emit(p.k.RASTER_STATISTICS),e.importSuccess++,e.totalImportProcess=Math.round((s+1)/i*100),s+1<i?(s++,e.creatSingleTask(t[s],a,n)):(e.isCreateTaskIng=!1,i>0&&e.importSuccess==i&&e.goNext())},n=function n(r,l){if(e.importFail++,e.totalImportProcess=Math.round((s+1)/i*100),e.failLayers||(e.failLayers=[]),l){var o=t.find(function(t){return t.id==l.id});o?e.failLayers.push(u()({},o,{err:r})):console.log("error")}s+1<i?(s++,e.creatSingleTask(t[s],a,n)):e.isCreateTaskIng=!1};this.creatSingleTask(t[s],a,n)},queryLayerMetaData:function(t,e,s){var i={id:t.id,params:{file_name:t.file_name,path:t.path},success:e,error:s};this.$http.getRasterLayerMetaData(i)},creatSingleTask:function(t,e,s){var i=this,a=(this.selfGlobalConfig||{}).blockSize,n=void 0===a?p.g:a;if(0==t.state){this.queryLayerMetaData(t,function(a){var r=u()({blockSize:n},t,{meta:u()({},a||{}),state:1});i.createLayerTask(r,e,s)},function(e){s(e,t)})}else this.createLayerTask(t,e,s)},createLayerTask:function(t,e,s){var i=this,a=(this.selfGlobalConfig||{}).sourceSrs,n=void 0===a?null:a,r=t||{},l=r.meta,o=void 0===l?null:l,c=r.name,f=void 0===c?null:c,u=r.file_name,h=void 0===u?null:u,d=r.file_size,m=void 0===d?0:d,g=r.path,v=void 0===g?null:g,y=r.blockSize,S=void 0===y?p.g:y,C=null;o&&o.srs&&o.srs.srid&&(C=o.srs.srid),C||n&&n.srid&&(C=n.srid);var _={params:{type:p.E.IMPORT_RASTER_TASK,name:f,file_name:h,path:v,file_size:m,srid:C,blocksize_x:S,blocksize_y:S},success:function(s){i.tastIds.push(s),e(t)},error:function(e){s(e,t)}};this.$http.createImportTask(_)},getStateLabel:function(t){return 0==t?"未设置":"已设置"}}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"t-s-container"},[s("div",[s("p",[t._v("任务进度")]),t._v(" "),s("p",[t._v(t._s(t.totalImportProcess)+"%")])]),t._v(" "),s("div",[s("p",[t._v("总计")]),t._v(" "),s("p",{staticClass:"state-total"},[t._v(t._s(t.totalImport))])]),t._v(" "),s("div",[s("p",[t._v("成功")]),t._v(" "),s("p",{staticClass:"state-success"},[t._v(t._s(t.importSuccess))])]),t._v(" "),s("div",[s("p",[t._v("失败")]),t._v(" "),s("p",{staticClass:"state-fail"},[t._v(t._s(t.importFail))])])]),t._v(" "),s("Table",{staticClass:"cus-view",staticStyle:{"margin-top":"20px"},attrs:{border:"",columns:t.columns,data:t.failLayers,height:200},scopedSlots:t._u([{key:"name",fn:function(e){var i=e.row;return[s("div",{staticClass:"label-ellipsis",attrs:{title:i.name}},[t._v(t._s(i.name))])]}},{key:"err",fn:function(e){var i=e.row;return[s("div",{staticClass:"label-ellipsis",attrs:{title:i.err}},[t._v(t._s(i.err))])]}},{key:"state",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(t.getStateLabel(i.state)))])]}},{key:"action",fn:function(e){var i=e.row;return[s("span",{staticClass:"content-text-default span-split",on:{click:function(e){return e.stopPropagation(),t.handleSettingClick(i)}}},[s("i",{staticClass:"iconfont iconguanli-"}),t._v("\n        "+t._s(t.$t("common.button.setting")||"设置")+"\n      ")])]}}])}),t._v(" "),s("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"flex-end",width:"100%","margin-top":"16px"}},[s("Button",{staticStyle:{float:"right","margin-right":"16px"},on:{click:function(e){return e.stopPropagation(),t.handleReImport.apply(null,arguments)}}},[t._v("重新导入")]),t._v(" "),s("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.goNext.apply(null,arguments)}}},[t._v("下 一 步")])],1),t._v(" "),s("LayerImportSetting",{ref:"layerImportSetting",on:{"layer-change":t.handleLayerChange}})],1)},staticRenderFns:[]};var L=s("C7Lr")(x,k,!1,function(t){s("iHSd")},"data-v-fa4dbb18",null).exports,z={components:{},data:function(){return{columns:[{title:"编号",key:"id",width:60,className:"table-header-text-default"},{title:"名称",key:"name",slot:"name",width:150,className:"table-header-text-default"},{title:"统计",key:"total_count",slot:"statics",className:"table-header-text-default"},{title:"状态",key:"status",slot:"status",width:80,className:"table-header-text-default"}],list:[],taskIds:[],timer:null,totalImportProcess:0,importSuccess:0,importProgress:0,importNoStart:0}},computed:{},watch:{},methods:{getImportTaskStatusLabel:h.a.getImportTaskStatusLabel,clear:function(){this.list=[],this.taskIds=[],this.clearTimer(),this.totalImportProcess=0,this.importSuccess=0,this.importProgress=0,this.importNoStart=0},clearTimer:function(){this.timer&&(clearInterval(this.timer),this.timer=null)},show:function(t){var e=this;this.clear(),this.taskIds=t;var s=function(){var t={params:{method:"select",data:e.taskIds},success:function(t){t=t||[],e.list=t,e.computeStatics(),100==e.totalImportProcess&&e.clearTimer()},error:function(t){Object(a.a)(t),e.clear()}};e.$http.batchImportTasksByIDs(t),e.$bus.$emit(p.k.DATA_STATISTICS)};s(),this.timer=setInterval(s,3e3)},computeStaticsMsg:function(t){var e=t.total_count,s=t.current_count,i=t.total_count,a=void 0===i?0:i,n=t.success_count,r=void 0===n?0:n,l=t.fail_count;return"总数:"+a+"    成功:"+r+"    失败:"+(void 0===l?0:l)+"    进度:"+(0==t.total_count?100:Math.round(s/e*100))},computeStatics:function(){var t=this;this.totalImportProcess=0,this.importSuccess=0,this.importProgress=0,this.importNoStart=0,this.list=this.list||[];var e=this.list.length;this.list.forEach(function(e){e.status==p.C.STATUS_0?t.importNoStart++:e.status==p.C.STATUS_1?t.importProgress++:e.status==p.C.STATUS_2&&t.importSuccess++}),this.totalImportProcess=e?Math.round(this.importSuccess/e*100):100}}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"task-container"},[s("div",[s("p",[t._v("导入进度")]),t._v(" "),s("p",[t._v(t._s(t.totalImportProcess)+"%")])]),t._v(" "),s("div",[s("p",[t._v("已完成")]),t._v(" "),s("p",{staticClass:"task-status-success"},[t._v(t._s(t.importSuccess))])]),t._v(" "),s("div",[s("p",[t._v("处理中")]),t._v(" "),s("p",{staticClass:"task-status-progress"},[t._v(t._s(t.importProgress))])]),t._v(" "),s("div",[s("p",[t._v("未开始")]),t._v(" "),s("p",{staticClass:"task-status-no-start"},[t._v(t._s(t.importNoStart))])])]),t._v(" "),s("Table",{staticClass:"cus-view",staticStyle:{"margin-top":"20px"},attrs:{border:"",columns:t.columns,data:t.list,height:280},scopedSlots:t._u([{key:"name",fn:function(e){var i=e.row;return[s("div",{staticClass:"label-ellipsis",attrs:{title:i.name}},[t._v(t._s(i.name))])]}},{key:"status",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(t.getImportTaskStatusLabel(i.status)))])]}},{key:"statics",fn:function(e){var i=e.row;return[s("div",[t._v(t._s(t.computeStaticsMsg(i))+"%")])]}}])})],1)},staticRenderFns:[]};var T=s("C7Lr")(z,I,!1,function(t){s("uctK")},"data-v-31cdeb86",null).exports,D={components:{Dialog:i.a,FirstStep:l,SecondStep:w,ThirdStep:L,FourStep:T},data:function(){return{visible:!1,total:4,curStep:1,titles:["选择文件","图层设置","创建任务","数据入库"]}},computed:{title:function(){return this.titles?this.titles[this.curStep-1]:""}},methods:{show:function(){this.visible=!0,this.$refs.firstStep&&this.$refs.firstStep.clear(),this.curStep=1},handleClose:function(){if(3==this.curStep){if(this.$refs.thirdStep.isCreateTaskIng)return Object(a.a)("任务正在创建中,无法关闭"),!1}else 4==this.curStep&&(this.$refs.fourStep&&this.$refs.fourStep.clear(),this.$emit("refrsh"));this.visible=!1},nextStep:function(t){if(1==t.step){var e=t.layers;e&&e.length>0&&(this.$refs.secondStep&&this.$refs.secondStep.show(e),this.curStep++)}else if(2==t.step){var s=t.layers,i=void 0===s?[]:s,a=t.globalConfig,n=void 0===a?{}:a;this.$refs.thirdStep&&this.$refs.thirdStep.show(i,n),this.curStep++}else if(3==t.step){var r=t.ids,l=void 0===r?[]:r;this.$refs.fourStep&&this.$refs.fourStep.show(l),this.curStep++}},previousStep:function(t){2==t.step&&(this.$refs.firstStep&&this.$refs.firstStep.clear(),this.curStep--)}}},R={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{attrs:{isShowBottomBtn:!1,title:t.title,visible:t.visible,showStep:!0,total:t.total,num:t.curStep,styles:{top:"20vh",width:"700px"}},on:{cus_cancel:t.handleClose}},[s("FirstStep",{directives:[{name:"show",rawName:"v-show",value:1===t.curStep,expression:"curStep === 1"}],ref:"firstStep",on:{next:t.nextStep}}),t._v(" "),s("SecondStep",{directives:[{name:"show",rawName:"v-show",value:2===t.curStep,expression:"curStep === 2"}],ref:"secondStep",on:{next:t.nextStep,previous:t.previousStep}}),t._v(" "),s("ThirdStep",{directives:[{name:"show",rawName:"v-show",value:3===t.curStep,expression:"curStep === 3"}],ref:"thirdStep",on:{next:t.nextStep}}),t._v(" "),s("FourStep",{directives:[{name:"show",rawName:"v-show",value:4===t.curStep,expression:"curStep === 4"}],ref:"fourStep"})],1)},staticRenderFns:[]};var $=s("C7Lr")(D,R,!1,function(t){s("rL40")},"data-v-2e0bdcfc",null);e.a=$.exports},uctK:function(t,e){},"xW1+":function(t,e){}});