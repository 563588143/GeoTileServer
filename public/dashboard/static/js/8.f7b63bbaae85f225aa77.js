webpackJsonp([8],{"2VhM":function(t,e,i){"use strict";var s=i("lP4K"),a={BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",COMPOSITE:"cmpt",POINT_CLOUD:"pnts",VECTOR:"vctr",GEOMETRY:"geom",GLTF:"gltf",GLTF_BINARY:"glb",IMPLICIT_SUBTREE:"subt",EXTERNAL_TILESET:"externalTileset",MULTIPLE_CONTENT:"multipleContent",isBinaryFormat:function(t){switch(t){case a.BATCHED_3D_MODEL:case a.INSTANCED_3D_MODEL:case a.COMPOSITE:case a.POINT_CLOUD:case a.VECTOR:case a.GEOMETRY:case a.IMPLICIT_SUBTREE:case a.GLTF_BINARY:return!0;default:return!1}}},n=a,l={SPHERE:"sphere",BOX:"box",REGION:"region"},r={REPLACE:"REPLACE",ADD:"ADD"},o=i("RuWt"),c={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},h={createOsgb:function(t){var e=t.name,i=t.path,a=t.enu,c=t.crs,h=t.origin_offset,u=t.compress,d=t.textureFormat,p={source:{path:i,enu:a,crs:c,origin_offset:h,type:s.b.OSGB},tile:{draco:{compress:u},texture:{format:d}},output:{content_type:n.BATCHED_3D_MODEL,bounding_volume:l.SPHERE,refine:r.REPLACE}};return{name:e,type:o.F.TYPE_2,detail:p}},createTYMX:function(t){var e=t.name,i=t.path,a=t.type,h=t.enu,u=t.crs,d=t.originOffset,p=void 0===d?{x:0,y:0,z:0}:d,f=t.compress,v=t.textureFormat,m=t.fields,g=void 0===m?[]:m,b=t.isAbsoluteHeight,_=void 0!==b&&b,y=t.topHeight,x=void 0===y?null:y,C=t.baseHeight,S=void 0===C?null:C,w=t.outline,D=void 0!==w&&w,k=t.simplify,F=void 0===k?0:k,T=t.buffer,O=void 0===T?0:T,z=t.encode,E=void 0===z?o.d:z,j=t.alphaMode,I=void 0===j?c.OPAQUE:j,L=t.alphaCutoff,A=void 0===L?.5:L,$=t.doubleSided,N=void 0!==$&&$,H=t.layerName,R={source:{path:i,layer_name:void 0===H?"":H,type:a,enu:h,crs:u,origin_offset:p,fields:g,is_absolute_height:_,top_height:x?{is_fixed:x.isFixed,field:x.field||"",factor:x.factor||1,value:x.value||10}:null,base_height:S?{is_fixed:S.isFixed,field:S.field||"",factor:S.factor||1,value:S.value||0}:null,outline:D,simplify:F,buffer:O,encode:E,alpha_mode:I,alpha_cutoff:A,double_sided:N},tile:{draco:{compress:f},texture:{format:v}},output:{content_type:n.BATCHED_3D_MODEL,bounding_volume:a===s.b.SHP?l.REGION:l.SPHERE,refine:r.REPLACE}};return{name:e,type:o.F.TYPE_1,detail:R}}};e.a=h},"3U1C":function(t,e){},"4O6x":function(t,e){},"6tbM":function(t,e,i){"use strict";var s=i("deIM"),a=(i("tIHl"),i("uoUy")),n=i("T452"),l={components:{Dialog:s.a},data:function(){return{title:"倾斜摄影切片详情",path:"",visible:!1,compress:!1,hasMetaData:!1,file:null,name:"",enu:"",crs:null,originOffset:{x:0,y:0,z:0},formatLabel:"",serviceUrl:""}},computed:{originOffsetLabel:function(){var t=this.originOffset||{},e=t.x,i=void 0===e?0:e,s=t.y,a=void 0===s?0:s,n=t.z;return[i,a,void 0===n?0:n].join()},spaceLabel:function(){return this.enu?"ENU:"+this.enu.lat+","+this.enu.lng:this.crs?""+this.crs.code:""}},methods:{clear:function(){this.path="",this.visible=!1,this.compress=!1,this.name="",this.enu="",this.crs=null,this.originOffset={x:0,y:0,z:0},this.formatLabel="",this.serviceUrl=""},show:function(t){var e=this;this.clear();var i={id:t,success:function(i){var s=i||{},l=s.name,r=void 0===l?null:l,o=s.detail,c=void 0===o?{}:o,h=c.tile,u=void 0===h?{}:h,d=c.source,p=void 0===d?{}:d;e.name=r,e.enu=p.enu,e.crs=p.crs,e.originOffset=p.origin_offset||{x:0,y:0,z:0},e.path=p.path;var f=u.draco,v=void 0===f?{}:f,m=u.texture,g=void 0===m?{}:m,b=v.compress,_=void 0!==b&&b,y=g.format,x=void 0===y?a.a.DEFAULT:y;e.compress=_,e.formatLabel=Object(a.c)(x),e.serviceUrl=Object(n.c)(t,!0,!0)}};this.$http.getTileset3DByID(i),this.visible=!0},handleClose:function(){this.clear()}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Dialog",{attrs:{isShowBottomBtn:!1,title:t.title,visible:t.visible,showStep:!1,styles:{top:"20vh",width:"500px"}},on:{cus_cancel:t.handleClose}},[i("Row",{staticClass:"row-item t-s-d-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("名称")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("span",[t._v(t._s(t.name))])])],1),t._v(" "),i("Row",{staticClass:"row-item t-s-d-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("路径")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("span",[t._v(t._s(t.path))])])],1),t._v(" "),i("Row",{staticClass:"row-item t-s-d-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("空间参考")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("span",[t._v(t._s(t.spaceLabel))])])],1),t._v(" "),i("Row",{staticClass:"row-item t-s-d-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("零点坐标")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("span",[t._v(t._s(t.originOffsetLabel))])])],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("顶点压缩")])]),t._v(" "),i("Col",{staticStyle:{"text-align":"left"},attrs:{span:"20"}},[i("Checkbox",{attrs:{disabled:""},model:{value:t.compress,callback:function(e){t.compress=e},expression:"compress"}})],1)],1),t._v(" "),i("Row",{staticClass:"row-item t-s-d-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("纹理格式")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("span",[t._v(t._s(t.formatLabel))])])],1),t._v(" "),i("Row",{staticClass:"row-item t-s-d-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("访问地址")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("span",[t._v(t._s(t.serviceUrl))])])],1)],1)},staticRenderFns:[]};var o=i("C7Lr")(l,r,!1,function(t){i("ObZ3")},"data-v-6f86911e",null);e.a=o.exports},"7ILc":function(t,e){},"7sWg":function(t,e,i){"use strict";var s=i("deIM"),a=i("tIHl"),n=i("oFuF"),l={components:{Dialog:s.a},data:function(){return{visible:!1,x:0,y:0,z:0}},methods:{clear:function(){this.x=0,this.y=0,this.z=0},handleClose:function(){this.clear(),this.visible=!1},handleOk:function(){return n.a.isNumber(this.x)?n.a.isNumber(this.y)?n.a.isNumber(this.z)?(this.$emit("on-set",{x:this.x,y:this.y,z:this.z}),this.visible=!1,void this.clear()):(Object(a.a)("Z坐标不是数字!"),!1):(Object(a.a)("Y坐标不是数字!"),!1):(Object(a.a)("X坐标不是数字!"),!1)},show:function(t){this.clear();var e=t=t||{x:0,y:0,z:0};this.x=e.x,this.y=e.y,this.z=e.z,this.visible=!0}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Dialog",{attrs:{isShowBottomBtn:!1,title:"设置零点坐标",visible:t.visible,showStep:!1,styles:{top:"20vh",width:"400px"}},on:{cus_cancel:t.handleClose}},[i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("X坐标")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("Input",{attrs:{placeholder:"请输入数字"},model:{value:t.x,callback:function(e){t.x=t._n(e)},expression:"x"}})],1)],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("Y坐标")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("Input",{attrs:{placeholder:"请输入数字"},model:{value:t.y,callback:function(e){t.y=t._n(e)},expression:"y"}})],1)],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"4"}},[i("span",[t._v("Z坐标")])]),t._v(" "),i("Col",{attrs:{span:"20"}},[i("Input",{attrs:{placeholder:"请输入数字"},model:{value:t.z,callback:function(e){t.z=t._n(e)},expression:"z"}})],1)],1),t._v(" "),i("Row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"end"}},[i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"24"}},[i("Button",{staticStyle:{"margin-right":"20px",width:"60px"},on:{click:function(e){return e.stopPropagation(),t.handleClose.apply(null,arguments)}}},[t._v("取消")]),t._v(" "),i("Button",{staticStyle:{width:"60px"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.handleOk.apply(null,arguments)}}},[t._v("确定")])],1)],1)],1)},staticRenderFns:[]};var o=i("C7Lr")(l,r,!1,function(t){i("VYST")},"data-v-2b8cec33",null);e.a=o.exports},DYzw:function(t,e){},DgzN:function(t,e){},Gdwo:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("RuWt"),a=i("tIHl"),n=i("TPXC"),l=i("brHk"),r=i("fsLt"),o=i("6tbM"),c=i("deIM"),h=i("lP4K"),u={props:{action:{type:String,default:s.a.ADD},modelType:{type:String,default:h.b.SHP}},data:function(){return{accept:"application/x-zip-compressed",format:["zip"],file:null,maxSize:2,showUpload:!0,percent:0,ACTION:s.a,tmpFiles:null}},computed:{size:function(){return this.maxSize+"G"},limitSize:function(){return this.maxSize*s.v},memo:function(){var t="";switch(this.modelType){case h.b.SHP:t="说明：需要把面类型的shp相关文件压缩成zip文件";break;case h.b.OBJ:t="说明：需要obj和mtl等文件压缩成zip文件";break;case h.b.FBX:t="说明：需要fbx相关文件压缩成zip文件";break;default:t="未定义"}return t}},methods:{handleBeforeUpload:function(t){return this.file=null,/\.(zip)$/.test(t.name)?t.size>this.maxSize*s.u?(Object(a.a)(this.$t("message.fileSize2GError")),this.$refs.upload.clearFiles(),!1):(this.file=t,this.uploadFile(),!1):(Object(a.a)(this.$t("message.fileFormatError")),this.$refs.upload.clearFiles(),!1)},clearProgress:function(){this.progress=0},clear:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.percent=0,this.file=null,this.showUpload=!0,t&&(this.tmpFiles=null)},uploadFile:function(){var t=this;if(!this.file)return Object(a.a)(this.$t("message.fileNullError")),!1;if(!/\.(zip)$/.test(this.file.name))return Object(a.a)(this.$t("message.fileFormatError")),!1;var e=new FormData;e.append("files",this.file);var i={data:e,params:{tileset_type:s.F.TYPE_1,model_type:h.b.SHP},uploadProgress:function(e){t.percent=e.loaded/e.total*100|0},success:function(e){if(!e||0==e.length)return Object(a.b)("没有模型数据."),t.showUpload=!0,t.clearProgress(),!1;t.action===s.a.EDIT?t.tmpFiles=e:t.tmpFiles=null,t.goNext(e)},error:function(e){e?Object(a.a)(e):Object(a.a)("未知错误"),t.showUpload=!0,t.clearProgress()}};this.showUpload=!1,this.clearProgress(),this.$http.updateModelFile(i)},goNext:function(t){this.$emit("next",{step:1,files:t,action:this.action}),this.showUpload=!0,this.clearProgress(),this.file=null}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showUpload,expression:"showUpload"}],staticClass:"upload_layout"},[i("span",{staticStyle:{color:"#707482","font-size":"14px","margin-bottom":"10px"}},[t._v("选择要上传的文件")]),t._v(" "),i("Upload",{ref:"upload",staticStyle:{width:"100%",padding:"0 20px"},attrs:{accept:t.accept,format:t.format,type:"drag","max-size":t.limitSize,action:"","before-upload":t.handleBeforeUpload}},[i("div",{staticClass:"upload-sub-layout"},[i("p",{staticStyle:{color:"#10243C","font-size":"12px",display:"flex","flex-direction":"row","align-items":"center"}},[i("i",{staticClass:"iconfont iconshangchuan-1 i-upload"}),t._v("\n          将文件拖至此处 或\n          "),i("span",{staticStyle:{color:"#44AAF6","margin-left":"5px"}},[t._v("点击上传")]),t._v("，文件大小不能超过"+t._s(t.size)+"\n        ")])])]),t._v(" "),t.action==t.ACTION.ADD?i("span",{staticStyle:{color:"red","font-size":"12px","margin-top":"5px"}},[t._v(t._s(t.memo))]):i("div",{staticClass:"f-s-qx-bottom"},[i("span",{staticStyle:{color:"red","font-size":"12px","margin-top":"5px"}},[t._v(t._s(t.memo))]),t._v(" "),i("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){return t.goNext(t.tmpFiles)}}},[t._v("下 一 步")])],1)],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.showUpload,expression:"!showUpload"}],staticClass:"upload_layout"},[i("Progress",{attrs:{"stroke-width":20,percent:t.percent}})],1)])},staticRenderFns:[]};var p=i("C7Lr")(u,d,!1,function(t){i("kImE")},"data-v-1a29482e",null).exports,f=i("4YfN"),v=i.n(f),m=i("2VhM"),g=i("oFuF"),b=i("7sWg"),_=i("XQUd"),y=i("IHPB"),x=i.n(y),C=i("E4LH"),S={props:{fields:{type:Array,default:function(){return[]}}},data:function(){var t=this;return{columns:[{isCheckAll:!1,title:"名称",key:"name",slot:"name",className:"table-header-text-default",renderHeader:function(e,i){return e("div",[e("i",{class:["iconfont",t.isCheckAll?"iconyixuan-":"iconkuang-"],style:{cursor:"pointer",verticalAlign:"middle",display:"inline-block"},on:{click:t.handleCheckChange}}),e("span",{style:{marginLeft:"10px",verticalAlign:"middle"}},i.column.title)])}},{title:"类型",key:"type",slot:"type",width:100,className:"table-header-text-default"},{title:"长度",key:"width",width:70,className:"table-header-text-default"},{title:"精度",key:"precision",width:70,className:"table-header-text-default"}],list:[]}},methods:{getDataTypeLabel:g.a.getDataTypeLabel,handleCheckChange:function(){var t=this;this.isCheckAll=!this.isCheckAll,this.list.forEach(function(e){e.checked=t.isCheckAll}),this.$emit("fields-change",this.list)},handleCheckState:function(t){this.list.forEach(function(e){e.name==t.name&&(e.checked=!e.checked)}),this.setCheckAllState(),this.$emit("fields-change",this.list)},handleCheckIndexState:function(t){this.list.forEach(function(e){e.name==t.name&&(e.checkedIndex=!e.checkedIndex)}),this.$emit("fields-change",this.list)},init:function(t){this.list=t?[].concat(x()(t)):[];var e=this.list.find(function(t){return 0==t.checked});this.isCheckAll=!e},setCheckAllState:function(){if(!this.list||0==this.list.length)return this.isCheckAll=!1,!1;var t=this.list.find(function(t){return 0==t.checked});this.isCheckAll=!t},scrollTop:function(){setTimeout(function(){var t=document.querySelector("#cusSelect .ivu-table-overflowY");t&&(t.scrollTop=0)},50)},handleBlur:function(t){if(Object(C.a)(t.name))return Object(a.a)(this.$t("message.fieldNameNullError")),!1;if(Object(C.c)(t.name,32))return Object(a.a)(this.$t("message.fieldLength32Error")),!1;if(Object(C.d)(t.name))return Object(a.a)("gid,geom,version为系统字段名"),!1;for(var e=0,i=this.list.length,s=0;s<i;s++)t.name.toLowerCase()==this.list[s].name.toLowerCase()&&(e+=1);return e>=2?(Object(a.a)(this.$t("message.fieldExistError",{name:t.name})),!1):void 0},handleChange:function(t,e){this.$set(this.list,e,t),this.$emit("fields-change",this.list)}},watch:{fields:{handler:function(t){this.init(t)}}},created:function(){this.init(this.fields)}},w={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{staticClass:"cus-view",attrs:{border:"",height:"200",columns:t.columns,data:t.list,id:"cusSelect"},scopedSlots:t._u([{key:"name",fn:function(e){var s=e.row;return[s.checked?i("i",{staticClass:"iconfont iconyixuan-",staticStyle:{cursor:"pointer","vertical-align":"middle",display:"inline-block"},on:{click:function(e){return t.handleCheckState(s)}}}):i("i",{staticClass:"iconfont iconkuang-",staticStyle:{cursor:"pointer","vertical-align":"middle",display:"inline-block"},on:{click:function(e){return t.handleCheckState(s)}}}),t._v(" "),i("span",{staticStyle:{"margin-left":"6px","vertical-align":"middle"}},[t._v(t._s(s.name))])]}},{key:"type",fn:function(e){var i=e.row;return[t._v(t._s(t.getDataTypeLabel(i.type)))]}}])})},staticRenderFns:[]};var D=i("C7Lr")(S,w,!1,function(t){i("DYzw")},"data-v-3c6b4a0a",null).exports,k=i("Izdj"),F={components:{Dialog:c.a,CsPage:n.a},mixins:[k.a],data:function(){return{charsets:s.I,tableHeight:0,list:[],visible:!1,columns:[],title:"数据预览",key:"",pageSize:5*s.y,total:0,current:1,selfLayerInfo:null,code:s.d}},watch:{totalHeight:function(t){this.tableHeight=t>0?t-113:0}},methods:{clear:function(){this.list=[],this.columns=[],this.pageSize=5*s.y,this.total=0,this.current=1,this.selfLayerInfo=null,this.code=s.d},show:function(t){this.clear(),this.onResize&&this.onResize(),t=t||{},this.selfLayerInfo=v()({},t),this.code=this.selfLayerInfo.encode?this.selfLayerInfo.encode:s.d,this.queryAttributes(t,this.pageSize,this.current),this.visible=!0},handleClose:function(){this.clear(),this.tableHeight=0,this.offResize&&this.offResize(),this.visible=!1},handleCodeChange:function(){this.queryAttributes(this.selfLayerInfo,this.pageSize,this.current)},handlePageSizeChange:function(t){this.current=1,this.pageSize=t,this.queryAttributes(this.selfLayerInfo,this.pageSize,this.current)},handleChangePage:function(t){this.current=t,this.queryAttributes(this.selfLayerInfo,this.pageSize,this.current)},queryAttributes:function(t,e,i){var s=this,a={id:t.id,params:{name:t.name,path:t.path,encode:this.code,page:i,page_size:e},success:function(t){var e=t=t||{},i=e.fields,a=void 0===i?[]:i,n=e.rows,l=void 0===n?[]:n,r=e.total,o=void 0===r?0:r;s.columns=[],a.forEach(function(t){s.columns.push({title:t.name,key:t.name,className:"table-header-text-default",ellipsis:!0,minWidth:150})}),s.list=l,s.total=o}};this.$http.getLayerAttributes(a)}}},T={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Dialog",{staticClass:"cus-view",attrs:{isShowBottomBtn:!1,title:t.title,fullscreen:!0,visible:t.visible,showStep:!1,isShowBg:!0},on:{cus_cancel:t.handleClose}},[i("Table",{staticClass:"cus-view",attrs:{border:"",columns:t.columns,data:t.list,"max-height":t.tableHeight}}),t._v(" "),i("Row",{staticClass:"cus-view",staticStyle:{"padding-top":"16px"},attrs:{type:"flex",justify:"end",align:"middle"}},[i("Col",{attrs:{span:"24"}},[i("p",{staticStyle:{display:"inline-block","vertical-align":"middle",color:"#4087f7"}},[t._v("若出现乱码请修改编码")]),t._v(" "),i("Select",{staticStyle:{width:"120px",margin:"0 12px"},on:{"on-change":t.handleCodeChange},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}},t._l(t.charsets,function(e,s){return i("Option",{key:s,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1),t._v(" "),i("CsPage",{attrs:{current:t.current,"page-size":t.pageSize,total:t.total},on:{"on-page-size-change":t.handlePageSizeChange,"on-change":t.handleChangePage}})],1)],1)],1)},staticRenderFns:[]},O=i("C7Lr")(F,T,!1,null,null,null).exports,z=i("uoUy"),E=i("mqoy"),j={components:{OriginOffsetDialog:b.a,KJCKDialog:_.a,FieldsSelect:D,PreviewDataDialog:O,SrsDialog:E.a},data:function(){return{heightArr:s.m,curTab:"tab1",tabs:[{label:"基础参数",name:"tab1"},{label:"造型参数",name:"tab2"},{label:"其它参数",name:"tab3"}],compress:!1,hasMetaData:!1,file:null,name:"",enu:"",crs:null,originOffset:{x:0,y:0,z:0},textureFormat:z.a.DEFAULT,textureArr:z.b,action:s.a.ADD,ACTIONS:s.a,id:null,modelType:h.b.NONE,encode:s.d,charsets:s.I,fields:[],layerType:null,featureCount:0,isSourceCRS:!1,path:null,jzHeightType:s.l.FIXED,jzHeight:10,jzField:"",jzFieldFactor:1,dmHeightType:s.l.FIXED,dmHeight:0,dmField:"",dmFieldFactor:1,isAbsoluteHeight:!1,outline:!1,sourceName:"",selectFields:[]}},computed:{isJZFixed:function(){return this.jzHeightType===s.l.FIXED},isDMFixed:function(){return this.dmHeightType===s.l.FIXED},originOffsetLabel:function(){var t=this.originOffset||{},e=t.x,i=void 0===e?0:e,s=t.y,a=void 0===s?0:s,n=t.z;return[i,a,void 0===n?0:n].join()},spaceLabel:function(){return this.enu?"ENU:"+this.enu.lat+","+this.enu.lng:this.crs?""+this.crs.code:""},numberFields:function(){return g.a.getNumberFields(this.fields)}},methods:{setTableScroll:function(){this.$refs.fieldsSelect&&this.$refs.fieldsSelect.scrollTop()},handleViewClick:function(){var t={encode:this.encode,name:this.sourceName,path:this.path,id:1};this.$refs.preData&&this.$refs.preData.show(t)},handleFieldsChange:function(t){var e=this;t=t||[],this.fields=t,this.selectFields=[],this.fields&&this.fields.forEach(function(t){t.checked&&e.selectFields.push(t.name)})},clear:function(){this.curTab="tab1",this.compress=!1,this.hasMetaData=!1,this.file=null,this.name="",this.enu=null,this.crs=null,this.originOffset={x:0,y:0,z:0},this.textureFormat=z.a.DEFAULT,this.action=s.a.ADD,this.id=null,this.modelType=h.b.NONE,this.encode=s.d,this.fields=[],this.layerType=null,this.featureCount=0,this.isSourceCRS=!1,this.path=null,this.jzHeightType=s.l.FIXED,this.jzHeight=10,this.jzField="",this.jzFieldFactor=1,this.dmHeightType=s.l.FIXED,this.dmHeight=0,this.dmField="",this.dmFieldFactor=1,this.isAbsoluteHeight=!1,this.outline=!1,this.sourceName="",this.selectFields=[],this.setTableScroll()},show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.clear();var i=e.files,a=void 0===i?[]:i,n=e.id,l=void 0===n?null:n,r=e.action,o=void 0===r?s.a.ADD:r,c=e.modelType;if(a=a||[],this.action=o,this.id=l,this.modelType=c,o===s.a.ADD)a.length>0&&(this.file=v()({},a[0])),this.queryMetaData();else{var h={id:l,success:function(e){var i=e||{},n=i.name,r=void 0===n?null:n,o=i.detail,c=void 0===o?{}:o,h=c.tile,u=void 0===h?{}:h,d=c.source,p=void 0===d?{}:d,f=p.enu,m=p.crs,b=p.path,_=u.draco,y=void 0===_?{}:_,x=u.texture,C=void 0===x?{}:x,S=y.compress,w=void 0!==S&&S,D=C.format,k=void 0===D?z.a.DEFAULT:D;t.name=r,t.encode=p.encode,t.enu=f,t.crs=m,t.originOffset=p.origin_offset||{x:0,y:0,z:0},t.compress=w,t.textureFormat=k,t.selectFields=p.fields||[],t.isAbsoluteHeight=p.is_absolute_height,t.outline=p.outline;var F=p.top_height,T=void 0===F?{}:F,O=p.base_height,E=void 0===O?{}:O,j=p.layer_name;t.sourceName=j,t.jzHeightType=T.is_fixed?s.l.FIXED:s.l.VARING,t.jzHeight=T.is_fixed?p.top_height.value:10,t.jzField=T.is_fixed?"":T.field,t.jzFieldFactor=T.is_fixed?1:T.factor,t.dmHeightType=E.is_fixed?s.l.FIXED:s.l.VARING,t.dmHeight=E.is_fixed?p.base_height.value:0,t.dmField=E.is_fixed?"":E.field,t.dmFieldFactor=E.is_fixed?1:E.factor,t.path=b;var I={id:l,params:{path:b,name:j,type:t.modelType,encode:t.encode},success:function(e){var i=e=e||{},n=i.fields,l=void 0===n?[]:n,r=i.srs,o=void 0===r?null:r,c=i.type,h=i.count,u=void 0===h?0:h,d=(i.name,i.path),p=void 0===d?"":d;if(a.length>0){t.file=v()({},a[0]);var f=t.file||{},m=f.path,_=f.name,y={id:f.id,params:{path:m,name:_,type:t.modelType,encode:t.encode},success:function(e){var i=e=e||{},a=i.fields,n=void 0===a?[]:a,l=i.srs,r=void 0===l?null:l,o=i.type,c=i.count,h=void 0===c?0:c,u=i.name,d=void 0===u?"":u,p=i.path,f=void 0===p?"":p;if(t.selectFields=[],n&&n.forEach(function(e){e.checked=!0,t.selectFields.push(e.name)}),t.fields=n||[],r){var v=r.auth_name,m=r.srid,b=r.proj4,_=r.wkt;t.crs={code:v+":"+m,proj4:b,wkt:_}}t.name=d,t.sourceName=d,t.path=f,t.layerType=g.a.getDatasetTypeLabel(o),t.featureCount=h,t.crs?t.isSourceCRS=!0:t.isSourceCRS=!1,T.is_fixed||(t.jzHeightType=s.l.FIXED,t.jzHeight=10,t.jzField="",t.jzFieldFactor=1),E.is_fixed||(t.dmHeightType=s.l.FIXED,t.dmHeight=0,t.dmField="",t.dmFieldFactor=1)}};t.$http.getModelMetaData(y)}else{if(l&&l.forEach(function(e){t.selectFields&&t.selectFields.indexOf(e.name)>=0?e.checked=!0:e.checked=!1}),t.fields=l||[],o){var x=o.auth_name,C=o.srid,S=o.proj4,w=o.wkt;t.crs={code:x+":"+C,proj4:S,wkt:w}}t.path=p,t.layerType=g.a.getDatasetTypeLabel(c),t.featureCount=u,t.isSourceCRS=!!o,t.file={path:b}}}};t.$http.getModelMetaData(I)}};this.$http.getTileset3DByID(h)}},queryMetaData:function(){var t=this,e=this.file||{},i=e.path,s=e.name,a={id:e.id,params:{path:i,name:s,type:this.modelType,encode:this.encode},success:function(e){var i=e=e||{},s=i.fields,a=void 0===s?[]:s,n=i.srs,l=void 0===n?null:n,r=i.type,o=i.count,c=void 0===o?0:o,h=i.name,u=void 0===h?"":h,d=i.path,p=void 0===d?"":d;if(a&&a.forEach(function(e){e.checked=!0,t.selectFields.push(e.name)}),t.fields=a||[],l){var f=l.auth_name,v=l.srid,m=l.proj4,b=l.wkt;t.crs={code:f+":"+v,proj4:m,wkt:b}}t.name=u,t.sourceName=u,t.path=p,t.layerType=g.a.getDatasetTypeLabel(r),t.featureCount=c,t.originOffset={x:0,y:0,z:0},t.crs?t.isSourceCRS=!0:t.isSourceCRS=!1}};this.$http.getModelMetaData(a)},reUpload:function(){this.setTableScroll(),this.$emit("previous",{step:2})},handleOk:function(){var t=this;if(C.b(this.name))return Object(a.a)("名称不能为空!"),!1;if(!this.file)return Object(a.a)("路径不能为空!"),!1;if(!this.enu&&!this.crs)return Object(a.a)("空间参考不能为空!"),!1;var e=null,i=null;if(this.isJZFixed){if(!g.a.isNumber(this.jzHeight))return Object(a.a)("建筑高度不是数字!"),!1;e={isFixed:!0,field:"",factor:1,value:this.jzHeight}}else{if(C.b(this.jzField))return Object(a.a)("非固定高度模式下建筑高度字段不能为空!"),!1;if(!g.a.isNumber(this.jzFieldFactor))return Object(a.a)("建筑高度系数不是数字!"),!1;e={isFixed:!1,field:this.jzField,factor:this.jzFieldFactor,value:0}}if(this.isDMFixed){if(!g.a.isNumber(this.dmHeight))return Object(a.a)("底面高度不是数字!"),!1;i={isFixed:!0,field:"",factor:1,value:this.dmHeight}}else{if(C.b(this.dmField))return Object(a.a)("非固定高度模式下底面高度字段不能为空!"),!1;if(!g.a.isNumber(this.dmFieldFactor))return Object(a.a)("底面高度系数不是数字!"),!1;i={isFixed:!1,field:this.dmField,factor:this.dmFieldFactor,value:0}}var n={name:this.name,path:this.path,type:h.b.SHP,enu:this.enu?{lng:this.enu.lng,lat:this.enu.lat}:null,crs:this.crs?{code:this.crs.code,proj4:this.crs.proj4,wkt:this.crs.wkt}:null,originOffset:this.originOffset?v()({},this.originOffset):null,topHeight:e,baseHeight:i,compress:this.compress,textureFormat:this.textureFormat,fields:this.selectFields,isAbsoluteHeight:this.isAbsoluteHeight,outline:this.outline,encode:this.encode,layerName:this.sourceName},l=m.a.createTYMX(n);if(!l)return Object(a.a)("参数错误!"),!1;this.action==s.a.ADD?this.$Modal.confirm({title:"提示",content:"<p>确定要发布切片服务吗？</p>",onOk:function(){var e={params:l,success:function(e){t.goNext()}};t.$http.createTileset3D(e)}}):this.$Modal.confirm({title:"提示",content:"<p>确定要修改切片服务吗？</p>",onOk:function(){var e={params:l,id:t.id,success:function(e){t.goNext()}};t.$http.updateTileset3D(e)}})},showKJCKDialog:function(){this.$refs.kjckDialog.show({enu:this.enu,crs:this.crs})},showSrsDialog:function(t){this.$refs.srsDialog.show()},goNext:function(){this.$emit("next",{step:2})},handleOnSetKJCK:function(t){this.enu=t.enu,this.crs=t.crs},handleSrsSelect:function(t){this.enu=null;var e=t.auth_name,i=t.srid,s=t.proj4,a=t.wkt;this.crs={code:e+":"+i,proj4:s,wkt:a}},showOriginOffsetDialog:function(){this.$refs.originOffsetDialog.show(this.originOffset)},handleOnSet:function(t){this.originOffset=v()({},t)}}},I={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Tabs",{attrs:{type:"card"},model:{value:t.curTab,callback:function(e){t.curTab=e},expression:"curTab"}},[i("TabPane",{attrs:{label:t.tabs[0].label,name:t.tabs[0].name}},[i("div",{staticClass:"i-s-item"},[i("div",{staticClass:"left-pannel"},[i("span",[t._v("*")]),t._v("名称")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span",[t._v("*")]),t._v("编码")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{placeholder:"请输入名称,长度不能超过64",maxlength:64},model:{value:t.name,callback:function(e){t.name="string"==typeof e?e.trim():e},expression:"name"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Select",{attrs:{transfer:!0},model:{value:t.encode,callback:function(e){t.encode="string"==typeof e?e.trim():e},expression:"encode"}},t._l(t.charsets,function(e,s){return i("Option",{key:s,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1)],1),t._v(" "),i("div",{staticClass:"i-s-item row-item-split"},[i("div",{staticClass:"left-pannel"},[i("span",[t._v("*")]),t._v("空间参考")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span"),t._v("零点坐标")])]),t._v(" "),t.isSourceCRS?i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:"",placeholder:"请设置空间参考"},model:{value:t.spaceLabel,callback:function(e){t.spaceLabel=e},expression:"spaceLabel"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Row",{attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"21"}},[i("Input",{attrs:{disabled:""},model:{value:t.originOffsetLabel,callback:function(e){t.originOffsetLabel=e},expression:"originOffsetLabel"}})],1),t._v(" "),i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"3"}},[i("span",{staticClass:"content-text-default span-split",on:{click:t.showOriginOffsetDialog}},[t._v("设置")])])],1)],1)],1):i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Row",{attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"21"}},[i("Input",{attrs:{disabled:"",placeholder:"请设置空间参考"},model:{value:t.spaceLabel,callback:function(e){t.spaceLabel=e},expression:"spaceLabel"}})],1),t._v(" "),i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"3"}},[i("span",{staticClass:"content-text-default span-split",on:{click:t.showSrsDialog}},[t._v("设置")])])],1)],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Row",{attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"21"}},[i("Input",{attrs:{disabled:""},model:{value:t.originOffsetLabel,callback:function(e){t.originOffsetLabel=e},expression:"originOffsetLabel"}})],1),t._v(" "),i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"3"}},[i("span",{staticClass:"content-text-default span-split",on:{click:t.showOriginOffsetDialog}},[t._v("设置")])])],1)],1)],1)],1),t._v(" "),i("TabPane",{attrs:{label:t.tabs[1].label,name:t.tabs[1].name}},[i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle",gutter:16}},[i("Col",{attrs:{span:"3"}},[i("span",[t._v("建筑高度")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Select",{attrs:{transfer:!0},model:{value:t.jzHeightType,callback:function(e){t.jzHeightType="string"==typeof e?e.trim():e},expression:"jzHeightType"}},t._l(t.heightArr,function(e,s){return i("Option",{key:s,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),t._v(" "),i("Col",{attrs:{span:"8"}},[t.isJZFixed?i("Input",{attrs:{placeholder:"请输入建筑高度"},model:{value:t.jzHeight,callback:function(e){t.jzHeight=t._n(e)},expression:"jzHeight"}}):i("Select",{attrs:{transfer:!0,placeholder:"请选择字段"},model:{value:t.jzField,callback:function(e){t.jzField=e},expression:"jzField"}},t._l(t.numberFields,function(e,s){return i("Option",{key:s,attrs:{value:e.name}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),t.isJZFixed?t._e():i("Col",{attrs:{span:"5"}},[i("div",{staticClass:"s-s-shp-height"},[i("span",[t._v("X")]),i("Input",{attrs:{placeholder:"请输入系数"},model:{value:t.jzFieldFactor,callback:function(e){t.jzFieldFactor=t._n(e)},expression:"jzFieldFactor"}})],1)])],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle",gutter:16}},[i("Col",{attrs:{span:"3"}},[i("span",[t._v("底面高度")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Select",{attrs:{transfer:!0},model:{value:t.dmHeightType,callback:function(e){t.dmHeightType="string"==typeof e?e.trim():e},expression:"dmHeightType"}},t._l(t.heightArr,function(e,s){return i("Option",{key:s,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1),t._v(" "),i("Col",{attrs:{span:"8"}},[t.isDMFixed?i("Input",{attrs:{placeholder:"请输入底面高度"},model:{value:t.dmHeight,callback:function(e){t.dmHeight=t._n(e)},expression:"dmHeight"}}):i("Select",{attrs:{transfer:!0,placeholder:"请选择字段"},model:{value:t.dmField,callback:function(e){t.dmField=e},expression:"dmField"}},t._l(t.numberFields,function(e,s){return i("Option",{key:s,attrs:{value:e.name}},[t._v(t._s(e.name))])}),1)],1),t._v(" "),t.isDMFixed?t._e():i("Col",{attrs:{span:"5"}},[i("div",{staticClass:"s-s-shp-height"},[i("span",[t._v("X")]),t._v(" "),i("Input",{attrs:{placeholder:"请输入系数"},model:{value:t.dmFieldFactor,callback:function(e){t.dmFieldFactor=t._n(e)},expression:"dmFieldFactor"}})],1)])],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle",gutter:16}},[i("Col",{attrs:{span:"3"}},[i("span",[t._v("绝对高度")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Checkbox",{model:{value:t.isAbsoluteHeight,callback:function(e){t.isAbsoluteHeight=e},expression:"isAbsoluteHeight"}})],1),t._v(" "),i("Col",{attrs:{span:"3"}},[i("span",[t._v("仅外轮廓")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Checkbox",{model:{value:t.outline,callback:function(e){t.outline=e},expression:"outline"}})],1)],1)],1),t._v(" "),i("TabPane",{attrs:{label:t.tabs[2].label,name:t.tabs[2].name}},[i("div",{staticClass:"i-s-item row-item-split"},[i("div",{staticClass:"left-pannel"},[i("span"),t._v("顶点压缩")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span"),t._v("纹理格式")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:"12"}},[i("Checkbox",{model:{value:t.compress,callback:function(e){t.compress=e},expression:"compress"}},[t._v("压缩")])],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Select",{attrs:{transfer:!0},model:{value:t.textureFormat,callback:function(e){t.textureFormat=e},expression:"textureFormat"}},t._l(t.textureArr,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1)],1),t._v(" "),i("div",{staticClass:"i-s-item row-item-split"},[i("div",{staticClass:"left-pannel"},[i("span"),t._v("图元类型")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span"),t._v("图元数量")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.layerType,callback:function(e){t.layerType="string"==typeof e?e.trim():e},expression:"layerType"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.featureCount,callback:function(e){t.featureCount="string"==typeof e?e.trim():e},expression:"featureCount"}})],1)],1)],1)],1),t._v(" "),i("p",{staticClass:"row-item-split"},[t._v("选择存储字段")]),t._v(" "),i("FieldsSelect",{ref:"fieldsSelect",staticClass:"row-item-split",attrs:{fields:t.fields},on:{"fields-change":t.handleFieldsChange}}),t._v(" "),i("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"flex-end",width:"100%","margin-top":"16px"}},[i("Button",{staticStyle:{"margin-right":"20px",width:"60px"},on:{click:function(e){return e.stopPropagation(),t.handleViewClick.apply(null,arguments)}}},[t._v("预览")]),t._v(" "),i("Button",{staticStyle:{float:"right","margin-right":"16px"},on:{click:t.reUpload}},[t._v(t._s(t.action==t.ACTIONS.ADD?"重新上传":"上一步"))]),t._v(" "),i("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("确定")])],1),t._v(" "),i("SrsDialog",{ref:"srsDialog",on:{"on-select":t.handleSrsSelect}}),t._v(" "),i("OriginOffsetDialog",{ref:"originOffsetDialog",on:{"on-set":t.handleOnSet}}),t._v(" "),i("PreviewDataDialog",{ref:"preData"})],1)},staticRenderFns:[]};var L=i("C7Lr")(j,I,!1,function(t){i("NnjQ")},"data-v-51a6b288",null).exports,A={components:{Dialog:c.a,FirstStep:p,SecondStepSHP:L},data:function(){return{curTab:h.b.SHP,visible:!1,total:2,curStep:1,titles:["上传模型","发布切片"],action:s.a.ADD,id:null,tabs:h.a,modelSourceType:h.b}},computed:{isShowTabs:function(){return 1===this.curStep&&this.action===s.a.ADD},title:function(){return this.titles?this.action+"----"+this.titles[this.curStep-1]:""}},methods:{clear:function(){this.visible=!1,this.curStep=1,this.action=s.a.ADD,this.id=null,this.curTab=h.b.SHP},show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.clear();var i=e.action,a=void 0===i?s.a.ADD:i,n=e.id,l=void 0===n?null:n;if(this.action=a,this.id=l,this.$refs.firstStep&&this.$refs.firstStep.clear(),a!==s.a.ADD){var r={id:l,success:function(e){t.curTab=e.detail.source.type}};this.$http.getTileset3DByID(r)}this.visible=!0},handleClose:function(){this.visible=!1,this.$emit("close-fb")},nextStep:function(t){if(1==t.step){var e=t.files||null;this.action==s.a.ADD?this.curTab===h.b.SHP?e&&e.length>0&&(this.$refs.secondStepShp&&this.$refs.secondStepShp.show({files:e,id:this.id,action:this.action,modelType:this.curTab}),this.curStep++):(this.$refs.secondStepShp&&this.$refs.secondStepShp.show({files:e,id:this.id,action:this.action,modelType:this.curTab}),this.curStep++):this.curTab===h.b.SHP&&(this.$refs.secondStepShp&&this.$refs.secondStepShp.show({files:e,id:this.id,action:this.action,modelType:this.curTab}),this.curStep++)}else 2==t.step&&this.handleClose()},previousStep:function(t){if(2==t.step){var e=this.action===s.a.ADD;this.$refs.firstStep&&this.$refs.firstStep.clear(e),this.curStep--}}}},$={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Dialog",{attrs:{isShowBottomBtn:!1,title:t.title,visible:t.visible,showStep:!0,total:t.total,num:t.curStep,styles:{top:"20vh",width:"700px"}},on:{cus_cancel:t.handleClose}},[i("Tabs",{directives:[{name:"show",rawName:"v-show",value:t.isShowTabs,expression:"isShowTabs"}],attrs:{type:"card"},model:{value:t.curTab,callback:function(e){t.curTab=e},expression:"curTab"}},t._l(t.tabs,function(t,e){return i("TabPane",{key:e,attrs:{label:t.label,name:t.value}})}),1),t._v(" "),i("FirstStep",{directives:[{name:"show",rawName:"v-show",value:1===t.curStep,expression:"curStep === 1"}],ref:"firstStep",attrs:{action:t.action,"model-type":t.curTab},on:{next:t.nextStep}}),t._v(" "),i("SecondStepSHP",{directives:[{name:"show",rawName:"v-show",value:2===t.curStep&&t.curTab===t.modelSourceType.SHP,expression:"curStep === 2 && curTab === modelSourceType.SHP"}],ref:"secondStepShp",on:{next:t.nextStep,previous:t.previousStep}})],1)},staticRenderFns:[]};var N=i("C7Lr")(A,$,!1,function(t){i("q6J6")},"data-v-85f653a0",null).exports,H=i("h72K"),R=i("T452"),P={props:{fields:{type:Array,default:function(){return[]}}},data:function(){return{columns:[{title:"选择",width:70,key:"checked",slot:"checked",className:"table-header-text-default"},{title:"名称",key:"name",className:"table-header-text-default"},{title:"类型",key:"type",slot:"type",width:100,className:"table-header-text-default"},{title:"长度",key:"width",width:70,className:"table-header-text-default"},{title:"精度",key:"precision",width:70,className:"table-header-text-default"}],list:[]}},methods:{getDataTypeLabel:g.a.getDataTypeLabel,handleCheckChange:function(){var t=this;this.isCheckAll=!this.isCheckAll,this.list.forEach(function(e){e.checked=t.isCheckAll}),this.$emit("fields-change",this.list)},handleCheckState:function(t){this.list.forEach(function(e){e.name==t.name&&(e.checked=!e.checked)}),this.setCheckAllState(),this.$emit("fields-change",this.list)},handleCheckIndexState:function(t){this.list.forEach(function(e){e.name==t.name&&(e.checkedIndex=!e.checkedIndex)}),this.$emit("fields-change",this.list)},init:function(t){this.list=t?[].concat(x()(t)):[];var e=this.list.find(function(t){return 0==t.checked});this.isCheckAll=!e},setCheckAllState:function(){if(!this.list||0==this.list.length)return this.isCheckAll=!1,!1;var t=this.list.find(function(t){return 0==t.checked});this.isCheckAll=!t},scrollTop:function(){setTimeout(function(){var t=document.querySelector("#cusSelect .ivu-table-overflowY");t&&(t.scrollTop=0)},50)},handleBlur:function(t){if(Object(C.a)(t.name))return Object(a.a)(this.$t("message.fieldNameNullError")),!1;if(Object(C.c)(t.name,32))return Object(a.a)(this.$t("message.fieldLength32Error")),!1;if(Object(C.d)(t.name))return Object(a.a)("gid,geom,version为系统字段名"),!1;for(var e=0,i=this.list.length,s=0;s<i;s++)t.name.toLowerCase()==this.list[s].name.toLowerCase()&&(e+=1);return e>=2?(Object(a.a)(this.$t("message.fieldExistError",{name:t.name})),!1):void 0},handleChange:function(t,e){this.$set(this.list,e,t),this.$emit("fields-change",this.list)}},watch:{fields:{handler:function(t){this.init(t)}}},created:function(){this.init(this.fields)}},U={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Table",{staticClass:"cus-view",attrs:{border:"",height:"200",columns:t.columns,data:t.list,id:"cusSelect"},scopedSlots:t._u([{key:"checked",fn:function(e){var s=e.row;return[i("Checkbox",{attrs:{disabled:""},model:{value:s.checked,callback:function(e){t.$set(s,"checked",e)},expression:"row.checked"}})]}},{key:"type",fn:function(e){var i=e.row;return[t._v(t._s(t.getDataTypeLabel(i.type)))]}}])})},staticRenderFns:[]};var B={components:{FieldsDetail:i("C7Lr")(P,U,!1,function(t){i("cG1s")},"data-v-44471a13",null).exports},props:{tileDetail:{type:Object},serviceUrl:{type:String,default:""},name:{type:String,default:""}},data:function(){return{heightArr:s.m,curTab:"tab1",tabs:[{label:"基础参数",name:"tab1"},{label:"造型参数",name:"tab2"},{label:"其它参数",name:"tab3"}],compress:!1,file:null,enu:"",crs:null,originOffset:{x:0,y:0,z:0},modelType:h.b.NONE,textureFormat:z.a.DEFAULT,encode:s.d,fields:[],layerType:null,featureCount:0,isSourceCRS:!1,path:null,jzHeightType:s.l.FIXED,jzHeight:10,jzField:"",jzFieldFactor:1,dmHeightType:s.l.FIXED,dmHeight:0,dmField:"",dmFieldFactor:1,isAbsoluteHeight:!1,outline:!1,layerName:"",selectFields:[]}},watch:{tileDetail:{handler:function(t){var e=t.source,i=void 0===e?{}:e,a=t.tile,n=void 0===a?{}:a,l=n.draco,r=void 0===l?{}:l,o=n.texture,c=void 0===o?{}:o,h=r.compress,u=void 0!==h&&h,d=c.format,p=void 0===d?z.a.DEFAULT:d,f=i.layer_name,v=i.enu,m=void 0===v?null:v,g=i.crs,b=void 0===g?null:g,_=i.origin_offset,y=void 0===_?{x:0,y:0,z:0}:_,x=i.encode,C=void 0===x?s.d:x,S=i.fields,w=void 0===S?[]:S,D=i.is_absolute_height,k=void 0!==D&&D,F=i.top_height,T=void 0===F?{}:F,O=i.base_height,E=void 0===O?{}:O,j=i.outline,I=void 0!==j&&j,L=i.path,A=i.type;this.compress=u,this.file={path:L,id:1,name:f},this.enu=m,this.crs=b,this.originOffset=y,this.textureFormat=p,this.encode=C,this.path=L,this.isAbsoluteHeight=k,this.outline=I,this.layerName=f,this.selectFields=w,this.jzHeightType=T.is_fixed?s.l.FIXED:s.l.VARING,this.jzField=T.is_fixed?"":T.field,this.jzHeight=T.is_fixed?T.value:10,this.jzFieldFactor=T.is_fixed?T.factor:1,this.dmHeightType=E.is_fixed?s.l.FIXED:s.l.VARING,this.dmField=E.is_fixed?"":E.field,this.dmHeight=E.is_fixed?E.value:10,this.dmFieldFactor=E.is_fixed?E.factor:1,this.modelType=A,this.queryMetaData()},deep:!0,immediate:!0}},computed:{isJZFixed:function(){return this.jzHeightType===s.l.FIXED},isDMFixed:function(){return this.dmHeightType===s.l.FIXED},originOffsetLabel:function(){var t=this.originOffset||{},e=t.x,i=void 0===e?0:e,s=t.y,a=void 0===s?0:s,n=t.z;return[i,a,void 0===n?0:n].join()},spaceLabel:function(){return this.enu?"ENU:"+this.enu.lat+","+this.enu.lng:this.crs?""+this.crs.code:""},jzHeightTypeLabel:function(){var t=this,e=s.m.find(function(e){return e.value===t.jzHeightType});return e?e.label:""},dmHeightTypeLabel:function(){var t=this,e=s.m.find(function(e){return e.value===t.dmHeightType});return e?e.label:""}},methods:{setTableScroll:function(){this.$refs.fieldsDetail&&this.$refs.fieldsDetail.scrollTop()},queryMetaData:function(){var t=this,e=this.file||{},i=e.path,s=e.name,a={id:e.id,params:{path:i,name:s,type:this.modelType,encode:this.encode},success:function(e){var i=e=e||{},s=i.fields,a=void 0===s?[]:s,n=i.srs,l=void 0===n?null:n,r=i.type,o=i.count,c=void 0===o?0:o,h=i.name,u=void 0===h?"":h,d=i.path,p=void 0===d?"":d;if(a&&a.forEach(function(e){e.checked=!0,t.selectFields&&t.selectFields.indexOf(e.name)>=0?e.checked=!0:e.checked=!1}),t.fields=[].concat(x()(a||[])),l){var f=l.auth_name,v=l.srid,m=l.proj4,b=l.wkt;t.crs={code:f+":"+v,proj4:m,wkt:b}}t.name=u,t.path=p,t.layerType=g.a.getDatasetTypeLabel(r),t.featureCount=c,t.originOffset={x:0,y:0,z:0}}};this.$http.getModelMetaData(a)}}},M={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cus-view-detail"},[i("Tabs",{attrs:{type:"card"},model:{value:t.curTab,callback:function(e){t.curTab=e},expression:"curTab"}},[i("TabPane",{attrs:{label:t.tabs[0].label,name:t.tabs[0].name}},[i("div",{staticClass:"i-s-item"},[i("div",{staticClass:"left-pannel"},[i("span",[t._v("*")]),t._v("名称")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span",[t._v("*")]),t._v("编码")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:"",maxlength:64},model:{value:t.name,callback:function(e){t.name="string"==typeof e?e.trim():e},expression:"name"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:"",maxlength:64},model:{value:t.encode,callback:function(e){t.encode="string"==typeof e?e.trim():e},expression:"encode"}})],1)],1),t._v(" "),i("div",{staticClass:"i-s-item row-item-split"},[i("div",{staticClass:"left-pannel"},[i("span",[t._v("*")]),t._v("空间参考")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span"),t._v("零点坐标")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:"",placeholder:"请设置空间参考"},model:{value:t.spaceLabel,callback:function(e){t.spaceLabel=e},expression:"spaceLabel"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.originOffsetLabel,callback:function(e){t.originOffsetLabel=e},expression:"originOffsetLabel"}})],1)],1),t._v(" "),i("div",{staticClass:"i-s-item row-item-split"},[i("div",{staticClass:"left-pannel"},[i("span"),t._v("访问地址")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"24"}},[i("Input",{attrs:{disabled:""},model:{value:t.serviceUrl,callback:function(e){t.serviceUrl=e},expression:"serviceUrl"}})],1)],1)],1),t._v(" "),i("TabPane",{attrs:{label:t.tabs[1].label,name:t.tabs[1].name}},[i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle",gutter:16}},[i("Col",{attrs:{span:"3"}},[i("span",[t._v("建筑高度")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Input",{attrs:{disabled:""},model:{value:t.jzHeightTypeLabel,callback:function(e){t.jzHeightTypeLabel=e},expression:"jzHeightTypeLabel"}})],1),t._v(" "),i("Col",{attrs:{span:"8"}},[t.isJZFixed?i("Input",{attrs:{disabled:"",placeholder:"请输入建筑高度"},model:{value:t.jzHeight,callback:function(e){t.jzHeight=e},expression:"jzHeight"}}):i("Input",{attrs:{placeholder:"请输入建筑高度",disabled:""},model:{value:t.jzField,callback:function(e){t.jzField=e},expression:"jzField"}})],1),t._v(" "),t.isJZFixed?t._e():i("Col",{attrs:{span:"5"}},[i("div",{staticClass:"s-s-shp-height"},[i("span",[t._v("X")]),i("Input",{attrs:{placeholder:"请输入系数",disabled:""},model:{value:t.jzFieldFactor,callback:function(e){t.jzFieldFactor=t._n(e)},expression:"jzFieldFactor"}})],1)])],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle",gutter:16}},[i("Col",{attrs:{span:"3"}},[i("span",[t._v("底面高度")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Input",{attrs:{disabled:""},model:{value:t.dmHeightTypeLabel,callback:function(e){t.dmHeightTypeLabel=e},expression:"dmHeightTypeLabel"}})],1),t._v(" "),i("Col",{attrs:{span:"8"}},[t.isDMFixed?i("Input",{attrs:{placeholder:"请输入底面高度",disabled:""},model:{value:t.dmHeight,callback:function(e){t.dmHeight=t._n(e)},expression:"dmHeight"}}):i("Input",{attrs:{placeholder:"请输入底面高度",disabled:""},model:{value:t.dmField,callback:function(e){t.dmField=t._n(e)},expression:"dmField"}})],1),t._v(" "),t.isDMFixed?t._e():i("Col",{attrs:{span:"5"}},[i("div",{staticClass:"s-s-shp-height"},[i("span",[t._v("X")]),t._v(" "),i("Input",{attrs:{disabled:"",placeholder:"请输入系数"},model:{value:t.dmFieldFactor,callback:function(e){t.dmFieldFactor=t._n(e)},expression:"dmFieldFactor"}})],1)])],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle",gutter:16}},[i("Col",{attrs:{span:"3"}},[i("span",[t._v("绝对高度")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Checkbox",{attrs:{disabled:""},model:{value:t.isAbsoluteHeight,callback:function(e){t.isAbsoluteHeight=e},expression:"isAbsoluteHeight"}})],1),t._v(" "),i("Col",{attrs:{span:"3"}},[i("span",[t._v("仅外轮廓")])]),t._v(" "),i("Col",{attrs:{span:"8"}},[i("Checkbox",{attrs:{disabled:""},model:{value:t.outline,callback:function(e){t.outline=e},expression:"outline"}})],1)],1)],1),t._v(" "),i("TabPane",{attrs:{label:t.tabs[2].label,name:t.tabs[2].name}},[i("div",{staticClass:"i-s-item row-item-split"},[i("div",{staticClass:"left-pannel"},[i("span"),t._v("顶点压缩")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span"),t._v("纹理格式")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:"12"}},[i("Checkbox",{attrs:{disabled:""},model:{value:t.compress,callback:function(e){t.compress=e},expression:"compress"}},[t._v("压缩")])],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.textureFormat,callback:function(e){t.textureFormat=e},expression:"textureFormat"}})],1)],1),t._v(" "),i("div",{staticClass:"i-s-item row-item-split"},[i("div",{staticClass:"left-pannel"},[i("span"),t._v("图元类型")]),t._v(" "),i("div",{staticClass:"right-pannel"},[i("span"),t._v("图元数量")])]),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.layerType,callback:function(e){t.layerType="string"==typeof e?e.trim():e},expression:"layerType"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.featureCount,callback:function(e){t.featureCount="string"==typeof e?e.trim():e},expression:"featureCount"}})],1)],1)],1)],1),t._v(" "),i("p",{staticClass:"row-item-split"},[t._v("字段列表")]),t._v(" "),i("FieldsDetail",{ref:"fieldsDetail",staticClass:"row-item-split",attrs:{fields:t.fields}})],1)},staticRenderFns:[]};var X=i("C7Lr")(B,M,!1,function(t){i("jWD3")},"data-v-338c2fb4",null).exports,Y={components:{Dialog:c.a,TileDetailSHP:X},data:function(){return{modelSourceType:h.b,title:"通用模型切片详情",modelType:h.b.NONE,visible:!1,tileDetail:null,serviceUrl:"",name:""}},computed:{},methods:{clear:function(){this.modelType=h.b.NONE,this.tileDetail=null,this.serviceUrl="",this.visible=!1},show:function(t){var e=this;this.clear();var i={id:t,success:function(i){var s=i.detail,a=void 0===s?{}:s,n=i.name,l=void 0===n?"":n,r=a.source,o=void 0===r?{}:r;e.modelType=o.type,e.tileDetail=v()({},a),e.name=l,e.serviceUrl=Object(R.c)(t,!0,!0)}};this.$http.getTileset3DByID(i),this.visible=!0},handleClose:function(){this.clear()}}},q={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Dialog",{attrs:{isShowBottomBtn:!1,title:t.title,visible:t.visible,showStep:!1,styles:{top:"20vh",width:"700px"}},on:{cus_cancel:t.handleClose}},[t.modelType===t.modelSourceType.SHP?i("TileDetailSHP",{attrs:{"tile-detail":t.tileDetail,"service-url":t.serviceUrl,name:t.name}}):t._e()],1)},staticRenderFns:[]};var K=i("C7Lr")(Y,q,!1,function(t){i("hDZW")},"data-v-63a0307a",null).exports,G={components:{CsPage:n.a,Tileset3DPreview:l.a,QXSYDialog:r.a,QXSYDetailDialog:o.a,TYMXDialog:N,TYMXDetailDialog:K},mixins:[H.a],data:function(){return{isFB:!1,isRefresh:!0,timer:null,isNoData:!1,noDataImg:s.t,tilesetType:s.F,tilesetTypeArray:s.G,columns:[{title:"名称",key:"name",slot:"name",width:240,className:"table-header-text-default"},{title:"统计",key:"process_msg",minWidth:220,className:"table-header-text-default"},{title:"状态",key:"status",slot:"status",width:120,className:"table-header-text-default"},{title:"类型",key:"type",slot:"type",width:120,className:"table-header-text-default"},{title:"创建日期",key:"create_time",width:150,className:"table-header-text-default"},{title:"操作",slot:"action",align:"left",width:320,className:"table-header-text-default"}],list:[],key:"",current:1,pageSize:5*s.y,total:0,orderBy:s.x.DESC,fieldOrder:s.i.CREATE_TIME}},computed:{isDesc:function(){return this.orderBy==s.x.DESC}},mounted:function(){this.clear(),this.query(this.key,this.pageSize,this.current),this.isRefresh&&(this.timer=setInterval(this.timerFunc,s.K))},beforeDestroy:function(){this.timer&&clearInterval(this.timer)},methods:{handleCloseFB:function(){this.isFB=!1},handleCreateClick:function(t){switch(t){case s.F.TYPE_1:this.isFB=!0,this.$refs.tymxDialog.show({action:s.a.ADD});break;case s.F.TYPE_2:this.isFB=!0,this.$refs.qxsyDialog.show({action:s.a.ADD});break;case s.F.TYPE_3:case s.F.TYPE_4:}},isStart:function(t){return t.status!=s.C.STATUS_1},handleStopClick:function(t){var e=this;if(t.status!=s.C.STATUS_1)return Object(a.b)("任务未处理无法停止"),!1;var i=g.a.getConfirmContent("确定要停止任务吗？");this.$Modal.confirm({title:"提示",content:i,width:400,onOk:function(){var i={id:t.id,success:function(t){e.timerFunc()}};e.$http.stopTileset3DTask(i)}})},handleStartClick:function(t){var e=this;if(t.status==s.C.STATUS_1)return Object(a.b)("任务在处理中无法启动"),!1;var i=g.a.getConfirmContent("确定要启动任务吗？");this.$Modal.confirm({title:"提示",content:i,width:400,onOk:function(){var i={id:t.id,success:function(t){e.timerFunc()}};e.$http.startTileset3DTask(i)}})},handleChangeRefresh:function(){this.isRefresh=!this.isRefresh,this.isRefresh?this.timer=setInterval(this.timerFunc,s.K):this.timer&&clearInterval(this.timer)},startTimer:function(){this.timer=setInterval(this.timerFunc,s.K)},closeTimer:function(){this.timer&&clearInterval(this.timer)},getTypeLabel:g.a.getTileset3dTypeLabel,getTaskStatusLabel:g.a.getTaskStatusLabel,timerFunc:function(){this.query(this.key,this.pageSize,this.current)},handleRefresh:function(){this.query(this.key,this.pageSize,this.current)},handleTileStatus:function(t){console.log(t)},clear:function(){this.list=[],this.key="",this.current=1,this.pageSize=5*s.y,this.total=0},handleOrderByClick:function(){this.orderBy==s.x.DESC?this.orderBy=s.x.ASC:this.orderBy=s.x.DESC,this.query(this.key,this.pageSize,this.current)},handleSearch:function(){this.current=1,this.query(this.key,this.pageSize,this.current)},handleNewClick:function(){this.$refs.tilesetDialog&&this.$refs.tilesetDialog.show(s.w.CREATE)},handlePageSizeChange:function(t){this.pageSize=t,this.current=1,this.query(this.key,this.pageSize,this.current)},handleChangePage:function(t){this.current=t,this.query(this.key,this.pageSize,this.current)},query:function(t,e,i){var s=this;if(!this.isFB){var a={params:{key:t,page_size:e,page:i,sortby:this.fieldOrder,order:this.orderBy},success:function(t){t=t||{},s.total=t.total?t.total:0;var e=t.rows?t.rows:[];s.list=e}};this.$http.searchTilesets3dByKey(a)}},handleDeleteClick:function(t){var e=this;if(t.status==s.C.STATUS_1)return Object(a.b)("任务在处理中无法删除"),!1;var i=g.a.getDeleteContent(t.name);this.$Modal.confirm({title:"提示",content:i,width:400,onOk:function(){var i={id:t.id,success:function(t){t&&(e.current=e.computPageNum(e.total,e.pageSize,e.current,1),e.$bus.$emit(s.k.MODEL_STATISTICS),e.query(e.key,e.pageSize,e.current))}};e.$http.deleteTileset3DByID(i)}})},handlePreviewClick:function(t){this.offResize&&this.offResize(),this.closeTimer(),this.$refs.tileset3DPreview.show(t.id)},handleClose:function(){this.onResize&&this.onResize(),this.startTimer()},handleDetailClick:function(t){switch(t.type){case s.F.TYPE_1:this.$refs.tymxDetailDialog.show(t.id);break;case s.F.TYPE_2:this.$refs.qxsyDetailDialog.show(t.id)}},handleEditClick:function(t){if(t.status==s.C.STATUS_1)return Object(a.b)("任务在处理中无法编辑"),!1;switch(t.type){case s.F.TYPE_1:this.isFB=!0,this.$refs.tymxDialog.show({action:s.a.EDIT,id:t.id});break;case s.F.TYPE_2:this.isFB=!0,this.$refs.qxsyDialog.show({action:s.a.EDIT,id:t.id});break;case s.F.TYPE_3:case s.F.TYPE_4:}},handlePreviewTileClick:function(t){if(t.status==s.C.STATUS_1)return Object(a.b)("任务在处理中无法预缓存"),!1;var e=this.$refs.tileCacheDialog;e&&e.show(t)},isEnable:function(t){return t.status==s.C.STATUS_1}}},J={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"100%"}},[i("div",{staticClass:"right-body"},[i("Row",{staticClass:"cus-view-search right-subject-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"18"}},[i("Input",{staticStyle:{width:"250px"},attrs:{search:"",placeholder:"搜索",suffix:"ios-search"},on:{"on-enter":t.handleSearch,"on-search":t.handleSearch},model:{value:t.key,callback:function(e){t.key="string"==typeof e?e.trim():e},expression:"key"}}),t._v(" "),i("span",{staticClass:"content-text-default span-split",staticStyle:{"font-size":"14px","margin-left":"10px"},on:{click:function(e){return e.stopPropagation(),t.handleOrderByClick.apply(null,arguments)}}},[i("Icon",{staticStyle:{"font-size":"16px"},attrs:{type:t.isDesc?"md-arrow-round-down":"md-arrow-round-up"}}),t._v("时间\n        ")],1)],1),t._v(" "),i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"6"}},[i("div",{staticClass:"i-t_btn-default",on:{click:t.handleChangeRefresh}},[t._v("\n          "+t._s(t.isRefresh?"停止刷新":"启动刷新")+"\n        ")]),t._v(" "),i("Dropdown",{on:{"on-click":t.handleCreateClick}},[i("Button",{attrs:{type:"primary"}},[t._v("\n            发布\n            "),i("Icon",{attrs:{type:"ios-arrow-down"}})],1),t._v(" "),i("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.tilesetTypeArray,function(e){return i("DropdownItem",{key:e.value,attrs:{name:e.value}},[t._v(t._s(e.label))])}),1)],1)],1)],1),t._v(" "),i("div",{staticClass:"cus-view"},[i("Table",{attrs:{columns:t.columns,data:t.list,"max-height":t.tableHeight},scopedSlots:t._u([{key:"name",fn:function(e){var s=e.row;return[i("div",{staticClass:"label-ellipsis",attrs:{title:s.name}},[t._v(t._s(s.name))])]}},{key:"process_msg",fn:function(e){var s=e.row;return[i("div",[t._v(t._s(s.process_msg))])]}},{key:"status",fn:function(e){var s=e.row;return[i("div",[t._v(t._s(t.getTaskStatusLabel(s.status)))])]}},{key:"type",fn:function(e){var s=e.row;return[i("div",[t._v(t._s(t.getTypeLabel(s.type)))])]}},{key:"action",fn:function(e){var s=e.row;return[i("span",{staticClass:"content-text-default span-split",on:{click:function(e){return t.handleEditClick(s)}}},[i("i",{staticClass:"iconfont iconbianji- content-text-default"}),t._v("\n            编辑\n          ")]),t._v(" "),i("span",{staticClass:"content-text-default span-split",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleDetailClick(s)}}},[i("i",{staticClass:"iconfont iconxiangqing- content-text-default"}),t._v("\n            详情\n          ")]),t._v(" "),i("span",{staticClass:"content-text-default span-split",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleDeleteClick(s)}}},[i("i",{staticClass:"iconfont iconshanchu- content-text-default"}),t._v("\n            删除\n          ")]),t._v(" "),i("span",{staticClass:"content-text-default span-split",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handlePreviewClick(s)}}},[i("i",{staticClass:"iconfont iconliulan- content-text-default"}),t._v("\n            预览\n          ")]),t._v(" "),t.isStart(s)?i("span",{staticClass:"content-text-default span-split",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleStartClick(s)}}},[i("i",{staticClass:"iconfont iconqidong- content-text-default"}),t._v("\n            启动\n          ")]):i("span",{staticClass:"content-text-default span-split",staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.handleStopClick(s)}}},[i("i",{staticClass:"iconfont iconzanting- content-text-default"}),t._v("\n            停止\n          ")])]}}])}),t._v(" "),i("Row",{staticClass:"right-subject-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"24"}},[i("CsPage",{attrs:{current:t.current,"page-size":t.pageSize,total:t.total},on:{"on-page-size-change":t.handlePageSizeChange,"on-change":t.handleChangePage}})],1)],1)],1)],1),t._v(" "),i("Tileset3DPreview",{ref:"tileset3DPreview",on:{"comp-close":t.handleClose}}),t._v(" "),i("QXSYDialog",{ref:"qxsyDialog",on:{"close-fb":t.handleCloseFB}}),t._v(" "),i("TYMXDialog",{ref:"tymxDialog",on:{"close-fb":t.handleCloseFB}}),t._v(" "),i("QXSYDetailDialog",{ref:"qxsyDetailDialog"}),t._v(" "),i("TYMXDetailDialog",{ref:"tymxDetailDialog"})],1)},staticRenderFns:[]};var V=i("C7Lr")(G,J,!1,function(t){i("7ILc")},"data-v-4fdbcb70",null);e.default=V.exports},NnjQ:function(t,e){},ObZ3:function(t,e){},VYST:function(t,e){},XQUd:function(t,e,i){"use strict";var s=i("4YfN"),a=i.n(s),n=i("deIM"),l=i("tIHl"),r=i("mqoy"),o=i("oFuF"),c={components:{Dialog:n.a,SrsDialog:r.a},data:function(){return{visible:!1,isENU:!0,enu:null,crs:null,lng:null,lat:null,code:null}},methods:{clear:function(){this.isENU=!0,this.enu=null,this.crs=null,this.lng=null,this.lat=null,this.code=null},handleClose:function(){this.clear(),this.visible=!1},handleOk:function(){if(this.isENU){if(!o.a.isNumber(this.lng)||this.lng>180||this.lng<-180)return Object(l.a)("经度不合法!"),!1;if(!o.a.isNumber(this.lat)||this.lat>90||this.lat<-90)return Object(l.a)("纬度不合法!"),!1;this.$emit("on-set",{enu:{lng:this.lng,lat:this.lat},crs:null}),this.visible=!1,this.clear()}else{if(!this.crs)return Object(l.a)("请选择坐标系!"),!1;this.$emit("on-set",{crs:a()({},this.crs),enu:null}),this.visible=!1,this.clear()}},show:function(t){this.clear();var e=t||{},i=e.enu,s=void 0===i?null:i,n=e.crs,l=void 0===n?null:n;s?(this.enu=a()({},s),this.isENU=!0,this.lng=this.enu.lng,this.lat=this.enu.lat):this.isENU=!1,l&&(this.crs=a()({},l),this.code=this.crs.code),this.enu||this.crs||(this.isENU=!0),this.visible=!0},handleSrsSelect:function(t){var e=t.auth_name+":"+t.srid;this.crs=a()({},t,{code:e}),this.isENU=!1,this.code=e},showSrsDialog:function(){this.$refs.srsDialog.show()}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Dialog",{attrs:{isShowBottomBtn:!1,title:"设置空间参考",visible:t.visible,showStep:!1,styles:{top:"20vh",width:"450px"}},on:{cus_cancel:t.handleClose}},[i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"6"}},[i("span",[t._v("站心坐标系")])]),t._v(" "),i("Col",{attrs:{span:"18"}},[i("Checkbox",{model:{value:t.isENU,callback:function(e){t.isENU=e},expression:"isENU"}})],1)],1),t._v(" "),t.isENU?i("div",[i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"6"}},[i("span",[t._v("经度")])]),t._v(" "),i("Col",{attrs:{span:"18"}},[i("Input",{attrs:{placeholder:"请输入经度,范围180到-180"},model:{value:t.lng,callback:function(e){t.lng=t._n(e)},expression:"lng"}})],1)],1),t._v(" "),i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"6"}},[i("span",[t._v("纬度")])]),t._v(" "),i("Col",{attrs:{span:"18"}},[i("Input",{attrs:{placeholder:"请输入纬度,范围90到-90"},model:{value:t.lat,callback:function(e){t.lat=t._n(e)},expression:"lat"}})],1)],1)],1):i("div",[i("Row",{staticClass:"row-item",attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"6"}},[i("span",[t._v("坐标系")])]),t._v(" "),i("Col",{attrs:{span:"18"}},[i("Row",{attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"21"}},[i("Input",{attrs:{disabled:"",placeholder:"请选择坐标系"},model:{value:t.code,callback:function(e){t.code=e},expression:"code"}})],1),t._v(" "),i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"3"}},[i("span",{staticClass:"content-text-default span-split",on:{click:t.showSrsDialog}},[t._v("选择")])])],1)],1)],1)],1),t._v(" "),i("Row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex",justify:"end"}},[i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"24"}},[i("Button",{staticStyle:{"margin-right":"20px",width:"60px"},on:{click:function(e){return e.stopPropagation(),t.handleClose.apply(null,arguments)}}},[t._v("取消")]),t._v(" "),i("Button",{staticStyle:{width:"60px"},attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.handleOk.apply(null,arguments)}}},[t._v("确定")])],1)],1),t._v(" "),i("SrsDialog",{ref:"srsDialog",on:{"on-select":t.handleSrsSelect}})],1)},staticRenderFns:[]};var u=i("C7Lr")(c,h,!1,function(t){i("vIFc")},"data-v-593c3d88",null);e.a=u.exports},brHk:function(t,e,i){"use strict";var s=i("4YfN"),a=i.n(s),n=i("deIM"),l=i("T452"),r=i("Izdj");window.CESIUM_BASE_URL="./static/lib/Cesium";var o=window.Cesium,c=i("bSIt"),h={components:{Dialog:n.a},mixins:[r.a],data:function(){return{tableHeight:0,visible:!1,bSwitchMap:!0,viewer:null,title:"三维切片预览",id:null}},computed:a()({},Object(c.b)(["access_token"])),watch:{totalHeight:function(t){this.tableHeight=t>0?t-113:0,this.viewer&&this.viewer.resize()}},methods:{clear:function(){this.id=null},handleClose:function(){this.clear(),this.tableHeight=0,this.viewer&&this.viewer.destroy(),this.viewer=null,this.offResize&&this.offResize(),this.visible=!1,this.$emit("comp-close")},show:function(t){var e=this;this.clear(),this.onResize&&this.onResize(),this.id=t;var i={id:t,success:function(t){var i=(t||{}).name,s=void 0===i?null:i;e.name=s,e.title=s?"【"+s+"】三维切片预览":"三维切片预览",e.addTile3dLayer()}};this.$http.getTileset3DByID(i),this.visible=!0},addTile3dLayer:function(){var t=this;this.viewer=new o.Viewer("cesiumContainer"),new o.Cesium3DTileset({url:Object(l.c)(this.id,!0)}).readyPromise.then(function(e){t.viewer.scene.primitives.add(e),t.viewer.zoomTo(e,new o.HeadingPitchRange(0,-.5,2*e.boundingSphere.radius))}).otherwise(function(t){console.log(t)})}}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("Dialog",{staticClass:"cus-view",attrs:{isShowBottomBtn:!1,fullscreen:!0,title:this.title,visible:this.visible,showStep:!1},on:{cus_cancel:this.handleClose}},[e("div",{staticClass:"v-t-d-containter"},[e("div",{style:{zIndex:this.bSwitchMap?10:0},attrs:{id:"cesiumContainer"}})])])},staticRenderFns:[]};var d=i("C7Lr")(h,u,!1,function(t){i("unTm")},"data-v-31037e9f",null);e.a=d.exports},cG1s:function(t,e){},fsLt:function(t,e,i){"use strict";var s=i("deIM"),a=i("tIHl"),n=i("RuWt"),l={props:{action:{type:String,default:n.a.ADD}},data:function(){return{accept:"application/x-zip-compressed",format:["zip"],file:null,maxSize:10,showUpload:!0,percent:0,memo:"说明：需要把Data目录或平级metadata.xml元文件压缩成zip文件",ACTION:n.a,tmpFiles:null}},computed:{size:function(){return this.maxSize+"G"},limitSize:function(){return this.maxSize*n.v}},methods:{handleBeforeUpload:function(t){return this.file=null,/\.(zip)$/.test(t.name)?t.size>this.maxSize*n.u?(Object(a.a)(this.$t("message.fileSize10GError")),this.$refs.upload.clearFiles(),!1):(this.file=t,this.uploadFile(),!1):(Object(a.a)(this.$t("message.fileFormatError")),this.$refs.upload.clearFiles(),!1)},clearProgress:function(){this.progress=0},clear:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.percent=0,this.file=null,this.showUpload=!0,t&&(this.tmpFiles=null)},uploadFile:function(){var t=this;if(!this.file)return Object(a.a)(this.$t("message.fileNullError")),!1;if(!/\.(zip)$/.test(this.file.name))return Object(a.a)(this.$t("message.fileFormatError")),!1;var e=new FormData;e.append("files",this.file);var i={data:e,params:{tileset_type:n.F.TYPE_2},uploadProgress:function(e){t.percent=e.loaded/e.total*100|0},success:function(e){if(!e||0==e.length)return Object(a.b)("没有倾斜摄影模型数据."),t.showUpload=!0,t.clearProgress(),!1;t.action===n.a.EDIT?t.tmpFiles=e:t.tmpFiles=null,t.goNext(e)},error:function(e){e?Object(a.a)(e):Object(a.a)("未知错误"),t.showUpload=!0,t.clearProgress()}};this.showUpload=!1,this.clearProgress(),this.$http.updateModelFile(i)},goNext:function(t){this.$emit("next",{step:1,files:t,action:this.action}),this.showUpload=!0,this.clearProgress(),this.file=null}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showUpload,expression:"showUpload"}],staticClass:"upload_layout"},[i("span",{staticStyle:{color:"#707482","font-size":"14px","margin-bottom":"10px"}},[t._v("选择要上传的文件")]),t._v(" "),i("Upload",{ref:"upload",staticStyle:{width:"100%",padding:"0 20px"},attrs:{accept:t.accept,format:t.format,type:"drag","max-size":t.limitSize,action:"","before-upload":t.handleBeforeUpload}},[i("div",{staticClass:"upload-sub-layout"},[i("p",{staticStyle:{color:"#10243C","font-size":"12px",display:"flex","flex-direction":"row","align-items":"center"}},[i("i",{staticClass:"iconfont iconshangchuan-1 i-upload"}),t._v("\n          将文件拖至此处 或\n          "),i("span",{staticStyle:{color:"#44AAF6","margin-left":"5px"}},[t._v("点击上传")]),t._v("，文件大小不能超过"+t._s(t.size)+"\n        ")])])]),t._v(" "),t.action==t.ACTION.ADD?i("span",{staticStyle:{color:"red","font-size":"12px","margin-top":"5px"}},[t._v(t._s(t.memo))]):i("div",{staticClass:"f-s-qx-bottom"},[i("span",{staticStyle:{color:"red","font-size":"12px","margin-top":"5px"}},[t._v(t._s(t.memo))]),t._v(" "),i("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(e){return t.goNext(t.tmpFiles)}}},[t._v("下 一 步")])],1)],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.showUpload,expression:"!showUpload"}],staticClass:"upload_layout"},[i("Progress",{attrs:{"stroke-width":20,percent:t.percent}})],1)])},staticRenderFns:[]};var o=i("C7Lr")(l,r,!1,function(t){i("3U1C")},"data-v-7fbe132a",null).exports,c=i("4YfN"),h=i.n(c),u=i("2VhM"),d=i("7sWg"),p=i("XQUd"),f=i("uoUy"),v=i("lP4K"),m=i("E4LH"),g={components:{OriginOffsetDialog:d.a,KJCKDialog:p.a},data:function(){return{compress:!1,hasMetaData:!1,file:null,name:"",enu:"",crs:null,originOffset:{x:0,y:0,z:0},textureFormat:f.a.DEFAULT,textureArr:f.b,action:n.a.ADD,ACTIONS:n.a,id:null}},computed:{path:function(){return this.file?this.file.path:""},originOffsetLabel:function(){var t=this.originOffset||{},e=t.x,i=void 0===e?0:e,s=t.y,a=void 0===s?0:s,n=t.z;return[i,a,void 0===n?0:n].join()},spaceLabel:function(){return this.enu?"ENU:"+this.enu.lat+","+this.enu.lng:this.crs?""+this.crs.code:""}},methods:{clear:function(){this.compress=!1,this.hasMetaData=!1,this.file=null,this.name="",this.enu=null,this.crs=null,this.originOffset={x:0,y:0,z:0},this.textureFormat=f.a.DEFAULT,this.action=n.a.ADD,this.id=null},show:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.clear();var i=e.files,s=void 0===i?[]:i,a=e.id,l=void 0===a?null:a,r=e.action,o=void 0===r?n.a.ADD:r;if(s=s||[],this.action=o,this.id=l,o===n.a.ADD)s.length>0&&(this.file=h()({},s[0])),this.queryMetaData();else{var c={id:l,success:function(e){var i=e||{},a=i.name,n=void 0===a?null:a,r=i.detail,o=void 0===r?{}:r,c=o.tile,u=void 0===c?{}:c,d=o.source,p=void 0===d?{}:d;t.name=n;var m=p.enu,g=p.crs;t.originOffset=p.origin_offset||{x:0,y:0,z:0};var b=p.path,_=u.draco,y=void 0===_?{}:_,x=u.texture,C=void 0===x?{}:x,S=y.compress,w=void 0!==S&&S,D=C.format,k=void 0===D?f.a.DEFAULT:D;t.compress=w,t.textureFormat=k;var F={id:l,params:{path:b,type:v.b.OSGB},success:function(e){var i=e=e||{},a=i.enu,n=void 0===a?null:a,l=i.crs,r=void 0===l?null:l;if(t.hasMetaData=!(!n&&!r),s.length>0){t.file=h()({},s[0]);var o=t.file||{},c=o.path,u=o.name,d={id:o.id,params:{path:c,name:u,type:v.b.OSGB},success:function(e){var i=e=e||{},s=i.enu,a=void 0===s?null:s,n=i.crs,l=void 0===n?null:n,r=i.origin_offset,o=void 0===r?{x:0,y:0,z:0}:r;a||l?(t.hasMetaData=!0,t.enu=a,t.crs=l,t.originOffset=h()({},o)):(t.hasMetaData=!1,t.originOffset=h()({},o))}};t.$http.getOsgbMetaData(d)}else t.file={path:b},t.enu=m,t.crs=g}};t.$http.getOsgbMetaData(F)}};this.$http.getTileset3DByID(c)}},queryMetaData:function(){var t=this,e=this.file||{},i=e.path,s=e.name,a={id:e.id,params:{path:i,name:s,type:v.b.OSGB},success:function(e){var i=e=e||{},s=i.enu,a=void 0===s?null:s,n=i.crs,l=void 0===n?null:n,r=i.origin_offset,o=void 0===r?{x:0,y:0,z:0}:r;t.enu=a,t.crs=l,t.enu||t.crs?t.hasMetaData=!0:t.hasMetaData=!1,t.originOffset=h()({},o)}};this.$http.getOsgbMetaData(a)},reUpload:function(){this.$emit("previous",{step:2})},handleOk:function(){var t=this;if(m.b(this.name))return Object(a.a)("名称不能为空!"),!1;if(!this.file)return Object(a.a)("路径不能为空!"),!1;if(!this.enu&&!this.crs)return Object(a.a)("空间参考不能为空!"),!1;var e={name:this.name,path:this.path,enu:this.enu?{lng:this.enu.lng,lat:this.enu.lat}:null,crs:this.crs?{code:this.crs.code,proj4:this.crs.proj4,wkt:this.crs.wkt}:null,origin_offset:this.originOffset?h()({},this.originOffset):null,compress:this.compress,textureFormat:this.textureFormat},i=u.a.createOsgb(e);if(!i)return Object(a.a)("参数错误!"),!1;this.action==n.a.ADD?this.$Modal.confirm({title:"提示",content:"<p>确定要发布切片服务吗？</p>",onOk:function(){var e={params:i,success:function(e){t.goNext()}};t.$http.createTileset3D(e)}}):this.$Modal.confirm({title:"提示",content:"<p>确定要修改切片服务吗？</p>",onOk:function(){var e={params:i,id:t.id,success:function(e){t.goNext()}};t.$http.updateTileset3D(e)}})},showKJCKDialog:function(){this.$refs.kjckDialog.show({enu:this.enu,crs:this.crs})},goNext:function(){this.$emit("next",{step:2})},handleOnSetKJCK:function(t){this.enu=t.enu,this.crs=t.crs},showOriginOffsetDialog:function(){this.$refs.originOffsetDialog.show(this.originOffset)},handleOnSet:function(t){this.originOffset=h()({},t)}}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._m(0),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{placeholder:"请输入名称,长度不能超过64",maxlength:64},model:{value:t.name,callback:function(e){t.name="string"==typeof e?e.trim():e},expression:"name"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.path,callback:function(e){t.path="string"==typeof e?e.trim():e},expression:"path"}})],1)],1),t._v(" "),t._m(1),t._v(" "),t.hasMetaData?i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:"",placeholder:"请设置空间参考"},model:{value:t.spaceLabel,callback:function(e){t.spaceLabel=e},expression:"spaceLabel"}})],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Input",{attrs:{disabled:""},model:{value:t.originOffsetLabel,callback:function(e){t.originOffsetLabel=e},expression:"originOffsetLabel"}})],1)],1):i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{attrs:{span:"12"}},[i("Row",{attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"21"}},[i("Input",{attrs:{disabled:"",placeholder:"请设置空间参考"},model:{value:t.spaceLabel,callback:function(e){t.spaceLabel=e},expression:"spaceLabel"}})],1),t._v(" "),i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"3"}},[i("span",{staticClass:"content-text-default span-split",on:{click:t.showKJCKDialog}},[t._v("设置")])])],1)],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Row",{attrs:{type:"flex",align:"middle"}},[i("Col",{attrs:{span:"21"}},[i("Input",{attrs:{disabled:""},model:{value:t.originOffsetLabel,callback:function(e){t.originOffsetLabel=e},expression:"originOffsetLabel"}})],1),t._v(" "),i("Col",{staticStyle:{"text-align":"right"},attrs:{span:"3"}},[i("span",{staticClass:"content-text-default span-split",on:{click:t.showOriginOffsetDialog}},[t._v("设置")])])],1)],1)],1),t._v(" "),t._m(2),t._v(" "),i("Row",{staticClass:"row-item-split",attrs:{gutter:30,type:"flex"}},[i("Col",{staticStyle:{display:"flex","align-items":"center"},attrs:{span:"12"}},[i("Checkbox",{model:{value:t.compress,callback:function(e){t.compress=e},expression:"compress"}},[t._v("压缩")])],1),t._v(" "),i("Col",{attrs:{span:"12"}},[i("Select",{model:{value:t.textureFormat,callback:function(e){t.textureFormat=e},expression:"textureFormat"}},t._l(t.textureArr,function(e){return i("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}),1)],1)],1),t._v(" "),i("div",{staticStyle:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"flex-end",width:"100%","margin-top":"16px"}},[i("Button",{staticStyle:{float:"right","margin-right":"16px"},on:{click:t.reUpload}},[t._v(t._s(t.action==t.ACTIONS.ADD?"重新上传":"上一步"))]),t._v(" "),i("Button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.handleOk}},[t._v("确定")])],1),t._v(" "),i("KJCKDialog",{ref:"kjckDialog",on:{"on-set":t.handleOnSetKJCK}}),t._v(" "),i("OriginOffsetDialog",{ref:"originOffsetDialog",on:{"on-set":t.handleOnSet}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"i-s-item"},[e("div",{staticClass:"left-pannel"},[e("span",[this._v("*")]),this._v("名称")]),this._v(" "),e("div",{staticClass:"right-pannel"},[e("span",[this._v("*")]),this._v("路径")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"i-s-item row-item-split"},[e("div",{staticClass:"left-pannel"},[e("span",[this._v("*")]),this._v("空间参考")]),this._v(" "),e("div",{staticClass:"right-pannel"},[e("span"),this._v("零点坐标")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"i-s-item row-item-split"},[e("div",{staticClass:"left-pannel"},[e("span"),this._v("顶点压缩")]),this._v(" "),e("div",{staticClass:"right-pannel"},[e("span"),this._v("纹理格式")])])}]};var _=i("C7Lr")(g,b,!1,function(t){i("4O6x")},"data-v-4ec57e36",null).exports,y={components:{Dialog:s.a,FirstStep:o,SecondStep:_},data:function(){return{visible:!1,total:2,curStep:1,titles:["上传模型","发布切片"],action:n.a.ADD,id:null}},computed:{title:function(){return this.titles?this.action+"----"+this.titles[this.curStep-1]:""}},methods:{clear:function(){this.visible=!1,this.curStep=1,this.action=n.a.ADD,this.id=null},show:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.clear();var e=t.action,i=void 0===e?n.a.ADD:e,s=t.id,a=void 0===s?null:s;this.action=i,this.id=a,this.$refs.firstStep&&this.$refs.firstStep.clear(),this.visible=!0},handleClose:function(){this.visible=!1,this.$emit("close-fb")},nextStep:function(t){if(1==t.step){var e=t.files||null;this.action==n.a.ADD?e&&e.length>0&&(this.$refs.secondStep&&this.$refs.secondStep.show({files:e,id:this.id,action:this.action}),this.curStep++):(this.$refs.secondStep&&this.$refs.secondStep.show({files:e,id:this.id,action:this.action}),this.curStep++)}else 2==t.step&&this.handleClose()},previousStep:function(t){if(2==t.step){var e=this.action===n.a.ADD;this.$refs.firstStep&&this.$refs.firstStep.clear(e),this.curStep--}}}},x={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("Dialog",{attrs:{isShowBottomBtn:!1,title:t.title,visible:t.visible,showStep:!0,total:t.total,num:t.curStep,styles:{top:"20vh",width:"700px"}},on:{cus_cancel:t.handleClose}},[i("FirstStep",{directives:[{name:"show",rawName:"v-show",value:1===t.curStep,expression:"curStep === 1"}],ref:"firstStep",attrs:{action:t.action},on:{next:t.nextStep}}),t._v(" "),i("SecondStep",{directives:[{name:"show",rawName:"v-show",value:2===t.curStep,expression:"curStep === 2"}],ref:"secondStep",on:{next:t.nextStep,previous:t.previousStep}})],1)},staticRenderFns:[]};var C=i("C7Lr")(y,x,!1,function(t){i("DgzN")},"data-v-45ba4032",null);e.a=C.exports},hDZW:function(t,e){},jWD3:function(t,e){},kImE:function(t,e){},lP4K:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var s={NONE:"none",OBJ:"obj",GLTF:"gltf",GLB:"glb",SHP:"shp",DB:"db",OSGB:"osgb",FBX:"fbx"},a=[{label:"SHP",value:s.SHP},{label:"OBJ",value:s.OBJ},{label:"FBX",value:s.FBX}];e.b=s},q6J6:function(t,e){},unTm:function(t,e){},uoUy:function(t,e,i){"use strict";i.d(e,"a",function(){return s}),i.d(e,"b",function(){return a}),e.c=function(t){var e=a.find(function(e){return e.value==t});return e?e.label:"未知"};var s={DEFAULT:"default",WEBP:"webp",KTX2:"ktx2"},a=[{value:s.DEFAULT,label:"默认"},{value:s.WEBP,label:"webp"},{value:s.KTX2,label:"ktx2"}]},vIFc:function(t,e){}});